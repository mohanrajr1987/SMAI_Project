Id,PostTypeId,AcceptedAnswerId,ParentId,CreationDate,DeletionDate,Score,ViewCount,Body,OwnerUserId,OwnerDisplayName,LastEditorUserId,LastEditorDisplayName,LastEditDate,LastActivityDate,Title,Tags,AnswerCount,CommentCount,FavoriteCount,ClosedDate,CommunityOwnedDate,PostId,Id
"85","1","154","","2008-08-01 14:19:52","","61","24109","<p>What are your best practices around creating flat file database structures in PHP?  A lot of the more mature PHP flat file frameworks I see out there attempt to implement SQL-like query syntax, which is over the top for my purposes in most cases (I would just use a database at that point).</p>

<p>Are there any elegant tricks out there to get good performance and features with the small code overhead one would want by taking on this problem in the first place?</p>","59","","243557","saint_groceon","2013-10-04 01:17:44","2015-08-24 17:50:22","Flat File Databases","<php><sql><database><flat-file>","13","0","13","","","85","22"
"109","1","2585","","2008-08-01 15:23:05","","24","4073","<p>Recently our site has been deluged with the resurgence of the <a href=""https://en.wikipedia.org/wiki/Asprox_botnet"">Asprox botnet</a> <a href=""http://en.wikipedia.org/wiki/SQL_injection"">SQL injection</a> attack. Without going into details, the attack attempts to execute SQL code by encoding the <a href=""http://en.wikipedia.org/wiki/Transact-SQL"">T-SQL</a> commands in an ASCII encoded BINARY string. It looks something like this:</p>

<pre><code>DECLARE%20@S%20NVARCHAR(4000);SET%20@S=CAST(0x44004500...06F007200%20AS%20NVARCHAR(4000));EXEC(@S);--
</code></pre>

<p>I was able to decode this in SQL, but I was a little wary of doing this since I didn't know exactly what was happening at the time.</p>

<p>I tried to write a simple decode tool, so I could decode this type of text without even touching <a href=""http://en.wikipedia.org/wiki/Microsoft_SQL_Server"">SQL&nbsp;Server</a>. The main part I need decoded is:</p>

<pre><code>CAST(0x44004500...06F007200 AS
NVARCHAR(4000))
</code></pre>

<p>I've tried all of the following commands with no luck:</p>

<pre><code>txtDecodedText.Text =
    System.Web.HttpUtility.UrlDecode(txtURLText.Text);
txtDecodedText.Text =
    Encoding.ASCII.GetString(Encoding.ASCII.GetBytes(txtURLText.Text));
txtDecodedText.Text =
    Encoding.Unicode.GetString(Encoding.Unicode.GetBytes(txtURLText.Text));
txtDecodedText.Text =
    Encoding.ASCII.GetString(Encoding.Unicode.GetBytes(txtURLText.Text));
txtDecodedText.Text =
    Encoding.Unicode.GetString(Convert.FromBase64String(txtURLText.Text));
</code></pre>

<p>What is the proper way to translate this encoding without using SQL Server? Is it possible? I'll take VB.NET code since I'm familiar with that too.</p>

<hr>

<p>Okay, I'm sure I'm missing something here, so here's where I'm at.</p>

<p>Since my input is a basic string, I started with just a snippet of the encoded portion - 4445434C41 (which translates to DECLA) - and the first attempt was to do this...</p>

<pre><code>txtDecodedText.Text = Encoding.UTF8.GetString(Encoding.UTF8.GetBytes(txtURL.Text));
</code></pre>

<p>...and all it did was return the exact same thing that I put in, since it converted each character into is byte.</p>

<p>I realized that I need to parse each two characters into a byte manually since I don't know of any methods yet that will do that, so now my little decoder looks something like this:</p>

<pre><code>while (!boolIsDone)
{
    bytURLChar = byte.Parse(txtURLText.Text.Substring(intParseIndex, 2));
    bytURL[intURLIndex] = bytURLChar;
    intParseIndex += 2;
    intURLIndex++;

    if (txtURLText.Text.Length - intParseIndex &lt; 2)
    {
        boolIsDone = true;
    }
}

txtDecodedText.Text = Encoding.UTF8.GetString(bytURL);
</code></pre>

<p>Things look good for the first couple of pairs, but then the loop balks when it gets to the ""4C"" pair and says that the string is in the incorrect format.</p>

<p>Interestingly enough, when I step through the debugger and to the GetString method on the byte array that I was able to parse up to that point, I get "",-+"" as the result.</p>

<p>How do I figure out what I'm missing - do I need to do a ""direct cast"" for each byte instead of attempting to parse it?</p>
","71","","63550","Jeff Atwood","2015-01-08 16:27:49","2015-01-08 17:02:44","Decoding T-SQL CAST in C#/VB.NET","<c#><sql><vb.net><ascii><hex>","2","3","","","","109","22"
"120","1","","","2008-08-01 15:50:08","","17","1046","<p>Has anyone got experience creating SQL-based ASP.NET site-map providers?</p>

<p>I've got the default XML file <em>web.sitemap</em> working properly with my Menu and SiteMapPath controls, but I'll need a way for the users of my site to create and modify pages dynamically.</p>

<p>I need to tie page viewing permissions into the standard ASP.NET membership system as well.</p>
","83","Zack","250832","Leon Bambrick","2015-06-09 13:45:55","2015-06-09 13:45:55","ASP.NET Site Maps","<sql><asp.net><sitemap>","1","0","2","","","120","22"
"308","1","360","","2008-08-02 01:52:54","","78","17915","<p>I often run into the following problem.</p>

<p>I work on some changes to a project that require new tables or columns in the database. I make the database modifications and continue my work. Usually, I remember to write down the changes so that they can be replicated on the live system. However, I don't always remember what I've changed and I don't always remember to write it down.</p>

<p>So, I make a push to the live system and get a big, obvious error that there is no <code>NewColumnX</code>, ugh.</p>

<p>Regardless of the fact that this may not be the best practice for this situation, is there a version control system for databases? I don't care about the specific database technology. I just want to know if one exists. If it happens to work with MS SQL Server, then great.</p>
","106","Sean","1039608","Ryan Fox","2012-05-04 09:38:02","2015-08-04 05:43:04","Is there a version control system for database structure changes?","<sql><database><version-control>","25","1","36","","","308","22"
"594","1","595","","2008-08-03 01:15:08","","15","16807","<p>There are several ways to iterate over a result set, which way is the best?</p>
","116","","1399491","Mark Harrison","2012-07-02 15:23:39","2012-07-02 15:23:39","cx_Oracle - what is the best way to iterate over a result set?","<python><sql><database><oracle><cx-oracle>","3","1","3","","","594","22"
"644","1","665","","2008-08-03 09:55:26","","26","5323","<p>I have a database table and one of the fields (not the primary key) is having a unique index on it. Now I want to swap values under this column for two rows. How could this be done? Two hacks I know are:</p>

<ol>
<li>Delete both rows and re-insert them</li>
<li>Update rows with some other value
and swap and then update to actual value.</li>
</ol>

<p>But I don't want to go for these as they do not seem to be the appropriate solution to the problem.
Could anyone help me out?</p>
","191","Ramesh Soni","1332690","","2012-04-25 04:46:28","2012-09-15 12:38:09","Swap unique indexed column values in database","<sql><database>","9","0","3","","","644","22"
"1042","1","1061","","2008-08-04 05:51:56","","7","6241","<p>For instance, my query is like the following using SQL Server 2005:</p>

<pre><code>SELECT * FROM Table WHERE FREETEXT(SearchField, 'c#')
</code></pre>

<p>I have a full text index defined to use the column SearchField which returns results when using:</p>

<pre><code>SELECT * FROM Table WHERE SearchField LIKE '%c#%'
</code></pre>

<p>I believe # is a special letter, so how do I allow FREETEXT to work correctly for the query above?</p>
","2","","2641576","Chris Fournier","2014-11-25 20:40:10","2014-11-25 20:40:10","Why doesn't SQL Full Text Indexing return results for words containing #?","<sql><sql-server><sql-server-2005><indexing><full-text-search>","2","1","","","","1042","22"
"1156","1","1157","","2008-08-04 11:21:26","","28","22088","<p>Hopefully, I can get answers for each database server.</p>

<p>For an outline of how indexing works check out: <a href=""http://stackoverflow.com/questions/1108/how-does-database-indexing-work"" rel=""nofollow"">http://stackoverflow.com/questions/1108/how-does-database-indexing-work</a></p>","264","","13302","","2012-02-15 06:34:52","2015-06-02 13:57:11","How do I index a database column","<sql><database><indexing>","5","3","13","","","1156","22"
"1451","1","1477","","2008-08-04 17:46:28","","12","1221","<p>I often encounter the following scenario where I need to offer many different types of permissions. I primarily use ASP.NET / VB.NET with SQL Server 2000.</p>

<p><strong>Scenario</strong></p>

<p>I want to offer a dynamic permission system that can work on different parameters. Let's say that I want to give either a department or just a specific person access to an application. And pretend that we have a number of applications that keeps growing.</p>

<p>In the past, I have chosen one of the following two ways that I know to do this.</p>

<p>1) Use a single permission table with special columns that are used for determining a how to apply the parameters. The special columns in this example are TypeID and TypeAuxID. The SQL would look something like this.</p>

<pre><code>SELECT COUNT(PermissionID)
FROM application_permissions
WHERE
(TypeID = 1 AND TypeAuxID = @UserID) OR
(TypeID = 2 AND TypeAuxID = @DepartmentID)
AND ApplicationID = 1
</code></pre>

<p>2) Use a mapping table for each type of permission, then joining them all together.</p>

<pre><code>SELECT COUNT(perm.PermissionID)
FROM application_permissions perm
LEFT JOIN application_UserPermissions emp
ON perm.ApplicationID = emp.ApplicationID
LEFT JOIN application_DepartmentPermissions dept
ON perm.ApplicationID = dept.ApplicationID
WHERE q.SectionID=@SectionID
  AND (emp.UserID=@UserID OR dept.DeptID=@DeptID OR
 (emp.UserID IS NULL AND dept.DeptID IS NULL)) AND ApplicationID = 1
ORDER BY q.QID ASC
</code></pre>

<p><strong>My Thoughts</strong></p>

<p>I hope that the examples make sense. I cobbled them together.</p>

<p>The first example requires less work, but neither of them feel like the best answer. Is there a better way to handle this?</p>
","106","","268273","","2012-03-02 07:21:58","2012-03-02 07:21:58","What is the best way to handle multiple permission types?","<sql><permissions>","5","0","5","","","1451","22"
"1970","1","59345","","2008-08-05 06:39:31","","7","2229","<p>PostgreSQL is interesting in that it supports several languages for writing stored procedures.  Which one do you use, and why?</p>
","116","","939860","","2011-10-14 07:28:02","2013-11-05 16:37:22","What language do you use for PostgreSQL triggers and stored procedures?","<sql><database><postgresql><stored-procedures><triggers>","8","1","","","","1970","22"
"1973","1","2700","","2008-08-05 06:48:38","","76","19920","<p>I've provided a solution for Python... please flesh this out with examples for other languages.</p>
","116","","3818739","Jeff Atwood","2014-07-30 03:49:16","2014-07-30 03:49:16","What is the best way to avoid SQL injection attacks?","<python><sql><database><security><sql-injection>","27","0","40","2012-08-06 14:28:27","2008-09-02 06:49:25","1973","22"
"2120","1","2382","","2008-08-05 11:49:11","","64","58814","<p>I want to get the MD5 Hash of a string value in SQL Server 2005. I do this with the following command:</p>

<pre><code>SELECT HashBytes('MD5', 'HelloWorld')
</code></pre>

<p>However, this returns a VarBinary instead of a VarChar value. If I attempt to convert <code>0x68E109F0F40CA72A15E05CC22786F8E6</code> into a VarChar I get <code>há ðô§*à\Â'†øæ</code> instead of <code>68E109F0F40CA72A15E05CC22786F8E6</code>.</p>

<p>Is there any SQL-based solution?</p>

<p><strong><a href=""http://stackoverflow.com/questions/2120/#2382"">Yes</a></strong></p>
","383","","496830","GateKiller","2011-09-07 15:58:18","2015-08-31 16:03:24","Convert HashBytes to VarChar","<sql>","8","0","17","","","2120","22"
"2647","1","2657","","2008-08-05 18:15:47","","293","489320","<p>Using SQL Server 2005, how do I split a string so I can access item x?</p>

<p>For example, take the string ""Hello John Smith"". How can I split the string by a space and access the item at index 1 which should return ""John""?</p>
","383","","3234422","","2014-04-25 08:11:55","2015-08-31 16:37:31","How do I split a string so I can access item x","<sql><sql-server><string><sql-server-2005><split>","29","1","83","","","2647","22"
"2702","1","2736","","2008-08-05 18:55:35","","15","28873","<p>I know I need to have (although I don't know why) an Order By clause on the end of a SQL query that uses any aggregate functions like count, sum, avg, etc:</p>

<pre><code>select count(userID), userName from users group by userName<br></code></pre>

<p>When else would GROUP BY be useful, and what are the performance ramifications?</p>","357","","9314","","2009-07-27 01:51:20","2012-11-27 13:33:37","How do I use T-SQL Group By","<sql><group-by>","5","1","2","","","2702","22"
"2811","1","2825","","2008-08-05 20:35:56","","4","3787","<p>I have a table with a structure like the following:</p>

<pre><code>------------------------------
LocationID     | AccountNumber
------------------------------
long-guid-here | 12345
long-guid-here | 54321
</code></pre>

<p>To pass into another stored procedure, I need the XML to look like this:</p>

<pre><code>&lt;root&gt; 
    &lt;clientID&gt;12345&lt;/clientID&gt;
    &lt;clientID&gt;54321&lt;/clientID&gt;
&lt;/root&gt;
</code></pre>

<p>The best I've been able to do so far was getting it like this:</p>

<pre><code>&lt;root clientID=""10705""/&gt;
</code></pre>

<p>I'm using this SQL statement:</p>

<pre><code>SELECT
    1 as tag,
    null as parent,
    AccountNumber as 'root!1!clientID'
FROM
    Location.LocationMDAccount
WHERE
    locationid = 'long-guid-here'
FOR XML EXPLICIT
</code></pre>

<p>So far, I've looked at the documentation on <a href=""http://msdn.microsoft.com/en-us/library/ms345137.aspx"" rel=""nofollow"">the MSDN page</a>, but I've not come out with the desired results.</p>

<hr>

<p>@KG,</p>

<p>Yours gave me this output actually:</p>

<pre><code>&lt;root&gt;
  &lt;Location.LocationMDAccount&gt;
    &lt;clientId&gt;10705&lt;/clientId&gt;
  &lt;/Location.LocationMDAccount&gt;
&lt;/root&gt;
</code></pre>

<p>I'm going to stick with the <code>FOR XML EXPLICIT</code> from Chris Leon for now.</p>
","448","","1039608","Kevin Fairchild","2012-05-04 09:51:19","2013-01-09 05:42:01","SQL Server 2005 For XML Explicit - Need help formatting","<sql><xml><sql-server-2005><formatting><for-xml>","5","0","","","","2811","22"
"2840","1","2843","","2008-08-05 20:57:00","","31","6014","<p>How do I page results in SQL Server 2005?</p>

<p>I tried it in SQL Server 2000, but there was no reliable way to do this. I'm now wondering if SQL Server 2005 has any built in method?</p>

<p>What I mean by paging is, for example, if I list users by their username, I want to be able to only return the first 10 records, then the next 10 records and so on.</p>

<p>Any help would be much appreciated.</p>
","383","","1039608","","2012-05-04 09:48:29","2012-05-04 09:48:29","Paging SQL Server 2005 Results","<sql><sql-server-2005><paging>","6","0","20","","","2840","22"
"3196","1","3197","","2008-08-06 09:00:58","","10","20781","<p>If I have data like this:</p>

<pre><code>+---+----+
|Key|Name|
+---+----+
|1  |Dan |
+---+----+
|2  |Tom |
+---+----+
|3  |Jon |
+---+----+
|4  |Tom |
+---+----+
|5  |Sam |
+---+----+
|6  |Dan |
+---+----+
</code></pre>

<p>What is the SQL query to bring back the records where <code>Name</code> is repeated 2 or more times?</p>

<p>So the result I would want is</p>

<pre><code> +---+
 |Tom|
 +---+
 |Dan|
 +---+
</code></pre>
","230","","1179699","Jeff Atwood","2014-01-16 10:20:09","2014-01-16 10:20:09","SQL query, count and group by","<sql>","3","0","4","","","3196","22"
"3272","1","5101","","2008-08-06 10:43:16","","4","1670","<p>I am currently working on a project with specific requirements.  A brief overview of these are as follows:  </p>

<ul>
<li>Data is retrieved from external webservices</li>
<li>Data is stored in SQL 2005</li>
<li>Data is manipulated via a web GUI</li>
<li>The windows service that communicates with the web services has no coupling with our internal web UI, except via the database.</li>
<li>Communication with the web services needs to be both time-based, and triggered via user intervention on the web UI.</li>
</ul>

<p>The current (pre-pre-production) model for web service communication triggering is via a database table that stores trigger requests generated from the manual intervention.  I do not really want to have multiple trigger mechanisms, but would like to be able to populate the database table with triggers based upon the time of the call.  As I see it there are two ways to accomplish this.</p>

<p>1) Adapt the trigger table to store two extra parameters.  One being ""Is this time-based or manually added?"" and a nullable field to store the timing details (exact format to be determined).  If it is a manaully created trigger, mark it as processed when the trigger has been fired, but not if it is a timed trigger.<br>
<em>or</em><br>
2) Create a second windows service that creates the triggers on-the-fly at timed intervals.</p>

<p>The second option seems like a fudge to me, but the management of option 1 could easily turn into a programming nightmare (how do you know if the last poll of the table returned the event that needs to fire, and how do you then stop it re-triggering on the next poll)</p>

<p>I'd appreciate it if anyone could spare a few minutes to help me decide which route (one of these two, or possibly a third, unlisted one) to take.</p>
","377","","4714","Chris Fournier","2012-01-31 14:26:13","2012-01-31 14:26:13","Timer-based event triggers","<sql><web-services><service><triggers><timer>","3","0","","","","3272","22"
"3432","1","3466","","2008-08-06 14:12:09","","168","138177","<p>I know that you can insert multiple rows at once, is there a way to update multiple rows at once (as in, in one query) in MySQL?</p>

<p>Edit:
For example I have the following</p>

<pre><code>Name   id  Col1  Col2<br>Row1   1    6     1<br>Row2   2    2     3<br>Row3   3    9     5<br>Row4   4    16    8<br></code></pre>

<p>I want to combine all the following Updates into one query</p>

<pre><code>UPDATE table SET Col1 = 1 WHERE id = 1;<br>UPDATE table SET Col1 = 2 WHERE id = 2;<br>UPDATE table SET Col2 = 3 WHERE id = 3;<br>UPDATE table SET Col1 = 10 WHERE id = 4;<br>UPDATE table SET Col2 = 12 WHERE id = 4;<br></code></pre>","1384652","","426671","Teifion","2013-06-25 20:03:23","2015-09-29 22:11:25","Multiple Updates in MySQL","<mysql><sql><sql-update>","15","0","95","","","3432","22"
"3567","1","3578","","2008-08-06 15:41:13","","3","132","<p>In SqlServer. How do you query a db to bring back all the tables that have a field of a specific name?</p>
","230","","35","Greg Hurlman","2008-08-21 18:53:08","2011-06-28 18:43:46","Sql to query a dbs scheme","<sql><sql-server>","3","0","","","","3567","22"
"3589","1","3609","","2008-08-06 15:53:51","","11","12194","<P>I need to create a backup of a SQL Server 2005 Database that's only the structure...no records, just the schema. Is there any way to do this?</P>
<P>EDIT: I'm trying to create a backup file to use with old processes, so a script wouldn't work for my purposes, sorry</P>","44","","2641576","Nigel Campbell","2014-11-25 20:55:48","2014-11-25 20:55:48","Backup SQL Schema Only?","<sql><sql-server><sql-server-2005><backup>","4","0","1","","","3589","22"
"3682","1","155901","","2008-08-06 16:58:34","","3","1367","<p>I have a MySQL table with approximately 3000 rows per user. One of the columns is a datetime field, which is mutable, so the rows aren't in chronological order.</p>

<p>I'd like to visualize the time distribution in a chart, so I need a number of individual datapoints. 20 datapoints would be enough.</p>

<p>I could do this:</p>

<pre><code>select timefield from entries where uid = ? order by timefield;
</code></pre>

<p>and look at every 150th row.</p>

<p>Or I could do 20 separate queries and use <code>limit 1</code> and <code>offset</code>. </p>

<p>But there must be a more efficient solution...</p>
","136","","866022","Michiel de Mare","2012-05-21 17:37:00","2014-02-27 11:36:00","Distribution of table in time","<sql><mysql>","7","1","","","","3682","22"
"3839","1","3860","","2008-08-06 18:47:24","","8","10000","<p>I'm trying out the following query:</p>

<pre><code>SELECT A,B,C FROM table WHERE field LIKE 'query%'
UNION
SELECT A,B,C FROM table WHERE field LIKE '%query'
UNION
SELECT A,B,C FROM table WHERE field LIKE '%query%'
GROUP BY B ORDER BY B ASC LIMIT 5
</code></pre>

<p>That's three queries stuck together, kindasorta. However, the result set that comes back reflects results from query #3 BEFORE results from query #1 (undesired).</p>

<p>Is there any way to prioritize these so that results come as all for query #1, then all for query #2 then all for query #3? I don't want to do this in PHP just yet (not to mention having to control for results that showed up in the first query not to show in the second and so forth).</p>

<p>edit: many thanks to all! <a href=""http://stackoverflow.com/questions/3839/how-do-i-concatenate-entire-result-sets-in-mysql#3876"">the solution</a> turned out to be a mix of all answers. worked beautifully!.</p>
","547","","426671","mauriciopastrana","2013-06-25 20:03:51","2015-03-15 19:47:56","How do I Concatenate entire result sets in MySQL?","<mysql><sql><union>","7","0","","","","3839","22"
"4110","1","4126","","2008-08-06 23:19:50","","4","3612","<p>I've been tasked with redesigning part of a ms-sql database structure which currently involves a lot of views, some of which contain joins to other views. </p>

<p>Anyway, I wonder if anyone here could recommend a utility to automatically generate diagrams to help me visualise the whole structure.</p>

<p>What's the best program you've used for such problems?</p>
","369","","116","Mark Harrison","2008-08-18 16:19:28","2014-12-13 16:24:17","What program can I use to generate diagrams of SQL view/table structure?","<sql><sql-server><database><diagram>","5","0","1","2014-12-30 11:43:01","","4110","22"
"4393","1","4401","","2008-08-07 04:41:37","","66","85348","<p>I'd like a script to drop all tables whose name begins with a given string. I'm sure this can be done with some dynamic sql and the <code>INFORMATION_SCHEMA</code> tables.</p>

<p>If anyone has a script, or can knock one up quickly, please post it.</p>

<p>If no-one posts an answer before I figure it out myself, I'll post my solution.</p>
","369","","369","moocha","2013-01-07 21:12:00","2015-07-28 06:14:25","Drop all tables whose names begin with a certain string","<sql><sql-server><scripting><dynamic-sql>","11","0","20","","","4393","22"
"4511","1","","","2008-08-07 08:04:30","","12","458","<p>New version of Management Studio (i.e. the one that ships with SQL Server 2008) finally has a Transact-SQL IntelliSense feature. However, out-of-the-box it only works with SQL Server 2008 instances.</p>

<p>Is there some workaround for this?</p>
","95","","2641576","Mark Harrison","2014-11-25 16:51:31","2014-11-25 16:51:31","Is there any trick that allows to use Management Studio's (ver. 2008) IntelliSense feature with earlier versions of SQL Server?","<sql><sql-server><database><sql-server-2008><intellisense>","2","2","","","","4511","22"
"4622","1","4626","","2008-08-07 12:13:01","","36","120934","<p>What is the <strong>complete</strong> and correct syntax for the SQL Case statement?</p>
","383","","3492139","Mark Harrison","2014-05-26 08:50:42","2014-05-26 08:50:42","SQL Case Statement Syntax?","<sql><sql-server><database><oracle><syntax>","8","0","13","","","4622","22"
"4891","1","4908","","2008-08-07 16:06:33","","3","296","<p>When developing whether its Web or Desktop at which point should a developer switch from SQLite, MySQL, MS SQL, etc</p>
","567","","1280410","","2012-05-03 14:06:32","2012-05-03 14:06:32","What point should someone decide to switch Database Systems","<sql><database>","3","0","","","","4891","22"
"4994","1","","","2008-08-07 17:18:37","","5","1451","<p>I am currently creating a master ddl for our database.  Historically we have used backup/restore to version our database, and not maintained any ddl scripts.  The schema is quite large.</p>

<p>My current thinking:</p>

<ul>
<li><p>Break script into parts (possibly in separate scripts):</p>

<ol>
<li>table creation</li>
<li>add indexes</li>
<li>add triggers</li>
<li>add constraints</li>
</ol></li>
<li><p>Each script would get called by the master script.</p></li>
<li>I might need a script to drop constraints temporarily for testing</li>
<li>There may be orphaned tables in the schema, I plan to identify suspect tables.</li>
</ul>

<p>Any other advice?</p>

<p>Edit: Also if anyone knows good tools to automate part of the process, we're using MS SQL 2000 (old, I know).</p>
","92","","116","Mark Harrison","2008-08-18 16:17:33","2010-08-29 06:50:55","How should I organize my master ddl script","<sql><sql-server><schema><ddl>","7","0","2","","","4994","22"
"5142","1","","","2008-08-07 18:52:07","","2","4708","<p>I created a view on a machine using the <em>substring</em> function from Firebird, and it worked.  When I copied the database to a different machine, the view was broken.  This is the way I used it:</p>

<pre><code>SELECT SUBSTRING(field FROM 5 FOR 15) FROM table;<br></code></pre>

<p>And this is the output on the machine that does not accept the function:</p>

<pre><code>token unknown:  FROM<br></code></pre>

<p>Both computers have this configuration:</p>

<ul>
<li><em>IB Expert</em> version 2.5.0.42 to run the queries and deal with the database.</li>
<li><em>Firebird</em> version 1.5 as server to database.</li>
<li><em>BDE Administration</em> version 5.01 installed, with <em>Interbase</em> 4.0 drivers.</li>
</ul>

<p>Any ideas about why it's behaving differently on these machines?</p>","431","","","","","2011-09-04 20:10:11","Firebird's SQL's Substring function not working","<sql><firebird><interbase>","2","0","1","","","5142","22"
"5802","1","5812","","2008-08-08 10:41:00","","5","3267","<p>Is there any way to use inheritance in database (Specifically in SQL Server 2005)?</p>

<p>Suppose I have few field like <strong>CreatedOn</strong>, <strong>CreatedBy</strong> which I want to add on all of my entities. I looking for an alternative way instead of adding these fields to every table.</p>","191","Ramesh Soni","2641576","","2014-11-25 20:40:04","2014-11-25 20:40:04","Inheritance in database?","<sql><database><inheritance><sql-server-2005>","9","3","","","","5802","22"
"6340","1","6349","","2008-08-08 20:07:43","","4","28532","<p>I've got a table that is supposed to track days and costs for shipping product from one vendor to another. We (brilliantly :p) stored both the shipping vendors (FedEx, UPS) with the product handling vendors (Think... Dunder Mifflin) in a ""VENDOR"" table. So, I have three columns in my SHIPPING_DETAILS table that all reference VENDOR.no. For some reason MySQL isn't letting me define all three as foreign keys. Any ideas?</p>

<pre><code>CREATE TABLE SHIPPING_GRID(  
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY COMMENT 'Unique ID for each row',  
    shipping_vendor_no INT(6) NOT NULL COMMENT 'Foreign key to VENDOR.no for the shipping vendor (vendors_type must be 3)',  
    start_vendor_no INT(6) NOT NULL COMMENT 'Foreign key to VENDOR.no for the vendor being shipped from',  
    end_vendor_no INT(6) NOT NULL COMMENT 'Foreign key to the VENDOR.no for the vendor being shipped to',  
    shipment_duration INT(1) DEFAULT 1 COMMENT 'Duration in whole days shipment will take',  
    price FLOAT(5,5) NOT NULL COMMENT 'Price in US dollars per shipment lbs (down to 5 decimal places)',  
    is_flat_rate TINYINT(1) DEFAULT 0 COMMENT '1 if is flat rate regardless of weight, 0 if price is by lbs',  
    INDEX (shipping_vendor_no),  
    INDEX (start_vendor_no),  
    INDEX (end_vendor_no),  
    FOREIGN KEY (shipping_vendor_no) REFERENCES VENDOR (no),  
    FOREIGN KEY (start_vendor_no) REFERENCES VENDOR (no),  
    FOREIGN KEY (end_vendor_no) REFERENCES VENDOR (no)  
) TYPE = INNODB;
</code></pre>

<p><em>Edited to remove double primary key definition...</em></p>

<hr>

<p>Yeah, unfortunately that didn't fix it though. Now I'm getting:</p>

<blockquote>
  <p>Can't create table
  './<em>REMOVED MY DB NAME</em>/SHIPPING_GRID.frm'
  (errno: 150)</p>
</blockquote>

<p>Doing a phpinfo() tells me this for mysql:</p>

<blockquote>
  <p>Client API version    5.0.45</p>
</blockquote>

<p>Yes, the VENDOR.no is type int(6).</p>
","58","","2040040","chills42","2013-11-03 05:06:52","2013-11-03 05:06:52","Multiple foreign keys?","<sql><mysql><foreign-keys>","3","1","1","","","6340","22"
"6369","1","10838","","2008-08-08 20:48:29","","11","29792","<p>So I have a Sybase stored proc that takes 1 parameter that's a comma separated list of strings and runs a query with in in an IN() clause:</p>

<pre><code>CREATE PROCEDURE getSomething @keyList varchar(4096)
AS
SELECT * FROM mytbl WHERE name IN (@keyList)
</code></pre>

<p>How do I call my stored proc with more than 1 value in the list?
So far I've tried </p>

<pre><code>exec getSomething 'John'         -- works but only 1 value
exec getSomething 'John','Tom'   -- doesn't work - expects two variables
exec getSomething ""'John','Tom'"" -- doesn't work - doesn't find anything
exec getSomething '""John"",""Tom""' -- doesn't work - doesn't find anything
exec getSomething '\'John\',\'Tom\'' -- doesn't work - syntax error
</code></pre>

<p><strong>EDIT:</strong> I actually found this <a href=""http://vyaskn.tripod.com/passing%5Farrays%5Fto%5Fstored%5Fprocedures.htm"" rel=""nofollow"">page</a> that has a great reference of the various ways to pas an array to a sproc</p>
","779","","1563422","Graeme Perrow","2013-03-14 04:51:41","2014-03-23 20:23:24","How to pass a comma separated list to a stored procedure?","<sql><sybase-ase>","9","2","3","","","6369","22"
"6899","1","6980","","2008-08-09 20:11:18","","117","57262","<p>To illustrate, assume that I have two tables as follows:</p>

<pre><code>VehicleID Name
1         Chuck
2         Larry

LocationID VehicleID City
1          1         New York
2          1         Seattle
3          1         Vancouver
4          2         Los Angeles
5          2         Houston
</code></pre>

<p>I want to write a query to return the following results:</p>

<pre><code>VehicleID Name    Locations
1         Chuck   New York, Seattle, Vancouver
2         Larry   Los Angeles, Houston
</code></pre>

<p>I know that this can be done using server side cursors, ie:</p>

<pre><code>DECLARE @VehicleID int
DECLARE @VehicleName varchar(100)
DECLARE @LocationCity varchar(100)
DECLARE @Locations varchar(4000)
DECLARE @Results TABLE
(
  VehicleID int
  Name varchar(100)
  Locations varchar(4000)
)

DECLARE VehiclesCursor CURSOR FOR
SELECT
  [VehicleID]
, [Name]
FROM [Vehicles]

OPEN VehiclesCursor

FETCH NEXT FROM VehiclesCursor INTO
  @VehicleID
, @VehicleName
WHILE @@FETCH_STATUS = 0
BEGIN

  SET @Locations = ''

  DECLARE LocationsCursor CURSOR FOR
  SELECT
    [City]
  FROM [Locations]
  WHERE [VehicleID] = @VehicleID

  OPEN LocationsCursor

  FETCH NEXT FROM LocationsCursor INTO
    @LocationCity
  WHILE @@FETCH_STATUS = 0
  BEGIN
    SET @Locations = @Locations + @LocationCity

    FETCH NEXT FROM LocationsCursor INTO
      @LocationCity
  END
  CLOSE LocationsCursor
  DEALLOCATE LocationsCursor

  INSERT INTO @Results (VehicleID, Name, Locations) SELECT @VehicleID, @Name, @Locations

END     
CLOSE VehiclesCursor
DEALLOCATE VehiclesCursor

SELECT * FROM @Results
</code></pre>

<p>However, as you can see, this requires a great deal of code.  What I would like is a generic function that would allow me to do something like this:</p>

<pre><code>SELECT VehicleID
     , Name
     , JOIN(SELECT City FROM Locations WHERE VehicleID = Vehicles.VehicleID, ', ') AS Locations
FROM Vehicles
</code></pre>

<p>Is this possible?  Or something similar?</p>
","799","","4519059","Mark Harrison","2015-07-22 09:12:25","2015-09-08 01:51:38","How to create a SQL Server function to ""join"" multiple rows from a subquery into a single delimited field?","<sql><sql-server>","11","1","64","","","6899","22"
"7211","1","","","2008-08-10 15:03:20","","12","2251","<p>I currently have a relatively small (4 or 5 tables, 5000 rows) MySQL database that I would like to convert to an sqlite database.  As I'd potentially have to do this more than once, I'd be grateful if anyone could recommend any useful tools, or at least any easily-replicated method.</p>

<p>(I have complete admin access to the database/machines involved.)</p>
","916","","57752","Eddie","2009-03-01 00:08:52","2012-12-14 02:00:38","What's the best way of converting a mysql database to a sqlite one?","<sql><mysql><database><sqlite>","4","0","3","","","7211","22"
"7517","1","25741","","2008-08-11 04:32:01","","5","2251","<p>Is there a simple way to drop a group of interrelated tables in SQL Server? Ideally I'd like to avoid having to worry about what order they're being dropped in since I know the entire group will be gone by the end of the process.</p>
","797","","116","Mark Harrison","2008-08-18 16:15:08","2008-09-19 15:59:14","Dropping a group of tables in SQL Server","<sql><sql-server><database>","7","0","0","","","7517","22"
"8213","1","8220","","2008-08-11 20:59:11","","33","46268","<p>I need to import a csv file into <strong>Firebird</strong> and I've spent a couple of hours trying out some tools and none fit my needs.</p>

<p>The main problem is that all the tools I've been trying like <a href=""http://www.sqlmanager.net/products/ibfb/dataimport"">EMS Data Import</a> and <a href=""http://www.sqlmaestro.com/products/firebird/datawizard/help/06_01_05_csv/"">Firebird Data Wizard</a> expect that my <strong>csv</strong> file contains all the information needed by my Table.</p>

<p>I need to write some custom SQL in the insert statement, for example, I have a cvs file with the city name, but as my database already has all the cities in another table (normalized), I need to write a subselect in the insert statement to lookup for the city and write its ID, also I have a stored procedure to cread GUIDS.</p>

<p>My Insert statement would be something like this:</p>

<pre><code>INSERT INTO PERSON (ID, NAME, CITY_ID) VALUES((SELECT NEW_GUID FROM CREATE_GUID), :NAME, (SELECT CITY_ID FROM CITY WHERE NAME = :CITY_NAME)
</code></pre>

<p>I know that it is very easy to write an application to do this, but I don't like to reinvent the wheel, and I'm sure that there are some tools out there to do it.</p>

<p>Can you guys give me some advice?</p>
","727","","1938054","","2013-01-13 19:30:29","2015-03-25 20:34:37","Generate Insert SQL statements from a csv file","<sql><csv><insert><firebird>","13","0","10","","","8213","22"
"8609","1","8611","","2008-08-12 08:40:42","","35","44994","<p>I'm doing some inter-database operational research e.g. synchronizing Oracle, MySQL, etc.</p>

<p>Are there any nice MySQL databases that I can download, so that I can test some importing on real-world cases?  I'm thinking of some open project that might have a weekly data dump available for download.</p>

<p>Of course, anything similar for Oracle, SQL Server, etc is welcome as well.</p>
","116","","2317532","Mark Harrison","2015-04-20 03:00:56","2015-04-20 03:00:56","any sample MySQL databases I can download?","<mysql><sql><database><seeding>","6","0","22","","","8609","22"
"8987","1","8993","","2008-08-12 15:50:49","","24","10720","<p>Scalar-valued functions can be called from .NET as follows:</p>

<pre><code>SqlCommand cmd = new SqlCommand(""testFunction"", sqlConn); //testFunction is scalar
cmd.CommandType = CommandType.StoredProcedure;  
cmd.Parameters.Add(""retVal"", SqlDbType.Int);
cmd.Parameters[""retVal""].Direction = ParameterDirection.ReturnValue;
cmd.ExecuteScalar();
int aFunctionResult = (int)cmd.Parameters[""retVal""].Value;
</code></pre>

<p>I also know that table-valued functions can be called in a similar fashion, for example: </p>

<pre><code>String query = ""select * from testFunction(param1,...)""; //testFunction is table-valued
SqlCommand cmd = new SqlCommand(query, sqlConn);
SqlDataAdapter adapter = new SqlDataAdapter(cmd);
adapter.Fill(tbl);
</code></pre>

<p>My question is, can table-valued functions be called as stored procedures, like scalar-valued functions can? (e.g., replicate my first code snippet with a table-valued function being called and getting the returned table through a ReturnValue parameter).</p>
","940","theprise","17360","","2014-01-13 23:52:57","2014-07-26 10:37:16","Calling Table-Valued SQL Functions From .NET","<c#><.net><sql>","2","1","2","","","8987","22"
"9614","1","9635","","2008-08-13 09:41:43","","5","633","<p>Suppose we have a table A:</p>

<pre><code>itemid mark
1      5
2      3
</code></pre>

<p>and table B:</p>

<pre><code>itemid mark
1      3
3      5
</code></pre>

<p>I want to join A*B on A.itemid=B.itemid both right and left ways. i.e. result:</p>

<pre><code>itemid A.mark B.mark
1      5      3
2      3      NULL
3      NULL   5
</code></pre>

<p>Is there a way to do it in one query in MySQL?</p>
","844","elephantum","","","","2013-01-22 10:18:48","Bidirectional outer join","<sql><mysql>","3","0","1","","","9614","22"
"9687","1","","","2008-08-13 12:06:07","","7","1961","<p>I'm looking for a pattern for performing a dynamic search on multiple tables.</p>

<p>I have no control over the legacy (and poorly designed) database table structure.</p>

<p>Consider a scenario similar to a resume search where a user may want to perform a search against any of the data in the resume and get back a list of resumes that match their search criteria.  Any field can be searched at anytime and in combination with one or more other fields.</p>

<p>The actual sql query gets created dynamically depending on which fields are searched.  Most solutions I've found involve complicated if blocks, but I can't help but think there must be a more elegant solution since this must be a solved problem by now.</p>

<hr>

<p>Yeah, so I've started down the path of dynamically building the sql in code.  Seems godawful.  If I really try to support the requested ability to query any combination of any field in any table this is going to be one MASSIVE set of if statements.  <em>shiver</em></p>

<hr>

<p>I believe I read that COALESCE only works if your data does not contain NULLs.  Is that correct?  If so, no go, since I have NULL values all over the place.</p>
","1097","Geoff","1922662","Chris","2013-02-19 00:10:06","2013-02-19 00:10:06","Need Pattern for dynamic search of multiple sql tables","<sql><database-design><design-patterns><dynamic-sql><table-structure>","3","0","2","","","9687","22"
"9974","1","9996","","2008-08-13 15:49:41","","21","9678","<p>This is a question I asked on another forum which received some decent answers, but I wanted to see if anyone here has more insight.</p>

<p>The problem is that you have one of your pages in a web application timing out when it gets to a stored procedure call, so you use Sql Profiler, or your application trace logs, to find the query and you paste it into management studio to figure our why it's running slow.  But you run it from there and it just blazes along, returning in less than a second each time.</p>

<p>My particular case was using ASP.NET 2.0 and Sql Server 2005, but I think the problem could apply to any RDBMS system.</p>
","1219","Eric Z Beard","2641576","Mark Harrison","2014-11-25 20:46:06","2014-11-25 20:46:06","Query times out from web app but runs fine from management studio","<sql><sql-server><sql-server-2005>","9","1","9","","","9974","22"
"10190","1","10194","","2008-08-13 18:38:02","","9","11107","<p>Many applications have grids that display data from a database table one page at a time. Many of them also let the user pick the number of records per page, sort by any column, and navigate back and forth through the results.</p>

<p>What's a good algorithm to implement this pattern without bringing the entire table to the client and then filtering the data on the client. How do you bring just the records you want to display to the user?</p>

<p>Does LINQ simplify the solution?</p>
","373","urini","","","","2013-10-27 13:52:40","How to return a page of results from SQL?","<.net><sql><linq><pagination>","8","1","8","","","10190","22"
"10688","1","254036","","2008-08-14 05:10:36","","29","23003","<p>I'm doing a survey for the best SQL change script generators out there, specifically for MS SQL Server.</p>

<p>I do know of <a href=""http://www.red-gate.com/products/SQL_Compare/index.htm"">Redgate SQL Compare</a>, but I'd like to know what others use, and if there are free versions of such software that I could try.</p>

<p>Any suggestions?</p>
","372","Jon Limjap","13302","Ray Vega","2010-11-04 05:57:44","2012-04-20 03:21:22","Best tool for auto-generating SQL change scripts for SQL Server","<sql><sql-server><database><diff>","11","0","30","2014-04-21 17:09:18","","10688","22"
"10727","1","10818","","2008-08-14 06:07:53","","3","387","<p>In your applications, what's a ""long time"" to keep a transaction open before committing or rolling back?  Minutes?  Seconds?  Hours?</p>

<p>and on which database? </p>
","116","Mark Harrison","-1","","2008-09-09 21:13:53","2009-02-13 00:54:40","What is a ""reasonable"" length of time to keep a SQL cursor open?","<sql><cursors>","5","0","","","","10727","22"
"10819","1","2663232","","2008-08-14 09:01:37","","44","9211","<p>For certain types of sql queries, an auxiliary table of numbers can be very useful. It may be created as a table with as many rows as you need for a particular task or as a user defined function that returns the number of rows required in each query.</p>

<p>What is the optimal way to create such a function?</p>
","224","vzczc","426671","","2013-06-25 20:04:16","2014-10-22 10:06:40","SQL, Auxiliary table of numbers","<sql><sql-server>","6","3","33","","","10819","22"
"11028","1","11044","","2008-08-14 13:44:43","","3","2490","<p>When I'm joining three or more tables together by a common column, I'd write my query like this:</p>

<pre><code>SELECT *
FROM   a, b, c
WHERE  a.id = b.id
AND    b.id = c.id
</code></pre>

<p>a colleague recently asked my why I didn't do explicit <em>Join Transitive Closure</em> in my queries like this:</p>

<pre><code>SELECT *
FROM   a, b, c
WHERE  a.id = b.id
AND    b.id = c.id
AND    c.id = a.id
</code></pre>

<p>are the really any advantages to this? Surely the optimiser can imply this for itself?</p>

<p><em>edit: I know it's evil syntax, but it's a quick and dirty example of legitimate legacy code +1 @<a href=""http://stackoverflow.com/questions/11028/what-are-the-advantages-of-explicit-join-transitive-closure-in-sql#11114"" rel=""nofollow"" title=""excanvas"">Stu</a> for cleaning it up</em></p>
","1030","ninesided","380","Vaibhav","2008-08-18 00:16:46","2013-11-03 09:15:43","What are the advantages of explicit Join Transitive Closure in SQL?","<sql>","8","0","1","","","11028","22"
"11043","1","11053","","2008-08-14 13:53:33","","30","21602","<p>What are the pros and cons of using table aliases in SQL?  I personally try to avoid them, as I think they make the code less readable (especially when reading through large where/and statements), but I'd be interested in hearing any counter-points to this.  When is it generally a good idea to use table aliases, and do you have any preferred formats?</p>
","637","tbreffni","","","","2013-07-26 16:00:47","SQL Table Aliases - Good or Bad?","<sql><table><alias>","18","1","5","2013-07-23 16:00:51","","11043","22"
"11141","1","11146","","2008-08-14 14:46:30","","2","532","<p>Recently I have been investigating the possibilities of caching in ASP.NET.</p>

<p>I rolled my own ""Cache"", because I didn't know any better, it looked a bit like this:</p>

<pre><code>public class DataManager
{

      private static DataManager s_instance;

      public static DataManager GetInstance()
      {
      }

      private Data[] m_myData;
      private DataTime m_cacheTime;

      public Data[] GetData()
      {
            TimeSpan span = DateTime.Now.Substract(m_cacheTime);

            if(span.TotalSeconds &gt; 10)
            {
                  // Do SQL to get data
                  m_myData = data;
                  m_cacheTime = DateTime.Now;
                  return m_myData;     
            }
            else
            {
                  return m_myData;
            }
      }

}
</code></pre>

<p>So the values are stored for a while in a singleton, and when the time expires, the values are renewed. If time has not expired, and a request for the data is done, the stored values in the field are returned.</p>

<p>What are the benefits over using the real method (<a href=""http://msdn.microsoft.com/en-us/library/aa478965.aspx"" rel=""nofollow"" title=""excanvas""><a href=""http://msdn.microsoft.com/en-us/library/aa478965.aspx"" rel=""nofollow"">http://msdn.microsoft.com/en-us/library/aa478965.aspx</a></a>) instead of this?</p>
","1144","Ice^^Heat","419","Kevin Kenny","2008-08-14 15:02:35","2010-09-21 07:28:46","ASP.NET Caching","<asp.net><sql><caching>","5","0","1","","","11141","22"
"11615","1","11618","","2008-08-14 19:52:54","","11","2296","<p>I'm looking for a book/site/tutorial on best practices for relational database design, tuning for performance etc. It turns out this kind of resource is a bit difficult to find; there's a lot of ""here's normalization, here's ER diagrams, have at it,"" but not much in the way of real examples. Anyone have any ideas?</p>
","1370","eplawless","2134","Chris Fournier","2008-08-23 18:08:57","2014-05-20 20:35:17","Good Resources for Relational Database Design","<sql><database><performance><design>","4","0","8","","","11615","22"
"12374","1","25204","","2008-08-15 15:29:14","","36","4660","<p>We’ve found that the unit tests we’ve written for our C#/C++ code have really paid off. 
But we still have thousands of lines of business logic in stored procedures, which only really get tested in anger when our product is rolled out to a large number of users. </p>

<p>What makes this worse is that some of these stored procedures end up being very long, because of the performance hit when passing temporary tables between SPs. This has prevented us from refactoring to make the code simpler.</p>

<p>We have made several attempts at building unit tests around some of our key stored procedures (primarily testing the performance), but have found that setting up the test data for these tests is really hard. For example, we end up copying around test databases. In addition to this, the tests end up being really sensitive to change, and even the smallest change to a stored proc. or table requires a large amount of changes to the tests. So after many builds breaking due to these database tests failing intermittently, we’ve just had to pull them out of the build process.</p>

<p>So, the main part of my questions is: has anyone ever successfully written unit tests for their stored procedures?</p>

<p>The second part of my questions is whether unit testing would be/is easier with linq? </p>

<p>I was thinking that rather than having to set up tables of test data, you could simply create a collection of test objects, and test your linq code in a “linq to objects” situation? (I am a totally new to linq so don’t know if this would even work at all)</p>
","1078","John Sibly","2134","Chris Fournier","2008-08-23 19:43:46","2015-07-22 10:15:02","Has anyone had any success in unit testing SQL stored procedures?","<sql><unit-testing><linq-to-sql>","16","0","19","","","12374","22"
"12613","1","12538719","","2008-08-15 19:12:24","","12","1940","<p>I've been using Emacs's sql interactive mode to talk to the MySQL db server and gotten to enjoy it. A developer has set up another db on a new non-default port number but I don't know how to access it using sql-mysql.</p>

<p>How do I specify a port number when I'm trying to connect to a database?</p>

<p>It would be even better if Emacs can prompt me for a port number and just use the default if I don't specify. Any chances of that?</p>
","680","Cristian","680","Cristian","2008-08-15 22:23:31","2012-09-21 21:58:36","Specify a Port Number in Emacs sql-mysql","<sql><mysql><emacs>","3","0","3","","","12613","22"
"12638","1","","","2008-08-15 19:35:13","","4","3488","<p>So basically I'm building an app for my company and it NEEDS to be built using MS Access and it needs to be built on SQL Server.</p>

<p>I've drawn up most of the plans but am having a hard time figuring out a way to handle the auditing system.</p>

<p>Since it is being used internally only and you won't even be able to touch the db from outside the building we are not using a login system as the program will only be used once a user has already logged in to our internal network via Active Directory.  Knowing this, we're using <a href=""http://stackoverflow.com/questions/9052/is-there-a-way-for-ms-access-to-grab-the-current-active-directory-user"" rel=""nofollow"">a system to detect automatically the name of the Active Directory user</a> and with their permissions in one of the DB tables, deciding what they can or cannot do.</p>

<p>So the actual audit table will have 3 columns (this design may change but for this question it doesn't matter); who (Active Directory User), when (time of addition/deletion/edit), what (what was changed)</p>

<p>My question is how should I be handling this.  Ideally I know I should be using a trigger so that it is impossible for the database to be updated without an audit being logged, however I don't know how I could grab the Active Directory User that way.  An alternate would be to code it directly into the Access source so that whenever something changes I run an INSERT statement.  Obviously that is flawed because if something happens to Access or the database is touched by something else then it will not log the audit.</p>

<p>Any advice, examples or articles that may help me would be greatly appreciated!</p>
","428190","Andrew G. Johnson","305","Mark Biek","2008-08-31 00:48:22","2013-05-17 12:04:14","Building an auditing system; MS Access frontend on SQL Server backend","<sql><sql-server><ms-access><triggers>","11","1","1","","","12638","22"
"13540","1","13554","","2008-08-17 06:48:50","","74","31566","<p>I've written a stored proc that will do an update if a record exists, otherwise it will do an insert. It looks something like this:</p>

<pre><code>update myTable set Col1=@col1, Col2=@col2 where ID=@ID
if @@rowcount = 0
insert into myTable (Col1, Col2) values (@col1, @col2)
</code></pre>

<p>My logic behind writing it in this way is that the update will perform an implicit select using the where clause and if that returns 0 then the insert will take place.</p>

<p>The alternative to doing it this way would be to do a select and then based on the number of rows returned either do an update or insert. This I considered inefficient because if you are to do an update it will cause 2 selects (the first explicit select call and the second implicit in the where of the update). If the proc were to do an insert then there'd be no difference in efficiency.</p>

<p>Is my logic sound here?
Is this how you would combine an insert and update into a stored proc?</p>
","1463","Guy","5745","Chris Fournier","2009-10-07 04:43:16","2012-10-21 07:26:35","Insert Update stored proc on SQL Server","<sql><sql-server><stored-procedures><upsert>","9","0","26","","","13540","22"
"14828","1","","","2008-08-18 15:55:34","","2","496","<p>I work on quite a few DotNetNuke sites, and occasionally (I haven't figured out the common factor yet), when I use the Database Publishing Wizard from Microsoft to create scripts for the site I've created on my Dev server, after running the scripts at the host (usually GoDaddy.com), and uploading the site files, I get an error...  I'm 99.9% sure that it's not file related, so not sure where to begin in the DB.  Unfortunately with DotNetNuke you don't get the YSOD, but a generic error, with no real way to find the actual exception that has occured.</p>

<p>I'm just curious if anyone has had similar deployment issues using the Database Publishing Wizard, and if so, how they overcame them?  I own the RedGate toolset, but some hosts like GoDaddy don't allow you to direct connect to their servers...</p>
","1795","Purple Ant","","","","2013-05-17 14:38:09","Issues with DB after publishing via Database Publishing Wizard from MSFT","<sql><deployment><dotnetnuke>","7","0","","","","14828","22"
"14934","1","14946","","2008-08-18 17:11:15","","6","2900","<p>.NET, Java and other high level database API's in various language often provide techniques known as prepared statements and parameter binding as opposed to sending plain text commands to the Database server. What I would like to know is what happens when you execute a statement like this:</p>

<pre><code>SqlCommand cmd = new SqlCommand(""GetMemberByID"");
cmd.CommandType = CommandType.StoredProcedure;
SqlParameter param = new SqlParameter(""@ID"", memberID);
para.DbType = DbType.Integer;
cmd.Parameters.Add(param);
</code></pre>

<p>I know this is a best practice. SQL injection attacks are minimized this way. But what exactly happens under the hood when you execute these statements? Is the end result still a SQL safe string?  If not, what is the end result? And is this enough to prevent SQL injection attacks?</p>
","1144","IceHeat","77567","","2013-06-28 21:52:21","2014-09-23 07:59:14","Parameter Binding: What happens under the hood?","<c#><.net><sql><database><api>","3","0","1","","","14934","22"
"15142","1","15277","","2008-08-18 19:54:39","","274","37092","<p>What are the advantages/disadvantages of keeping SQL in your C# source code or in Stored Procs? I've been discussing this with a friend on an open source project that we're working on (C# ASP.NET Forum). At the moment, most of the database access is done by building the SQL inline in C# and calling to the SQL Server DB. So I'm trying to establish which, for this particular project, would be best.</p>

<p>So far I have:</p>

<p>Advantages for in Code:</p>

<ul>
<li>Easier to maintain - don't need to run a SQL script to update queries</li>
<li>Easier to port to another DB - no procs to port</li>
</ul>

<p>Advantages for Stored Procs:</p>

<ul>
<li>Performance</li>
<li>Security</li>
</ul>
","1463","Guy","24179","ScottCher","2008-10-27 14:46:03","2014-02-18 18:11:30","What are the pros and cons to keeping SQL in Stored Procs versus Code","<c#><sql><sql-server><stored-procedures>","47","2","159","2014-02-19 03:09:30","2008-10-17 22:48:11","15142","22"
"15399","1","","","2008-08-18 23:58:10","","0","232","<p>My firm have a talented and smart operations staff who are working very hard. I'd like to give them a SQL-execution tool that helps them avoid common, easily-detected SQL mistakes that are easy to make when they are in a hurry. Can anyone suggest such a tool? Details follow.</p>

<p>Part of the operations team remit is writing very complex ad-hoc SQL queries. Not surprisingly, operators sometimes make mistakes in the queries they write because they are so busy. </p>

<p>Luckily, their queries are all SELECTs not data-changing SQL, and they are running on a copy of the database anyway. Still, we'd like to prevent errors in the SQL they run. For instance, sometimes the mistakes lead to long-running queries that slow down the duplicate system they're using and inconvenience others until we find the culprit query and kill it. Worse, occasionally the mistakes lead to apparently-correct answers that we don't catch until much later, with consequent embarrassment. </p>

<p>Our developers also make mistakes in complex code that they write, but they have Eclipse and various plugins (such as <a href=""http://findbugs.sourceforge.net/"" rel=""nofollow"" title=""FindBugs"">FindBugs</a>) that catch errors as they type. I'd like to give operators something similar - ideally it would see</p>

<pre><code>SELECT U.NAME, C.NAME FROM USER U, COMPANY C WHERE U.NAME = 'ibell';
</code></pre>

<p>and before you executed, it would say ""Hey, did you realise that's a Cartesian product? Are you sure you want to do that?"" It doesn't have to be very smart - finding obviously missing join conditions and similar evident errors would be fine.</p>

<p>It looks like <a href=""http://www.toadsoft.com/"" rel=""nofollow"" title=""TOAD"">TOAD</a> should do this but I can't seem to find anything about such a feature. Are there other tools like TOAD that can provide this kind of semi-intelligent error correction?</p>

<p>Update: I forgot to mention that we're using MySQL.</p>
","","Squirrel","","Squirrel","2008-08-19 00:06:14","2009-01-05 20:48:00","SQL With A Safety Net","<sql><mysql>","7","0","","","","15399","22"
"16447","1","16465","","2008-08-19 15:53:19","","3","16258","<p>I am trying to generate a report by querying 2 databases (Sybase) in classic ASP.</p>

<p>I have created 2 connection strings:<br></p>

<blockquote>
  <p>connA for databaseA<br>
  connB for databaseB</p>
</blockquote>

<p>Both databases are present on the same server (don't know if this matters)<br></p>

<p>Queries:</p>

<blockquote>
  <p>q1 = SELECT column1 INTO #temp FROM databaseA..table1 WHERE xyz=""A""<br>
  q2 = SELECT columnA,columnB,...,columnZ FROM table2 a #temp b WHERE b.column1=a.columnB</p>
</blockquote>

<p>followed by:</p>

<blockquote>
  <p>response.Write(rstsql) <br>
  set rstSQL = CreateObject(""ADODB.Recordset"")<br>
  rstSQL.Open q1, connA<br>
  rstSQL.Open q2, connB</p>
</blockquote>

<p>When I try to open up this page in a browser, I get error message:</p>

<blockquote>
  <p>Microsoft OLE DB Provider for ODBC Drivers error '80040e37'</p>
  
  <p>[DataDirect][ODBC Sybase Wire Protocol driver][SQL Server]#temp not found. Specify owner.objectname or use sp<em>help to check whether the object exists (sp</em>help may produce lots of output). </p>
</blockquote>

<p>Could anyone please help me understand what the problem is and help me fix it?</p>

<p>Thanks.</p>
","1311","Pascal","25163","","2009-10-22 04:24:55","2009-10-22 04:24:55","Select Query on 2 tables, on different database servers","<sql><asp-classic><vbscript><sybase>","3","0","2","","","16447","22"
"16458","1","137090","","2008-08-19 15:57:33","","4","1743","<p>I'm using ColdFusion to return a result set from a SQL database and turn it into a list.  I need some way to generate an alphabetical navigation bar for that list.  I have ColdFusion and the jQuery library available.  I'm looking to generate something like this:</p>

<pre><code>A | B | C | ...      
- A
- A
- B
- B
- B
- C
- D
</code></pre>

<p>Where clicking on one of the letters drops you down the page to the first item for that letter.  Not all 26 letters of the alphabet are necessarily in use.</p>
","666","alexp206","1065868","","2013-02-15 21:57:24","2013-02-15 21:57:24","Dynamic Alphabetical Navigation","<javascript><jquery><sql><html><coldfusion>","4","0","1","","","16458","22"