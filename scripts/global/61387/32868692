<p>I have a very simple Koa application:</p>  <pre><code>var app = module.exports = require("koa")();  app.use(function *(){     this.body = "Koa says Hi!"; });  var port = process.env.PORT || (process.argv[2] || 3000); port = (typeof port === "number") ? port : 3000;  app.listen(port); console.log("Application started. Listening on port:" + port); </code></pre>  <p>that I test with mocha and supertest like this; </p>  <pre><code>var app = require("../"); var request = require("supertest").agent(app.listen());  describe("Our amazing site", function () {      it("has a nice welcoming message", function (done) {         request             .get("/")             .expect("Koa says Hi!")             .end(done);     }); }); </code></pre>  <p>I want to watch my files for changes and use the <code>-w</code> flag like this</p>  <pre><code>mocha -u bdd -R min -w </code></pre>  <p>That works fine. I change a file, the test is reexcuted and all is well. </p>  <p>But, very strangely, if I move that command into my <code>package.json</code> file as a script, like this: </p>  <pre><code>"scripts": {     "watch:test": "mocha -u bdd -R min -w" }, </code></pre>  <p>The first time I run the command it works, when I make a change that is picked up but now the test fails with: </p>  <pre><code>1)  Uncaught error outside test suite:      Uncaught Error: listen EADDRINUSE :::3000       at Object.exports._errnoException (util.js:837:11)       at exports._exceptionWithHostPort (util.js:860:20)       at Server._listen2 (net.js:1231:14)       at listen (net.js:1267:10)       at Server.listen (net.js:1363:5)       at Application.app.listen (node_modules/koa/lib/application.js:70:24)       at Object.&lt;anonymous&gt; (index.js:10:5)       at Object.&lt;anonymous&gt; (test/site.spec.js:1:73)       at Array.forEach (native)       at StatWatcher._handle.onchange (fs.js:1285:10) </code></pre>  <p>That error will not go away until I stop <code>mocha</code> and then restart it. </p>  <p>Why does it behave differently when run via <code>npm</code>? What can I do to fix this? </p>