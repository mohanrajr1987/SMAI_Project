<p>I need to build a nested HTML structure out of tree-like data, with keeping track of the path of each node starting from root (array of names of all the nodes that have to be traversed in order to reach a particular node). I've created a recursive function that builds the html well, but keeping track of path doesn't work.</p>  <p>I've tried to accomplish this by populating the array with name of the node on each step, but wrong values are stored. I suspect it might be js closure trap, but not sure. This is the function:</p>  <pre><code>// parent - d3 selection, path - array of parent nodes function buildTreeRecursively(parent, path) {      // start from empty if it's root and no array passed     path = path || [];       // populate array with this node's namme     path.push(parent.datum().name);      if (!parent.datum().children) return;      parent.append("div")         .style('padding-left', path.length * 10 + 'px')         .text(function(d) {              // I'm printing the path here so the you can see the error             return d.name + ": (" +  path.join(" -&gt; ") + ")"          })         .attr("path", function(d) {             return path.join(" ")         })          .selectAll("div")         .data(function(d) { return d.children || [] })         .enter()         .append("div")         .call(function(selection) {             return buildTreeRecursively(selection, path);         }); } </code></pre>  <p>here's jsFiddle - <a href="http://jsfiddle.net/g6hgkeh9/2/" rel="nofollow">http://jsfiddle.net/g6hgkeh9/2/</a></p>