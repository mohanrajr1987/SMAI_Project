<p>I have a table as shown below: 'contract'</p>  <pre><code>company    contractor  subcontractor    intel         x            y   intel         x            z      intel         x            a   intel         y            a   intel         y            b   intel         p            q   intel         p            r   intel         q            s   googl         m            n   googl         n            r   googl         n            f </code></pre>  <p>another table  'main contractor'</p>  <pre><code> company    main_contractor    intel          x   googl          m </code></pre>  <p>I need to extract data from this table in to a java object or json as a hierarchy using a java program.</p>  <pre><code>[  [Intel, [x, [y, [a,b],z,a]],         [p, [q, [s],r]],  ],  [googl, [m, [n, [[r,f]]          ]   ] ] </code></pre>  <p>How can I generate such a hierarchical data from the table using a java program? I dont' have special features available in SQL such as 'connect by' or 'with recursive' because I am using Ingres db.     </p>