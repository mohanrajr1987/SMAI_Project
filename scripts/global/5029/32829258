<p>I'm trying to write cross-platform library which will be used on <em>embed system (performance is very important)</em>.<br> I used to check <strong>PIMPL idiom</strong>, which looks fine, but i'am little a bit scared of dynamic object allocation which is kind a heavy operation (where i will allocate lots of classes).<br> Also i tried to attach implementation files in IDE depending on target system.<br> By this trick I think that I got very well performance but decreased code clarity, and had to use preprocessor to define in class system dependent variables.<br> <strong>Can somebody tell me which of above idioms is best in my case, or if there is better one, tell name of it.</strong><br> Thanks.</p>