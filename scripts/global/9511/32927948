<p>Just learned that Laravel using nikic phpparser internally.   </p>  <p>I modified my code to sending emails on one of the conditions &amp; it started dying.<br> The PHP logs showed this :</p>  <blockquote>   <p>[Sat Oct 03 21:18:23 2015] [error] [client xx.xx.xx.xx] PHP Fatal   error:  Allowed memory size of 33554432 bytes exhausted (tried to   allocate 1048576 bytes) in   /home/yyyy/public_html/vendor/nikic/php-parser/lib/PHPParser/NodeTraverser.php   on line 66, referer: <a href="http://yyyy.com/home" rel="nofollow">http://yyyy.com/home</a></p> </blockquote>  <p>Temporarily I've increased the memory to resolve the issue.<br> But, I want to move away from the band-aid.<br> I see that the NodeTraverser function is doing a clone, would that cause the problem :</p>  <pre><code>   protected function traverseNode(PHPParser_Node $node)    {      ini_set('memory_limit', '64M'); // temporary fix     $node = clone $node;      foreach ($node-&gt;getSubNodeNames() as $name) {         $subNode =&amp; $node-&gt;$name;          if (is_array($subNode)) {             $subNode = $this-&gt;traverseArray($subNode);         } elseif ($subNode instanceof PHPParser_Node) {             foreach ($this-&gt;visitors as $visitor) {                 if (null !== $return = $visitor-&gt;enterNode($subNode)) {                     $subNode = $return;                 }             }              $subNode = $this-&gt;traverseNode($subNode);              foreach ($this-&gt;visitors as $visitor) {                 if (null !== $return = $visitor-&gt;leaveNode($subNode)) {                     $subNode = $return;                 }             }         }     }      return $node; } </code></pre>  <p>This is how I'm sending the email. This is no different than anywhere else, hence I doubt this would cause an issue :</p>  <pre><code>                 $this-&gt;mailer-&gt;queue('emails.forreg',                         [                             'toName' =&gt;  $toEmailName,                             'fromName' =&gt;  $user-&gt;username,                             'site_name' =&gt; \Config::get('site_title')                         ],                         function($mail) use($toEmailAddress, $user, $subject_to_send, $toEmailName)                         {                             $mail-&gt;to($toEmailAddress, $toEmailName)                                 -&gt;subject($subject_to_send)                                 -&gt;from('xxx@yyy.com', $user-&gt;username);                         }                     ); </code></pre>  <p>Any ideas on how to resolve this ?</p>