<p>I'm just trying to change the background image of the app, it has nothing in it yet and i just wanted to change the background of the main activity to an image. It displays correctly in the preview but when I come to run it either on an emulator or on my physical device I get this error.</p>  <blockquote>   <p>Throwing OutOfMemoryError "Failed to allocate a 604786188 byte   allocation with 4194208 free bytes and 230MB until OOM"</p> </blockquote>  <p>The image is less than 1.5MB so I have no clue why it would run out of memory or be trying to allocate that much.</p>  <p>all I did was open a blank project and change the background of the relative layout.</p>  <p>The strange thing is if I run the app on a nexus 4 emulator it works fine, but a nexus 5 even on the same version on android throws this error.</p>  <p><strong>EDIT</strong></p>  <p>No longer getting the above error instead the following error occurs on launch of the app regardless of the emulator used.</p>  <pre><code>FATAL EXCEPTION: main     Process: com.jacksteel.comp4, PID: 2164     java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.jacksteel.comp4/com.jacksteel.comp4.MainActivity}: java.lang.NullPointerException: Attempt to invoke virtual method 'android.view.View android.view.Window.findViewById(int)' on a null object reference             at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2236)             at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2390)             at android.app.ActivityThread.access$800(ActivityThread.java:151)             at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1303)             at android.os.Handler.dispatchMessage(Handler.java:102)             at android.os.Looper.loop(Looper.java:135)             at android.app.ActivityThread.main(ActivityThread.java:5257)             at java.lang.reflect.Method.invoke(Native Method)             at java.lang.reflect.Method.invoke(Method.java:372)             at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:903)             at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:698)      Caused by: java.lang.NullPointerException: Attempt to invoke virtual method 'android.view.View android.view.Window.findViewById(int)' on a null object reference             at android.app.Activity.findViewById(Activity.java:2072)             at com.jacksteel.comp4.MainActivity.&lt;init&gt;(MainActivity.java:20)             at java.lang.reflect.Constructor.newInstance(Native Method)             at java.lang.Class.newInstance(Class.java:1606)             at android.app.Instrumentation.newActivity(Instrumentation.java:1066)             at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2226)             at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2390)             at android.app.ActivityThread.access$800(ActivityThread.java:151)             at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1303)             at android.os.Handler.dispatchMessage(Handler.java:102)             at android.os.Looper.loop(Looper.java:135)             at android.app.ActivityThread.main(ActivityThread.java:5257)             at java.lang.reflect.Method.invoke(Native Method)             at java.lang.reflect.Method.invoke(Method.java:372)             at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:903)             at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:698) </code></pre>  <p><strong>EDIT 2</strong> Source Code</p>  <pre><code> package com.jacksteel.comp4;  import android.content.res.Resources; import android.graphics.Bitmap; import android.graphics.BitmapFactory; import android.graphics.drawable.BitmapDrawable; import android.support.v7.app.AppCompatActivity; import android.os.Bundle; import android.view.Menu; import android.view.MenuItem; import android.widget.RelativeLayout;    public class MainActivity extends AppCompatActivity {      private RelativeLayout Bg = (RelativeLayout) findViewById(R.id.MainBg);     @Override     protected void onCreate(Bundle savedInstanceState) {         super.onCreate(savedInstanceState);         setContentView(R.layout.activity_main);          Bitmap bitmap = decodeSampledBitmapFromResource(getResources(),R.drawable.redboxes,Bg.getWidth(), Bg.getHeight());         Resources res = getResources();         BitmapDrawable backgroundDrawable = new BitmapDrawable(res, bitmap);         Bg.setBackgroundDrawable(backgroundDrawable);     }        @Override     public boolean onCreateOptionsMenu(Menu menu) {         // Inflate the menu; this adds items to the action bar if it is present.         getMenuInflater().inflate(R.menu.menu_main, menu);         return true;     }      @Override     public boolean onOptionsItemSelected(MenuItem item) {         // Handle action bar item clicks here. The action bar will         // automatically handle clicks on the Home/Up button, so long         // as you specify a parent activity in AndroidManifest.xml.         int id = item.getItemId();          //noinspection SimplifiableIfStatement         if (id == R.id.action_settings) {             return true;         }          return super.onOptionsItemSelected(item);     }      public static int calculateInSampleSize(             BitmapFactory.Options options, int reqWidth, int reqHeight) {         // Raw height and width of image         final int height = options.outHeight;         final int width = options.outWidth;         int inSampleSize = 1;          if (height &gt; reqHeight || width &gt; reqWidth) {              final int halfHeight = height / 2;             final int halfWidth = width / 2;              // Calculate the largest inSampleSize value that is a power of 2 and keeps both             // height and width larger than the requested height and width.             while ((halfHeight / inSampleSize) &gt; reqHeight                     &amp;&amp; (halfWidth / inSampleSize) &gt; reqWidth) {                 inSampleSize *= 2;             }         }          return inSampleSize;     }     public static Bitmap decodeSampledBitmapFromResource(Resources res, int resId,int reqWidth, int reqHeight) {          // First decode with inJustDecodeBounds=true to check dimensions         final BitmapFactory.Options options = new BitmapFactory.Options();         options.inJustDecodeBounds = true;         BitmapFactory.decodeResource(res, resId, options);          // Calculate inSampleSize         options.inSampleSize = calculateInSampleSize(options, reqWidth, reqHeight);          // Decode bitmap with inSampleSize set         options.inJustDecodeBounds = false;         return BitmapFactory.decodeResource(res, resId, options);     } } </code></pre>  <p><strong>EDIT 3</strong> Update</p>  <p>Updated Source code</p>  <pre><code>@Override protected void onCreate(Bundle savedInstanceState) {     super.onCreate(savedInstanceState);     setContentView(R.layout.activity_main);     final RelativeLayout Bg = (RelativeLayout) findViewById(R.id.MainBg);      Bg.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() {         @Override         public void onGlobalLayout() {             Bg.getViewTreeObserver().removeGlobalOnLayoutListener(this);             Bitmap bitmap = decodeSampledBitmapFromResource(getResources(), R.drawable.redboxes, Bg.getWidth(), Bg.getHeight());             Resources res = getResources();             BitmapDrawable backgroundDrawable = new BitmapDrawable(res, bitmap);             Bg.setBackgroundDrawable(backgroundDrawable);         }     });  } </code></pre>  <p>Updated Error</p>  <pre><code>FATAL EXCEPTION: main     Process: com.jacksteel.comp4, PID: 1872     java.lang.OutOfMemoryError: Failed to allocate a 107347980 byte allocation with 1048576 free bytes and 63MB until OOM             at dalvik.system.VMRuntime.newNonMovableArray(Native Method)             at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)             at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:609)             at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:444)             at android.graphics.BitmapFactory.decodeResource(BitmapFactory.java:467)             at com.jacksteel.comp4.MainActivity.decodeSampledBitmapFromResource(MainActivity.java:93)             at com.jacksteel.comp4.MainActivity$1.onGlobalLayout(MainActivity.java:27)             at android.view.ViewTreeObserver.dispatchOnGlobalLayout(ViewTreeObserver.java:912)             at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1881)             at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:1061)             at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:5885)             at android.view.Choreographer$CallbackRecord.run(Choreographer.java:767)             at android.view.Choreographer.doCallbacks(Choreographer.java:580)             at android.view.Choreographer.doFrame(Choreographer.java:550)             at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:753)             at android.os.Handler.handleCallback(Handler.java:739)             at android.os.Handler.dispatchMessage(Handler.java:95)             at android.os.Looper.loop(Looper.java:135)             at android.app.ActivityThread.main(ActivityThread.java:5257)             at java.lang.reflect.Method.invoke(Native Method)             at java.lang.reflect.Method.invoke(Method.java:372)             at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:903)             at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:698) </code></pre>