<blockquote>   <p>I have used docx4j API and Apache POI API for water Mark on Microsoft   Word Document file but when add water Mark on Work Document page   ,content of word document is Removed and I add content on that   document then water Mark is removed. and also can't add water Mark all   pages of document file.</p>      <p>I have use code below under , it is not working please help me for any   possible  solution</p> </blockquote>  <pre><code>package com.solusoft;  import java.io.File; import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.FileOutputStream; import java.io.FileWriter; import java.io.IOException; import java.util.List;  import org.apache.poi.openxml4j.opc.internal.ContentType; import org.apache.poi.xwpf.extractor.XWPFWordExtractor; import org.apache.poi.xwpf.usermodel.XWPFDocument; import org.apache.poi.xwpf.usermodel.XWPFParagraph; import org.apache.poi.xwpf.usermodel.XWPFRun; import org.docx4j.XmlUtils; import org.docx4j.jaxb.Context; import org.docx4j.model.structure.SectionWrapper; import org.docx4j.openpackaging.exceptions.InvalidFormatException; import org.docx4j.openpackaging.packages.OpcPackage; import org.docx4j.openpackaging.packages.WordprocessingMLPackage; import org.docx4j.openpackaging.parts.Part; import org.docx4j.openpackaging.parts.WordprocessingML.HeaderPart; import org.docx4j.openpackaging.parts.relationships.RelationshipsPart; import org.docx4j.relationships.Relationship; import org.docx4j.wml.Body; import org.docx4j.wml.Hdr; import org.docx4j.wml.HdrFtrRef; import org.docx4j.wml.HeaderReference; import org.docx4j.wml.ObjectFactory; import org.docx4j.wml.P; import org.docx4j.wml.SectPr;  public class watermark1 {      public static void main(String[] args) throws Exception {         watermark1 sample = new watermark1();         sample.addWaterMark();     }     static ObjectFactory factory = Context.getWmlObjectFactory();      public void addWaterMark() throws Exception {          WordprocessingMLPackage wmlPackage = WordprocessingMLPackage                 .load(new FileInputStream(new File("C:\\Users\\pdixit\\Desktop\\VivekDesktop\\Demo SOP template.docx")));          Relationship relationship = createHeaderPart(wmlPackage);         createHeaderReference(wmlPackage, relationship);         File f = new File("C:\\Users\\pdixit\\Desktop\\VivekDesktop\\TestFileTest.docx");         wmlPackage.save(f);     }      public static Relationship createHeaderPart(             WordprocessingMLPackage wordprocessingMLPackage) throws Exception {           HeaderPart headerPart = new HeaderPart();         Relationship rel = wordprocessingMLPackage.getMainDocumentPart()                 .addTargetPart(headerPart);           headerPart.setJaxbElement(getHdr(wordprocessingMLPackage, headerPart));         return rel;     }      public static void createHeaderReference(             WordprocessingMLPackage wordprocessingMLPackage,             Relationship relationship) throws InvalidFormatException {          List&lt;SectionWrapper&gt; sections = wordprocessingMLPackage                 .getDocumentModel().getSections();         SectPr sectPr = sections.get(sections.size() - 1).getSectPr();         // There is always a section wrapper, but it might not contain a sectPr         if (sectPr == null) {             sectPr = factory.createSectPr();             wordprocessingMLPackage.getMainDocumentPart().addObject(sectPr);             sections.get(sections.size() - 1).setSectPr(sectPr);         }          HeaderReference headerReference = factory.createHeaderReference();         headerReference.setId(relationship.getId());         headerReference.setType(HdrFtrRef.DEFAULT);         sectPr.getEGHdrFtrReferences().add(headerReference);      }      public static Hdr getHdr(WordprocessingMLPackage wordprocessingMLPackage,             Part sourcePart) throws Exception {         Hdr hdr = factory.createHdr();          String openXML = "&lt;w:p xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\"&gt;"                 + "&lt;w:pPr&gt;"                 + "&lt;w:pStyle w:val=\"Body\"/&gt;"                  + "&lt;/w:pPr&gt;"                 + "&lt;w:sdt&gt;"                 + "&lt;w:sdtPr&gt;"                 + "&lt;w:id w:val=\"-1589924921\"/&gt;"                  + "&lt;w:lock w:val=\"sdtContentLocked\"/&gt;"                  + "&lt;w:docPartObj&gt;"                 + "&lt;w:docPartGallery w:val=\"Watermarks\"/&gt;"                  + "&lt;w:docPartUnique/&gt;"                  + "&lt;/w:docPartObj&gt;"                  + "&lt;/w:sdtPr&gt;"                  + "&lt;w:sdtEndPr/&gt;"                  + "&lt;w:sdtContent&gt;"                 + "&lt;w:r&gt;"                 + "&lt;w:rPr&gt;"                 + "&lt;w:noProof/&gt;"                  + "&lt;w:lang w:eastAsia=\"zh-TW\"/&gt;"                  + "&lt;/w:rPr&gt;"                  + "&lt;w:pict&gt;"                 + "&lt;v:shapetype adj=\"10800\" coordsize=\"21600,21600\" id=\"_x0000_t136\" o:spt=\"136\" path=\"m@7,l@8,m@5,21600l@6,21600e\"&gt;"                 + "&lt;v:formulas&gt;"                 + "&lt;v:f eqn=\"sum #0 0 10800\"/&gt;"                  + "&lt;v:f eqn=\"prod #0 2 1\"/&gt;"                  + "&lt;v:f eqn=\"sum 21600 0 @1\"/&gt;"                  + "&lt;v:f eqn=\"sum 0 0 @2\"/&gt;"                  + "&lt;v:f eqn=\"sum 21600 0 @3\"/&gt;"                  + "&lt;v:f eqn=\"if @0 @3 0\"/&gt;"                  + "&lt;v:f eqn=\"if @0 21600 @1\"/&gt;"                  + "&lt;v:f eqn=\"if @0 0 @2\"/&gt;"                  + "&lt;v:f eqn=\"if @0 @4 21600\"/&gt;"                  + "&lt;v:f eqn=\"mid @5 @6\"/&gt;"                  + "&lt;v:f eqn=\"mid @8 @5\"/&gt;"                  + "&lt;v:f eqn=\"mid @7 @8\"/&gt;"                  + "&lt;v:f eqn=\"mid @6 @7\"/&gt;"                  + "&lt;v:f eqn=\"sum @6 0 @5\"/&gt;"                  + "&lt;/v:formulas&gt;"                  + "&lt;v:path o:connectangles=\"270,180,90,0\" o:connectlocs=\"@9,0;@10,10800;@11,21600;@12,10800\" o:connecttype=\"custom\" textpathok=\"t\"/&gt;"                  + "&lt;v:textpath fitshape=\"t\" on=\"t\"/&gt;"                  + "&lt;v:handles&gt;"                 + "&lt;v:h position=\"#0,bottomRight\" xrange=\"6629,14971\"/&gt;"                  + "&lt;/v:handles&gt;"                  + "&lt;o:lock shapetype=\"t\" text=\"t\" v:ext=\"edit\"/&gt;"                  + "&lt;/v:shapetype&gt;"                  + "&lt;v:shape fillcolor=\"silver\" id=\"PowerPlusWaterMarkObject357476642\" o:allowincell=\"f\" o:spid=\"_x0000_s2049\" stroked=\"f\" style=\"position:absolute;margin-left:0;margin-top:0;width:527.85pt;height:131.95pt;rotation:315;z-index:-251658752;mso-position-horizontal:center;mso-position-horizontal-relative:margin;mso-position-vertical:center;mso-position-vertical-relative:margin\" type=\"#_x0000_t136\"&gt;"                 + "&lt;v:fill opacity=\".5\"/&gt;"                  + "&lt;v:textpath string=\"SOLUSOFT\" style=\"font-family:&amp;quot;Calibri&amp;quot;;font-size:1pt\"/&gt;"                  + "&lt;w10:wrap anchorx=\"margin\" anchory=\"margin\"/&gt;"                  + "&lt;/v:shape&gt;"                  + "&lt;/w:pict&gt;"                  + "&lt;/w:r&gt;"                  + "&lt;/w:sdtContent&gt;"                  + "&lt;/w:sdt&gt;" + "&lt;/w:p&gt;";          P p = (P) XmlUtils.unmarshalString(openXML);          hdr.getContent().add(p);         return hdr;     }  } </code></pre>