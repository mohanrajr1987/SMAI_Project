<p>I'm trying to create a word addin that adds complex IF Statement Creation, from a list of possible mergefields.</p>  <p><strong>Complex is</strong></p>  <p><code>{ IF { = OR ( { COMPARE { MERGEFIELD Field_1 } &lt;= "Value" }, { COMPARE { MERGEFIELD Field_2 } &gt;= "Value" } ) } = 1 "True Instructions" "False Instructions" }</code></p>  <p>Im trying to do this all in VBA, but im having issues with my Complex if, as I cant get the "}" to end in the right locations.</p>  <p>If I use the terminator "Selection.EndKey Unit:=wdLine" in any other location besides the end, it creates a mess and putts all the } at that line.</p>  <p>Here is my Code:</p>  <pre><code>Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _     PreserveFormatting:=False Selection.TypeText Text:="IF "   Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _     PreserveFormatting:=False     Selection.TypeText Text:=" = " &amp; JointOperator1 &amp; " ( "  'FIRST ARG Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _     PreserveFormatting:=False     Selection.TypeText Text:="COMPARE "   Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _     PreserveFormatting:=False, Text:="MERGEFIELD " &amp; FirstArg1      Selection.TypeText Text:=" "     Selection.TypeText Text:=ComparisonType1     Selection.TypeText Text:=" "     Selection.TypeText Text:=Chr(34) &amp; SecondArg1 &amp; Chr(34)   Selection.TypeText Text:=", "   'SECOND ARG Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _     PreserveFormatting:=False     Selection.TypeText Text:="COMPARE "   Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _     PreserveFormatting:=False, Text:="MERGEFIELD " &amp; FirstArg2      Selection.TypeText Text:=" "     Selection.TypeText Text:=ComparisonType2     Selection.TypeText Text:=" "     Selection.TypeText Text:=Chr(34) &amp; SecondArg2 &amp; Chr(34)   Selection.TypeText Text:=" ) "  Selection.TypeText Text:=" = 1 "  Selection.TypeText Text:=vbCrLf &amp; " " &amp; Chr(34)   Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _     PreserveFormatting:=False Selection.TypeText Text:=strTempIfTrue   Selection.TypeText Text:=Chr(34) &amp; " " &amp; vbCrLf Selection.TypeText Text:=" " &amp; Chr(34)  Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, _     PreserveFormatting:=False Selection.TypeText Text:=strTempIfFalse   Selection.TypeText Text:=Chr(34) Selection.EndKey Unit:=wdLine Selection.TypeParagraph </code></pre>  <p>And this is what I get when generating the "Complex if"</p>  <pre><code>{IF { = AND ( {COMPARE{MERGEFIELD FHB} = "T", { COMPARE {MERGEFIELD BLAH} = "F") = 1 "If True text" "If False Text"}}}} </code></pre>  <p><strong>But it should be this:</strong></p>  <pre><code>{IF { = AND ( {COMPARE{MERGEFIELD FHB} = "T" **}** , { COMPARE {MERGEFIELD BLAH} = "F" **}** ) **}**  = 1 "If True text" "If False Text"} </code></pre>  <p>If someone could shed some light on this matter, where am I going wrong. Or If there is a way of forcing the location of the Ending }, that would be great I'm very new to VBA (I'm a C++ Programmer)</p>