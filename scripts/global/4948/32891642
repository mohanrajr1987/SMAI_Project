<p>I want to send pdf files from within a MS Word docm file. This file is linked with an Excel source file to perform Mail Merge function. With the support of <a href="http://word.officeacademy.it/450/word-come-fare-stampa-unione-direttamente-in-singoli-file-pdf-vba/" rel="nofollow">http://word.officeacademy.it/450/word-come-fare-stampa-unione-direttamente-in-singoli-file-pdf-vba/</a> and <a href="http://www.rondebruin.nl/win/s7/win001.htm" rel="nofollow">http://www.rondebruin.nl/win/s7/win001.htm</a> I started to create a Macro:</p>  <pre><code>Sub NewZip(sPath) 'Create empty Zip File 'Changed by keepITcool Dec-12-2005     If Len(Dir(sPath)) &gt; 0 Then Kill sPath     Open sPath For Output As #1     Print #1, Chr$(80) &amp; Chr$(75) &amp; Chr$(5) &amp; Chr$(6) &amp; String(18, 0)     Close #1 End Sub </code></pre>  <hr>  <pre><code>Sub Unione_in_pdf()  Dim fd As FileDialog Dim file As Variant  'Crea un oggetto FileDialog per scegliere la cartella in cui salvare i file Set fd = Application.FileDialog(msoFileDialogFolderPicker) With fd      'Usa il metodo Show per mostrare la finestra di dialogo e restituire l'azione dell'utente     If .Show = -1 Then             For Each vrtSelectedItem In .SelectedItems              'vrtSelectedItem è una stringa che contiene l'indirizzo di ogni elemento selezionato.             'E' possibile usare qualsiasi funzione di I/O sui file utilizzando questo indirizzo.             SelectedPath = vrtSelectedItem              Next vrtSelectedItem      Else             MsgBox ("Nessuna cartella è stata selezionata.")             Exit Sub     End If  End With  'Imposta la variabile oggetto a Nothing Set fd = Nothing  Application.ScreenUpdating = False  MainDoc = ActiveDocument.Name ChangeFileOpenDirectory SelectedPath For i = 1 To ActiveDocument.MailMerge.DataSource.RecordCount     With ActiveDocument.MailMerge         .Destination = wdSendToNewDocument         .SuppressBlankLines = True         With .DataSource             .FirstRecord = i             .LastRecord = i             .ActiveRecord = i              'Utilizza alcuni campi del file sorgente per impostare il nome del file pdf             'IMPORTANTE: tali campi vanno personalizzati in base a quelli effettivamente             'presenti nella sorgente dati             docName = "Lettera_" &amp; .DataFields("NomeCentro").Value &amp; "_" &amp; .DataFields("Allievo").Value &amp; ".pdf"             Value = .DataFields("NomeCentro").Value         End With         .Execute Pause:=False          Application.ScreenUpdating = False      End With      ActiveDocument.ExportAsFixedFormat OutputFileName:=docName, _         ExportFormat:=wdExportFormatPDF, OpenAfterExport:=False, OptimizeFor:= _         wdExportOptimizeForPrint, Range:=wdExportAllDocument, From:=1, To:=1, _         Item:=wdExportDocumentContent, IncludeDocProps:=True, KeepIRM:=True, _         CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _         BitmapMissingFonts:=True, UseISO19005_1:=False     ActiveWindow.Close SaveChanges:=False      Folder = ActiveDocument.Path     DestFolder = Folder &amp; Application.PathSeparator &amp; Value     If Len(Dir(DestFolder, vbDirectory)) = 0 Then          MkDir DestFolder          Dim FileNameZip         Dim oApp As Object              If Right(DestFolder, 1) &lt;&gt; "\" Then                 DestFolder = DestFolder &amp; "\"             End If          FileNameZip = DestFolder &amp; "MyZip" &amp; ".zip"          'Create empty Zip File         NewZip (FileNameZip)          Set oApp = CreateObject("Shell.Application")         'Copy the files to the compressed folder         oApp.Namespace(FileNameZip).CopyHere oApp.Namespace(DestFolder).items          'Keep script waiting until Compressing is done         On Error Resume Next         Do Until oApp.Namespace(FileNameZip).items.Count = _            oApp.Namespace(DestFolder).items.Count             Application.OnTime When:=Now + TimeValue("00:00:15"), _   Name:="MyDelayMacro"         Loop         On Error GoTo 0          'Create the mail         Set OutApp = CreateObject("Outlook.Application")         Set OutMail = OutApp.CreateItem(0)         strbody = "Hi there" &amp; vbNewLine &amp; vbNewLine &amp; _                   "This is line 1" &amp; vbNewLine &amp; _                   "This is line 2" &amp; vbNewLine &amp; _                   "This is line 3" &amp; vbNewLine &amp; _                   "This is line 4"          On Error Resume Next         With OutMail             .To = "ron@debruin.nl"             .CC = ""             .BCC = ""             .Subject = "This is the Subject line"             .Body = strbody             .Attachments.Add FileNameZip             .Send   'or use .Display         End With         On Error GoTo 0                   End If  Next i         Application.ScreenUpdating = True  End Sub </code></pre>  <p>I create pdf files, create folders but I can't zip files in created folders. </p>  <p>I need to find all the files with the keyword in the Dim Value ("NomeCentro" field in the Excel source file) and the zip and copy in the "NomeCentro" folder previously created. </p>  <p>Finally I need to send a mail for each zip file (I've not tested the mail code cause debug stops me before). </p>  <p>Edit: the error generates a popup with (try to translate message) "Cannot Move a Compressed (zipped) Folder into itself" at the line</p>  <pre><code>oApp.Namespace(FileNameZip).CopyHere oApp.Namespace(DestFolder).items </code></pre>