<p>I want to do Gauss normalization on a set of values (it is normalization by the business ranked and by the rank of reviewers). Here is the code:</p>  <pre><code>import pandas as pd import numpy as np  columns = ['user_id','business_id', 'stars'] data = {'user_id': ['u1', 'u1', 'u2', 'u1', 'u2', 'u2', 'u2', 'u1'],     'business_id': ['r1', 'r2', 'r2', 'r2', 'r1', 'r2', 'r1', 'r1'],     'stars': [5.0, 3.0, 2.0, 4.0, 1.0, 5.0, 2.0, 4.0],     } df = pd.DataFrame(data, columns=columns)  userList = set(df.user_id) busList = set(df.business_id)   for user_id in userList:     # average rating given by the user     avg_user = df[df.user_id == user_id].stars.mean()     sum = 0.0       for bus_id in busList:          sum += (df[(df.user_id == user_id) &amp; (df.business_id == bus_id)].stars.values - avg_user)**2      for bus_id2 in busList:          rating = (df[(df.user_id == user_id) &amp; (df.business_id == bus_id2)].stars.values - avg_user) / sum          df[(df.user_id == user_id) &amp; (df.business_id == bus_id2)].stars = rating </code></pre>  <p>busList - is a list of business IDs userList - a list of user IDs</p>  <ol> <li><p>I think I have way too many loops but I can not figure out a way to reduce their number. Need an advice</p></li> <li><p>My last line of code, where I am replacing the values in the column "stars" with a calculated value "rating" seems very bulky. Any suggestions?</p></li> <li><p>When I print sum after every cycle I get weird for me results:</p>  <p>[ 2.  0.]  - must be 2.0 for u1 (sum of these 2 numbers)</p>  <p>[ 2.5  6.5] - must be 9 for u2 (sum of these 2 numbers)</p></li> </ol>  <p>I just feel that the code is bulky and I am doing something wrong</p>  <p>Thank you!</p>