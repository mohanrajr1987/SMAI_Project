<p>Note: in my real dataset, it cannot happen that there are less than two valid values in a row.</p>  <p>I want to replace NaN with the rowMeans of the particular row  I tried to go with apply: </p>  <pre><code>apply(dat,1, FUN= function(x) ifelse(is.na(x[1]),rowMeans(dat[,1:3], na.rm=TRUE), x[1])) </code></pre>  <p>But with this on my data I always obtain the same vlaue if there is a NaN. The problems seems to be that in apply(,1,) I cannot write rowMeans(dat[1:3]) to obtain the particular value (I guess).</p>