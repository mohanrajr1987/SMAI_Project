<p>I have two protein sequences FASTA files:</p>  <p>nsp.fasta --> original file</p>  <p>wsp.fasta --> output file from a signal peptide predictor tool, which returned the proteins in nsp.fasta with the signal stripped.</p>  <p>For example:</p>  <p>record in nsp.fasta:</p>  <pre> >gi|564250271|ref|XP_006264203.1| PREDICTED: apolipoprotein D [Alligator mississippiensis] MRGMLALLAALLGLLGLVEGQTFHMGQCPNPPVQEDFDPSKYLGKWYEIEKLPSGFEQER CVQANYSLKANGKIKVLTKMVRSAQHLTCLQHRMMLLVSSPVMPASPYWVVATDYENYAL VYSCTSFFWLFHVDYAWIRSRTPQLHPETVEHLKSVLRSYRIQTGMMLPTDQMNCPSDM </pre>  <p>record in wsp.fasta:</p>  <pre> >gi|564250271|ref|XP|006264203.1|  PREDICTED: apolipoprotein D [Alligator mississippiensis]; MatureChain: 21-179 QTFHMGQCPNPPVQEDFDPSKYLGKWYEIEKLPSGFEQERCVQANYSLKANGKIKVLTKM VRSAQHLTCLQHRMMLLVSSPVMPASPYWVVATDYENYALVYSCTSFFWLFHVDYAWIRS RTPQLHPETVEHLKSVLRSYRIQTGMMLPTDQMNCPSDM </pre>  <p>However, not all the proteins in nsp.fasta contained a signal peptide, so wsp.fasta is a subset of the proteins in nsp.fasta that contains the signal. What I need is a unique file that contains all the protein records, both proteins with no signal peptide found and the mature chains with the signal peptide stripped.</p>  <p>I have tried the following:</p>  <pre><code>from Bio import SeqIO  file1 = SeqIO.parse(r"c:\Users\Sergio\Desktop\nsp.fasta", "fasta")  file2 = SeqIO.parse(r"c:\Users\Sergio\Desktop\wsp.fasta", "fasta")  for seq1 in file1:     for seq2 in file2:         if seq2.id == seq1.id:             seq1.seq = seq2.seq             SeqIO.write(seq1, r"c:\Users\Sergio\Desktop\nuevsp.fasta", "fasta") </code></pre>  <p>But there's no output at all. I have tried putting the SeqIO.write out of the loops, and it returns a blank file. What am I doing wrong? There already exist any method to merge two files or to replace sequences in one file with sequences in other file?</p>  <p>Thank you in advance!!</p>  <p>Sergio</p>  <p>Edited code, I added an elif clause in an attempt to also add the records in nsp.fasta that doesn't match wsp.fasta, but it doesn't work:</p>  <pre><code>to_write = []  for seq1 in SeqIO.parse(r"c:\Users\Sergio\Desktop\nsp.txt", "fasta"):     for seq2 in SeqIO.parse(r"c:\Users\Sergio\Desktop\wsp.txt", "fasta"):         if seq1.id == seq2.id:             seq1.seq = seq2.seq             to_write.append(seq1)         elif seq1.id != seq2.id:             to_write.append(seq1)  SeqIO.write(to_write, r"c:\Users\Sergio\Desktop\nuevsp.txt", "fasta") </code></pre>