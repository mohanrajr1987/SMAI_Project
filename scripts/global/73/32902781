<p>I have a large dataset and I used <code>splitting</code> to make the data more approachable. I ended up with ~250 splits. As a result, each split has different number of columns that are empty. I want to remove the empty columns and write the updated files. I am able to do it manually, but as I mentioned, I have roughly 250 splits so I can't do it to all of them.</p>  <p>Below is a reproducible example:</p>  <pre><code>df &lt;- data.frame(Size= c(800, 850, 1100, 1200, 1000),                   Value= c(900, NA, 1300, 1100, NA),                  Location= c(NA, 'midcity', 'uptown', NA, 'Lakeview'),                  Num1 = c(2, NA, 3, 2, NA),                  Num2 = c(2,3,3,1,2),                  Rent= c('y', 'y', 'n', 'y', 'n')) </code></pre>  <p>This is what I have so far.</p>  <p>Splitting:</p>  <pre><code>index &lt;- apply(is.na(df)*1, 1,paste, collapse = "") s &lt;- split(df, index) split(df, index) for (i in 1:length(s))  {write.csv(s[i], file = paste0("Splits/", i, "splits.csv"), row.names=FALSE, na = "")} </code></pre>  <p>Removing empty columns:</p>  <pre><code>split &lt;- read.csv("Splits/3splits.csv") updated_split &lt;- split[,colSums(is.na(split))&lt;nrow(split)] write.csv(updated_split, file = "updated_3split.csv", row.names=FALSE)  split &lt;- read.csv("Splits/2splits.csv") updated_split &lt;- split[,colSums(is.na(split))&lt;nrow(split)] write.csv(updated_split, file = "updated_2split.csv", row.names=FALSE)  split &lt;- read.csv("Splits/1splits.csv") updated_split &lt;- split[,colSums(is.na(split))&lt;nrow(split)] write.csv(updated_split, file = "updated_1split.csv", row.names=FALSE) </code></pre>  <p>Is there a way to automate the process above? What I mean by automate is to find a way to remove the empty columns in those three files without repeating the same three lines over and over again (doing it with 250 files isn't really an option).</p>  <p>Edit 1:</p>  <p>Like this?</p>  <pre><code>for (i in 1:length(s)) { lapply(s, function(x) x[,colSums(is.na(x))&lt;nrow(x)]) write.csv(s[i], file = paste0("Splits/", i, "splits.csv"), row.names=FALSE, na = "") } </code></pre>