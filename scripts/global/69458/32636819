<p>I am trying to extract the text under the mouse using the following code</p>  <pre><code>private static async Task&lt;string&gt; getText(double x, double y) {     try     {         var location = new System.Windows.Point(x, y);         AutomationElement element = AutomationElement.FromPoint(location);          object patternObj;         if (element.TryGetCurrentPattern(TextPattern.Pattern, out patternObj))         {             var textPattern = (TextPattern)patternObj;              var range = textPattern.RangeFromPoint(location);             range.ExpandToEnclosingUnit(TextUnit.Word);                                 var text = range.GetText(-1).Trim();              range.ExpandToEnclosingUnit(TextUnit.Line);             text += " [" + range.GetText(-1).Trim() + "]";             return text;         }         else if (element.TryGetCurrentPattern(ValuePattern.Pattern, out patternObj))         {             var valuePattern = (ValuePattern)patternObj;             return valuePattern.Current.Value;         }         else         {             var text = "";             var patterns = element.GetSupportedPatterns();             foreach (var pattern in patterns)             {                 text += pattern.Id + " " + pattern.ProgrammaticName;                 text += Environment.NewLine;             }              return text;         }     }     catch (Exception ex)     {         return ex.Message;     } } </code></pre>  <p>this works normally (using the Money Metro app to test). However, if the text box is scrolled beyond the first line, the UI Automation begins to pull the wrong text because it thinks the top of the window is the top of the text. For example for the image below, the mouse is on "increasing" and the top of the text (starting with "A majority...") is visible.</p>  <p><a href="http://i.stack.imgur.com/uRvEM.png" rel="nofollow"><img src="http://i.stack.imgur.com/uRvEM.png" alt="enter image description here"></a></p>  <p>If we scroll past the first line, and place the mouse again on "increasing", this time it gets confused and is pulling from the line above. As we scroll more and more the displacement becomes larger and larger. In the image below, it picks up "with" from the line above.</p>  <p><a href="http://i.stack.imgur.com/6NQaB.png" rel="nofollow"><img src="http://i.stack.imgur.com/6NQaB.png" alt="enter image description here"></a></p>  <p>Any ideas for workaround also much appreciated.</p>  <p><strong>Update.</strong> The "class" in this case is RichTextBlock. Same issue in TextBlock in the Windows Store. Seems like an issue with RangeFromPoint not accounting for scrolling past the first line.</p>