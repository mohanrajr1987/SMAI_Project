<p>The data table I am working with is like</p>  <pre><code>require(data.table) set.seed(2) dt &lt;- data.table(user=c(rep('a', 3), rep('b', 2), rep('c', 4)),                  type=c(sample(LETTERS[1:4], 3),                          sample(LETTERS[1:4], 2),                         sample(LETTERS[1:4], 4))                  ) </code></pre>  <p>which is</p>  <pre><code>   user type 1:    a    A 2:    a    C 3:    a    B 4:    b    A 5:    b    C 6:    c    D 7:    c    A 8:    c    B 9:    c    C      </code></pre>  <p>I'd like to find specific users of types in either <code>A</code>, <code>B</code> or <code>C</code> only. In the example above, user <code>c</code> is not qualified because he has <code>D</code> in one of his type records. So the desired output should be</p>  <pre><code>   user type 1:    a    A 2:    a    C 3:    a    B 4:    b    A 5:    b    C </code></pre>  <p>The first method, which is obvious inefficient, comes to my mind is split <code>dt</code> with <code>split(dt, dt$user)</code> and check if  <code>grepl</code> and <code>nrow</code> are the same, followed by indexing and <code>rbindlist</code>. Since the data table I am actually working with has 10989251 rows, an efficient way to do the subsetting is necessary.</p>