<p>I need to see my program's printf output in sync with the dtrace output.</p>  <p>I like to build my own version of dtrace command that produce the equivalent output of the "<strong><em>sudo dtruss -t write_nocancel ls</em></strong>" command. </p>  <p><strong>This is the "correct dtruss command/output":</strong></p>  <pre><code>sudo dtruss -t write_nocancel ls Chap1   Chap10  Chap11  Chap12  Chap2   Chap3   Chap4   Chap5   Chap6   Chap7   Chap8   Chap9   README SYSCALL(args)        = return write_nocancel(0x1, "Chap1\tChap10\tChap11\tChap12\tChap2\tChap3\tChap4\tChap5\tChap6\tChap7\tChap8\tChap9\tREADME\n\0", 0x52)       = 82 0 </code></pre>  <p><strong>Base on looking at the dtruss script source code, I tried this dtrace command, but it failed.</strong></p>  <pre><code>    sudo  dtrace -q \     -n '*:*:write_nocancel:entry {self-&gt;arg0=arg0; self-&gt;arg1 =arg1; \     self-&gt;arg2 =arg2; self-&gt;code=0; } ' \             -n '*:*:write_nocancel:return { \         printf("return %s(0x%X, \"%S\", 0x%X)         = %d %d", \         probefunc,self-&gt;arg0,       arg0 == -1 ? "" : stringof(copyin(self-&gt;arg1,arg0)),self-&gt;arg2,(int)arg0, \   (int)errno); }' \              -c ls   2&gt;&amp;1                  Chap1                 Chap10                 Chap11                 Chap12                 Chap2                 Chap3                 Chap4                 Chap5                 Chap6                 Chap7                 Chap8                 Chap9                 README                 dtrace: error on enabled probe ID 3 (ID 209288: fbt:mach_kernel:write_nocancel:return): invalid address (0xffffff80218dfc40) in action #3 at DIF offset 92                 dtrace: error on enabled probe ID 4 (ID 958: syscall::write_nocancel:return): invalid address (0xffffff80218dfc40) in action #3 at DIF offset 92                 dtrace: error on enabled probe ID 3 (ID 209288: fbt:mach_kernel:write_nocancel:return): invalid address (0xffffff801a7c0010) in action #3 at DIF offset 92 </code></pre>  <p><strong>Any dtrace experts out there might have a clue on how to fixe this?</strong> </p>