<p>I'm trying to write some unit tests for code that uses Dojo 1.10.4 and so far I haven't had any success.  I've tried lots of things, but I'm currently trying to use Intern 3.0.5.  Here's what I've got in intern.js at the moment:</p>  <pre><code>define({   capabilities: { 'browserstack.selenium_version': '2.45.0' },   environments: [ { browserName: 'firefox', version: '40', platform: ['WINDOWS'] } ],   maxConcurrency: 2,   tunnel: 'NullTunnel',   //loaders: { 'host-browser': 'dojo/dojo.js' },   loaderOptions: {     packages: [       { name: 'app', location: 'src' },       { name: 'dojo', location: 'dojo' },       { name: 'dijit', location: 'dijit' }     ],      map: {       '*': {         'dojo': 'dojo',       },       'intern': {         'dojo': 'node_modules/intern/node_modules/dojo'       }     }   },   suites: ['tests/unit/ButtonTests'],   excludeInstrumentation: true,   useSauceConnect: false,   proxyPort: 9000,   proxyUrl: 'http://localhost:9000/' });  dojoConfig = {   has: { 'dojo-undef-api': true } }; </code></pre>  <p>My hope is that I can let Intern use the Dojo 2 loader that it ships with, but then point my code at Dojo 1.10.4, so I set up a map in loaderOptions to take care of that.  Unfortunately, my code doesn't seem to be picking up the right copy and I'm getting this error:</p>  <pre><code>Ã— firefox 40 on WINDOWS - unit tests - Button tests - icon uses correct class (0.001s) TypeError: target is null   at on  &lt;dojo\on.js:69:6&gt;   at clazz&lt;._initializeEventHandlers  &lt;src\Button.js:35:1&gt;   at clazz&lt;.constructor  &lt;src\Button.js:29:9&gt;   at singleConstructor/&lt;  &lt;dojo\_base\declare.js:440:5&gt; @http://localhost:9000/tests/unit/ButtonTests.js:19:20   at Test.prototype.run/&lt;  &lt;__intern\lib\Test.js:211:19&gt;   at Promise/this.then/&lt;/&lt;  &lt;node_modules\intern\node_modules\dojo\Promise.ts:393:15&gt;   at runCallbacks  &lt;node_modules\intern\node_modules\dojo\Promise.ts:11:2&gt;   at settle/&lt;  &lt;node_modules\intern\node_modules\dojo\Promise.ts:317:4&gt;   at run  &lt;node_modules\intern\node_modules\dojo\Promise.ts:237:7&gt;   at CallbackQueue&lt;/CallbackQueue.prototype.drain  &lt;node_modules\intern\node_modules\dojo\CallbackQueue.ts:39:4&gt;   at nextTick&lt;/observer&lt;  &lt;node_modules\intern\node_modules\dojo\nextTick.ts:63:4&gt; </code></pre>  <p>I also tried making Intern use the loader that comes with Dojo 1.10 instead of the one it ships with, which is commented out in the config I pasted above.  When I do that, I get this error:</p>  <pre><code>Suite firefox 40 on WINDOWS - unit tests FAILED Error: xhrFailed   at makeError  &lt;dojo\dojo.js:106:15&gt;   at req.getText  &lt;dojo\dojo.js:331:1&gt;   at injectModule  &lt;dojo\dojo.js:1539:8&gt;   at forEach  &lt;dojo\dojo.js:93:6&gt;   at injectDependencies/&lt;  &lt;dojo\dojo.js:758:5&gt;   at guardCheckComplete  &lt;dojo\dojo.js:1277:5&gt;   at injectDependencies  &lt;dojo\dojo.js:757:4&gt;   at runDefQ/&lt;  &lt;dojo\dojo.js:1621:6&gt;   at forEach  &lt;dojo\dojo.js:93:6&gt;   at runDefQ  &lt;dojo\dojo.js:1620:5&gt;   at injectModule/xhrCallback  &lt;dojo\dojo.js:1488:9&gt;   at req.getText  &lt;dojo\dojo.js:328:7&gt;   at injectModule  &lt;dojo\dojo.js:1539:8&gt;   at forEach  &lt;dojo\dojo.js:93:6&gt;   at injectDependencies/&lt;  &lt;dojo\dojo.js:758:5&gt;   at guardCheckComplete  &lt;dojo\dojo.js:1277:5&gt;   at injectDependencies  &lt;dojo\dojo.js:757:4&gt;   at contextRequire  &lt;dojo\dojo.js:821:6&gt;   at req  &lt;dojo\dojo.js:124:11&gt;   at PreExecutor.prototype._loadExecutorWithLoader/&lt;  &lt;__intern\lib\executors\PreExecutor.js:287:5&gt;   at Promise  &lt;__intern\node_modules\dojo\Promise.js:172:17&gt;   at PreExecutor.prototype._loadExecutorWithLoader  &lt;__intern\lib\executors\PreExecutor.js:286:1&gt;   at loadExecutorWithLoader  &lt;__intern\lib\executors\PreExecutor.js:365:12&gt;   at Promise/this.then/&lt;/&lt;  &lt;__intern\node_modules\dojo\Promise.js:156:41&gt;   at runCallbacks  &lt;__intern\node_modules\dojo\Promise.js:19:13&gt;   at settle/&lt;  &lt;__intern\node_modules\dojo\Promise.js:103:21&gt;   at run  &lt;__intern\node_modules\dojo\Promise.js:51:33&gt;   at CallbackQueue&lt;/CallbackQueue.prototype.drain  &lt;__intern\node_modules\dojo\CallbackQueue.js:39:21&gt;   at nextTick&lt;/observer&lt;  &lt;__intern\node_modules\dojo\nextTick.js:52:21&gt; </code></pre>  <p>I was also getting this error yesterday, but I can't remember exactly how I did it!  I was trying to use PhantomJS, so that might have done it:</p>  <pre><code>Error: Repeated sequence for session 08ee5fa0-67a6-11e5-9d1c-49f2f4677a77: 0 last 0 cur   at Proxy._publishInSequence  &lt;node_modules\intern\lib\Proxy.js:181:11&gt;   at IncomingMessage.&lt;anonymous&gt;  &lt;node_modules\intern\lib\Proxy.js:63:39&gt;   at IncomingMessage.emit  &lt;events.js:104:17&gt;   at &lt;_stream_readable.js:908:16&gt;   at process._tickCallback  &lt;node.js:355:11&gt; </code></pre>  <p>On a side note, should I be able to set dojoConfig at the end of intern.js like I'm doing above?  I'd like to enable dojo-undef-api.</p>  <p>Any help would be greatly appreciated!</p>