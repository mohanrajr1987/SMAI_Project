<p><a href="http://staging1.unep.org/iris-dev/default/Auto/generate-indicator/2adab4ea-352b-450d-b8d1-95d21b3e353b" rel="nofollow">http://staging1.unep.org/iris-dev/default/Auto/generate-indicator/2adab4ea-352b-450d-b8d1-95d21b3e353b</a></p>  <p>The webpage above is loading fine on web browsers (Firefox &amp; Chrome) and loads an online spreadsheet and a map. I want to use PhantomJS to capture a screenshot of the map rendered in  <code>div#chart-or-map </code></p>  <p>I have the following code in my <code>generate_indictor.js</code> file</p>  <pre><code>    var page = require('webpage').create();      page.open('http://staging1.unep.org/iris-dev/default/auto/generate-indicator/2adab4ea-352b-450d-b8d1-95d21b3e353b', function() {   // being the actual size of the headless browser   page.viewportSize = { width: 1440, height: 900 };    var clipRect = page.evaluate(function(){     return document.querySelector('#chart-or-map').getBoundingClientRect();   });    page.clipRect = {     top:    clipRect.top,     left:   clipRect.left,     width:  clipRect.width,     height: clipRect.height   };    page.render('/tmp/map.png');   phantom.exit(); }); </code></pre>  <p>From my console I run <code>phantomjs generate_indictor.js </code> but then I get the following error: </p>  <pre><code>ReferenceError: Can't find variable: get_spatial_data    http://staging1.unep.org/iris-dev/default/auto/generate-indicator/2adab4ea-352b-450d-b8d1-95d21b3e353b:1115 in draw_map   http://staging1.unep.org/iris-dev/default/auto/generate-indicator/2adab4ea-352b-450d-b8d1-95d21b3e353b:1133 </code></pre>  <p>When I look at the HTML source code of the page, <code>get_spatial_data</code> has been clearly defined as a function. </p>  <p>What I'm I missing?</p>