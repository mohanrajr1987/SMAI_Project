<p>I've already made a little Chrome extension that runs with a background script. Looks like this:</p>  <pre><code>chrome.browserAction.onClicked.addListener(function (tab) {          chrome.tabs.executeScript(tab.id, {         code: 'if(window.location.href.indexOf("something")===-1){if(window.location.href.indexOf("?")===-1){window.location.href+="?something";}else{window.location.href+="&amp;something";}}else{var get=function(id){return document.querySelectorAll(id);};var src=get("script[src], img, picture[src], audio[src], video[src], source");var href=get("a, link");for(var i=0;i&lt;src.length;i++){src[i].src+="?something";}for(var i=0;i&lt;href.length;i++){href[i].href+="?something";}}'     });     }); </code></pre>  <p>The code in the String is the same as the following:</p>  <pre><code>if (window.location.href.indexOf("something") === -1) {     if(window.location.href.indexOf("?") === -1) {         window.location.href += "?something";     } else {         window.location.href += "&amp;something";     } } else {     var get = function (id) { return document.querySelectorAll(id); };     var src = get("script[src], img, picture[src], audio[src], video[src], source");     var href = get("a, link");      for(var i = 0; i &lt; src.length; i++) {         src[i].src += "?something";     }      for(var i = 0; i &lt; href.length; i++) {         href[i].href += "?something";     } } </code></pre>  <p>Basically, it just gets the URL, verifies if it contains "something" on it. If it does not, adds "something" as a parameter, but if it does, adds "?something" to all of the tags that may make a request.</p>  <p>It works! What I'm trying to do now is the same, but from a HTML popup. I've created a document with a button, and I tried to execute the function above in every possible way I could imagine.</p>  <p>I've tried the following methods (understand <code>func</code> as the event listener above, passed as parameter in the <code>addListener</code> function):</p>  <ul> <li><code>chrome.tabs.getSelected(null, func);</code></li> <li><code>chrome.tabs.query({ "active": true }, func);</code></li> <li><code>func(null);</code></li> </ul>  <p>I've also tried to execute the code in the String directly, but it didn't worked either.</p>  <p>In my folder, there's a HTML file (the popup, no Javascript code in it), a JS file (that add a function that runs one of the items above as a listener to the button's click event) and the Manifest.</p>  <p>There's a lot of permissions in my Manifest file, even some unnecessary things. Here are they:</p>  <ul> <li><code>tabs</code></li> <li><code>activeTab</code></li> <li><code>cookies</code></li> <li><code>webRequest</code></li> <li><code>webRequestBlocking</code></li> <li><code>http://*/*</code></li> <li><code>https://*/*</code></li> <li><code>&lt;all_urls&gt;</code></li> </ul>  <p>Am I doing something wrong or have I missed something?</p>  <p>Thank you all for the help!</p>