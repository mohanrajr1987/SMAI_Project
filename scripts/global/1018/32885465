<p>I have hard time porting POSIX regex to Lua string patterns.</p>  <p>I'm dealing with html response from which I would like to filter checkboxes that are checked. Particularly I'm interested in <code>value</code> and <code>name</code> fields of each checked checkbox:</p>  <p>Here are examples of checkboxes I'm interested in:</p>  <pre><code>&lt;input class="rid-2 form-checkbox" id="edit-2-access-comments" name="2[access comments]" value="access comments" checked="checked" type="checkbox"&gt;  &lt;input class="rid-3 form-checkbox real-checkbox" id="edit-3-administer-comments" name="3[administer comments]" value="administer comments" checked="checked" type="checkbox"&gt; </code></pre>  <p>as opposed I'm not interested in this (unchecked checkbox):</p>  <pre><code>&lt;input class="rid-2 form-checkbox" id="edit-2-access-printer-friendly-version" name="2[access printer-friendly version]" value="access printer-friendly version" type="checkbox"&gt; </code></pre>  <p>Using POSIX regex I've used following pattern in Python: <code>pattern=r'name="(.*)" value="(.*)" checked="checked"'</code> and it just worked.</p>  <p>My first approach in Lua was simply to use this: <code>pattern ='name="(.-)" value="(.-)" checked="checked"'</code> but it gave strange results (first capture was as expected but the second one returned lots of unneeded html).</p>  <p>I've also tried following pattern: <code> pattern = 'name="(%d?%[.-%])" value="(.-)"%s?(c?).-="?c.-"%s?type="checkbox"' </code></p>  <p>This time, in second capture content of <code>value</code> was returned but all checkboxes where matched (not only those with <code>checked="checked"</code> field)</p>  <p>For completeness, here's the Lua code (snippet from my Nmap NSE script) that attempts to do this pattern matching:</p>  <pre><code>  pattern = 'name="(.-)" value="(.-)" checked="checked"'    data = {}   for name, value in string.gmatch(res.body, pattern) do     stdnse.debug(1, string.format("%s %s", name, value))   end </code></pre>