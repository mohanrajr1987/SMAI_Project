<p>Using: Delphi XE7, latest daily build of Indy 10.</p>  <p>This code was working 2 months earlier. Now I recompiled my app, and its not working anymore, with the same account details. The exception message is 'Disconnected'.  </p>  <p>The SMTP port used is 587.</p>  <p>Code follows: </p>  <pre><code>  FIdSMTP := TIdSMTP.Create;   FIdSSLIOHandler := TIdSSLIOHandlerSocketOpenSSL.Create;   FIdMessage := TIdMessage.Create;   FIdAttachment := TIdAttachmentFile.Create(FIdMessage.MessageParts);    if (FEmailServer.SMTPUseSSL) then   begin     FIdSSLIOHandler.SSLOptions.Method := sslvTLSv1;     // FIdSSLIOHandler.SSLOptions.Method := sslvSSLv3;     FIdSMTP.IOHandler := FIdSSLIOHandler;     FIdSMTP.UseTLS := utUseExplicitTLS;     // FIdSMTP.UseTLS := utUseImplicitTLS;   end;    FIdSMTP.Host := FEmailServer.SMTPHost; //smtp.gmail.com   FIdSMTP.Port := FEmailServer.SMTPPort; //587   FIdSMTP.AuthType := satDefault;   FIdSMTP.Username := FEmailServer.SMTPUserName;   FIdSMTP.Password := FEmailServer.SMTPPassword;    FIdMessage.Recipients[0].Address := mailmessage.RecipientEmailAddr;   FIdMessage.From.Name := mailmessage.SenderName;   FIdMessage.Subject := mailmessage.EmailSubject;   FIdMessage.Body.Text := mailmessage.EmailMessage;    FIdAttachment.LoadFromFile(mailmessage.AttachmentFile);   FIdAttachment.FileName := ExtractFileName(mailmessage.AttachmentFile);    try     if (not FIdSMTP.Connected) then       FIdSMTP.Connect;      FIdSMTP.Send(FIdMessage);   except     on E: Exception do       ShowMessage(E.Message);   end; </code></pre>  <p>Do you see anything obvious that could be causing it to not send the email?</p>