<p>I am getting an error after upgrading to Excel 2016. The debugger gives me the error: "invalid procedure call or argument". I did not used to get this error in 2013. The error comes in the third line. All the appropriate references are enabled, unless there is a new one that needs to be referenced. Any alternate methods or ideas to create a text log file would be appreciated.</p>  <pre><code>Dim FSO As Object, oFile As Object     Set FSO = CreateObject("Scripting.FileSystemObject") **Set oFile = FSO.CreateTextFile(strFile)** oFile.WriteLine msg oFile.Close </code></pre>  <p>Edit 1: Below is my information for variable strFile. I seem to be getting this error for ActiveWorkbook.Path “Object Variable or With block variable not set” Also, I realized that the error is coming only from my personal.xlsb file when I open Excel. However, I did not used to get this error before. </p>  <pre><code>Dim strFile as String strFile = ActiveWorkbook.Path &amp; "\" &amp; ActiveWorkbook.Name            strFile = Left(strFile, Len(strFile) - 4) strFile = strFile &amp; "txt" </code></pre>