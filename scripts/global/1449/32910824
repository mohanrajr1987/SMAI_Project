<p>I am trying to set the border and interior formatting of cells in column F using vba. Whether or not their formatting gets changed depends on whether there is any information in the cell directly above and/or below it. I have been using the following code to do this:</p>  <pre><code>Dim ws as worksheet Set ws = worksheets("Res")  Dim c As Range For Each c In ws.UsedRange.Columns("F").Cells If IsEmpty(c.Offset(1, 0)) = True And IsEmpty(c.Offset(-1, 0)) = False Then     With c.Offset(-1, 0).Borders(xlEdgeTop)         .LineStyle = xlContinuous         .ThemeColor = 5         .TintAndShade = 0.399945066682943         .Weight = xlThin     End With     With c.Offset(-1, 0).Interior         .Pattern = xlSolid         .PatternColorIndex = xlAutomatic         .ThemeColor = xlThemeColorAccent1         .TintAndShade = 0.799981688894314         .PatternTintAndShade = 0     End With End If Next c </code></pre>  <p>At the</p>  <pre><code>If IsEmpty(c.Offset(1, 0)) = True And IsEmpty(c.Offset(-1, 0)) = False Then </code></pre>  <p>I have been getting the error: </p>  <blockquote>   <p>Application Defined or Object-Defined Error</p> </blockquote>  <p>Does anyone know why that is?</p>  <p>Thanks for your help.</p>