<p>I need to validate that my authentication is working properly, So I thought I would change a current test that looks for 401, instead of 302. What I wrote is:</p>  <pre><code>public function it_should_not_let_you_access_the_company_end_point_when_not_logged_in() {     $response = $this-&gt;get('api/v1/company/', [],[],[],['Content-Type' =&gt; 'application/json']);     dd($response-&gt;response);     $this-&gt;assertEquals('302', $response-&gt;getStatusCode()); } </code></pre>  <p>The content type is json so the response type should be ajax, how ever:</p>  <pre><code>Illuminate\Http\RedirectResponse {#1066   #request: Illuminate\Http\Request {#963     #json: null     #userResolver: Closure {#945       class: "Illuminate\Auth\AuthServiceProvider"       this: Illuminate\Auth\AuthServiceProvider {#68 â€¦}       use: array:1 [ </code></pre>  <p>Is what I see in a dump of the response object.</p>  <p>The auth middle ware is set up as such:</p>  <pre><code>public function handle($request, Closure $next) {     if ($this-&gt;auth-&gt;guest())     {         if ($request-&gt;ajax())         {             return response('Unauthorized.', 401);         }          return redirect()-&gt;guest('auth/login');     }      return $next($request); } </code></pre>  <p>But the <code>$request-&gt;ajax()</code> returns false. I need it to be true and to do the 401 instead.</p>  <p>Ideas?</p>