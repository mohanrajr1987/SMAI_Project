<p>I've built a program using the Windows API that detects the insertion of some media (cd, usb...). The program returns the device path:</p>  <p><code>\\\\?\\usb#vid_vvvv&amp;pid_pppp#aaaaaaaaaaaaaaaa#{gggggggg-gggg-gggg-gggg-gggggggggggg} </code></p>  <p>I am using the function <code>GetVolumeNameForVolumeMountPoint</code> to obtain the volume name by parsing the device interface path as reported <a href="https://msdn.microsoft.com/library/windows/desktop/aa364994%28v=vs.85%29.aspx" rel="nofollow">here</a>, but it seems that this feature is not working for USB devices.</p>  <p>Any idea of how to get the volume name from the device path in case of working with usb devices?</p>