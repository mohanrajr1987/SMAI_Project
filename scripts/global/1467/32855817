<p>Using vb.net I download files using sftp then immediately set their attributes to normal.</p>  <pre><code>    File.SetAttributes(Downloadedfile, Attr)   </code></pre>  <p>where Attr is a FileAttribute. I later set the attributes to readonly</p>  <pre><code>    File.SetAttributes(Downloadedfile, FileAttributes.ReadOnly)  </code></pre>  <p>The problem I am having is that there appears to be a delay between the file being downloaded and the attributes being set by the OS(Win7).  As a result the .normal attribute doesn't always get set but later the readonly attribute does.  Is it possible to wait until the OS has finished whatever it is doing? I've looked around and seen various articles about changing the indexing and what the folder will be used to store but none of these suggestions has worked.  Don't expect somebody to come up with "You need to this" but a pointer in the right direction would be a great help.  </p>