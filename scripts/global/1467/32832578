<p>I am working on an issue where I need to add an attribute to an element under certain conditions. Here is the XML that I have. When an <code>AdditionalItem</code> element has a non-empty <code>Value</code> element, I need to add an attribute called <em>action</em> as such:</p>  <pre><code>    &lt;AdditionalItems&gt;         **&lt;AdditionalItem&gt;**             &lt;Keys&gt;                 &lt;Key&gt;Intake Source&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;Intake Source&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;Enumeration&lt;/type&gt;                 &lt;enumeration&gt;                     &lt;String&gt;311&lt;/String&gt;                     &lt;String&gt;NIS Inspector&lt;/String&gt;                     &lt;String&gt;Other CCD Agency&lt;/String&gt;                 &lt;/enumeration&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;Enumerations&gt;                     &lt;Enumeration&gt;                         &lt;Keys&gt;                             &lt;Key&gt;311&lt;/Key&gt;                         &lt;/Keys&gt;                         &lt;IdentifierDisplay&gt;311&lt;/IdentifierDisplay&gt;                     &lt;/Enumeration&gt;                     &lt;Enumeration&gt;                         &lt;Keys&gt;                             &lt;Key&gt;NIS Inspector&lt;/Key&gt;                         &lt;/Keys&gt;                         &lt;IdentifierDisplay&gt;NIS Inspector&lt;/IdentifierDisplay&gt;                     &lt;/Enumeration&gt;                     &lt;Enumeration&gt;                         &lt;Keys&gt;                             &lt;Key&gt;Other CCD Agency&lt;/Key&gt;                         &lt;/Keys&gt;                         &lt;IdentifierDisplay&gt;Other CCD Agency&lt;/IdentifierDisplay&gt;                     &lt;/Enumeration&gt;                 &lt;/Enumerations&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Enumeration&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;Intake Source&lt;/Name&gt;             **&lt;Value&gt;311&lt;/Value&gt;**             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;         &lt;AdditionalItem&gt;             &lt;Keys&gt;                 &lt;Key&gt;Other CCD Agency&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;Other CCD Agency&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;String&lt;/type&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Text&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;Other CCD Agency&lt;/Name&gt;             &lt;Value/&gt;             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;         &lt;AdditionalItem&gt;             &lt;Keys&gt;                 &lt;Key&gt;311 Agent&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;311 Agent&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;String&lt;/type&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Text&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;311 Agent&lt;/Name&gt;             &lt;Value/&gt;             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;         &lt;AdditionalItem&gt;             &lt;Keys&gt;                 &lt;Key&gt;Case Number&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;Case Number&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;String&lt;/type&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Text&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;Case Number&lt;/Name&gt;             &lt;Value/&gt;             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;         &lt;AdditionalItem&gt;             &lt;Keys&gt;                 &lt;Key&gt;Case Created Date&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;Case Created Date&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;Date&lt;/type&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Date&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;Case Created Date&lt;/Name&gt;             &lt;Value/&gt;             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;         &lt;AdditionalItem&gt;             &lt;Keys&gt;                 &lt;Key&gt;Complaintant Name:&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;Complaintant Name:&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;String&lt;/type&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Text&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;Complaintant Name:&lt;/Name&gt;             &lt;Value&gt;Fred Fredderson&lt;/Value&gt;             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;         &lt;AdditionalItem&gt;             &lt;Keys&gt;                 &lt;Key&gt;Phone Number:&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;Phone Number:&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;String&lt;/type&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Text&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;Phone Number:&lt;/Name&gt;             &lt;Value&gt;3033333333&lt;/Value&gt;             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;         &lt;AdditionalItem&gt;             &lt;Keys&gt;                 &lt;Key&gt;Email&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;Email&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;String&lt;/type&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Text&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;Email&lt;/Name&gt;             &lt;Value&gt;1@2.com&lt;/Value&gt;             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;         &lt;AdditionalItem&gt;             &lt;Keys&gt;                 &lt;Key&gt;Council District:&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;Council District:&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;String&lt;/type&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Text&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;Council District:&lt;/Name&gt;             &lt;Value/&gt;             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;         &lt;AdditionalItem&gt;             &lt;Keys&gt;                 &lt;Key&gt;Inspector Distict:&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;Inspector Distict:&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;String&lt;/type&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Text&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;Inspector Distict:&lt;/Name&gt;             &lt;Value/&gt;             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;         &lt;AdditionalItem&gt;             &lt;Keys&gt;                 &lt;Key&gt;Permit Number&lt;/Key&gt;             &lt;/Keys&gt;             &lt;IdentifierDisplay&gt;Permit Number&lt;/IdentifierDisplay&gt;             &lt;DataType&gt;                 &lt;type&gt;String&lt;/type&gt;                 &lt;inputRange&gt;                     &lt;maxValue&gt;0.0&lt;/maxValue&gt;                 &lt;/inputRange&gt;                 &lt;inputRequired&gt;false&lt;/inputRequired&gt;                 &lt;fieldType&gt;Text&lt;/fieldType&gt;             &lt;/DataType&gt;             &lt;Name&gt;Permit Number&lt;/Name&gt;             &lt;Value/&gt;             &lt;security&gt;F&lt;/security&gt;             &lt;drillDown&gt;false&lt;/drillDown&gt;         &lt;/AdditionalItem&gt;     &lt;/AdditionalItems&gt; </code></pre>  <p>My first thought was to do a <code>for-each</code> on <code>//AdditionalItem</code>, then check to see if the length of the <code>Value</code> element was > 0. If so, add the <em>action</em> attribute. Does that seem like a reasonable approach? Something similar to this:</p>  <pre><code>&lt;xsl:for-each select="/ns2:UpdateCAP/ns2:AdditionalInformation//AdditionalItem"&gt;     &lt;xsl:if test="string-length(Value) &gt; 0"&gt;       &lt;!-- somehow add the attribute --&gt;     &lt;/xsl:if&gt; &lt;/xsl:for-each&gt; </code></pre>