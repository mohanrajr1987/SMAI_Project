<p>Google Cloud Storage provides Java, C# code samples for generating signed URLs:</p>  <p><a href="https://cloud.google.com/storage/docs/access-control?hl=en#signing-code-csharp" rel="nofollow">https://cloud.google.com/storage/docs/access-control?hl=en#signing-code-csharp</a></p>  <p>I'm using the code sample. With the same service account|key, bucket and object, the Java code and the C# code (on Windows) work. When I try the C# code on Mono/Linux, it does not work. The error is:</p>  <pre><code>Code: SignatureDoesNotMatch Message: The request signature we calculated does not match the signature you provided. Check your Google secret key and signing method. </code></pre>  <p>Injecting some debugging code corroborates this error.</p>  <p>Here's the augmented method that does the signing:</p>  <pre><code>private String signString(String stringToSign)  {     if (key == null) throw new Exception("Certificate not initialized");     CspParameters cp = new CspParameters(         24,         "Microsoft Enhanced RSA and AES Cryptographic Provider",         ((RSACryptoServiceProvider)key.PrivateKey).CspKeyContainerInfo.KeyContainerName         );     RSACryptoServiceProvider provider = new RSACryptoServiceProvider(cp);     byte[] buffer = Encoding.UTF8.GetBytes(stringToSign);     byte[] rawSignature = provider.SignData(buffer, CryptoConfig.MapNameToOID("SHA256"));     Console.WriteLine ("signature == ");     Console.WriteLine (BitConverter.ToString(rawSignature).Replace("-", string.Empty));     return Convert.ToBase64String(rawSignature); } </code></pre>  <p>I expect (perhaps incorrectly that) repeated calls to signString with the same string value, would return the same rawSignature and result. On Java and Windows, this is true. On Mono, the value changes</p>  <pre><code>String testString="helloworld"; Console.WriteLine("Signing '" + testString + "' == " + this.signString(testString)); Console.WriteLine("Signing '" + testString + "' == " + this.signString(testString)); Console.WriteLine("Signing '" + testString + "' == " + this.signString(testString)); </code></pre>  <p>returns, abbreviated results:</p>  <pre><code>signature ==  4415768E8E2FB862... Signing 'helloworld' == RBV2jo4v... signature ==  95E589C2F8DAD7ED... Signing 'helloworld' == leWJwvja... signature ==  0589E4454FE4FB3A... Signing 'helloworld' == BYnkRU/k... </code></pre>  <p>With Java, a similar test using the Google sample returns:</p>  <pre><code>rawSignature ==  3E56F09EE9CF7D98... Signing 'helloworld' == PlbwnunP... rawSignature ==  3E56F09EE9CF7D98... Signing 'helloworld' == PlbwnunP... rawSignature ==  3E56F09EE9CF7D98... Signing 'helloworld' == PlbwnunP... </code></pre>  <p>What am I doing wrong?</p>