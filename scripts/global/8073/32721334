<p>I am working with a filter mediator attempting to send messages to an output xml file. I have my sequence using a filter mediator based on a attribute value, if it is true I want to write the message to a new xml file in a certain directory. If it is false I will drop the record.  Here is my sequence:</p>  <pre><code>&lt;sequence xmlns="http://ws.apache.org/ns/synapse" name="RenaissanceIqtFilterSequence"&gt;    &lt;log level="custom"&gt;       &lt;property name="sequence" value="FilterSequence"&gt;&lt;/property&gt;    &lt;/log&gt;    &lt;filter xmlns:rs="urn:schemas-microsoft-com:rowset" xmlns:ns="http://org.apache.synapse/xsd" xmlns:z="RowsetSchema" xpath="//z:row/@name='RP'"&gt;       &lt;then&gt;          &lt;log level="custom"&gt;             &lt;property name="sequence" value="Condition Write"&gt;&lt;/property&gt;          &lt;/log&gt;          &lt;call-template target="FileWriteTemplate"&gt;             &lt;with-param name="targetFileName" value="NEW_MESSAGE_FILE"&gt;&lt;/with-param&gt;             &lt;with-param name="addressUri" value="vfs:file:///var/process/rrout"&gt;&lt;/with-param&gt;          &lt;/call-template&gt;       &lt;/then&gt;       &lt;else&gt;          &lt;log level="custom"&gt;             &lt;property name="sequence" value="Condition Drop"&gt;&lt;/property&gt;          &lt;/log&gt;          &lt;drop&gt;&lt;/drop&gt;       &lt;/else&gt;    &lt;/filter&gt; &lt;/sequence&gt; </code></pre>  <p>*I am using a template as you can see to write out to my new output file setting parameters for the file name and uri.</p>  <p>The result is the whole file is being written out to the directory not just the messages I want. I have been running google searches trying to see where I am going wrong. I assume at this point I may be using the Filter mediator incorrectly? Maybe there is a better way or mediator to use to accomplish this task? I would appreciate any thoughts or recommendations folks may have. Thanks for your time!</p>