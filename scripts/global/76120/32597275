<p>I recently ran the <a href="https://github.com/presidentbeef/brakeman" rel="nofollow">Brakeman gem</a> against my app, and one of its warnings was about a redirect line in my controller:</p>  <pre><code>Confidence:  High Warning type:  Redirect Message:  Possible unprotected redirect near line xx </code></pre>  <p>In that line in my controller, my redirect notice message includes the name of the object uploaded by the user:</p>  <pre><code>def update   parent_klass = params[:parent_type].constantize   @entity = parent_klass.find params[:parent_id]    authorize! :update, @entity    entity_param_key = params[:parent_type].downcase.to_sym   @entity.update_attributes params[entity_param_key]    cache_path = begin     if parent_klass == Clinic       clinic_path(@entity)     else       specialist_path(@entity)     end   end   expire_fragment cache_path    redirect_to @entity, :notice  =&gt; "Successfully updated #{@entity.name}." end </code></pre>  <p>In this controller, <code>@entity.name</code> is a form value that is defined by the user, meaning someone <em>in theory</em> could try to put malicious code into this field.  However I'm unsure if using that parameter to generate a notice presents as a security risk.</p>  <p>Flash notice messages get presented in the view as such (in HAML):</p>  <pre><code>#body.container   .row     #content.span12       #container         - flash.each do |type, msg|           .alert.alert-success= msg          = yield </code></pre>  <p>Is this controller pattern a security risk, and if so, how can I prevent it from being a security risk while still keeping a customized notice message?</p>