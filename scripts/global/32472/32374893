<p>I'm using a tables called transaction and sales where transaction contains account number, scriptname, transaction type(transactio) and Quanity; and sales table contains scriptname, account number, shares_bought and shares_sold. If the transaction type is sell then shares_bought = Quantity else Shares_sold= Quantity. The SQL command which I have written is not working, Please tell corrections.</p>  <pre><code>SELECT t.scriptname, s.accnum, s.shares_bought, s.shares_sold FROM sales AS s INNER JOIN transac AS t ON s.accnum = t.accnum SELECT CASE WHEN t.transactio = 'buy' THEN s.shares_bought=t.Quantity  ELSE s.shares_sold=t.Quantity  END </code></pre>  <p>For example I have in the transaction table I have scriptname="abcd" accnum="1" transactio="buy" and Quantity="20" In sales table I should get scriptname="abcd" accnum="1" shares_bought="20" and shares sold empty</p>