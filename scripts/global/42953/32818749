<p>Appreciate it very much if you can help me create an SQL statement for my requirement where i want to count how many days the end user is logged IN. I only have read only access to the MS SQL table so  i created a temporary table with the below MS SQL statement.</p>  <pre><code>SELECT EH.EventID, EH.EventType, EH.ModuleAndEventText, EH.Node, case when EH.ModuleAndEventText like 'User AP\%' then 'AP' when EH.ModuleAndEventText like 'User EUROPE\%' then 'EUROPE' when EH.ModuleAndEventText like 'User USA\%' then 'USA' end AS Domain, case when EH.ModuleAndEventText like 'User AP\%' then SUBSTRING(EH.ModuleAndEventText, 9, 6) when EH.ModuleAndEventText like 'User EUROPE\%' then SUBSTRING(EH.ModuleAndEventText, 13, 6) when EH.ModuleAndEventText like 'User USA\%' then SUBSTRING(EH.ModuleAndEventText, 10, 6) end AS Account, EH.[Time], case when EH.EventType like 'Agent_Connected' or EH.EventType like 'Agent_Reconnected' then 'User_Logged_IN_&amp;_Agent_Connected' when EH.EventType like 'Agent_Disconnected' then 'User_Still_Logged_IN_But_Agent_Disconnected' when EH.EventType like 'Broker_UserLoggedOut' then 'User_Logged_Out' when EH.EventType like ‘Agent_Ended’ then 'Agent_Ended_Session_&amp;_User_Logged_Out' end AS Status INTO #HVD_UTIL_Temp_Table FROM event_historical AS EH Select * from #HVD_UTIL_Temp_Table </code></pre>  <p>The Temporary Table output is similar to the image (see URL below) where i gave two end users as examples.</p>  <p><a href="http://i.stack.imgur.com/nX49g.jpg" rel="nofollow">http://i.stack.imgur.com/nX49g.jpg</a> </p>  <p>Requirements:</p>  <ol> <li>Using MS SQL statement, I want to count how many users are logged-in per Day (regardless whether the event_type is agent_connected, agent_reconnected, or agent_disconnected)? Note that the Status Column gives an idea about the meaning of each Event_Type.</li> <li>The indication that the user is logged in is when the Event_Type are agent_connected, agent_reconnected, or agent_disconnected. The user can have more than 1 Event_Type (i.e. Agent_Connected, Agent_Reconnected, &amp; Agent_Disconnected) in one day but will be counted as 1 logged IN per day even though the user disconnected/reconnected/connected the agent multiple times in one day.</li> <li>The indication that the user logged out is the Event_Type Agent_Ended.</li> <li>Another consideration is that a user can logon on a certain date for example Monday and may disconnect the agent on Wednesday, reconnect the agent on Thursday, and logged out (Agent_Ended) the following week let’s say Monday. So the calculation will need to show those users who don’t do daily logged IN / daily logged Out including Saturday / Sunday.</li> <li>On the day that the user logged out (i.e. Event_Type Agent_Ended) that day is also going to be included in the count because the user is presumed logged IN before the user initiated the logged out (i.e. Event_Type Agent_Ended).</li> </ol>  <p>Once we have a working SQL statement for the requirements stated above I will use it to create a report using MS Report Builder/SSRS. Please let me know if you are not able to view the temporary table using the URL provided above so I can try other ways to upload the image of the temporary table example.</p>