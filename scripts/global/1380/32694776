<p>Here is a function which uses Zend DB / Tablegateway :</p>  <pre><code>public function listAttestations($sSidx = null, $sSord = null, $iOffset = 0, $iLimit = 0) {     try {         $resultSet = $this-&gt;tableGateway-&gt;select(             function (Select $select) use ($sSidx, $sSord, $iOffset, $iLimit) {                 if ($sSidx != null &amp;&amp; $sSord != null) {                     $select-&gt;order($sSidx.' '.$sSord);                 }                 $select-&gt;join(                     'f_travclient',                     'syndic_client_id = f_travclient.travClient_id',                      array('syndic' =&gt; 'nom')                 );                 $select-&gt;offset($iOffset);                 $select-&gt;limit($iLimit);             }         );         return $resultSet;     } catch (\Exception $e) {         throw new \Exception($e);     } } </code></pre>  <p>I use PHPUnit to do unit tests. Perhaps, I don't know how to make the function which crosses my previous method. I thought this could be functional :</p>  <pre><code>public function testListAttestations() {     $resultSet = new ResultSet();      $mockTableGateway = $this-&gt;getMock('Zend\Db\TableGateway\TableGateway', array('select'), array(), '', false);      $mockTableGateway-&gt;expects($this-&gt;once())             -&gt;method('select')             -&gt;with()             -&gt;will($this-&gt;returnValue($resultSet));      $attestTable = new FMaiAttestationTable($mockTableGateway, $this-&gt;adapter, $this-&gt;sql);      $this-&gt;assertSame($resultSet, $attestTable-&gt;listAttestations('maiAttestation_id', 'ASC', 0, 30)); } </code></pre>  <p>But this doesn't go further the  : </p>  <pre><code>function (Select $select) use ($sSidx, $sSord, $iOffset, $iLimit) { </code></pre>  <p>Could somebody help me ? Thanks.</p>