<p>Time ago I've made this functions:</p>  <pre><code>vap.vector &lt;- function (x, y) {     y[is.infinite(y)] &lt;- NA     y[y == 0] &lt;- NA     logtasa &lt;- log(y)     datos &lt;- data.frame(x, logtasa)     datos &lt;- na.omit(datos)     lmdatos &lt;- lm(logtasa ~ x, data = datos)     es &lt;- qt(0.975, lmdatos$df.residual) * summary(lmdatos)$coefficients[2, 2]     vap &lt;- summary(lmdatos)$coefficients[2, 1]     vec &lt;- c(vap = vap, es = es, lwr = vap - es, upr = vap + es)     round((1 - exp(vec)) * -100, 2) }  vap_ &lt;- function (df, x, y) {     x = lazyeval::lazy_eval(x, df)     y = lazyeval::lazy_eval(y, df)     vap.vector(x, y) }  vap &lt;- function (df, x, y)  vap_(df, lazyeval::lazy(x), lazyeval::lazy(y)) </code></pre>  <p>I have this dataset</p>  <p><a href="https://drive.google.com/file/d/0Bw2XRcfksYZuX1R5bG9oZzdhZ2M/view?usp=sharing" rel="nofollow">https://drive.google.com/file/d/0Bw2XRcfksYZuX1R5bG9oZzdhZ2M/view?usp=sharing</a></p>  <p>and I wanna do:</p>  <pre><code>tbl_df %&gt;% group_by(code, sex) %&gt;% vap(year, values) </code></pre>  <p>or </p>  <pre><code>tbl_df %&gt;% group_by(code, sex) %&gt;%            summarise(vap = vap.vector(year, values)[1],                      lwr = vap.vector(year, values)[3],                      upr = vap.vector(year, values)[4]  ) </code></pre>  <p>and as result a data.frame with code, sex, and vap, lwr and upr columns.</p>  <p>but I cannot do it. I the second aproach I get:</p>  <pre><code>Error: 0 (non-NA) cases </code></pre>  <p>There is a simply way to do it or I need to be @hadley</p>  <p>I'm working on Windows with R 3.2.2 and dplyr 0.4.3. Thanks in advance...</p>