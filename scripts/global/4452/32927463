<p>I have a huge dataset containing observations about 1000 different entities. Each entity has an ID between 1 and 1000 and there are no missing IDs. Since the dataset has more than 1 million rows, I want to obtain a subset with 10 random observations for each entity to make some analysis.</p>  <p>The following code does the trick, but it looks cumbersome and its performance is poor.</p>  <pre><code>library(dplyr) # sample_n is a dplyr function samples &lt;- sample_n(dataset[dataset$Entity == 1, ], 10) for (x in 2:1000) {   samples &lt;- rbind(samples, sample_n(dataset[dataset$Entity == x, ], 10)) } </code></pre>  <p>Could you please share some ideas for doing the same in a better fashion?</p>  <p>Thanks in advance!</p>