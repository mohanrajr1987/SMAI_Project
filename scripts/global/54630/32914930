<p>This is the first script i try to write from scratch. I think im close to making it work. im writing this in a spreadsheet's script proyect in google app scripts.</p>  <p>Case: I recieve e-commerce confirmation emails from e-commerce sites no reply email address. In the email's body they send email address from buyers. I want to send an automated mail to the body's email address.</p>  <p>How i plan to do this (any suggetions to eliminate steps will be thanked).</p>  <ol> <li>Use a rule to tag incoming emails with a unique tag.</li> <li>Use that tag to identify emails in gmail with a script, go one by one and extract the info i need. Use regex with the emails body content to extract the email address i need to send the automated emails. Plan is to get: subject, date, email from body.</li> <li>Write all that info to a spreadsheet.</li> <li>Get rid of unique tag info to prevent duplicate runs.</li> <li>Then use form mule addon to send emails from the spreadsheet.</li> </ol>  <p>I have everything runnin smooth with the spreadsheet, tags and gmail methods. I retrieve all the info i need and write it on the spreadsheet.</p>  <p>The problem arrises when i try to apply a function to the email body trying to match it to a regex expression.</p>  <p>I hacked many regex expressions for javasript but none of them seems to work.</p>  <p>Can i get some help please?</p>  <pre><code>function myFunction() {     function emailextract(x) {      return x.match("\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b");   }    var ss = SpreadsheetApp.getActiveSheet();   var label = GmailApp.getUserLabelByName("tag");   var threads = label.getThreads();    for (var i=0; i&lt;threads.length; i++)   {     var messages = threads[i].getMessages();      var msg = messages[0].getBody();     var email = emailextract(msg);     var sub = messages[0].getSubject();     var dat = messages[0].getDate();      ss.appendRow([dat, sub, email]);      threads[i].removeLabel(label);   } } </code></pre>  <p>Thanks, Sebastian</p>