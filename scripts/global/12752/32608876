<p>I'm trying to convert a tab to a print preview thing. I am successfully turning to print preview like this:</p>  <pre><code>function noida_printpreview(aWindow) {     var wbp = aWindow.QueryInterface(Ci.nsIInterfaceRequestor).getInterface(Ci.nsIWebBrowserPrint);     var listener = {         onLocationChange: function(webProgress, request, location, flags) {},         onProgressChange: function(webProgress, request, curSelfProgress, maxSelfProgress, curTotalProgress, maxTotalProgress) {},         onSecurityChange: function(webProgress, request, state) {},         onStateChange: function(webProgress, request, stateFlags, status) {},         onStatusChange: function(webProgress, request, status, message) {},         QueryInterface: function(iid) {             if (iid.equals(Ci.nsIWebProgressListener) || iid.equals(Ci.nsISupportsWeakReference)) {                 return this;             }             throw Cr.NS_NOINTERFACE;         }     }     Services.prefs.setBoolPref('print.show_print_progress', false);     //XXX I would have thought this would work, instead I'm forced to use prefs service     wbp.globalPrintSettings.showPrintProgress = false;     wbp.printPreview(wbp.globalPrintSettings, aWindow, listener);     Services.prefs.clearUserPref('print.show_print_progress'); } </code></pre>  <p>If you copy paste that to scratchpad, then do:</p>  <pre><code>noida_printpreview(content) </code></pre>  <p>You'll see it turn to print preview, but it has no buttons to go to print dialog, or even close. And back button doesn't work anymore.</p>  <p>Can you help me to figure why its so quirky like this.</p>  <p>Thanks</p>