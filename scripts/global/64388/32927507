<p>There is a " table " in the ES, which has the form</p>  <pre><code>{"fields": [{"id": [{"innerField": [value]}]}]}} </code></pre>  <p>or</p>  <pre><code> object ("fields", array (object ("ids", array (object ("innerFields", array (value)))))) orIndexResponse response = client           .prepareIndex(index, type, id)           .setSource(               jsonBuilder()                 .startObject()                   .startArray("fields")                     .startObject()                       .startArray(filmId).                         startObject().array("ids",val).endObject()                       .endArray()                     .endObject()                   .endArray()                 .endObject())           .execute().actionGet(); </code></pre>  <p>How can I make a request Update from the script in Groovy, if I want to add to the array ids entry and inside have to add an entry to the array innerFields. It is necessary to record not duplicated .</p>  <p>That came long before that , but the issue exceptions</p>  <pre><code>if (ctx._source.fields.contains(\""+id1+"\")) {   if(!ctx._source.fields[\""+id1+"\"].innerFields.contains(\""+val1+"\")){     ctx._source.fields[\""+id1+"\"].innerFields = [\""+val1+"\"]   }; } else {   ctx._source.fields += \""+id1+"\"   ctx._source.fields[\""+id1+"\"].innerFields =  [\""+val1+"\"] } </code></pre>  <p>Sorry, then markup problems</p>  <p>I would be very grateful, if prompt where to dig and how to change the code!</p>