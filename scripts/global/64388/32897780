<p>i have the following query for elasticsearch:</p>  <pre><code>{     query: {       bool: {         must: [           { term: { adspace: adspace } },           { term: { type: 'tab' } },           { range: { created_at: { from: format_datetime(from_date, 'begin'), to: format_datetime((to_date || Date.today.end_of_day), 'end') } } }         ],         must_not: [], should: []       }     },     from: 0,     size: 10,     facets: {},     aggs: {       dedup_counters: {         top_hits: {           sort: [             { counter: { order: 'desc' } }           ],           size: 1         }       }     }   } ) </code></pre>  <p>It returns the register with biggest counter, in desc order. What I want is to discard a register if it has the field 'tab_name' equal to another with bigger counter. Remove duplications</p>