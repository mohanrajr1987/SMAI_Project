<p>I have a WINAPI application and I want to start it by drag and drop of a file onto the Icon of my application.</p>  <p>The main window is created with</p>  <pre><code>hWnd = CreateWindow("app-name",                     "",                     WS_OVERLAPPEDWINDOW                     | WS_CLIPSIBLINGS                     | WS_EX_ACCEPTFILES,                     CW_USEDEFAULT, 0, CW_USEDEFAULT, 0,                     NULL, NULL, hInstance, NULL); </code></pre>  <p>and has a WndProc with</p>  <pre><code>static LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam) {     switch (message)     {         case WM_CREATE:             {                 DragAcceptFiles(hWnd, TRUE);                  // etc (other controls and windows created here)              }             break;         case WM_DROPFILES:            {              char filename[MAX_PATH];              HDROP hDropInfo = (HDROP) wParam;              DragQueryFile(hDropInfo, 0, filename, MAX_PATH);              // etc open file...             }            break; </code></pre>  <p>The problem is that when I drag and drop a file from the Explorer onto my program Icon, the program is started, but I don't receive any WM_DROPFILES message. That is also the case if I configure the file-type to "open with" my program - it's started but no WM_DROPFILES is received.</p>  <p>But once the program is initialized I can drag a drop a file into some of its windows, and then I get the WM_DROPFILES message as I expect it.</p>  <p>What am I doing wrong?</p>  <p>Thanks for advice!</p>  <p>BR Alfred</p>