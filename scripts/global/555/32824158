<p>Since I am relatively new to R and I would like to use it for formatting large amount of data that are in one file (+30,000 unique IDs) and re-writing them in different format in another file. I have a big problem in solving some sort of R-behaviour. Due to the complexity of the case I share a dropbox folder with the example files included. This is what I am trying to achieve:</p>  <p>I would like to have the file formatted like the "Final Product.dat" which is space delimited (but it has to keep rigorously the same spacing as here, otherwise the things I am running will not run!).  So, on the first line of the file there is an ID called "HUXXX...1" which will go from 1 to +30,000, then the next 5 lines will be always the same and then there are the data. So, the lines from 2 to 4 are written in a separate file (SHead); and for the whole the line 5 I wrote in "header.txt"  For the first line, I created another file called ID-s100 which will contain the "HUXXXX" plus the ID column. I was hopin to use some sort of "sprintf" in that case (see code attached in dropbox).  the data are in the "S100.txt"; note that I have created an ID as first column.</p>  <p>My code kind of work but within each ID will repeat the same values for the whole ID. For example, for ID =1 instead of creating one HU0000001 and one profile (as in "Final Product.dat") it will create 12 times HU00001 and the same data, then do the same for ID 2.  What I want is exactly what "Final Product.dat" is: ONE Unique HUXXXXXN and for each of that HUXXXXN its correspondent data below (which should be matched by the ID column). Can someone help me? I am now finding hard to make the code working with the feedback I can find from the Internet and I guess I might need some insight. </p>  <p><a href="https://www.dropbox.com/sh/5gxpw0dy2brahho/AADirGyvMUjkTDPbO4fJmlLBa?dl=0" rel="nofollow">https://www.dropbox.com/sh/5gxpw0dy2brahho/AADirGyvMUjkTDPbO4fJmlLBa?dl=0</a></p>  <p>Since I understand the  need for having the code and the data written here I try to do it as best as I could:</p>  <p>I hope the "Final Product" will look as good as it should be: The bold on the first line is something I would to be changing following each ID</p>  <blockquote>   <p><strong>*HU00000001</strong>  AAAA       C       150 SOME DEFAULT</p> </blockquote>  <p>so I have a file called ID-s100.txt which has the ID on Col 1 and the HU numbers on Col 2. </p>  <p>The these lines will be the same for each ID  </p>  <p>@ SITE         COUNTRY           LAT      LON    SC   FL<br>   LCO   ................................................. (Some info go here)<br> @     SCOM    SALB    SLU1    SLDR    SLRO    SLNF    SLPF    SMHB    SMPX    SMKE<br> .............................. (some other info goes here)</p>  <p>the above four lines are read in the SHead.txt file</p>  <p>Then the header.txt is the following:</p>  <p>@  SLB  SLMH  SLLL  SDUL  SSAT  SRGF  SSKS  SBDM  SLOC  SLCL  SLSI  SLCF  SLNI SLHW  SLHB SCEC SADC</p>  <p>and the data that goes below are stored in the "s100.csv" and "ksat and srfg.txt" and have the ID on the first column and the data afterwards. the "ksat..." is just one set of data repeated all over until the end, below is an extract of the data for the first ID (first column..):</p>  <pre><code>   1      10    0.02    0.04    0.12    0.42       4       8     1.4    2.02    6.18    1      20    0.02    0.04    0.12    0.42       4       8     1.4    2.02    6.18    1      30    0.02    0.04    0.12    0.42       4       8     1.4    2.02    6.18    1      40    0.02    0.04    0.12    0.42       4       8     1.4     0.5     5.5      2       5    0.02    0.04    0.12    0.42       3       8     1.4     2.4     5.5    2      10    0.02    0.04    0.12    0.42       3       8     1.4     2.4     5.5    2      20    0.02    0.04    0.12    0.42       3       8     1.4     2.4     5.5 </code></pre>  <p>...then it goes until +30,000</p>  <p>and here is the code:</p>  <pre><code>Library(MASS) setwd("C:\\....") s100 = read.csv("C:\\.....\\S100.csv", header=F) SHead = readLines("SHead.txt") sID.n= read.table("C:\\.....\\ID-s100.txt",header=F) sheader= read.table("C:\\.....\\header.txt", header=F) ksat = read.table("C:\\.....\\Ksat and Srfg.txt", header=F) m99 &lt;- rep("-99", nrow(s100)) m9df = as.data.frame(m99) SSAT.n = cbind(s100$V1, s100$V12, s100$V2, m9df, s100$V4, s100$V5, s100$V6, ksat$V1, ksat$V2,             s100$V9, s100$V10, s100$V7, s100$V8, m9df, m9df, s100$V11, m9df, m9df, m9df) for(id in s100$V1){ SSAT = SSAT.n[s100$V1 == id, 2:19]  shead = as.matrix(sheader, dimnames = NULL)  SSAT[is.na(DSSAT)] &lt;- " " xxm = as.matrix(DSSAT, dimnames = NULL)  names(xxm) &lt;- names(shead)  t1 = rbind(shead,xxm) t2 = as.data.frame(t1, dimnames = NULL)  names(t2) = c("  ", "  ","  ","  ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ") t3 = format(t2, justify = "right", col.names=F, row.names=F, dimnames=NULL) sID = sID.n[sID.n$V1 == id, 2] Line2 = paste(sprintf("%1s%1s %5s", "*", sID, " UPSC        SCL      140  SOIL PROFILE\n", "\n", sep="")) file.n = "TRIAL.dat" con = file(description = paste(file.n), open="a")  writeLines(Line2, con=con, sep= "\n") writeLines(SoilHead, con = con , sep = "\n" ) write.table(t3, file= con, append = TRUE, quote=F, col.names=FALSE, row.names= F) close(con) } </code></pre>  <p>Thank you in advance for any help!</p>