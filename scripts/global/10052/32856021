<p>Here is a link to my spreadsheet: <a href="http://s000.tinyupload.com/index.php?file_id=88100583725623411196" rel="nofollow">http://s000.tinyupload.com/index.php?file_id=88100583725623411196</a></p>  <p>The attached photo shows the steps I need to accomplish this macro</p>  <ol> <li>Filter Col A to "Type 1 Error"</li> <li>Search Col D for "Error 1"</li> <li>Search Col E for ON OFF ON OFF series next to the "Error 1"</li> <li>Flag error <a href="http://i.stack.imgur.com/Go4gB.png" rel="nofollow"><img src="http://i.stack.imgur.com/Go4gB.png" alt="enter image description here"></a></li> </ol>  <p>Below is my code - it almost works except it misses the case where the ON OFF ON OFF series is broken up in the unfiltered data. I need a way to offset only on the visible cells (and not the hidden). The .SpecialCells(xlCellTypeVisible) command doesn't seem to help.</p>  <pre><code>Private Sub ErrorTest()  With Worksheets("Sheet1")      lastrow = .Range("A" &amp; Rows.Count).End(xlUp).Row      .Rows("1:1").AutoFilter field:=1, Criteria1:="Type 1 Error"      Dim rRng As Range     Set rRng = Range("D2:E" &amp; lastrow).SpecialCells(xlCellTypeVisible)      For Each cell In rRng          If cell.Value = "Error1" And cell.Offset(0, 1).Value = "ON" And cell.Offset(1, 1).Value = "OFF" And cell.Offset(2, 1).Value = "ON" And cell.Offset(3, 1).Value = "OFF" Then             cell.Offset(0, -1).Value = "FLAG ERROR"             cell.Offset(0, -1).Interior.Color = RGB(255, 255, 0)         End If      Next  End With End Sub </code></pre>