<p>I have a file with comma separated values (CSV), that have this format:    </p>  <pre><code>26/09/2015,GROUP_1,0,0,0,0,0,0,0,0,0,0,12345.006,12345.006,27469.005,27469.005,27983.005,27983.005,28081.005,0,0,0,28105.005,28105.005,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 </code></pre>  <p>Every number represents the work hours over an interval of 15 minutes, over the range 8:00 am - 8:00 pm.  The first start time is <code>08:00:00</code>) and the last start time will be <code>19:45:00</code>; there are 49 "columns" of data.</p>  <pre><code>0,0,0,0,0,0,0,0,0,0,12345.006,12345.006,27469.005,27469.005,27983.005,27983.005,28081.005,0,0,0,28105.005,28105.005,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 </code></pre>  <p>The date will be the date when the "event" happened and it's the date on the data. But I need to get the values that are the same and specify a time range. For example, those first two non-zero values are the same:</p>  <pre><code>12345.006,12345.006  </code></pre>  <p>These start at 10:30 and 10:45; I need to merge these and report 12345 hours for the time span 10:30 - 11:00 am.</p>  <p>I read the file; I have those values as an array, and the problem I'm having is how to "group" the same values into the appropriate time ranges.</p>  <pre><code>DateTime startDate = new DateTime(2015,08,05); DateTime finisDahte = new DateTime(2015,08,05); int column = 0; for (int i = 0; i &lt; data.Length; i++) {     //timerange start with every 15 minutes by column     if (column &gt;= 2)     {         if (data[i] != "0")         {             //Getting rid of decimals, they are not neccesary and that's how the file have it, I dont know why             if (data[i].Contains('.'))             {                 data[i] = data[i].Substring(0, data[i].LastIndexOf('.'));              }              //we check if there is a next index to compare the same value             if ((i + 1) &lt;= totalElementos)             {                  var nextElem = data[i + 1];                 if (nextElem != "0")                 {                     nextElem.Substring(0, nextElem.LastIndexOf('.'));                 }                 else                 {                     //the is no next element... something here                 }                  //CRUCIAL PART: if the current index it's the same as the next one, it means they share the time range                 if (data[i] == nextElem)                 {                     //the same index as the next one                     //I need to identify when it's the first time I'm comparing a value with the next one, so I can set a start date                     //I need to sum the total amount of time ranges for every repetition they have and save when the value start and when the value is different (so it's a new value)                 }                 else                 {                     //it's not the same index, so technically the finishdate will be set here?                 }             }             else             {                 //there is not more indexes, so finishdate will be here             }          }      }      //column++; } </code></pre>  <p>Hope I could explain. Thanks</p>