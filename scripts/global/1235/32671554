<p>According to the documentation for the <a href="https://msdn.microsoft.com/en-us/library/ms646839.aspx" rel="nofollow">OPENFILENAME structure</a>, the following algorithm is used to select the initial directory:</p>  <blockquote>   <p>Windows 7:</p>      <ol>   <li>If <strong>lpstrInitialDir</strong> has the same value as was passed the first time the application used an <strong>Open</strong> or <strong>Save As</strong> dialog box, the path most recently selected by the user is used as the initial directory.</li>   <li>Otherwise, if <strong>lpstrFile</strong> contains a path, that path is the initial directory.</li>   <li>Otherwise, if <strong>lpstrInitialDir</strong> is not <strong>NULL</strong>, it specifies the initial directory.</li>   <li>If <strong>lpstrInitialDir</strong> is <strong>NULL</strong> and the current directory contains any files of the specified filter types, the initial directory is the current directory.</li>   <li>Otherwise, the initial directory is the personal files directory of the current user.</li>   <li>Otherwise, the initial directory is the Desktop folder.</li>   </ol> </blockquote>  <p>I'm using the following code to construct a file dialog:</p>  <pre><code>CFileDialog dlgFile(bOpenFileDialog); dlgFile.m_ofn.lpstrInitialDir = strSourcePath; dlgFile.m_ofn.lpstrFile = fileName.GetBuffer(_MAX_PATH); </code></pre>  <p>However, it ALWAYS opens the same default folder in strSourcePath. Does anyone know why? It should only use this directory the first time, and subsequent file opens should remember the last folder (bullet point 1. in the algorithm). I'm using VS2012 on Windows 7.</p>