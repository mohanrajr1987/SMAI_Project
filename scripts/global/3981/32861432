<p>I'm trying to run this piece of code:</p>  <pre><code>SET IDENTITY_INSERT [dbo].[FIN_REP_REPORT_LOG] ON SET IDENTITY_INSERT [dbo].[REPORT_LOG_SEQ] ON INSERT INTO [dbo].[REPORT_LOG_SEQ] ([sqVal]) VALUES (1000000); </code></pre>  <p>I'm getting this error: <a href="http://i.stack.imgur.com/8ftjw.png" rel="nofollow"><img src="http://i.stack.imgur.com/8ftjw.png" alt="SQL Server 2008 R2 - Error1"></a></p>  <p>For reference: I'll refer to FIN_REP_REPORT_LOG as 'TABLE A', and REPORT_LOG_SEQ as 'TABLE B'.</p>  <p>The error message after the 2nd IDENTITY_INSERT statement on the REPORT_LOG_SEQ table doesn't even relate!</p>  <pre><code>SET IDENTITY_INSERT [TABLE B] ON --Msg 8107, Level 16, State 1, Line 1 --IDENTITY_INSERT is already ON for table [TABLE A].  --Cannot perform SET operation for table [TABLE B]. </code></pre>  <p>The INSERT INTO statement then fails for [TABLE B]!</p>  <pre><code>INSERT INTO [TABLE B] ([sqVal]) VALUES (1000000) --Msg 544, Level 16, State 1, Line 1 --Cannot insert explicit value for identity column in table [TABLE B] when IDENTITY_INSERT is set to OFF. </code></pre>  <p>The SET operation on [TABLE B] doesn't happen, so the INSERT operation fails.</p>  <p><strong>What I want to know is:</strong></p>  <ol> <li>Why does the second SET IDENTITY_INSERT statement fail?</li> <li>Why does the error message even reference the unrelated [TABLE A]?</li> <li>What can I do to fix it?</li> </ol>  <p><strong>The scenario:</strong></p>  <ul> <li>I'm running this code one line at a time!</li> <li>I'm using SQL Server 2008 R2</li> <li>The code works just fine in the "dev" and "test" servers, but FAILS on the production server.</li> <li>The 'Compatibility Level' of the production server is 100. It's Level 80 for the "dev" and "test" servers.</li> <li>Their are no inter-dependencies between the tables in question.</li> <li>I am not the DBA. I can only run the code on "dev". The DBA must run the code on "Test" and "Prod".</li> <li>The DBA is as stumped as I am.</li> </ul>  <p><strong>FYI:</strong> Table definition for FIN_REP_REPORT_LOG (TABLE A):</p>  <pre><code>CREATE TABLE [dbo].[FIN_REP_REPORT_LOG](     [ID] [bigint] IDENTITY(1,1) NOT NULL,     [REPORT_NAME] [nvarchar](50) NOT NULL,     [EMPLOYEE_NUMBER] [nvarchar](10) NULL,     [PARAMS] [nvarchar](1000) NULL,     [START_DATE] [datetime2](0) NOT NULL,     [END_DATE] [datetime2](0) NULL ) ON [PRIMARY] </code></pre>  <p>The table definition for REPORT_LOG_SEQ (TABLE B):</p>  <pre><code>CREATE TABLE [dbo].[REPORT_LOG_SEQ](     [sqVal] [bigint] IDENTITY(1000000,1) NOT NULL ) ON [PRIMARY] </code></pre>  <p>Any help (even clues) will be appreciated. :)</p>