<p>I am currently testing my AngularJS application and I am struggling with the tests of the controllers injecting a service. </p>  <p>Here is my controller:</p>  <pre><code>.controller('UserCtrl', ['$scope', '$routeParams', 'User', function ($scope, $routeParams, User) {      $scope.hello = "lol";      $scope.userId = $routeParams.id;     var user = new User($scope.userId);      $scope.load = function(){         user.load().then(             function(user){                 $scope.name     = user.name;             },             function() {                 $scope.dataFail = 'error error' ;             }         );     };      $scope.load(); }]); </code></pre>  <p>Here is my User service (that i want to inject in my controller's test)</p>  <pre><code>.factory('user', ['$http', '$q', function ($http, $q) {  var User = function (id) {     this.id = id;     this.name = null; };  User.prototype.load = function () {     var deferred = $q.defer();      $http.post('/user/' + this.id + '/load')         .success(function(data) {             var user = new User(data.id);             user.name = data.name             deferred.resolve(user);         })         .error(function(err, code) {             deferred.reject(err);         $log.error(err, code);     });     return deferred.promise; };  return User; </code></pre>  <p>And finally is my test : </p>  <pre><code>describe('Controller: UserCtrl', function () {  var $controller, $scope, User;  beforeEach(module('octosendApp', function($provide){     User = jasmine.createSpyObj('User', ['load']);      User.load.and.returnValue({         name: 'testName'     });     $provide.value('User', User); }));  beforeEach(inject(function(_$controller_, $rootScope, _User_){     $scope = $rootScope.$new();     User = _User_;      $controller = _$controller_('UserCtrl', {         $scope: $scope,         User : User,         $routeParams: {id: 2}     }); }));  it('should have a hello property', function() {     expect($scope.hello).toBeDefined(); }); </code></pre>  <p>});</p>  <p>I get the following error : </p>  <pre><code>TypeError: '[object Object]' is not a constructor (evaluating 'new User($scope.userId)') </code></pre>  <p>I guess the problem is because my factory is object oriented and i can not use the constructor. i followed this tutoarial : <a href="https://vimeo.com/90938739" rel="nofollow">https://vimeo.com/90938739</a> and did the exact same, the only difference is the structure of the factory, which I do NOT want to change. </p>  <p>Thank you for your help. </p>