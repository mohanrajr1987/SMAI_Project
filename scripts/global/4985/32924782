<p>I am trying to download images from a webpage using Excel. I have the sheet like this.</p>  <p><strong>Image <a href="http://postimg.org/image/ou1nnq7lb/" rel="nofollow">link</a></strong></p>  <p><strong>I am using the code given in this <a href="http://stackoverflow.com/questions/10383614/get-pictures-from-a-url-and-then-rename-the-picture">link</a></strong></p>  <p>The code is:</p>  <pre><code>    Option Explicit  Private Declare Function URLDownloadToFile Lib "urlmon" _ Alias "URLDownloadToFileA" (ByVal pCaller As Long, _ ByVal szURL As String, ByVal szFileName As String, _ ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long  Dim Ret As Long  '~~&gt; This is where the images will be saved. Change as applicable Const FolderName As String = "C:\Temp\"  Sub Sample()     Dim ws As Worksheet     Dim LastRow As Long, i As Long     Dim strPath As String      '~~&gt; Name of the sheet which has the list     Set ws = Sheets("Sheet1")      LastRow = ws.Range("A" &amp; Rows.Count).End(xlUp).Row      For i = 2 To LastRow '&lt;~~ 2 because row 1 has headers         strPath = FolderName &amp; ws.Range("A" &amp; i).Value &amp; ".jpg"          Ret = URLDownloadToFile(0, ws.Range("B" &amp; i).Value, strPath, 0, 0)          If Ret = 0 Then             ws.Range("C" &amp; i).Value = "File successfully downloaded"         Else             ws.Range("C" &amp; i).Value = "Unable to download the file"         End If     Next i End Sub  Private Sub Worksheet_SelectionChange(ByVal Target As Range)  End Sub </code></pre>  <p><strong>Problem:</strong></p>  <p>The problem is whenever I run macro. It gives me an error "subscript out of range" Runtime error '9'.</p>  <p>Any idea what code should I use?</p>