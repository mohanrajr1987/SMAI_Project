<p>I need help with finding matching records in SQL. My table below alleviates many to many problem, where GridToPageID is primary key, and there can be many instances of a single GridID with a different PageID.</p>  <p><a href="http://i.stack.imgur.com/RTntz.jpg" rel="nofollow"><img src="http://i.stack.imgur.com/RTntz.jpg" alt="enter image description here"></a></p>  <p>In my application, parameter will be passed with a specific list of PageID's and I would need to query and find only records that match exact number of PageID's passed. When I query SQL using below query it returns me all records that have 2 and more matches where I wanted to get only one record that has exactly those 2.</p>  <pre><code>SELECT [GridID]   FROM [AgencySalesAgreementU01].[dbo].[GridToPage]     where PageID in('11aida','30aida') --or any number   group by gridid   having COUNT (GridToPageID) = 2 --match the number of PageID's passed </code></pre>  <p>This is the same linq-to-sql query tested in LinqPad</p>  <pre><code>string[] allpages ={"11aida","30aida"};//,"32aida"};  var result = from gtp in GridToPage  where allpages.Contains(gtp.PageID)  group gtp by gtp.GridID into grp where grp.Count() == allpages.Count()  select grp.Key; result.Dump(); </code></pre>  <p>The result of above query returns GridID of 261, 263 and 266 where I wanted it to return only 261. If I pass three PageID's I would need it to return 263 and 266.  And similarly, for only PageID '11aida' it would return 268.</p>