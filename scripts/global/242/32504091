<p>I have one <code>csv</code> file, <code>csv_file.csv</code>, which had multiple records for each state and the state is identified with an id. The sample looks like:</p>  <pre><code>state_id,year,value 01,2012,8.0 01,2012,8.1 01,2012,8.0 01,2012,7.7 01,2013,7.3 01,2013,7.0 01,2013,7.0 </code></pre>  <p>I want to convert the <code>state_id</code> in above dataset to corresponding <code>state_name</code> and write the records into another <code>csv</code> file,<code>output.csv</code>, so that for each state all the <code>value</code> fields come in one row and the output becomes:</p>  <pre><code>Alabama,8.0,8.1,8.0,7.7,7.3,7.0,7.0 Alaska,8.1,8.1,8.0,7.4,7.25,7.6,7.5 </code></pre>  <p>For doing the mapping I have another <code>csv</code> file, <code>state.csv</code>, with the mapping details:</p>  <pre><code>state_id,state_name 01,Alabama 02,Alaska 04,Arizona 05,Arkansas 06,California 08,Colorado 09,Connecticut </code></pre>  <p>I wrote this code but this only seems to convert only 4 records(the top 4 records for <code>state_id</code> <code>01</code> and <code>year</code> <code>2012</code>) of the <code>csv_file.csv</code> as when I open the <code>Output.csv</code> I see only 4 records and that too for them the <code>value</code> field is repeated. My current code is:</p>  <pre><code>reader_csv = csv.reader(open('csv_file.csv', 'rb')) reader_state = csv.reader(open('states.csv', 'rb')) file_write = open('Output.csv', 'a') writer = csv.writer(file_write)  for line in reader_csv:     for states in reader_state:         if line[0] == states[0]:            print line[0]+'='+states[1]            writer.writerow([states[1]]+[line[1]]+[line[2]])            break  file_write.close() </code></pre>  <p>What is the mistake I am doing here and how can I do the mapping to change <code>state_id</code> to <code>state_name</code>?</p>