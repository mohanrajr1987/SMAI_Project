<p>So I am trying to find the last site in a URL for sharepoint. I want to be able to copy and paste a URL into a field and have it strip everything after the site.</p>  <p>Sharepoint URL Example 1: (always different)- <a href="http://lobportal-iceo.mysite.com/sites/wig/Support/Lists/Queue/test%20tickets.aspx" rel="nofollow">http://lobportal-iceo.mysite.com/sites/wig/Support/Lists/Queue/test%20tickets.aspx</a></p>  <p>In the above example, the last site would be "support" so it should give me <a href="http://lobportal-iceo.mysite.com/sites/wig/Support" rel="nofollow">http://lobportal-iceo.mysite.com/sites/wig/Support</a> when pasted in a field</p>  <p>Sharepoint example URL 2: <a href="http://lobportal-iceo.mysite.com/sites/wig/Support/SupportCenter/_layouts/15/viewlsts.aspx" rel="nofollow">http://lobportal-iceo.mysite.com/sites/wig/Support/SupportCenter/_layouts/15/viewlsts.aspx</a> So the last site in this URL is SupportCenter</p>  <p>The thing is, it will always change because there may be 1 or 10 subsites</p>  <p>This is what I have</p>  <p>url = url.indexOf("/Lists") >= 0 ? url.substring(0, url.indexOf("/Lists")) : url;    url = url.indexOf("/Documents") >= 0 ? url.substring(0, url.indexOf("/Documents")) : url;    url = url.indexOf("/View") >= 0 ? url.substring(0, url.indexOf("/View")) : url;</p>