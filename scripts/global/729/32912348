<p>I am working on a file parer/validator application that needs to pull in records from various flat files(CSV, Fixed Width, etc), validate the data in the columns and eventually present the data to the calling application in a DataTable for processing. In this I need to make a decision on a trade-off between memory usage and speed. Here's the dilemma. I can't build the DataTable with the appropriate column types until I know that all of the data is correct. I can't very well stick the value "one" into a column of type Int or Decimal. So I need to loop through the file processing each field on each record determining if it of the correct type and within the appropriate range. If there is a error I need to write that to an errors column in the Table and then it will eventually be presented to the user for correction. If the error is one that precludes me from putting the data value into it's column (e.g. text into a numeric column) then I have an issue. What I've determined is that I need a DataTable that has all string/text columns plus one extra to report the errors for the record. If there are no errors then I need to go back through the data putting it into a DataTable where the columns are the appropriate type and returning it back to the calling application indicating that it passed the validation. If not then I return the DataTable where all of the columns are text with the additional error column so it can present the data to the user to be corrected.</p>  <p>So here's the question. </p>  <ul> <li>Would it be better to loop through the file twice? Validating the data on the first pass and then building up the valid DataTable on the second?</li> <li>Would it be better to better to loop through the file once building up the all text display DataTable and then loop through that first DataTable on the second pass building up the valid DataTable?</li> <li>Would it be better to build up both DataTables simultaneously as I make one pass through the file and then toss out the valid DataTable if I encounter an error?</li> </ul>  <p>The first two approaches would use less memory but would take longer. And which of these two would take longer? Looping through the file twice or looping through the file once and the resulting DataTable once? The third option would be faster, because I am only looping through the data one time. Given that there could easily be several hundred thousand records in any given file, this could be significant. On the other hand, given that number of records, having two DataTables in memory would chew up a lot of additional memory. This being initially targeted to a web application that is not a desirable either.</p>  <p>Any thoughts and/or suggestions on this would be truly appreciated.</p>  <p>Thanks, Doug</p>  <p>If you are going to down vote this (as I see two people already have), please be respectful enough to add a comment as to why.</p>