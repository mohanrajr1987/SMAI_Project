<p>I have a simple Windows Form application. I have used a Timer and on Timer interval I am checking online database for values and updating it on the form. </p>  <pre><code>Private Sub Timer_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer.Tick       Try         String ConnectionString = globalConnString         Dim SQL As String = "SELECT AnnouncementID, AnnoucementText FROM tblAnnouncements"         Dim conn As SqlConnection = New SqlConnection(ConnectionString)             conn.Open()          Dim adapter As SqlDataAdapter = New SqlDataAdapter(SQL, conn)          Dim ds As DataSet = New DataSet("Announcements")         adapter.Fill(ds)          UpdateForm(ds)     Catch ex As Exception             LogError("Timer_Tick", ex)     End Try  End Sub </code></pre>  <p>Now sometimes the internet is disconnected or there is very slow internet. For that I have created a function as below,</p>  <pre><code>Public Function CheckInternetConnection() As Boolean     Try         If My.Computer.Network.IsAvailable = True Then             Return My.Computer.Network.Ping("8.8.8.8")         Else             Return False         End If     Catch ex As Exception         Return False     End Try         End Function </code></pre>  <p>This function is pinging google public DNS but in my application this is the IP address of my database server. I have wrapped the functionality inside Timer_Tick inside CheckInternetConnection so that when there is internet connection only then the database operation is made.</p>  <p>Now problem I am facing is that when I switch internet (using two different wifi conenctions) and when I turn on and off the internet then very rarely the code is broken and exception is created for line adapter.Fill(ds). My guess is that it is because at the start of function there is internet connectivity available and the condition for internet check is passed. When program starts to execute database operation then at that point rarely internet is gone so the program raises exception.</p>  <p>The example I have given is for one function and the actual application (which is quite big and written long time ago) is like this and I have to fix the connectivity issue within the same code. How can I make this fool proof that no database code is ever reached when there is no internet connectivity? </p>