<p>I'm writing an application in C on Mac OS X that communicates with a Bluetooth device using COM ports. If the Bluetooth device is powered off after the connection has been made, subsequent calls to <code>close</code> block indefinitely. Note I am using <code>aio_read</code> and <code>aio_write</code> to read and write to the device.</p>  <p>If the device is left powered on, then <code>close</code> succeeds as expected.</p>  <p>Example:</p>  <pre><code>/* Open the com port */ int fd = open (g_comName, O_RDWR | O_NOCTTY | O_ASYNC );  /* Ensure fd is valid, do some work, then power off the Bluetooth device */  /* Wait until all aysnc io is complete */ while (aio_cancel(fd, NULL) == AIO_NOTCANCELED) {}  /* Application will hang here */ close(fd); </code></pre>  <p>What am I doing wrong? My guess is the OS is waiting for confirmation from the device, but never gets anything. Is there anyway to force close the connection?</p>