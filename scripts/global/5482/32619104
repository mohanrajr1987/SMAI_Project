<p>I am writing a C program with pthread. After I start my threads and execute them, <strong>something changes the value of one of my two pthreads to 0</strong> in the background for a not explainable reason for me. On my machine, this problem already occurs between   </p>  <pre><code>printf( "Created thread %d !\n", id2 ); </code></pre>  <p>and</p>  <pre><code>printf( "id2==%d !\n", id2 ); </code></pre>  <p>Here is the C code:</p>  <pre><code>#include "mutex.h" #include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;pthread.h&gt; #include &lt;unistd.h&gt; pthread_t id1; pthread_t id2; unsigned char mutex = 0;   void* run(  ) {   pthread_t s=pthread_self();   printf( "Thread(%d) starting.\n", s );    mutex_lock( &amp;mutex );   printf( "Working in the critical area for 2s.\n" );   sleep( 2 );   mutex_unlock( &amp;mutex );    s=pthread_self();   printf( "Thread(%d) exiting.\n", s );    pthread_exit( NULL ); }   int main() {   if( pthread_create( &amp;id1, NULL, run, NULL ) )   {     perror( "pthread_create failed!" );     exit( EXIT_FAILURE );   }   printf( "Created thread %d !\n", id1 );   if( pthread_create( &amp;id2, NULL, run, NULL ) )   {     perror( "pthread_create failed!" );     exit( EXIT_FAILURE );   }   printf( "Created thread %d !\n", id2 );    int r=0;   printf( "Ready for joining thread %d !\n", id1 );   printf( "id2==%d !\n", id2 );   if( ( r=pthread_join( id1, NULL ) ) )   {     fprintf( stderr, "%d==pthread_join( id1, ... ) failed!\n", r );     exit( EXIT_FAILURE );   }   printf( "Ready for joining thread %d !\n", id2 );   if( ( r=pthread_join( id2, NULL ) ) )   {     fprintf( stderr, "%d==pthread_join( id2, ... ) failed!\n", r );     exit( EXIT_FAILURE );   }   exit( EXIT_SUCCESS ); } </code></pre>  <p>My functions lock and unlock look like this:</p>  <pre><code>void mutex_lock( unsigned char* m ) {   printf( "mutex_lock()\n" );   while( tsl( m )==1 );   printf( "mutex locked\n" ); }   void mutex_unlock( unsigned char* m ) {   printf( "mutex_unlock()\n" );   *m=0;   printf( "mutex unlocked\n" ); } </code></pre>  <p>Why does my pthread ID suddenly change?</p>