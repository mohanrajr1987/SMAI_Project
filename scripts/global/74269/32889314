<p>I have the following query:</p>  <pre><code>SELECT DISTINCT      T0.DocNum, T0.Status, T1.ItemCode, T2.ItemName,      T1.PlannedQty, T0.PlannedQty AS 'Net Quantity' FROM      OWOR T0   INNER JOIN      WOR1 T1 ON T0.DocEntry = T1.DocEntry INNER JOIN      OITM T2 ON T0.ItemCode = T2.ItemCode WHERE      T0.Status = 'L' AND      T1.ItemCode IN ('BYP/RM/001', 'BYP/RM/002', 'BYP/RM/003', 'BYP/RM/004','BILLET') AND      T2.ItmsGrpCod = 111 AND      (T0.PostDate BETWEEN (SELECT Dateadd(month, Datediff(month, 0, {?EndDate}), 0)) AND {?EndDate}) </code></pre>  <p>that returns data like:</p>  <p><a href="http://i.stack.imgur.com/Mvize.png" rel="nofollow"><img src="http://i.stack.imgur.com/Mvize.png" alt="enter image description here"></a></p>  <p>Explanation:</p>  <p>To make 10 MM steel bars, billets are used as raw materials. Any ItemCode 'BYP%' is part of solid wastage. The net quantity for every DocNum is the amount of 'MM' steel produced by weight. For example, for DocNum 348, the following are used as inputs:</p>  <p><a href="http://i.stack.imgur.com/LdGSa.png" rel="nofollow"><img src="http://i.stack.imgur.com/LdGSa.png" alt="enter image description here"></a></p>  <p>However for that DocNum, 147.359 of 10 MM steel was produced, meaning the missing 3.52 (150.879 - 147.359) is burned loss (not solid).</p>  <p>How do I modify the query such that for each DocNum, the query returns:</p>  <p><a href="http://i.stack.imgur.com/gn2YA.png" rel="nofollow"><img src="http://i.stack.imgur.com/gn2YA.png" alt="enter image description here"></a></p>