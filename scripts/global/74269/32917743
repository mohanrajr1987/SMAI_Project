<p>I am trying to do an upsert into a single table using SQL Server's Merge statement.</p>  <pre><code>declare @Mergeoutput table (action varchar(50))  declare variables ...  MERGE Usertable AS target using (Select .... from Usertable where filter conditions using variables)     as Source (column names..) on source.... = target.... (multiple statements)  WHEN MATCHED THEN   UPDATE SET....  WHEN NOT MATCHED by target THEN   INSERT (...)      VALUES (...) output $action into @Mergeoutput; select * from @Mergeoutput </code></pre>  <p>The update works if there's a match but the insert doesn't happen when there's no match. @Mergeout is empty. My update and insert statements should take action on one row. How does Merge work when the using statement is an empty set and I want to insert a new row?</p>