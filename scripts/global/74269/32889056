<p>I am having a quandary to resolve, with TSql.</p>  <p>Below is an example set of data that is riddled throughout log files.</p>  <p>I am working on a process of converting the "Valid" Contents into columns.  I can get every row, except the sole XML formatted rows, into Columns.  As described in the Problem section, it bugs out if not fully bombing out, when it comes to the rows with just XML Elements in them.</p>  <p>I have been able to isolate out the "invalid" rows out of the parser but then the row the data pertains to is irrelevant with out the subsequent information.</p>  <h2>Problem</h2>  <p>The rows with <code>{DELIM}</code> in the Contents need to have the subsequent rows concatenated with it, to make a single row.  </p>  <p>Example Data:</p>  <pre><code>RowID                FileID               Contents -------------------- -------------------- --------- 3595                 1                    8/30/2015 5:00:01 AM{DELIM}Debug{DELIM}Impersonation result 1: &lt;ImpersonationResultClass xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt; 3596                 1                      &lt;LoggedOn&gt;true&lt;/LoggedOn&gt; 3597                 1                      &lt;ProfileLoaded&gt;false&lt;/ProfileLoaded&gt; 3598                 1                      &lt;UsingLocalLogon&gt;false&lt;/UsingLocalLogon&gt; 3599                 1                      &lt;ImpersonatedAs&gt;NT AUTHORITY\SYSTEM&lt;/ImpersonatedAs&gt; 3600                 1                      &lt;ErrorOccured&gt;false&lt;/ErrorOccured&gt; 3601                 1                      &lt;ErrorString /&gt; 3602                 1                    &lt;/ImpersonationResultClass&gt; 3629                 1                    8/30/2015 5:00:03 AM{DELIM}Debug{DELIM}Impersonation result 1: &lt;ImpersonationResultClass xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt; 3630                 1                      &lt;LoggedOn&gt;true&lt;/LoggedOn&gt; 3631                 1                      &lt;ProfileLoaded&gt;false&lt;/ProfileLoaded&gt; 3632                 1                      &lt;UsingLocalLogon&gt;false&lt;/UsingLocalLogon&gt; 3633                 1                      &lt;ImpersonatedAs&gt;NT AUTHORITY\SYSTEM&lt;/ImpersonatedAs&gt; 3634                 1                      &lt;ErrorOccured&gt;false&lt;/ErrorOccured&gt; 3635                 1                      &lt;ErrorString /&gt; 3636                 1                    &lt;/ImpersonationResultClass&gt; 3653                 1                    8/30/2015 5:00:12 AM{DELIM}Debug{DELIM}Impersonation result 1: &lt;ImpersonationResultClass xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt; 3654                 1                      &lt;LoggedOn&gt;true&lt;/LoggedOn&gt; 3655                 1                      &lt;ProfileLoaded&gt;false&lt;/ProfileLoaded&gt; 3656                 1                      &lt;UsingLocalLogon&gt;false&lt;/UsingLocalLogon&gt; 3657                 1                      &lt;ImpersonatedAs&gt;NT AUTHORITY\SYSTEM&lt;/ImpersonatedAs&gt; 3658                 1                      &lt;ErrorOccured&gt;false&lt;/ErrorOccured&gt; 3659                 1                      &lt;ErrorString /&gt; 3660                 1                    &lt;/ImpersonationResultClass&gt; 5239                 1                    8/30/2015 7:00:01 AM{DELIM}Debug{DELIM}Impersonation result 1: &lt;ImpersonationResultClass xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt; 5240                 1                      &lt;LoggedOn&gt;true&lt;/LoggedOn&gt; 5241                 1                      &lt;ProfileLoaded&gt;false&lt;/ProfileLoaded&gt; 5242                 1                      &lt;UsingLocalLogon&gt;false&lt;/UsingLocalLogon&gt; 5243                 1                      &lt;ImpersonatedAs&gt;NT AUTHORITY\SYSTEM&lt;/ImpersonatedAs&gt; 5244                 1                      &lt;ErrorOccured&gt;false&lt;/ErrorOccured&gt; 5245                 1                      &lt;ErrorString /&gt; 5246                 1                    &lt;/ImpersonationResultClass&gt; </code></pre>  <h2>Question</h2>  <p>Could I get some help to compact the subsequent XML Elements into the single row with a valid DateTime?</p>  <p>For instance:</p>  <pre><code>RowID                FileID               Contents -------------------- -------------------- --------- 3595                 1                    8/30/2015 5:00:01 AM{DELIM}Debug{DELIM}Impersonation result 1: &lt;ImpersonationResultClass xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&lt;LoggedOn&gt;true&lt;/LoggedOn&gt;&lt;ProfileLoaded&gt;false&lt;/ProfileLoaded&gt;&lt;UsingLocalLogon&gt;false&lt;/UsingLocalLogon&gt;&lt;ImpersonatedAs&gt;NT AUTHORITY\SYSTEM&lt;/ImpersonatedAs&gt;&lt;ErrorOccured&gt;false&lt;/ErrorOccured&gt;&lt;ErrorString /&gt;&lt;/ImpersonationResultClass&gt; 3629                 1                    8/30/2015 5:00:03 AM{DELIM}Debug{DELIM}Impersonation result 1: &lt;ImpersonationResultClass xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&lt;LoggedOn&gt;true&lt;/LoggedOn&gt;&lt;ProfileLoaded&gt;false&lt;/ProfileLoaded&gt;&lt;UsingLocalLogon&gt;false&lt;/UsingLocalLogon&gt;&lt;ImpersonatedAs&gt;NT AUTHORITY\SYSTEM&lt;/ImpersonatedAs&gt;&lt;ErrorOccured&gt;false&lt;/ErrorOccured&gt;&lt;ErrorString /&gt;&lt;/ImpersonationResultClass&gt; 3653                 1                    8/30/2015 5:00:12 AM{DELIM}Debug{DELIM}Impersonation result 1: &lt;ImpersonationResultClass xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&lt;LoggedOn&gt;true&lt;/LoggedOn&gt;&lt;ProfileLoaded&gt;false&lt;/ProfileLoaded&gt;&lt;UsingLocalLogon&gt;false&lt;/UsingLocalLogon&gt;&lt;ImpersonatedAs&gt;NT AUTHORITY\SYSTEM&lt;/ImpersonatedAs&gt;&lt;ErrorOccured&gt;false&lt;/ErrorOccured&gt;&lt;ErrorString /&gt;&lt;/ImpersonationResultClass&gt; 5239                 1                    8/30/2015 7:00:01 AM{DELIM}Debug{DELIM}Impersonation result 1: &lt;ImpersonationResultClass xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;&lt;LoggedOn&gt;true&lt;/LoggedOn&gt;&lt;ProfileLoaded&gt;false&lt;/ProfileLoaded&gt;&lt;UsingLocalLogon&gt;false&lt;/UsingLocalLogon&gt;&lt;ImpersonatedAs&gt;NT AUTHORITY\SYSTEM&lt;/ImpersonatedAs&gt;&lt;ErrorOccured&gt;false&lt;/ErrorOccured&gt;&lt;ErrorString /&gt;&lt;/ImpersonationResultClass&gt; </code></pre>