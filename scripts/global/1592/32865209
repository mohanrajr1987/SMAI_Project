<p>I've tried to create Recordset using Excel.Interop and ExcelDNA. I use list function to get Function Wizard dialog. So what i do: 1) I write to ActiveCell.FormulaR1C1 value of that function ("=MyFunction()") 2) And then tries to run Function Wizard</p>  <pre><code>            ...             cell.FormulaR1C1 = formulaStr;             if (!(bool)cell.FunctionWizard()) {             ... </code></pre>  <p>Function dialog starts and works fine(i can set all parameters) but when i press ok AccessViolation error occurs in case if at least one of parameters refers to another sheet.(IF everything is located at one sheet, this method works fine). Function evaluates after pressing ok button and exception occurs on the FunctionWizard() method. Does anyone have something similar?</p>  <p>---------- Update --------------</p>  <p>I made simple DNA Addin, with only 1 button.. and error still reproduces: 1) Function:</p>  <pre><code>            [ExcelFunction("My Test Function")]         public static string MyTestFunction(string param1, string param2) {             return "It works!";         } </code></pre>  <p>2) Ribbon button code:</p>  <pre><code>        public void OnButtonPressed(IRibbonControl control) {         Application exAp = (Application)ExcelDnaUtil.Application;          Range ac = exAp.ActiveCell;         ac.FormulaR1C1 = "=MyTestFunction()";         if ((bool)ac.FunctionWizard()) {             // Do something         }     } </code></pre>  <p>So when i set parameters from another sheet and press ok at function wizard, AccessViolation occurs.</p>