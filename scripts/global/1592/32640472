<p>I am trying to add a TextBox to an external process. The following code works fine with one program, but with the other, the textbox disappears after dragging the table to a new location. Also, I can't give the textbox focus when I click on it. Does anyone have any ideas on how to fix this? I am not against using a different method for adding the textbox to the other window.</p>  <pre><code>TextBox tb = new TextBox(); tb.Width = 150; tb.Height = 20; tb.Background = new SolidColorBrush(Colors.Black); tb.Foreground = new SolidColorBrush(Colors.White); tb.Text = "0"; var parameters = new HwndSourceParameters(); parameters.WindowStyle = 0x10000000 | 0x40000000; parameters.SetPosition(200, 100); parameters.SetSize(150, 20); parameters.ParentWindow = Parent.hwnd;  src = new HwndSource(parameters); src.RootVisual = tb;  private const int DlgcWantChars = 0x0080; private const int DlgcWantTab = 0x0002; private const int DlgcWantAllKeys = 0x0004; private const int DlgcWantArrows = 0x0001; private IntPtr messageHook(IntPtr hwnd, int msg, IntPtr wparam, IntPtr lparam, ref bool handled)     {         switch (msg)         {             case WmGetDlgCode:                 {                     handled = true;                     return (IntPtr)(DlgcWantChars | DlgcWantTab | DlgcWantArrows | DlgcWantAllKeys);                 }          }          return IntPtr.Zero;     } </code></pre>