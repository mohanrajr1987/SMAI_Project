<p>I have multiple tables. All tables have multiple columns that could not logically be stored in one merged table.</p>  <pre><code>class Foo(Model):     foo_id = Column(Integer(unsigned=True), primary_key=True, nullable=False)     foo_data = Column(...)  class Bar(Model):     bar_id = Column(Integer(unsigned=True), primary_key=True, nullable=False)     bar_info = Column(...)  class Baz(Model):     baz_id = Column(Integer(unsigned=True), primary_key=True, nullable=False)     baz_content = Column(...) </code></pre>  <p>Now I want to save changes in a history table:</p>  <pre><code>class Diff(Model):     diff_id = Column(...)     foreign_id = Column(Integer(unsigned=True), index=True, nullable=False)     foreign_table = Column(Char(16, collation='ascii_bin'), index=True, nullable=False)  class SingleDiff(Model):      ...      diff = relationship(Diff, backref=backref('changes', uselist=True, ...)) </code></pre>  <p>Now my problem is: <strong>How can I populate <code>Diff.foreign_id</code> in the same commit when inserting a new <code>Foo</code>, <code>Bar</code>, or <code>Baz</code>?</strong></p>  <p>This works, but if there should be a problem to insert the <code>Diff</code> then it is too late to rollback the changes to <code>foo</code>:</p>  <pre><code>foo = Foo(foo_data='TODO: changes table names') try:     session.add(foo)     session.commit()  # first commit except ...:     .... else:     try:          diff = Diff(changes=[...])          diff.foreign_id = foo.foo_id          diff.foerein_table = 'foo'          session.add(diff)          session.commit()  # second commit      except ...:          raise Exception('Cannot rollback commit #1 anymore :-(') </code></pre>  <p>For normal relationships the id is inserted automagically:</p>  <pre><code>class FooDiff(Model):     diff_id = Column(...)     foo_id = Column(Integer(unsigned=True), ForeignKey(...), ...)     foo = relationship(Foo) </code></pre>  <p>But I don't have <code>Diff.foo</code>, because <code>Diff.foreign_id</code> could point to many different tables.</p>