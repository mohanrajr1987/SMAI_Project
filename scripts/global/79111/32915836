<p>This is my document structure for some kind of articles. I try to move some elements in the nested structured document to a deeper level. For me it is difficult to get the correct update query. So this is what I have so far:</p>  <p><strong>document</strong></p>  <pre><code>{     "title": "Any article",     "sectionName": [         {             "title": "lorem ipsum 1",             "type": "element",             "order": 1         },         {             "title": "lorem ipsum 2",             "type": "element",             "order": 2         },         {             "title": "lorem ipsum 3",             "type": "element",             "order": 3         },         {             "title": "lorem ipsum 4",             "type": "element",             "order": 4         }     ], } </code></pre>  <p>A user can select (in a list) some of the elements. With a button-click a new element will be added and the selected elements are moved to group-array.</p>  <pre><code>&lt;ul data-section="sectionName"&gt;     &lt;li&gt;&lt;input type="checkbox" value="1"&gt; &lt;input type="text" value="lorem ipsum 1"&gt;&lt;/li&gt;     &lt;li&gt;&lt;input type="checkbox" value="2"&gt; &lt;input type="text" value="lorem ipsum 2"&gt;&lt;/li&gt;     &lt;li&gt;&lt;input type="checkbox" value="3"&gt; &lt;input type="text" value="lorem ipsum 3"&gt;&lt;/li&gt;     &lt;li&gt;&lt;input type="checkbox" value="4"&gt; &lt;input type="text" value="lorem ipsum 4"&gt;&lt;/li&gt; &lt;/ul&gt; </code></pre>  <p>The values of the checkboxes are set by spacebars in the template. Now assume the user selected element 2 and 3. These should move to a new group, so that this document results:</p>  <p><strong>what is needed...</strong></p>  <pre><code>{     "title": "Any article",     "sectionName": [         {             "title": "lorem ipsum 1",             "type": "element",             "order": 1         },         {             "title": "lorem ipsum 4",             "type": "element",             "order": 3         },         {             "title": "new group", // &lt;-- new             "type": "group", // &lt;-- new             "order": 2, // &lt;-- order id of first selected element             "groupElements": [ // &lt;-- add new group-array                 {                     "title": "lorem ipsum 2",                     "type": "element",                     "order": 1 // &lt;-- new order                 },                 {                     "title": "lorem ipsum 3",                     "type": "element",                     "order": 4 // &lt;-- new order                 }             ]         },      ], } </code></pre>  <p>That means a new group-element will be added with the orderId of the first selected element and to this new group-element the selected elements are moved.</p>  <p>Now I have some problems with the update procedure:</p>  <pre><code>var inputFields = wrapper.getElementsByTagName('input'); var selectedElements = new Array();  for(var i = 0; i &lt; inputFields.length; i++) {     if (inputFields[i].type == 'checkbox' &amp;&amp; inputFields[i].checked == true) {         if (!firstElementOrderNumber) firstElementOrderNumber = parseInt(inputFields[i].parentNode.parentNode.getAttribute('data-order'));         selectedElements.push(inputFields[i].value);                     } }  </code></pre>  <p>So first I have to push the new element:</p>  <pre><code>var newSectionTitle = "new group"; var selectedElementsObj = // how to create the object from 'selectedElements'? Articles.update({ _id: id, ...query? }, { $push: { title: newSectionTitle, groupElements: selectedElementsObj } };  </code></pre>  <p>And now I have to remove the selected Elements. </p>  <p><strong>My problems</strong></p>  <ol> <li>How do I do the correct query as I want to select the _id of the doc, the <code>sectionName</code> (=data-section) to do the update in this nested array?</li> <li>How do I create the <code>selectedElementObj</code> which I want to insert in the groupElements-array?</li> <li>How do I remove the selected elements?</li> </ol>