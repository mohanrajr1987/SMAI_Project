<p>It looks like my site has been hacked. I have removed all files form the site (on IIS7) and replaced it with a simple asp file:</p>  <pre><code>&lt;%@ Language=VBscript%&gt;  &lt;%  %&gt; &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt; &lt;html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"&gt; &lt;head&gt; &lt;/head&gt;&lt;body&gt; &lt;/body&gt; &lt;/HTML&gt; </code></pre>  <p>If the page is called with the HTTPreferer as 'googlebot' a load of spam links are inserted just before the body close tag. Otherwise the page works fine.</p>  <p>I have the site on shared hosing but have access to IIS7 manager for the site with limited control. I cannot see a URL rewrite function or anything that will allow the page to be altered before the data being sent. There are some functions of the IIS7 system I dont have access to as it is a shared server and I am trying to work with my hosting provider to resove the problem, but they also seem to be drawing a blank.</p>  <p>any ideas? its killing my google rankings!</p>  <p>PS is does affect another of my sites on the same hosing system but not all my sites nor a couple of others I tested.</p>