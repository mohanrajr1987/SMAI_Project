<p>I need to copy a whole lot of e-mails to a folder, but instead of saving them using the subject line I want the file name of the saved e-mail to be that of the attachment in the e-mail. </p>  <p>All I currently have is the code to save the e-mail using the subject line:</p>  <pre><code>Sub Sample()     Dim selectedEmail As MailItem     Dim emailsub As String      Set selectedEmail = ActiveExplorer.Selection.Item(1)      attach = GetValidName(selectedEmail.subject)      'Debug.Print emailsub      With selectedEmail         .SaveAs "C:\direcotry\folder\" &amp; attach &amp; ".msg", OlSaveAsType.olMSG     End With End Sub  Function GetValidName(sSub As String) As String     '~~&gt; File Name cannot have these \ / : * ? " &lt; &gt; |     Dim sTemp As String      sTemp = sSub      sTemp = Replace(sTemp, "\", "")     sTemp = Replace(sTemp, "/", "")     sTemp = Replace(sTemp, ":", "")     sTemp = Replace(sTemp, "*", "")     sTemp = Replace(sTemp, """", "")     sTemp = Replace(sTemp, "&lt;", "")     sTemp = Replace(sTemp, "&gt;", "")     sTemp = Replace(sTemp, "|", "")      GetValidName = sTemp End Function </code></pre>  <p>How can I determine the name of an attachment in the e-mail?</p>