<p>I am looking for some help with Excel VBA to write a simple code. The function of the code needs to be as follows:</p>  <p>I have a worksheet like this:</p>  <pre><code>ID Type Expiration date -- ---- --------------- 1   A   2-10-2015 2   B   3-10-2015 3   C   4-10-2015 </code></pre>  <p>Now a macro needs to make sure that he must automatically (reminder) create tasks in my agenda outlook for the table above. So for example i need to see in Outlook at 2-10-2015 that ID 1, type a proceeds so i can now when i need to extend it again. </p>  <p>I used to following code, but dont seems to work for me:</p>  <pre><code>Sub CreateAppointments()  Dim cell As Excel.Range Dim rng As Excel.Range Dim wholeColumn As Excel.Range Dim startingCell As Excel.Range Dim oApp As Outlook.Application Dim tsk As Outlook.TaskItem Dim wkbk As Excel.Workbook Dim wksht As Excel.Worksheet Dim lastRow As Long Dim arrData As Variant Dim i As Long  ' start Outlook Set oApp = GetOutlookApp If oApp Is Nothing Then   MsgBox "Could not start Outlook.", vbInformation   Exit Sub End If  ' read worksheet range into an array in one go Set wkbk = ActiveWorkbook Set wksht = wkbk.ActiveSheet Set wholeColumn = wksht.Range("A:A") lastRow = wholeColumn.End(xlDown).Row - 2 Set startingCell = wksht.Range("A2") Set rng = wksht.Range(startingCell, startingCell.offset(lastRow, 1)) arrData = Application.Transpose(rng.value)  ' loop through array and create tasks for each record For i = LBound(arrData, 2) To UBound(arrData, 2)   Set tsk = oApp.CreateItem(olTaskItem)   With tsk     .DueDate = arrData(2, i)     .subject = arrData(1, i)     .ReminderSet = True     Select Case Weekday(CDate(arrData(2, i)) - 4, vbSaturday)       Case 1, 6, 7         .ReminderTime = CDate(arrData(2, i)) - 5       Case 2, 3         .ReminderTime = CDate(arrData(2, i)) - 3       Case Else         .ReminderTime = CDate(arrData(2, i)) - 4     End Select     .Save   End With Next i  End Sub  Function GetOutlookApp() As Outlook.Application ' return Outlook.Application object On Error Resume Next Set GetOutlookApp = CreateObject("Outlook.Application") End Function </code></pre>