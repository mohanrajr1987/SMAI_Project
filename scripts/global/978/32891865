<p>I am using Outlook 2010 and I am trying to forward emails to specific users based on the attachment name. The code below works, except that I have to create a rule in Outlook for each different attachment name (I eventually run out of storage for my rules, even after increasing the rules size to 256kb in exchange console).</p>  <p>I would like this script to run under one rule. It would need to be something like.... if the attachment name is "xxxxx.pdf" then send to "name@domain.com" if not then skip, if the attachment name is "xx.xls" then send to "name1@domain.com" if not then skip....and so on...</p>  <p>Below is what I have so far, I would like it all combined.</p>  <p>Code pasted in Outlook session:</p>  <pre><code>Sub SendOnMessage23(olItem As MailItem) Dim olAtt As Attachment, yest As Boolean, ol_newmail As MailItem For Each olAtt In olItem.Attachments     If InStr(1, olAtt.FileName, "Print_Ack_Rpt.rpt_1100023-1") &gt; 0 Then yest = True: Exit For NextIf yest = True Then     Set ol_newmail = olItem.Forward         ol_newmail.To = "user@domain.com"         ol_newmail.Send End If End Sub  Sub SendOnMessage23(olItem As MailItem) Dim olAtt As Attachment, yest As Boolean, ol_newmail As MailItem For Each olAtt In olItem.Attachments     If InStr(1, olAtt.FileName, "Print_Ack_Rpt.rpt_1100024-1") &gt; 0 Then yest = True: Exit For NextIf yest = True Then     Set ol_newmail = olItem.Forward         ol_newmail.To = "user1@domain.com"         ol_newmail.Send End If End Sub  Sub SendOnMessage23(olItem As MailItem) Dim olAtt As Attachment, yest As Boolean, ol_newmail As MailItem For Each olAtt In olItem.Attachments     If InStr(1, olAtt.FileName, "Print_Ack_Rpt.rpt_1100024-1") &gt; 0 Then yest = True: Exit For NextIf yest = True Then     Set ol_newmail = olItem.Forward         ol_newmail.To = "user2@domain.com"         ol_newmail.Send End If End Sub  Sub SendOnMessage23(olItem As MailItem) Dim olAtt As Attachment, yest As Boolean, ol_newmail As MailItem For Each olAtt In olItem.Attachments     If InStr(1, olAtt.FileName, "Print_Ack_Rpt.rpt_1100024-1") &gt; 0 Then yest = True: Exit For NextIf yest = True Then     Set ol_newmail = olItem.Forward         ol_newmail.To = "user3@domain.com"         ol_newmail.Send End If End Sub </code></pre>