<p>I need to use a join within a <code>count</code> subquery.</p>  <p>Here is my code, so you can see what I'm trying to do:</p>  <pre><code>select verticals.name,         (select count(*) from `leads` where `id_vertical` = verticals.id) as `unique_leads`,         (select count(*) from `lead_history` where `id_vertical` = verticals.id) as `all_leads`,         (select count(a.*)              from `assignments` as a             left join `leads` as l on (l.id = a.id_lead)             where l.id_vertical = verticals.id) as `assigned`         from verticals </code></pre>  <p>I'm getting a syntax error because I'm guessing my query is totally incorrect. What is the correct way of writing this?</p>