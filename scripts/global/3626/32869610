<p>I create two temporary tables and join them together using the following codes but encounter <code>ERROR 1064 near 'LEFT JOIN'</code>.</p>  <pre class="lang-sql prettyprint-override"><code>(SELECT DISTINCT routes.route_short_name, MIN(stop_times.stop_sequence) AS first_stop, stops.stop_name AS first_stop_name FROM trips JOIN routes ON ... JOIN stop_times ON ... JOIN stops ON ... JOIN calendar ON ... GROUP BY stop_times.trip_id) first_table LEFT JOIN (SELECT DISTINCT routes.route_short_name, MAX(stop_times.stop_sequence) AS last_stop, stops.stop_name AS last_stop_name FROM trips JOIN routes ON ... JOIN stop_times ON ... JOIN stops ON ... JOIN calendar ON ... GROUP BY stop_times.trip_id) last_table ON first_table.route_short_name = last_table.route_short_name; </code></pre>  <p>The desired results are something like:</p>  <pre><code>route_short_name, first_stop_name, last_stop_name ... </code></pre>