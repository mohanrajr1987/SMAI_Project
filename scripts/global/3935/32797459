<p>I have an action which I should protect it from CSRF attack. I have used Strut's tokenSession Interceptor to achieve this.</p>  <pre class="lang-xml prettyprint-override"><code>&lt;action name="showBranchSelection" class="action.Request.BranchSelectionAction"         method="showBranchSelection"&gt;     &lt;interceptor-ref name="tokenSession" /&gt;     &lt;interceptor-ref name="basicStack" /&gt;     &lt;result name="success"&gt;         /jsp/customer/request/branchSelection.jsp     &lt;/result&gt; &lt;/action&gt; </code></pre>  <p>and works great where this action has been called directly from jsp.</p>  <pre class="lang-xml prettyprint-override"><code>&lt;s:form id="frmRequestShowBranchSelection" action="../../showBranchSelection" method="post" theme="simple" onsubmit="return false;"&gt;  &lt;s:token name="tknRequestShowBranchSelection" /&gt;  &lt;s:submit /&gt; &lt;/s:form&gt; </code></pre>  <p>But I also have other actions (protected and not protected) which will be chained to this action in some situations.</p>  <pre class="lang-xml prettyprint-override"><code>&lt;!-- not protected action chains to protected one --&gt; &lt;action name="entranceCustomerLoginAction" class="action.Request.CustomerLoginAction"             method="entrance"&gt;     &lt;result name="success"&gt;/jsp/login/success.jsp&lt;/result&gt;     &lt;result name="showBranchSelection" type="chain"&gt; showBranchSelection     &lt;/result&gt; &lt;/action&gt;  &lt;!-- protected action chains to another protected one --&gt; &lt;action name="continueReimTable" class="action.Request.ReimburseTableControllerAction"             method="continueReimTable"&gt;     &lt;interceptor-ref name="tokenSession" /&gt;     &lt;interceptor-ref name="basicStack" /&gt;     &lt;result name="showBranchSelection" type="chain"&gt;         showBranchSelection     &lt;/result&gt;     &lt;result name="success" type="chain"&gt;         showBranchPage     &lt;/result&gt; &lt;/action&gt; </code></pre>  <p>What's the proper way to use token in such chains?! i.e. in both, when a not protected action chains to a protected action and when a protected action chains to another protected action.</p>