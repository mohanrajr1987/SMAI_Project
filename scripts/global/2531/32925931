<p>I have an airline delays data set with columns for carrier, origin airport, destination airport, dep delay, arr delay. How do I write a function that calculates and returns the average arrival delay for a carrier flying into the specified destination airport? This is what I have and it's not working. </p>  <pre><code>avgDelay &lt;- function(Carrier,Dest) {     x &lt;- 0     for (i in 1:dim(delays)[1])     {         for(j in 1:dim(delays)[1])         {             if(delays[i,3] == Carrier &amp;&amp; delays[j,5] == Dest)             {                 total &lt;- x+(sum(delays[i,7] &gt; 0, na.rm = TRUE))                 avg &lt;- mean(total)             }         }     }     return(avg) } </code></pre>