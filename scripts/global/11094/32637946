<p>I am building a console application which calls 3 different web services. The first one call all the project with their projectsIds, projects status and project names.</p>  <p>The first web service get all projectsIDs <code>GetProjectData()</code> and the call is correct. I am putting the result into a csv file.</p>  <p>The second call, <code>GetProjectDetails()</code> and it provide me a <code>dataset</code> of all the projects (with many values into the dataset).</p>  <p>This call contain the projectType (Open or close) where I need to put it next to the GetProjectData() call.</p>  <p>This is the schema from GetProjectDetails dataset call:</p>  <pre><code>&lt;?xml version="1.0" encoding="utf-16"?&gt; &lt;xs:schema id="NewDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"&gt;   &lt;xs:element name="NewDataSet" msdata:IsDataSet="true" msdata:UseCurrentLocale="true"&gt;     &lt;xs:complexType&gt;       &lt;xs:choice minOccurs="0" maxOccurs="unbounded"&gt;         &lt;xs:element name="Table"&gt;           &lt;xs:complexType&gt;             &lt;xs:sequence&gt;               &lt;xs:element name="ProjectID" type="xs:string" minOccurs="0" /&gt;               &lt;xs:element name="Title" type="xs:string" minOccurs="0" /&gt;               &lt;xs:element name="ProjectType" type="xs:string" minOccurs="0" /&gt;             &lt;/xs:sequence&gt;           &lt;/xs:complexType&gt;         &lt;/xs:element&gt;       &lt;/xs:choice&gt;     &lt;/xs:complexType&gt;   &lt;/xs:element&gt; &lt;/xs:schema&gt; </code></pre>  <p>I need to obtain the ProjectType and assign it to my project which is going to show either is open or close.</p>  <p>I have created a method which parse the xml output:</p>  <pre><code>public static string parseXML(System.Data.DataSet ds) {     string txt = "";     XmlDocument xml = new XmlDocument();     xml.LoadXml(ds.GetXml());     XmlNodeList elements = xml.SelectNodes("/NewDataSet/Table");     foreach (XmlNode elem in elements)     {         txt += elem["ProjectType"].InnerText;         txt += "\n";     }     return txt;  } </code></pre>  <p>I have another web service call but I am correct with that one because I am having the expected output.</p>  <p>The problem is that I need to extract the projecType into the final result and depending to each project type either is open or close.</p>  <p>Here you have my code.</p>  <pre><code>string path = @"c:\testList"; try {                 string List = "listOfProjects"; string outCsvFile = string.Format(@"C:\\testList\\{0}.csv", List + DateTime.Now.ToString("_yyyyMMdd HHmms"));  //This is the call to get all the projects WS.ProjectData[] pr = db.GetAllProjectData();   using (StreamWriter file = new StreamWriter(fs)) { file.WriteLine("ProjectID, ProjectTitle,PublishStatus,Type,ProjectStartDate,ProjectEndDate");      foreach(WS.ProjectMetaData proj in pr.Distinct(new ProjectEqualityComparer()))     {         string language = "";         var userIDs = db.GetList(proj.ProjectID);         var projectInfo = parseXML(db.GetProjectDetails(language)); //GetProjectDetails require a string into the method          file.WriteLine("{0},\"{1}\",{2},{3},{4},{5}",                proj.ProjectID,         proj.ProjectTitle,         proj.PublishStatus,         userIDs.Length.ToString(NumberFormatInfo.InvariantInfo),         proj.ProjectStartDate.ToString(DateTimeFormatInfo.InvariantInfo),         proj.ProjectEndDate.ToString(DateTimeFormatInfo.InvariantInfo),     } } </code></pre>  <p>Can you please help me to output the ProjectType into the final result? I guess I need to somehow do something with the projectInfo and reference it with the projectIDs so it can know if its the type open or close.</p>  <p>Thanks</p>  <p>Output expected:</p>  <pre><code>ProjectID, ProjectTitle, PublishStatus,Type,ProjectStartDate,ProjectEndDate  7bd001b2-991e, "test project", published, open, 01-01-2010, 01-01-2015  4ed00772-541e, "test project 2", expired, Close, 01-01-2010, 01-01-2015 </code></pre>  <p>What is inside <code>WS.ProjectData[] pr = db.GetAllProjectData();</code> is the follows:</p>  <pre><code>ProjectID, ProjectTitle PublishStatus ProjectStartDate ProjectEndDate </code></pre>  <p>These are the values that can be exported from <code>GetAllProjectData()</code></p>  <p>The data set also contain ProjectID, so if there's a way to relate the projectId so when its see the same projectID it distribute the ProjectType</p>  <p>I have also noticed, if inside from the parseXML method I pass ProjectID, the first ProjectID from the data set gets into the output on each row (same ProjectID all the time) Thanks again </p>