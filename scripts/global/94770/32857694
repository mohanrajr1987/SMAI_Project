<p>Working on my first angular app, and writing my first protractor test to check login functionality. Authentication is using ng-token-auth and I'm also using ui-router. I suspect the issue is that the test is not properly catching the redirect but I've tried various workarounds and cannot get anything to work. </p>  <p>Here's the basic routing and redirection code:</p>  <pre><code>angular   .module('testAngularApp', [     'ngAnimate',     'ngCookies',     'ngResource',     'ui.router',     'ngSanitize',     'ng-token-auth'   ])   .config(function ($stateProvider, $urlRouterProvider, $authProvider, $locationProvider) {     $locationProvider.html5Mode(true).hashPrefix('!');     $urlRouterProvider.otherwise('/');      $authProvider.configure({       apiUrl: 'http://backend.dev'     });      $stateProvider       .state('index', {         url: "/",         templateUrl: 'views/main.html',         controller: 'MainCtrl',         controllerAs: 'main'       })       .state('app', {         url: '/app',         abstract: true,         template: '&lt;ui-view/&gt;',         resolve: {           auth: function($auth, $state) {             return $auth.validateUser().catch(function() {               $state.go('index');             });           }         }       })       .state('app.dashboard', {         url: '/dashboard',         templateUrl: 'views/dashboard.html',         controller: 'DashboardCtrl',         controllerAs: 'dashboard'       });   })   .run(function($rootScope, $location, $state) {     $rootScope.$on('auth:login-success', function() {       $state.go('app.dashboard');     });   }); </code></pre>  <p>So on rendering the main page, you fill in login details, click the button, and use $state.go to head to the app dashboard. My protractor test is as follows:</p>  <pre><code>describe('Budget', function() {   describe('Authentication', function() {     beforeEach(function() {       browser.get('http://localhost:9000');     });      it('should log in and redirect to the dashboard', function(done) {       element(by.model('loginForm.email')).sendKeys('someone@somewhere.com');       element(by.model('loginForm.password')).sendKeys('password');       element(by.id('login-button')).click();        expect($('h3.title').getText()).toEqual('Welcome');     });   }); }); </code></pre>  <p>Fairly straightforward. The error I get is:</p>  <pre><code>     Timed out waiting for Protractor to synchronize with the page after 11 seconds. Please see https://github.com/angular/protractor/blob/master/docs/faq.md. The following tasks were pending: - $timeout: function () {                     return _this.validateUser({                       config: _this.getSavedConfig()                     });                   } </code></pre>  <p>Notably as this test fails, it works just fine. In the chrome window that pops up, logging in works, the browser redirects and I see the Welcome text. </p>  <p>Things I've tried...</p>  <ul> <li>browser.ignoreSynchronization = true; in the test</li> <li>browser.wait(...for element...) in the test</li> <li>$location.path instead of $state.go</li> <li>adding browser.waitForAngular() to the test</li> <li>probably random other stack overflow suggestions I've found and forgotten</li> </ul>  <p>Any ideas?</p>