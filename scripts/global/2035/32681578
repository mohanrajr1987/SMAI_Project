<p>I am looking for a way to prevent usbcore to register a new interface usbhid or other after a "request" probe .</p>  <p><strong>C function Linux Kernel Module (mUSBdriver.c)</strong></p>  <pre><code>... static int mUSBdriver_probe(struct usb_interface *interface, const struct usb_device_id *id){        printk(KERN_INFO "mUSBdriver: new USB device PLUGGED!");        return 0; // indicate we will manage this device        //return -ENODEV;  indicate we will NOT manage this device     } ... </code></pre>  <p><strong>here are my steps compilation and insertion</strong></p>  <pre><code>rmmod usbhid  rmmod mUSBdriver  make  insmod mUSBdriver.ko </code></pre>  <p><strong>When i Hot-Plug my device</strong></p>  <pre><code>~# tail -n 50 /var/log/syslog ... ...kernel: usbcore: registered new interface driver mUSBdriver ...kernel: usb 2-1: Product HID Keyboard ... ...kernel: mUSBdriver:new USB device PLUGGED! ... </code></pre>  <p><strong>My device is an HID keyboard class, then</strong></p>  <pre><code>~# tail -n 50 /var/log/syslog ... ...kernel: usbcore: registered new interface driver mUSBdriver ...kernel: usb 2-1: Product HID Keyboard ... ...kernel: mUSBdriver:new USB device PLUGGED! ...kernel: usbcore: registered new interface driver usbhid ...kernel: usbhid: USB HID core driver ... </code></pre>  <p>Then nothing appears since I decided to manage (return 0) this device. I am looking for a solution to prevent usbcore registered another interface after my driver receive a probe. I want to consider this device as "BAD USB" and cancel all other operations. I search in usb.h but nothing .</p>  <p>Any idea how do I take ?</p>  <pre><code>my idea:  - send a notification to usbcore ? - hook on usbcore  ?  (but I do not know how to do it) </code></pre>