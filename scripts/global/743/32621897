<pre><code>Imports System Imports System.Threading Imports System.ComponentModel Imports System.IO.Ports  Public Class SMSCOMMS     Private WithEvents SMSPort As SerialPort      Private SMSThread As Thread     Private ReadThread As Thread     Shared _Continue As Boolean = False     Shared _ContSMS As Boolean = False     Private _Wait As Boolean = False     Shared _ReadPort As Boolean = False     Public Event Sending(ByVal Done As Boolean)     Public Event DataReceived(ByVal Message As String)      Public Sub New(ByRef COMMPORT As String)         SMSPort = New SerialPort         With SMSPort             .PortName = COMMPORT             .BaudRate = 115200             .Parity = Parity.None             .DataBits = 8             .StopBits = StopBits.One             .Handshake = Handshake.RequestToSend             .DtrEnable = True             .RtsEnable = True             .NewLine = vbCrLf         End With         'ReadThread = New Thread(AddressOf ReadPort)     End Sub      Public Sub SendSMS(ByVal CellNumber As String, ByVal SMSMessage As String)         Dim MyMessage As String = Nothing         If SMSMessage.Length &lt;= 160 Then             MyMessage = SMSMessage         Else             MyMessage = Mid(SMSMessage, 1, 160)         End If         If IsOpen = True Then             SMSPort.WriteLine("AT+CMGS=" &amp; CellNumber &amp; vbCr)             _ContSMS = False             Thread.SpinWait(200)             SMSPort.WriteLine(MyMessage &amp; vbCrLf &amp; Chr(26))             _Continue = False             Thread.SpinWait(200)             RaiseEvent Sending(False)         End If     End Sub      Private Sub ReadPort()         Dim SerialIn As String = Nothing         Dim RXBuffer(SMSPort.ReadBufferSize) As Byte         Dim SMSMessage As String = Nothing         Dim Strpos As Integer = 0         Dim TmpStr As String = Nothing          While SMSPort.IsOpen = True             If (SMSPort.BytesToRead &lt;&gt; 0) And (                 SMSPort.IsOpen = True) Then                 While SMSPort.BytesToRead &lt;&gt; 0                     SMSPort.Read(RXBuffer, 0, SMSPort.ReadBufferSize)                     SerialIn =                         SerialIn &amp; System.Text.Encoding.ASCII.GetString(                         RXBuffer)                     If SerialIn.Contains("&gt;") = True Then                         _ContSMS = True                     End If                     If SerialIn.Contains("+CMGS:") = True Then                         _Continue = True                         RaiseEvent Sending(True)                         _Wait = False                         SerialIn = String.Empty                         ReDim RXBuffer(SMSPort.ReadBufferSize)                     End If                 End While                 RaiseEvent DataReceived(SerialIn)                 SerialIn = String.Empty                 ReDim RXBuffer(SMSPort.ReadBufferSize)             End If         End While     End Sub      Public ReadOnly Property IsOpen() As Boolean         Get             If SMSPort.IsOpen = True Then                 IsOpen = True             Else                 IsOpen = False             End If         End Get     End Property      Public Sub Open()         If IsOpen = False Then             SMSPort.Open()             'ReadThread.Start()         End If     End Sub      Public Sub Close()         If IsOpen = True Then             SMSPort.Close()         End If     End Sub End Class </code></pre>  <p>i tried sending  sms using gsm modem in vb.net using this code. This is working fine but when i tried sending sms to multiple recipient the first recipient only receives the sms while the others no reponse.</p>  <p>This is the code for the sending sms: </p>  <pre><code> Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click         Dim sms As SMSCOMMS         sms = New SMSCOMMS("COM25")         sms.Open()         sms.SendSMS("+63*******", "123")         Threading.Thread.SpinWait(200)         sms.SendSMS("+63*******", "456")         sms.Close()     End Sub </code></pre>