<p>I am trying to setup a dev environment using ansible and vagrant. Now i am stuck at cloning a git repo from bitbucket.</p>  <p>Below are Vagrantfile and ansible settings and things i have tried.  </p>  <p>In my Vagrantfile i have <code>config.ssh.forward_agent = true</code></p>  <p>In my deploy.yml i have </p>  <pre><code>- name: ensure bitbucket is a known host   lineinfile:     dest: /home/vagrant/.ssh/known_hosts     create: yes     state: present     line: "{{ lookup('pipe', 'ssh-keyscan -p 443 -t rsa altssh.bitbucket.org') }}"     regexp: "^altssh\\.bitbucket\\.org"   sudo_user: "vagrant"   tags: known_hosts  - name: checkout opentest repo   git: &gt;     dest="/home/vagrant/ot/"     repo="ssh://git@altssh.bitbucket.org:443/muhammadammar/opentest/"     version="master"     accept_hostkey=yes   sudo_user: "vagrant"   tags: checkout </code></pre>  <p>First task above add bitbucket's public key into <code>/home/vagrant/.ssh/known_hosts</code>.</p>  <p>Below is the output when ansible try to checkout the repo</p>  <pre><code>&lt;127.0.0.1&gt; ESTABLISH CONNECTION FOR USER: vagrant &lt;127.0.0.1&gt; REMOTE_MODULE git dest="/home/vagrant/ot/" repo="ssh:********@altssh.bitbucket.org:443/muhammadammar/opentest/" version=master accept_hostkey=yes &lt;127.0.0.1&gt; EXEC ssh -C -vvv -o ForwardAgent=yes -o ControlMaster=auto -o ControlPersist=60s -o ControlPath="/Users/ammar/.ansible/cp/%h-%r" -o StrictHostKeyChecking=no -o Port=2222 -o IdentityFile="/Users/ammar/.vagrant.d/insecure_private_key" -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o User=vagrant -o ConnectTimeout=10 127.0.0.1 /bin/sh -c 'sudo -k &amp;&amp; sudo -HE -S -p "[sudo via ansible, key=vwkfotuvzzmllxvxptkgehjzdlqygoez] password: " -u vagrant /bin/sh -c '"'"'echo BECOME-SUCCESS-vwkfotuvzzmllxvxptkgehjzdlqygoez; LANG=C LC_CTYPE=C /usr/bin/python'"'"'' failed: [default] =&gt; {"cmd": "/usr/bin/git ls-remote 'ssh:********@altssh.bitbucket.org:443/muhammadammar/opentest/' -h refs/heads/master", "failed": true, "rc": 128} stderr: RSA host key for IP address '131.103.20.174' not in list of known hosts. Permission denied (publickey). fatal: Could not read from remote repository.  Please make sure you have the correct access rights and the repository exists.  msg: RSA host key for IP address '131.103.20.174' not in list of known hosts. Permission denied (publickey). fatal: Could not read from remote repository.  Please make sure you have the correct access rights and the repository exists.  FATAL: all hosts have already failed -- aborting             to retry, use: --limit @/Users/ammar/dev.retry  default                    : ok=1    changed=0    unreachable=0    failed=1     Ansible failed to complete successfully. Any error output should be visible above. Please fix these errors and try again. </code></pre>  <p>On my host i have added my private key to ssh authentication agent. I can see private key identities using <code>ssh-add -l</code> on both host and on vagrant box.</p>  <p>In vagrant box i can successfully clone the repo using <code>git clone ssh://git@altssh.bitbucket.org:443/muhammadammar/opentest ot</code></p>  <p>I am not sure what is the issue. Can anyone help to resolve this issue.</p>  <p><strong>EDIT</strong></p>  <p>Even the below is not working in ansible</p>  <pre><code>shell: "git clone ssh://git@altssh.bitbucket.org:443/muhammadammar/opentest/ /home/vagrant/omp/" </code></pre>