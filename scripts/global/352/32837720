<p>I Hava a class called VarianteValore this class have a collection of Foto, the primary key of VarianteValore is a multiple compositeId.<br> Now when Map my class NHibernate return me the exception above. i'm struggle with the mapping solution by day, but i haven't found a solution yet.</p>  <p>below my Class and Mapping</p>  <pre><code> public class VarianteValore : EntityBase {     #region Private         private ICollection&lt;Foto&gt; _immagini;     #endregion      public virtual VarianteProdotti VarianteProdotti { get; set; }     public virtual GruppoAttributi GruppoAttributi { get; set; }     public virtual AttributiValore AttributiValore { get; set; }       public virtual ICollection&lt;Foto&gt; Foto     {         get { return _immagini != null ? _immagini : new List&lt;Foto&gt;(); ; }         set { _immagini = value; }     }      public virtual double OffSetPrezzo { get; set; }      public override bool Equals(object obj)     {         if (obj == null)             return false;         VarianteValore id;         id = (VarianteValore)obj;         if (id == null)             return false;         if (this.Id == id.Id &amp;&amp; this.VarianteProdotti.Prodotti == id.VarianteProdotti.Prodotti &amp;&amp; this.GruppoAttributi.Attributi == id.GruppoAttributi.Attributi)             return true;         return false;     }      public override int GetHashCode()     {         return (this.Id + "|" + this.VarianteProdotti.Prodotti + "|" + this.GruppoAttributi.Attributi).GetHashCode();     }  }    public class Foto : EntityBase {     public virtual VarianteProdotti VarianteProdotti { get; set; }     public virtual GruppoAttributi GruppoAttributi { get; set; }     public virtual Prodotti Prodotti { get; set; }     public virtual string Path { get; set; }     public virtual bool Pubblicata { get; set; }      public virtual bool IsVideo { get; set; }     public virtual int Position { get; set; }      public virtual string Alt { get; set; }      public override bool Equals(object obj)     {         if (obj == null)             return false;         Foto id;         id = (Foto)obj;         if (id == null)             return false;         if (this.Id == id.Id &amp;&amp; this.VarianteProdotti == id.VarianteProdotti)             return true;         return false;     }      public override int GetHashCode()     {         return (this.Id + "|" + this.VarianteProdotti).GetHashCode();     } }   public class VarianteValoreMap : ClassMap&lt;VarianteValore&gt; {     public VarianteValoreMap()     {         CompositeId()            .KeyReference(x =&gt; x.VarianteProdotti, "Prodotti_Id", "VarianteProdotti_Id")           .KeyReference(x =&gt; x.GruppoAttributi, "Prodotti_Id", "Attributi_Id");          //FK AttributiValore          References(x =&gt; x.AttributiValore, "AttributiValore_Id");          HasMany(x =&gt; x.Foto).KeyColumns.Add("Prodotti_Id", "VarianteProdotti_Id", "Attributi_Id");      } }  public class FotoMap : ClassMap&lt;Foto&gt; {     public FotoMap()     {         Id(x =&gt; x.Id).GeneratedBy.Identity();         References(x =&gt; x.VarianteProdotti).Columns("Prodotti_Id", "VarianteProdotti_Id", "Attributi_Id");         Map(x =&gt; x.Path).Length(400);         Map(x =&gt; x.Pubblicata);         Map(x =&gt; x.IsVideo);         Map(x =&gt; x.Position);     } } </code></pre>  <p>I hope the code below can ilustrate better. Thanks in advance for any help</p>