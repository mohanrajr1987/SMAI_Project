<p>I'm writing a server in Erlang and want to open a large number of connections. The problem is that I receive <strong>{error, eaddrnotavail}</strong> after 16358 <code>gen_tcp:connect/3</code> calls. As you can see below, the server is pretty simple.</p>  <p>I modified my MacOS Yosemite limit; <code>ulimit -n</code> output is 6553600.</p>  <p>I start with:</p>  <pre><code>erl +Q 134217727 +P 1000000 -env ERL_MAX_PORTS 40960000 -env ERTS_MAX_PORTS 40960000 </code></pre>  <p>The server:</p>  <pre><code>-module(naive_server). -author("Stefan Stan").  -compile(export_all).  start_server(Port) -&gt;      Pid = spawn_link(fun() -&gt;     {ok, Listen} = gen_tcp:listen(Port, [binary, {backlog, 6553600}]),     spawn(fun() -&gt; acceptor(Listen, 0) end),     timer:sleep(infinity)   end),   {ok, Pid}.  acceptor(ListenSocket, Nr) -&gt;    {ok, Socket} = gen_tcp:accept(ListenSocket),   io:format("Client nr ~p connected~n", [Nr]),   spawn(fun() -&gt; acceptor(ListenSocket,Nr+1) end),   handle(Socket).  handle(Socket) -&gt;   receive     {tcp, Socket, &lt;&lt;"quit", _/binary&gt;&gt;} -&gt;       gen_tcp:close(Socket);     {tcp, Socket, Msg} -&gt;       gen_tcp:send(Socket, Msg),       handle(Socket)   end. </code></pre>  <p>The client:</p>  <pre><code>-module(naive_client). -author("Stefan Stan").  %% API -export([connect_clients/3, connect/1]).  connect(Port) -&gt;   gen_tcp:connect({127,0,0,1}, Port, []).  connect_clients(Number, Port, List) when is_number(Number), Number &gt;= 0, is_number(Port), Port&gt;0 -&gt;   F =     fun() -&gt;       case Number of         0 -&gt; {ok, lists:reverse(List)};         _ -&gt;           {ok, Pid} = connect(Port),           NewList = [Pid|List],           connect_clients(Number-1, Port, NewList)       end     end,   spawn(F). </code></pre>