<p>I am trying to write a sub query that counts up the number of 'TRACE_NO' and if there is only one instance I want it to display the original string. However, if it has more than one 'TRACE_NO' instance I want the row to display 'Duplicate'. What am I doing wrong? </p>  <pre><code>SELECT      SL.FILE_NO AS FILE,     (SELECT CASE(WHEN TR.TRACE_NO HAVING COUNT(*) &gt;1 THEN 'DUPLICATE' ELSE TR.TRACE_NO)       FROM IASDB.TRACE_DETAIL TR       WHERE SL.INVOICE_NO = TR.INVOICE_NO        AND TR.TRACE_TYPE IN 'XX') AS XX </code></pre>  <p>TABLE</p>  <pre><code>FILE   XX  1120 | SEA 1315 | SDF 1251 | SEA 1251 | GEG 1991 | ATL 1235 | BOI 1235 | CVG </code></pre>  <p>Desired Output:</p>  <pre><code>FILE | XX 1120 | SEA 1315 | SDF 1251 | DUPLICATE 1991 | ATL 1235 | DUPLICATE </code></pre>