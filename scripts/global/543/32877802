<p>I would like to seek some help regarding the query below.</p>  <p>Running this Script causes the system to timeout. The query is so slow it took 5 minutes to run for just 22 records. I believe this has something to do with "NOT IN" statement. I already look for answers here in Stackoverflow regarding this and some are suggesting using LEFT OUTER JOIN and WHERE NOT EXIST but I can't seem to incorporate it in this query.</p>  <pre><code>   SELECT a.UserId, COUNT(DISTINCT(a.CustomerId)) AS TotalUniqueContact FROM [UserActivityLog] a WITH(NOLOCK) WHERE CAST(a.ActivityDatetime AS DATE) BETWEEN '2015-09-28' AND '2015-09-30' AND a.ID  NOT IN (     SELECT DISTINCT(COALESCE(a.activitylogid, 0))     FROM [CustomerNoteInteractions] a WITH(NOLOCK)     WHERE a.reason IN ('20', '36') AND CAST(a.datecreated AS DATE) BETWEEN '2015-09-28' AND '2015-09-30' AND a.UserId IN (SELECT b.Id     FROM [User] b     WHERE b.UserType = 'EpicUser' AND b.IsEpicEmployee = 1 AND b.IsActive = 1) ) AND a.UserId IN ( SELECT b.Id FROM [User] b WHERE b.UserType = 'EpicUser' AND b.IsEpicEmployee = 1 AND b.IsActive = 1) GROUP BY a.UserId </code></pre>