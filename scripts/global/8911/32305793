<p>I've got a form that I've been trying to rework. Essentially it was just interacting with a REST API provided by a third party to integrate with their software. On a separate form, I am able to create a csv file with data for import in to a server. I have been trying to re-work them so that on submit they both function but I am only able to get on or the other.</p>  <p>Here is my createCSV function</p>  <pre><code>function createCSV(){ global $strnmbr, $Content, $hostname;     $ext = " - 'SOMETHING'.csv";     $FileName = "s" . $hostname . $ext;     header('Content-Type: application/csv');      header('Content-Disposition: attachment; filename="' . $FileName . '"');     echo $Content;    exit();    } </code></pre>  <p>Then follows</p>  <pre><code>if(isset($_POST['submit'])){  if($_SESSION['Hostname']==""){$hostname = sprintf("%'.05d", $_SESSION['Store Number']);} else{$hostname = $_SESSION['Hostname'];}  $hostname1 = "'info here'" . ".s" . $hostname . ".'info here'"; $resolve = "FALSE"; $IP = "0.0.0.0"; $mac= strtolower($_POST['mpMAC']); $proxy = ""; $outproxy = ""; $opstate = "OPSTATE"; $audiodevserial1 = $_POST['assetSN']; $type = "TYPE"; $brand = "BRAND"; $series = "SERIES"; $model = "MODEL"; $modvers = ""; $login = ""; $password = ""; $continent = "North America"; $country = "United States"; $stateabr = $_SESSION['State']; $city = $_SESSION['City']; $StAddress = $_SESSION['Street']; $zip = $_SESSION['Zip']; $lat = "0"; $long = "0"; $RCV = "TRUE"; $SEND = "FALSE"; $category = ""; $SecHostname = ""; $SecIP = ""; $SecMac = ""; $MODE = "1"; $ITEM = $_SESSION['Store Number']; $strnmbr = $_SESSION['Store Number']; $timezone = $_POST['TIME_ZONE']; $ACTIVE= "FALSE"; $RESTART= "Yes";  $Content .= "$hostname1, $resolve, $IP, $MAC, $proxy, $outproxy, $opstate, $SN, $type, $brand, $series, $model, $modvers, $login, $password, $continent, $country, $stateabr, $city, $StAddress, $zip, $lat, $long, $SEND, $RCV, $category, $SecHostname, $SecIP, $SecMac, $MODE, $ITEM, $strnmbr, $timezone, ACTIVE, $RestartPlaylist\n";    createCSV();          }    </code></pre>  <p>And finally within a  on the page further down I return the info made from the request for the web call to the API.</p>  <pre><code>if(isset($_POST['submit'])){                     include_once('../tools/createConErr.php');                     $_SESSION['requestID'];                         echo "&lt;tr&gt;&lt;td&gt; "MORE INFO HERE' - Location " . $_SESSION['Store Number'] . " - Ticket # &lt;a href=\"'link here'" . $_SESSION['requestID'] . "\"target='_blank'&gt;" . $_SESSION['requestID'] . "&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;";                  } </code></pre>  <p>Both sets of code work individually, but not together. I've tried moving the bottom up and the top to the bottom and just trying to make a mash of the two but I can't seem to get it to work. I've tried putting them both within the same if(isset($_POST['submit'])){code} as I'm sure that's what needs to happen but it still didn't work.  </p>  <p>I've changed some of the variable names and text for this post but I think you can still get the idea. </p>  <p>Any help is much appreciated. </p>  <p>THANKS!</p>