<p>Hi everyone i tried using kmeans clustering to group the objects. So that i can use this clustering method to detect objects. I get output but the problem is its too slow{How can i solve this?? } and i get the output window is as shown in the below link. Three output images are displayed instead of one how can i solve this. I don't know where exactly the error lies.</p>  <p><a href="http://tinypic.com/view.php?pic=30bd7dc&amp;s=8#.VgkSIPmqqko" rel="nofollow">http://tinypic.com/view.php?pic=30bd7dc&amp;s=8#.VgkSIPmqqko</a></p>  <pre><code>#include "opencv2/imgproc/imgproc.hpp" #include "opencv2/highgui/highgui.hpp" #include &lt;iostream&gt;  using namespace cv;  using namespace std;  int main(  ) {   Mat src = imread( "Light.jpg", 0 ); //  imshow("fff",src);  // cvtColor(src,src,COLOR_BGR2GRAY);   Mat dst;  // pyrDown(src,src,Size( src.cols/2, src.rows/2 ),4);  // src=dst;   resize(src,src,Size(128,128),0,0,1);   Mat samples(src.rows * src.cols, 3, CV_32F);   for( int y = 0; y &lt; src.rows; y++ )     for( int x = 0; x &lt; src.cols; x++ )     //  for( int z = 0; z &lt; 3; z++)         samples.at&lt;float&gt;(y + x*src.rows) = src.at&lt;uchar&gt;(y,x);     cout&lt;&lt;"aaa"&lt;&lt;endl;   int clusterCount = 15;   Mat labels;   int attempts = 2;   Mat centers;     cout&lt;&lt;"aaa"&lt;&lt;endl;   kmeans(samples, clusterCount, labels, TermCriteria(CV_TERMCRIT_ITER|CV_TERMCRIT_EPS, 10000, 0.0001), attempts, KMEANS_PP_CENTERS, centers );   Mat new_image( src.size(), src.type() );     cout&lt;&lt;"aaa"&lt;&lt;endl;   for( int y = 0; y &lt; src.rows; y++ )     for( int x = 0; x &lt; src.cols; x++ )     {         int cluster_idx = labels.at&lt;int&gt;(y + x*src.rows,0);       new_image.at&lt;uchar&gt;(y,x) = centers.at&lt;float&gt;(cluster_idx,0);       //new_image.at&lt;Vec3b&gt;(y,x)[1] = centers.at&lt;float&gt;(cluster_idx, 1);      // new_image.at&lt;Vec3b&gt;(y,x)[2] = centers.at&lt;float&gt;(cluster_idx, 2);     }   imshow( "clustered image", new_image );   waitKey( 0 ); } </code></pre>