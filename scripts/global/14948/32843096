<p>I have a date range for the last 12 months and below that for each customer is either a "on" or "off" value. I am basically looking to count for each "off" period of many days they were of benefit before going back on.</p>  <p>Example</p>  <pre><code>Col A        01/01/2014      02/01/2014     03/01/2014   04/01/2014   1               off              off           on            off 2               on               off           off           off 3               on               on            on             on </code></pre>  <p>So basically at end of each row of dates I want another six columns block 1 to block 6 (block 6 will always be the max) So for the above ID 1 was off benefit two days then back on and off again, so I want the columns at the end to look like:</p>  <pre><code>Col A         Block 1      Block 2      Block 3      Block 4      etc etc  1                 2           1            -             - 2                 3           -            -             - 3                 -           -            -             -  </code></pre>  <p>For each time they go back on benefit and then come back off that starts a new block. Is there any easy way of doing this? I have nearly 800k of rows and really really don't want to do this manually</p>