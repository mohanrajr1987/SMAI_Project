<p>I have a fairly large data set(over a million rows) of patient encounters.  Each encounter(row) has a patient(column) and a primary stop code(column).  What I would like to do is when a patient has a specific stop code, label all of their other encounters with a status(new column) which can be used to pull that patient from the data set.</p>  <p>For example:</p>  <pre><code>Patient             Stop Code              Status John                 513                    Remove John                 642                     John                 125                     </code></pre>  <p>Say stop code 513 is one which denotes all cases of John need to be removed from the data set.</p>  <p>A simple if then function can be used to assign the status for the case with actual 513 code, but I am stuck on how to designate "removal" status to the other cases in the data set.</p>  <p>Has anyone done something similar before?  Any advice you can provide will be greatly appreciated!</p>