<p>I'm intending to get the current balance of a stock using an Excel sheet. In this workbook, the balance is entered every day. However only the most recent day's balance is actually shown, all other are hidden. The data is entered in columns, and hence only one column of data is shown. </p>  <p>In this example, I want to sum the values from row 21 to 24. I enter the formula from the first documented balance, to some columns ahead in time (so the range does not need to be changed often). </p>  <p>For this I use:</p>  <pre><code>  =SUBTOTAL(109,C21:O24) </code></pre>  <p>The last column's values sums to 20. However, using this formula sums to 260. It actually sums all values in row 21 to 24!</p>  <p>I confered the site <a href="https://support.office.com/en-us/article/SUBTOTAL-function-7b027003-f060-4ade-9040-e478765b9939" rel="nofollow">https://support.office.com/en-us/article/SUBTOTAL-function-7b027003-f060-4ade-9040-e478765b9939</a> where it says that the value "109" should be used as the first argument in order to only sum non-hidden values. But evidently, this does not work. I also tried to use "9" as the first argument as well with the same result.</p>  <p>What is it that I am missing? Why doesn't this formula execute as intended?</p>  <p>MCVE (I reckon that if this is copied into cell A20, the value should become 260. When hiding all columns but A,B and O should give 20 using SUBTOTAL, but for me it still produces 260).</p>  <pre><code>  Stock                                                                         Prod1    5   5   5   5   5   5   5   5   5   5   5   5   5               Prod2    5   5   5   5   5   5   5   5   5   5   5   5   5                   Prod3    5   5   5   5   5   5   5   5   5   5   5   5   5               Prod4    5   5   5   5   5   5   5   5   5   5   5   5   5           =SUBTOTAL(109;C21:O24) </code></pre>  <p>Regards</p>