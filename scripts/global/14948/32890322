<p>I have two Worksheets in Excel 2013. In the first one I have Column A with Customer Numbers e.g. <code>999999</code> (starting in A2) and in the second one I have a table that matches the old Number Format to a new format. So I have a Column E with the new Format e.g. <code>1111111111</code> and in Column F the connected old Format <code>999999</code> (same as in the first worksheet).</p>  <p>I want to take the Number from Sheet 1 (Column A) and search it in worksheet 2 (Column F), if there's a match, I want  to check if there exists a new Format for the matching Number in Column E, if so, take the new number, if not take the old one.</p>  <p>I tried this one, but it won't work:</p>  <pre><code>=IF(OFFSET(COLUMN(VLOOKUP(A2;'[Konzern Kunde HKunde_neu.xlsm]Konzern Kunde'!$F$2:$G$456;1;FALSE))ROW(VLOOKUP(A2;'[Konzern Kunde HKunde_neu.xlsm]Konzern Kunde'!$F$2:$G$455;1;FALSE));0;-1)&lt;&gt;"";OFFSET(COLUMN(VLOOKUP(A2;'[Konzern Kunde HKunde_neu.xlsm]Konzern Kunde'!$F$2:$G$456;1;FALSE))ROW(VLOOKUP(A2;'[Konzern Kunde HKunde_neu.xlsm]Konzern Kunde'!$F$2:$G$455;1;FALSCH));0;-1);VLOOKUP(A2;'[Konzern Kunde HKunde_neu.xlsm]Konzern Kunde'!$F$2:$G$5000;1;FALSE)) </code></pre>