<p>I have constructed below to show an certain active directory users details and all their groups.   </p>  <p>This works ok if only one user is returned howver if multiple users are returned I get an error with this section: <code>"Get-ADPrincipalGroupMembership $user.samaccountname | select name"</code></p>  <p>I've looked in the direction of for loops but haven't yet found a solution </p>  <p>I need each user found displayed with their groups. I plan to use this script to quickly gather info to troubleshoot user issues.</p>  <p>Thanks for reading</p>  <pre><code>add-pssnapin quest.activeroles.admanagement  import-module activedirectory  clear-host  $name = read-host 'Whats the name ?'  $user = Get-qAduser $name -properties *  $user | select name,SamAccountName,AccountIsLockedOut,PasswordStatus,PasswordLastSet,PasswordExpires,email,ParentContainerDN,CreationDate | format-list  Get-ADPrincipalGroupMembership $user.samaccountname | select name  cmd /c pause | Out-Null </code></pre>