<p>This could be a repeat question but slightly different as I am running MSTest.exe on azure as part of a web role.</p>  <p>I have a web role which runs a powershell that invokes MSTest.exe with dll name and the results file name</p>  <p>sample :</p>  <pre><code>. MsTest.exe /testcontainer:$testcontainerPath /resultsfile:$resultsFile /test:ValidPaymentAccount /testsettings:Testsettings.testsettings </code></pre>  <p>Now when this piece of code is executed,I can see MSTest.exe launched, but not tests are executed and I get the following error with stack trace</p>  <pre><code>  &lt;RunInfos&gt;       &lt;RunInfo computerName="some_server" outcome="Error" timestamp="2015-10-02T21:09:45.7278887+00:00"&gt;         &lt;Text&gt;Failed to queue test run 'TestResults': The path is not of a legal form.&lt;/Text&gt;         &lt;Exception&gt;System.ArgumentException: The path is not of a legal form.    at System.IO.Path.NormalizePath(String path, Boolean fullCheck, Int32 maxPathLength, Boolean expandShortPaths)    at System.IO.Path.GetFullPathInternal(String path)    at System.IO.Path.GetFullPath(String path)    at Microsoft.VisualStudio.TestTools.Common.ControllerDefaults.GetControllerWorkingDirectory()    at Microsoft.VisualStudio.TestTools.Controller.ControllerObject..ctor(Boolean remote, ControllerConfiguration controllerConfiguration, AgentManager agentManager)    at Microsoft.VisualStudio.TestTools.TestManagement.LocalControllerProxy.InitializeController(TestRun run)    at Microsoft.VisualStudio.TestTools.TestManagement.ControllerProxy.QueueTestRunWorker(Object state)&lt;/Exception&gt;       &lt;/RunInfo&gt;     &lt;/RunInfos&gt; </code></pre>  <p>TestResults folder in the stack is the user defined folder name provided in the TestSettings.testsettings file.</p>  <p>To see if there was indeed a problem with exe and if it crashed , I logged on to the azure instance and tried to execute the same powershell script  with the exact same parameter on the machine and it worked perfectly well.</p>  <p>Now I observed that when I log in using my user account the MStest.exe is run under by user name while when I run it using my web role, it runs under"Network Service".</p>  <p>Is there a way to get this issue resolved? Can the user under which MSTest.exe runs be an issue?</p>  <p>Any help here is highly appreciated.</p>