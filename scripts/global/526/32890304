<p>I am using <a href="https://gallery.technet.microsoft.com/scriptcenter/4208a159-a52e-4b99-83d4-8048468d29dd" rel="nofollow">this Out-Table function</a> to get contents of a <code>.csv</code> file as a <code>DataTable</code>. But when the file contains <code>ä</code>,<code>å</code>,<code>ö</code> (Swedish characters), the <code>DataTable</code> turns them into a <code>?</code>. Where in the function should I change the encoding so that the characters look correct in the output? Here is the function code:</p>  <pre><code>function Out-DataTable  {      [CmdletBinding()]      param([Parameter(Position=0, Mandatory=$true, ValueFromPipeline = $true)] [PSObject[]]$InputObject)       Begin      {          $dt = new-object Data.datatable          $First = $true       }      Process      {          foreach ($object in $InputObject)          {              $DR = $DT.NewRow()                foreach($property in $object.PsObject.get_properties())              {                    if ($first)                  {                        $Col =  new-object Data.DataColumn                         $Col.ColumnName = $property.Name.ToString()                        if ($property.value)                      {                          if ($property.value -isnot [System.DBNull]) {                              $Col.DataType = [System.Type]::GetType("$(Get-Type $property.TypeNameOfValue)")                           }                      }                      $DT.Columns.Add($Col)                  }                    if ($property.Gettype().IsArray) {                      $DR.Item($property.Name) =$property.value | ConvertTo-XML -AS String -NoTypeInformation -Depth 1                  }                   else {                      $DR.Item($property.Name) = $property.value                  }              }                $DT.Rows.Add($DR)                $First = $false          }      }        End      {          Write-Output @(,($dt))      }   } #Out-DataTable </code></pre>