<p>I have this function:</p>  <pre><code>pcal.getPeriodForDate &lt;- function(date_) {     dateObject &lt;- as.POSIXlt(date_)     calendarStart &lt;- pcal.getCalendarStart(dateObject$year + 1900)      difference &lt;- dateObject - calendarStart      if(difference &lt; 0) {         calendarStart &lt;- pcal.getCalendarStart(dateObject$year + 1899)         difference &lt;- dateObject - calendarStart     }      period &lt;- difference / 28      week &lt;- ifelse(period &lt; 1, ceiling(period * 4), ceiling((period - floor(period)) * 4))      return(list(Period = as.numeric(ceiling(period)), Week = week)) } </code></pre>  <p>I also have a data frame  with the following structure</p>  <pre><code>&gt; str(sells) 'data.frame':   73738 obs. of  4 variables:  $ LOC_NBR: chr  "2" "2" "2" "2" ...  $ SLS_DT : Date, format: "2015-02-01" "2015-02-02" "2015-02-03" "2015-02-04" ...  $ SALES  : num  1 2 3 4 5 ... </code></pre>  <p>I want to be able to do this:</p>  <pre><code>sells$pd &lt;- pcal.getPeriodForDate(sells$SLS_DT)$Period </code></pre>  <p>however, i get a ton of warnings: </p>  <pre><code>Warning messages: 1: In if (year &lt; 2000) { :   the condition has length &gt; 1 and only the first element will be used 2: In seedYear:year :   numerical expression has 73738 elements: only the first used 3: In if (difference &lt; 0) { :   the condition has length &gt; 1 and only the first element will be used 4: In if (year &lt; 2000) { :   the condition has length &gt; 1 and only the first element will be used 5: In seedYear:year :   numerical expression has 73738 elements: only the first used </code></pre>  <p>the function works fine passing one value:</p>  <pre><code>&gt; pcal.getPeriodForDate('2015-09-29') $Period [1] 9  $Week [1] 3 </code></pre>  <p>How can I make this work?</p>