<p>I have a XML file</p>  <pre><code>&lt;Superfoo&gt; &lt;foo&gt;     &lt;Number&gt;1&lt;/Number&gt;       &lt;childfoo&gt;20&lt;/childfoo&gt; &lt;/foo&gt; &lt;foo&gt;     &lt;Number&gt;2&lt;/Number&gt;       &lt;childfoo&gt;10&lt;/childfoo&gt; &lt;/foo&gt; &lt;foo&gt;     &lt;Number&gt;3&lt;/Number&gt;       &lt;childfoo&gt;29&lt;/childfoo&gt; &lt;/foo&gt; &lt;/Superfoo&gt; </code></pre>  <p>My requirement is to loop on  nodes. I don't want to hard code them as it can vary from one XML to another XML. Is there any way we can achieve it using <strong><code>PIG XPath</code></strong>.</p>  <pre><code>A =  LOAD 'foo.xml' using org.apache.pig.piggybank.storage.XMLLoader('Superfoo') as (x:chararray);  B = FOREACH A GENERATE XPath(x, 'Superfoo/foo/Number'), XPath(x, 'Superfoo/foo/childfoo'); dump B; </code></pre>  <p>I tried with above code but it return only 1 row but with Foreach it should return all the rows of  node. </p>  <p>Is it possible that we can do it thru Hive using loop? Seems difficult to me....</p>  <p>Any pointers????</p>  <p>Thanks.</p>