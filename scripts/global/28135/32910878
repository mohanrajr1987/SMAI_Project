<p>I'd like to report for all batch_runs that meet <code>where batch_run &gt; 200833 and batch_id=100</code></p>  <p>If a <code>BATCH_RUN</code> does not have any <code>batch_id=100</code>, then report <code>0.</code></p>  <pre><code>  select batch_id,        batch_run,        count(*) over (partition by batch_id,                                    batch_run                           order by batch_run) as total_lot_count,        sum(lot_size) over (partition by batch_id,                                         batch_run) as total_lot_size,        row_number() over (partition by batch_id                                order by batch_run) as line_number  from batch_jobs   -- inner join batches on batch_jobs.batch_run = batches.batch_run -- left join batches on batch_jobs.batch_run = batches.batch_run   where batch_run &gt; 200833 and   batch_id = 100 </code></pre>  <p>See <a href="http://sqlfiddle.com/#!4/c8a25/27" rel="nofollow">Fidde</a></p>  <pre><code>BATCHES BatchSequence   Batch_run ------------------------- 1                200833 2                200911 3                200922 4                200933 5                201011 6                201022 7                201033   BATCH_RUNS Batch_id      Batch_run  Lot_size  ---------------------------------- 100            200933      10      100            200933      20      100            200933      30      100            201022     400      100            201022     500       Desired Result  Batch_Run       Batch_id Lot_count  Total_Lots Line_No --------------------------------------------------- 200911                                0    1 200922            100       3        60    2 200933                                0    3 201011                                0    4 201022            100       2       900    5 201033                                0    6 </code></pre>