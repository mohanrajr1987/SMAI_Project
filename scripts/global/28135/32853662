<p>Company produces three batches per year each using the following naming convention: <code>YYYY11,YYYY22,YYYY33</code></p>  <p>In this case <code>batch_id =1</code> all the batches are sequential. However the absence of <code>batches 200933</code> and <code>201022</code> make <code>batch_id=2</code> non sequential.</p>  <pre><code>with batch_sequences as(   select  1 as batch_sequence, '200911' as batch_date  from dual union all   select  2 as batch_sequence, '200922' as batch_date from dual  union all   select  3 as batch_sequence, '200933' as batch_date  from dual  union all   select  4 as batch_sequence, '201011' as batch_date  from dual union all   select  5 as batch_sequence, '201022' as batch_date from dual union all   select  6 as batch_sequence, '201033' as batch_date  from dual), batch_entries as  (    select   1 as batch_id, '200911' as  batch_date from dual union all    select   1 as batch_id, '200922' as  batch_date from dual union all    select   1 as batch_id, '200933' as  batch_date from dual union all    select   1 as batch_id, '201011' as  batch_date from dual union all    select   1 as batch_id, '201022' as  batch_date from dual union all    select   1 as batch_id, '201033' as  batch_date from dual union all    select   2 as batch_id, '200911' as  batch_date from dual union all    select   2 as batch_id, '200922' as  batch_date from dual union all    select   2 as batch_id, '201011' as  batch_date from dual union all    select   2 as batch_id, '201033' as  batch_date from dual)    select batch_sequence,         e.batch_id,         s.batch_date,         lead(batch_sequence,1) over (order by batch_sequence) as next_batch  from batch_entries e  inner join batch_sequences s on e.batch_date=s.batch_date  order by e.batch_id,           e.batch_date </code></pre>  <p>I'm thinking I can perform math on lead values, but I'm not getting all the  batch_sequence values to correctly calculate this.</p>  <p><strong>Question</strong>  How can I write a query to show that <code>batch_id=1</code> had a 'perfect run' and that <code>batch_id=2</code> missed some batch_dates?</p>  <p>I'll be content with any result set that can highlight this.</p>