<ul> <li><a href="http://pastebin.com/wvQYLJrV" rel="nofollow">start.bat</a></li> <li>Server.jar  <ul> <li><a href="http://pastebin.com/u9DU4F9a" rel="nofollow">server/Server.java</a></li> <li><a href="http://pastebin.com/T05VBh1L" rel="nofollow">server/HTTPServer.java</a></li> <li><a href="http://pastebin.com/u9DU4F9a" rel="nofollow">server/WebSocket.java</a></li> <li><a href="http://pastebin.com/UpPW7uvD" rel="nofollow">server/util/FileUtil.java</a></li> </ul></li> <li>root  <ul> <li><a href="http://pastebin.com/0RmzwRJp" rel="nofollow">index.html</a></li> <li><a href="http://pastebin.com/jv2EnDz7" rel="nofollow">script.js</a></li> <li><a href="http://pastebin.com/93CnYSsf" rel="nofollow">style.css</a></li> <li>favicon.ico</li> </ul></li> <li>error  <ul> <li><a href="http://pastebin.com/Ns9Rnpi5" rel="nofollow">error.html</a></li> <li><a href="http://pastebin.com/VjzuWZ0w" rel="nofollow">script.js</a></li> <li><a href="http://pastebin.com/DSrJK4NJ" rel="nofollow">error.js</a></li> <li><a href="http://pastebin.com/TfCs0xX2" rel="nofollow">style.css</a></li> <li>favicon.ico</li> </ul></li> </ul>  <p>There's alot of files that can't possibly cause the problem, but i decided to include them anyway so you can try this if you want to. Also i've added a couple of <code>System.out.println(arg0);</code>'s for debugging</p>  <p><strong>On Google Chrome:</strong> works as intended when refreshing with ctr+r or ctr+shit+r. But if you press the refresh button it loads everything but the WebSocket request freezes for a little while. When done freezing the server picks up a couple (2?) requests but the first lines are <code>null</code>, therefor the server stops handling the request and waits for a new request. Then the server picks up a correct WebSocket request and everything continues on as intended. But if you refresh while it is frozen, the server connects to the previous WebSocket and correctly sends <code>index.html</code> and <code>style.css</code>, but fails to send <code>script.js</code> and throws a <code>java.net.SocketException</code> and a <code>java.lang.NegativeArraySizeException</code> because it tries to read a negative number (-124?) bytes of data.</p>  <p><strong>On FireFox:</strong> Wame as google chrome, but it happens randomly instead of when the refresh button is pressed.</p>  <p>I also can't connect to the server if a WebSocket is opened, wich is probably because the WebSocket reads the request that the ServerSocket is supposed to read, but i'm not sure about this and i have no idea how to fix this.</p>