<p>I'm trying to learn Koa and I'm getting an issue with server.on('request', callback). I've instantiated an app object and exported it into a file that then uses it as the callback parameter in the server.on function. I am getting an error that "listener must be a function". My stack trace has identified the problem as being in my server/main.js file, which is requiring server/app/index.js to import the app object. The error is specifically in the createApplication function. Any ideas? </p>  <p>Here is the code for server/main.js:</p>  <pre><code>'use strict'; let path = require('path'); let koa = require('koa'); let app = koa();  app.use(function *() {     this.body="hello!"; });  app.listen(1337); module.exports = app; </code></pre>  <p>And here is my code for server/app/index.js:</p>  <pre><code>'use strict'; let chalk = require('chalk');  let startDb = require('./db');  //create node server instance let server = require('http').createServer();  let createApplication = function() {     let app = require('./app');     server.on('request', app); // attach Koa app };  let startServer = function() {     // let PORT = process.env.PORT || 1337;      // server.listen(PORT, function() {     //  console.log(chalk.blue('Server started on port', chalk.magenta(PORT)));      // }) }  startDb.then(createApplication).then(startServer) .catch(function(err) {     console.log(chalk.red(err.stack));     process.kill(1); }); </code></pre>