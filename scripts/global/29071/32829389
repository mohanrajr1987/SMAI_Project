<p>I am working on a full AJAX client form, where, if the post does not contain the client ID, it would create a new MongoDB entry, and if there an ID, it would update the entry.</p>  <p>I am trying to use mongoose's findOneAndUpdate() like so:</p>  <pre><code>exports.post = function ( req, res ) {     var payload   = req.body,         condition = payload._id ? { _id: payload._id } : null,         query     = {}      query[ payload.fieldName ] = payload.value      Client.findAndUpdate(         condition,         query,         { upsert: true },         function ( err, client ) {             var response = {                 success: true,                 message: null,                 client: client             }              if ( err ) {                 console.error( err )                 results.success = false                 results.message = err             }              res.json( response )             }) } </code></pre>  <p>My problem is that, if the condition is null or {}, it will find the last created entry and update that one, rather than create a new entry,</p>  <p>How do I get to my desired behaviour? if else and use 2 different mongoose methods based on the ID availability?</p>