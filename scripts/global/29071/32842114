<p>I want to write a "find or create" static method on my user model - pretty much like an upsert but where the pre-save hook will also run.</p>  <p>This is my user model:</p>  <pre><code>var Promise = require("bluebird") var mongoose = require("mongoose"); var bcrypt = Promise.promisifyAll(require('bcrypt-nodejs'));  var Schema = mongoose.Schema;  var userSchema = new Schema({     e:  { type: String, required: true, trim: true, index: { unique: true } },     fb: { type: String, required: true },     ap: { type: String, required: true },     f:  { type: String, required: true },     l:  { type: String, required: true } });  // Execute before each user.save() call userSchema.pre('save', function(callback) {     bcrypt.genSaltAsync(5)     .then(function (salt) {         return bcrypt.hash(this.fb, salt, null);     })     .then(function (hash) {         user.fb = hash;     })     .then(function (){         return bcrypt.genSaltAsync(5);     })     .then(function (salt) {         return bcrypt.hash(this.ap, salt, null);     })     .then(function (hash) {         user.ap = hash;     })     .then(function () {         callback();     })     .catch(function (err) {         callback(err);     }); });  module.exports = mongoose.model('User', userSchema); </code></pre>  <p>I'm wanting it to do something like this, but nothing I try is working:</p>  <pre><code>userSchema.statics.FindOrCreate(function(json) {     return this.findOne({e: json.email}, function(err, user) {         if(err) return err;         if(user) return user;         // return new user     }); }); </code></pre>  <p>Many thanks!</p>