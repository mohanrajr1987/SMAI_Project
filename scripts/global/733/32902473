<p>I'm trying to create a powershell script, which creates new Team Projects in a given Team Project Collection. This script will have to run on the Team Foundation Server.</p>  <p>I'm using Team Foundation Server 2012, Visual Studio Team Explorer 2012 and TFS Power Tools 2012.</p>  <p>The script (based on <a href="http://stackoverflow.com/questions/24952607/microsoft-teamfoundation-create-project">this</a>):</p>  <pre><code>$tpcUrl = "http://localhost:8080/tfs/mycollection"; $teamproject = "TestProject" tfpt.exe createteamproject /collection:$tpcUrl /teamproject:$teamproject /processtemplate:"Microsoft Visual Studio Scrum 2.2" /sourcecontrol:"New" /noportal /noreports </code></pre>  <p>This works if I only run it once (if I only have to add one project), but when I run it again (with a different project name, of course), it gives an exception:</p>  <pre><code>System.InvalidOperationException: Unexpected error occurred when Visual Studio tried to load Team Foundation Server client application.     at Microsoft.TeamFoundation.PowerTools.CommandLine.TeamProjectCreator.CreateProject() </code></pre>  <p>I found only one solution for this exception <a href="https://visualstudiogallery.msdn.microsoft.com/b1ef7eb2-e084-4cb8-9bc7-06c3bad9148f/view/Discussions/8" rel="nofollow">here</a>, but it did not help, because I'm not running TFS Admin tool while the exception occurs.</p>  <p>I could only make this work if I manually (in TfsMgmt.exe) restart the collection (stop and start collection, not detach and attach). After that, the script worked, but again only for one new project. However, this is not a good solution, since I cannot restart a collection from script, so the project creation would require manual actions, which defeats its purpose.</p>  <p>This only occurs when I run this script on the Team Foundation Server, it works if I try to run it from my development PC. The problem is that I have to run it on the server.</p>  <p>Has anyone met this exception? Is there a way to fix it? Or is there a way I can restart a collection from script?</p>