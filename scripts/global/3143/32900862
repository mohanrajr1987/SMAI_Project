<p>I am new to Scala. How come the "map" function is not serializable? How to make it serializable? For example, if my code is like below:</p>  <pre><code>val data = sc.parallelize(List(1,4,3,5,2,3,5))  def myfunc(iter: Iterator[Int]) : Iterator[Int] = {   val lst = List(("a", 1),("b", 2),("c",3), ("a",2))   var res = List[Int]()   while (iter.hasNext) {     val cur = iter.next     val a = lst.groupBy(x =&gt; x._1).mapValues(_.size)     //val b= a.map(x =&gt; x._2)     res = res ::: List(cur)   }   res.iterator }  data.mapPartitions(myfunc).collect </code></pre>  <p>If I uncomment the line </p>  <pre><code>val b= a.map(x =&gt; x._2) </code></pre>  <p>The code returns an exception:</p>  <pre><code>org.apache.spark.SparkException: Task not serializable Caused by: java.io.NotSerializableException: scala.collection.immutable.MapLike$$anon$2 Serialization stack:     - object not serializable (class: scala.collection.immutable.MapLike$$anon$2, value: Map(1 -&gt; 3))     - field (class: $iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC, name: a, type: interface scala.collection.immutable.Map) </code></pre>  <p>Thank you very much.</p>