<p>I have a function developed in Clojure to <code>scan</code> a HBase table:</p>  <pre><code>(defn- ^Scan make-scan []  (Scan. ))   (defn hscan [hbase tbl]   (let [htbl (.getTable  (:connection hbase)  (. TableName valueOf tbl))         scanner (.getScanner htbl (make-scan))         results (mapv (fn preprocess-result [result]                    result)              scanner)]     (println "Results: " results))) </code></pre>  <p>And I call the function thus for a given HBase table name <code>lookup</code>:</p>  <pre><code>(hscan @hbase "lookup") </code></pre>  <p>PS: The <code>@hbase</code> holds the HBase configuration </p>  <p>I'm getting this as output:</p>  <pre><code>Results: [           #object[org.apache.hadoop.hbase.client.Result 0x16cf8438 keyvalues={Pepsi/A:Canada/1443095322877/Put/vlen=5/seqid=0, Pepsi/A:USA/1443095303916/Put/vlen=5/seqid=0}]           #object[org.apache.hadoop.hbase.client.Result 0x3e5beab5 keyvalues={Wallmart/A:Canada/1443095361758/Put/vlen=5/seqid=0, Wallmart/A:USA/1443095349956/Put/vlen=5/seqid=0}]          ] </code></pre>  <p>And actually I have 2 rows in the HBase table:</p>  <pre><code> hbase(main):007:0&gt; scan 'lookup'  ROW                            COLUMN+CELL                                                                              Pepsi                         column=A:Canada,   timestamp=1443095322877, value=upc-b                                    Pepsi                         column=A:USA, timestamp=1443095303916, value=upc-a                                       Wallmart                      column=A:Canada, timestamp=1443095361758, value=upc-d                                    Wallmart                      column=A:USA, timestamp=1443095349956, value=upc-c                                       2 row(s) in 0.0790 seconds </code></pre>  <p>Question is I want to format the result to produce a clojure map of the form:</p>  <pre><code>{   :Pepsi {:A {:USA "upc-a" :Canada "upc-b"}}   :Wallmart {:A {:USA "upc-c" :Canada "upc-d"}} } </code></pre>  <p>And I'm lost on how to implement that. Kindly help me with this implementation</p>  <p>Thanks!</p>