<p>Consider the following C++ code. I have two classes <code>Singleton</code> and <code>ConcreteSingleton</code>. <code>ConcreteSingleton</code> is derived from <code>Singleton</code>.</p>  <p><code>Singleton</code> shall be a <strong>friend</strong> of <code>ConcreteSingleton</code>:</p>  <pre><code>template &lt;class T&gt; class Singleton {};  class ConcreteSingleton : public Singleton&lt;ConcreteSingleton&gt; {     template &lt;class T&gt;     friend class Singleton; };  int main() {} </code></pre>  <p>It works with Microsoft's visual C++ compiler. But, I can't compile it with g++ 4.8.4. The error is:</p>  <blockquote> <pre><code>   error: specialization of ‘Singleton&lt;ConcreteSingleton&gt;’ after instantiation        template &lt;class T&gt; friend class Singleton; </code></pre> </blockquote>  <p>Is there any way to fix it?</p>