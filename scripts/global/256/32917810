<p>I currently have a table <code>m</code> of the following format:</p>  <pre><code>id    scenario    period    ct 2        1          1       1   2        1          2       1 2        1          3       1 2        1          4       1 2        2          1       1 2        2          2       1 2        2          3       1 2        2          4       1 2        3          1       1 2        3          2       1 2        3          3       1 2        3          4       1 </code></pre>  <p>I want to create the following table:</p>  <pre><code>id    scenario    period    1    2    3    4 2        1          1       1 2        1          2            1 2        1          3                 1 2        1          4                      1 2        2          1       1 2        2          2            1 2        2          3                 1 2        2          4                      1 2        3          1       1 2        3          2            1 2        3          3                 1 2        3          4                      1 </code></pre>  <p>The tablefunc extension has been created in my Postgres database already. I'm currently trying to use the <code>crosstab()</code> function to complete the pivot. However, I'm getting a table that looks like the following:</p>  <pre><code>id    scenario    period    1    2   3    4  2        1          1       1    1   1    1 </code></pre>  <p>The query I tried:</p>  <pre><code>SELECT * FROM crosstab(         'SELECT id, scenario, period, ct FROM m              ORDER BY 1',          'SELECT DISTINCT period FROM m              ORDER BY 1') AS (id, scenario, period, 1, 2, 3, 4); </code></pre>