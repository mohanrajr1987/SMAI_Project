<p>I have a batch script which generates a WinSCP upload script to upload a file to an SFTP location. Now when I run the batch file via command prompt -  it runs successfully and loads it. I called the same thru SSIS Execute process task - it runs successfully and loads it. Now when I put the same on SQL Agent - I tried the following two options:</p>  <ol> <li>Using Operating System (CmdExec) - cmd.exe /c "\.bat"</li> <li>Added the SSIS package to SSISDB and added it as a job step.</li> </ol>  <p>With both the above options the job showed a successful run. However the file is not uploaded! Any ideas on what is happening?</p>  <p>Here's my batch script:</p>  <pre><code>echo off SET winscp=C:\"Program Files (x86)"\WinSCP\WinSCP.com SET stagingDirectory=\\&lt;staging path&gt;\ SET scriptPath=\\&lt;ScriptPath&gt;\UploadScript.txt SET ftpHost=xx.xx.xx.xx SET ftpUser=user SET ftpPass=password SET fileName=Test.xlsx SET ftpFlags= @REM ftpFlags: -explicit  echo deleting uploadScript if it already exists  IF EXIST %scriptPath% del /F %scriptPath% IF EXIST %scriptPath% exit 1  echo Generating WINSCP Upload Script  &gt;&gt;%scriptPath% echo option batch abort &gt;&gt;%scriptPath% echo option confirm off &gt;&gt;%scriptPath% echo open sftp://%ftpUser%:%ftpPass%@%ftpHost% %ftpFlags% &gt;&gt;%scriptPath% echo option transfer binary &gt;&gt;%scriptPath% echo put %stagingDirectory%%fileName% / &gt;&gt;%scriptPath% echo close &gt;&gt;%scriptPath% echo exit  echo Launching WINSCP upload  start /wait %winscp% /console /script=%scriptPath% </code></pre>