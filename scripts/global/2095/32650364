<p><strong>Update -</strong> I was trying to evaluate an expresion in C# using the <strong>DataTable.Compute()</strong> method and found that instead of using <strong>ternary operator(?,:)</strong>, I should've used the <strong>IFF(expression, truepart, falsepart)</strong>. So I'm trying to convert the whole expression into the IFF format and need a little help to construct the logic.</p>  <pre><code>static string IIFApproach() {     DataTable dt = new DataTable();     string formula = "If(1 &gt; 20) then((1 / 1) &gt; 10 and(1 / 1) &lt;= 3500) else (If(1 equals 0) then TRUE else FALSE )";      formula = formula         .Replace("If", "IIf(")         .Replace("then", ",")         .Replace("equals", "=")         .Replace("else", ",");       formula = dt.Compute(formula, "").ToString();      return formula; } </code></pre>  <p>I'm struck at the opening and closing of the IFF parenthesis. I have tried to add the starting parenthesis at the time of replacement [<strong>.Replace("If", "IIf(")</strong>] but I'm unable to put the closing parenthesis at the end of the expression. I know that it can be done using stacks but as I confess I'm not good with data structures. Please help me to construct a logic.</p>  <p><strong>Old Post -</strong> I'm trying to evaluate an expression using the Compute() method of DataTable and it shows an error "Cannot interpret token ?". My expression contains ternary operator and i need to solve the expression manually (without using nCalc or other tools). Is there any inbuilt microsoft functionality to solve this expression.</p>  <pre><code>&lt;code&gt; DataTable dt = new DataTable(); var result = dt.Compute(" ( 1 &gt; 20 ) ? (( 1 / 1 ) &gt; 10 &amp;&amp; ( 1 / 1 ) &lt;= 3500 ) : (  ( 1 == 0) ? 1 : 0 )", null); Console.WriteLine("The result is" + result); &lt;/code&gt; </code></pre>