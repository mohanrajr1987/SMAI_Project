<p>I'm working on an existing project that currently has a reasonable amount of logic within HAML files rather than in a decorator.</p>  <p>Is it possible to test logic within a HAML file in a way similar to the following, checking that certain objects receive messages, as opposed to testing the output rendered?</p>  <pre><code>describe 'show.html.haml' do   context 'user is an admin' do     let(:user) { create(:user, :admin) }      it 'shows a form' do       # Pseudo-code       expect(SimpleForm).to receive(:generate_a_form)     end   end    context 'user is an ordinary user' do     let(:user) { create(:user) }      it 'does not show a form' do       # Pseudo-code       expect(SimpleForm).to_not receive(:generate_a_form)     end   end end </code></pre>