<p>Given something like:</p>  <pre><code>class MyClass   def subscribe     $redis.subscribe('channel') do |on|        on.message do |channel, msg|          Something.create(msg)        end     end   end end </code></pre>  <p>How can I test that when <code>MyClass</code> executes <code>subscribe</code>, it will run <code>Something.create</code> for each message it receives on the channel?</p>