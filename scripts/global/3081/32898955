<p>I'm trying to mock this call in my tests for an model method: </p>  <pre><code>    client = TwitterAPI.new.client </code></pre>  <p>I'm not sure how to do this in tests, as I've tried </p>  <pre><code>allow_any_instance_of(TwitterAPI::Client).to receive(:search).with(@search, @since_time, @until_time).and_return(unprocessed_tweets(3, @tag_name, @now-1.weeks, @now)) </code></pre>  <p>But this gives me a name error, and I feel like, regardless is the incorrect approach. Any suggestions? </p>