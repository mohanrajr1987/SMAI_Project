<p>I am trying to automate website deployment using the Azure Resource Manager. Website creation and code deployment is working fine, but I am unable to attach the new site to an existing Web Hosting plan.</p>  <p>I am using the 2015-08-01 API and from different examples I think that this template should work (it does not...):</p>  <p>The deployment fails at "Microsoft.Web/sites/config" and the site is beeing assigned a new default free hosting plan.</p>  <pre><code>{ "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "parameters": {     "siteName": {         "type": "string"     },     "subscriptionId": {         "type": "string"     },     "setting1": {         "type": "string"     },     "setting2": {         "type": "string"     } }, "resources": [     {         "apiVersion": "2015-08-01",         "type": "Microsoft.Web/sites",         "name": "[parameters('siteName')]",         "location": "[resourceGroup().location]",         "properties": {             "serverFarmId ": "/subscriptions/xxxxxx/resourceGroups/xxxxxx/providers/Microsoft.Web/serverfarms/xxxxxx"         },         "resources": [             {                 "apiVersion": "2015-08-01",                 "name": "web",                 "type": "config",                 "dependsOn": [                     "[resourceId('Microsoft.Web/Sites', parameters('siteName'))]"                 ],                 "properties": {                     "phpVersion": "off",                     "netFrameworkVersion": "v4.6",                     "use32BitWorkerProcess": false,                     "webSocketsEnabled": true,                     "alwaysOn": true,                     "requestTracingEnabled": false,                     "httpLoggingEnabled": false,                     "logsDirectorySizeLimit": 40,                     "detailedErrorLoggingEnabled": false,                     "appSettings": [                         {                             "Name": "setting1",                             "Value": "Value1"                         },                         {                             "Name": "setting2",                             "Value": "Value2"                         }                     ]                 }             },             {                 "apiVersion": "2015-08-01",                 "type": "extensions",                 "name": "MSDeploy",                 "dependsOn": [                     "[resourceId('Microsoft.Web/sites', parameters('siteName'))]"                 ],                 "properties": {                     "packageUri": "xxxxxxxx",                     "dbType": "None",                     "connectionString": ""                 }             }         ]     } ], "outputs": {     "siteUri": {         "type": "string",         "value": "[concat('http://',reference(resourceId('Microsoft.Web/sites', parameters('siteName'))).hostNames[0])]"     } } </code></pre>  <p>}</p>