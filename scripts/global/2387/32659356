<p>I have the following java-code:</p>  <pre><code>public class DoubleSHA256 {      final protected static char[] hexArray = "0123456789abcdef".toCharArray();      public static String gen(String input) {          MessageDigest digester = null;         try {             digester = MessageDigest.getInstance("SHA-256");         } catch (NoSuchAlgorithmException e) {             // TODO Auto-generated catch block             e.printStackTrace();         }          return bytesToHex(digester.digest(digester.digest(input.getBytes())));      }      private static String bytesToHex(final byte[] bytes)     {         char[] hexChars = new char[bytes.length * 2];          for ( int j = 0; j &lt; bytes.length; j++ ) {             int v = bytes[j] &amp; 0xFF;             hexChars[j * 2] = hexArray[v &gt;&gt;&gt; 4];             hexChars[j * 2 + 1] = hexArray[v &amp; 0x0F];         }          return new String(hexChars);     }  } </code></pre>  <p>The call of the class looks as following:</p>  <pre><code>System.out.println(DoubleSHA256.gen(     "0100000081cd02ab7e569e8bcd9317e2fe99f2de44d49ab2b8851ba4a308000000000000e320b6c2fffc8d750423db8b1eb942ae710e951ed797f7affc8892b0f1fc122bc7f5d74df2b9441a42a14695" )); </code></pre>  <p>The result is:</p>  <pre><code>6500f13bc254c59e9f3d77bd0b1999e686fadf7765ae2b59266d1d835b869083 </code></pre>  <p>but it should be:</p>  <pre><code>1dbd981fe6985776b644b173a4d0385ddc1aa2a829688d1e0000000000000000 </code></pre>  <p>or</p>  <pre><code>00000000000000001e8d6829a8a21adc5d38d0a473b144b6765798e61f98bd1d </code></pre>  <p>Source (<a href="https://en.bitcoin.it/wiki/Block_hashing_algorithm" rel="nofollow">https://en.bitcoin.it/wiki/Block_hashing_algorithm</a>): </p>  <pre><code>&gt;&gt;&gt; import hashlib &gt;&gt;&gt; header_hex = ("01000000" +     "81cd02ab7e569e8bcd9317e2fe99f2de44d49ab2b8851ba4a308000000000000" +     "e320b6c2fffc8d750423db8b1eb942ae710e951ed797f7affc8892b0f1fc122b" +     "c7f5d74d" +     "f2b9441a" +     "42a14695") &gt;&gt;&gt; header_bin = header_hex.decode('hex') &gt;&gt;&gt; hash = hashlib.sha256(hashlib.sha256(header_bin).digest()).digest()  &gt;&gt;&gt; hash.encode('hex_codec') '1dbd981fe6985776b644b173a4d0385ddc1aa2a829688d1e0000000000000000' &gt;&gt;&gt; hash[::-1].encode('hex_codec') '00000000000000001e8d6829a8a21adc5d38d0a473b144b6765798e61f98bd1d' </code></pre>  <p>Can anyone give me a hint what is wrong?</p>