<p>I have a console application that creates a NamedPipe, and I'm trying to connect to it from a Windows Service <code>SvcMain()</code> function.</p>  <pre><code>HANDLE hPipe = CreateFile(serviceConnPipe, GENERIC_READ | GENERIC_WRITE, 0, nullptr, OPEN_EXISTING, 0, nullptr);     if (hPipe == INVALID_HANDLE_VALUE)      {         // It always fails here          DWORD error = GetLastError();        } </code></pre>  <p>The call to <code>CreateFile()</code> function always fails with <code>INVALID_HANDLE_VALUE</code> and the extended error is <code>ERROR_ACCESS_DENIED</code>.</p>  <p>If I debug the Service (<code>SvcMain()</code> function), then it works fine.  What is the issue here?</p>