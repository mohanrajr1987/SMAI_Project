<p>I have a <code>TcpClient</code> and <code>TcpListener</code> based Windows Service running on two machines on my network.  Both client and server nodes operate from the same Windows service.  The service runs as <code>Local System</code> and <code>PC01</code> is Win7 x64 and <code>PC02</code> is Win7 x86.</p>  <p>The application was throwing a <code>SocketException</code> 10060 (connection timed out) during connection attempts from client to server, and I have found that the Windows firewall exceptions generated by the application's automatic firewall configuration code are not allowing TCP traffic to pass through. </p>  <p>Taking a step back, I tried the following tests sequentially on <code>PC01</code> with the firewall on <code>PC02</code> permanently disabled to remove it as a variable:</p>  <ol> <li>Disabled the firewall on <code>PC01</code> - this worked.</li> <li>Enabled the firewall on <code>PC01</code> and <em>manually</em> added an exception to allow all inbound <code>TCP</code> traffic on port <code>12345</code> - this worked.</li> <li>Further restricted the exception to allow remote traffic from the local subnet only - this worked.</li> <li>Further restricted the exception to allow (all) services only - this worked.</li> <li>Further restricted the exception to allow the specific service by selecting from the list of services or by entering service short name - this <strong>failed.</strong></li> <li>Attempted instead to restrict the exception to the specific service by selecting the <code>myservice.exe</code> executable - this <strong>failed.</strong></li> </ol>  <p>What is it about my Windows service that prevents this from working when the exception is restricted to the specific service? Is there a caveat for Windows services that I should be aware of?  Is opening the port for all services the only solution?</p>  <hr>  <p>EDIT: I've used <code>netstat -a -n -b</code> to collect info regarding active connections and listening ports.  The below excerpt details the information regarding my service:</p>  <pre><code>Active Connections  Proto  Local Address          Foreign Address        State TCP    0.0.0.0:12345          0.0.0.0:0              LISTENING [myservice.exe] ... UDP    0.0.0.0:12344          *:*                     [myservice.exe] (listening for UDP broadcast packets) ... UDP    0.0.0.0:62794          *:*                     [myservice.exe] (this is an outbound broadcast packet) </code></pre>  <p>Thanks everyone for any insights you can offer.</p>