<p>I've made App and facebook login for my site. But I've tested it and it works for another type of mail. I tried now with gmail and it's showing: <code>ErrorException [ Notice ]: Undefined index: email</code></p>  <p>My method for that is:</p>  <p><div class="snippet" data-lang="js" data-hide="false"> <div class="snippet-code"> <pre class="snippet-code-html lang-html prettyprint-override"><code> public function action_fbLogin(){                $facebook = new Facebook(array(             'appId'  =&gt; 'MyAppId',             'secret' =&gt; 'MySecret',         ));          $user = $facebook-&gt;getUser();         if ($user) {              $user_profile = $facebook-&gt;api('/me', array('fields' =&gt; 'id,email,name,first_name,last_name,picture'));                        $user_id = Model_UserFunctions::checkIfUserExist($user_profile['email']);              if($user_id &gt; 0)             {                                  Session::instance()-&gt;set('user', array(                     'fb_id' =&gt; $user_profile['id'],                     'user_id' =&gt; $user_id,                     'pic' =&gt; $user_profile['picture'],                     'email' =&gt; $user_profile['email'],                     'first_name' =&gt;  $user_profile['first_name'],                     'last_name' =&gt;  $user_profile['last_name'],                 ));                                                $this-&gt;redirect('profile');                 exit;             }             $values = array(                     'email' =&gt; $user_profile['email'],                     'username' =&gt; $user_profile['email'],                     'password' =&gt; '12345678'                 );             $user = ORM::factory ( 'User' );             $user-&gt;values($values);             try             {                 if($user-&gt;save()){                     $user_new_id = $user-&gt;as_array();                     $user_new_id = $user_new_id['id'];                     Session::instance()-&gt;set('user', array(                             'fb_id' =&gt; $user_profile['id'],                             'user_id' =&gt; $user_new_id,                             'pic' =&gt; $user_profile['picture'],                             'email' =&gt; $user_profile['email'],                              'first_name' =&gt; $user_profile['first_name'],                             'last_name' =&gt; $user_profile['last_name'],                         ));                                          $this-&gt;redirect('profile');                 }               }             catch (ORM_Validation_Exception $e)             {                 $result = $e-&gt;errors('models');                 echo '&lt;pre&gt;';                 print_r($result);                 exit;             }           }         else          {                          $this-&gt;redirect($facebook-&gt;getLoginUrl(array('id,email,name,first_name,last_name,picture')));          }         exit;          }</code></pre> </div> </div> </p>  <p>Are there other things that I should add to my code for gmail users? Thank you in advance!</p>  <p>Edited: my method for logut is:</p>  <p><div class="snippet" data-lang="js" data-hide="false"> <div class="snippet-code"> <pre class="snippet-code-html lang-html prettyprint-override"><code> public  function action_logout(){         Session::instance()-&gt;delete('user');         $this-&gt;redirect('/');     }</code></pre> </div> </div> </p>  <p>Maybe problem is that it doesn't logout. I'm not sure. It shows me the same user data although I'm logged with different user. </p>