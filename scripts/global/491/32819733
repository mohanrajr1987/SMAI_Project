<p>So I have a function to convert Datatable to NPOI Workbook.</p>  <p>Here's the code :</p>  <pre><code>public static XSSFWorkbook DataTableToExcel(DataTable dt, string sheetName = "Sheet1")         {             if (dt.Rows.Count &gt; 0)             {                 var excel = new XSSFWorkbook();                 var sheet = (XSSFSheet)excel.CreateSheet(sheetName);                 var col = sheet.CreateRow(0);                  //iterate columns                 for(int x = 0; x &lt; dt.Columns.Count; x++)                 {                     col.CreateCell(x).SetCellValue(dt.Columns[x].ColumnName);                 }                  //iterate row                 for (int r = 0; r &lt; dt.Rows.Count; r++) //SLOW AS HELL                 {                     var row = sheet.CreateRow(r + 1);                      for (int c = 0; c &lt; dt.Columns.Count; c++)                     {                         value = dt.Rows[r][c].ToString();                         row.CreateCell(c).SetCellValue(value);                     }                 }                  return excel;             }              return null;         } </code></pre>  <p>My problem is that the performance is horrible (10.000 rows took around 30 minutes) cause by the loop.</p>  <p>Is there a way to improve the performance?</p>