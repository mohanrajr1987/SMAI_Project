<p>I have a service that lives in a quite restricted server system. It must run under a specific user, let's call it user A.</p>  <p>The service must also be able to access a network share which user A does not have access to, but user B has. So the service must access this network share as user B, while running as user A.</p>  <p>The way I would do this if running locally on the computer is to map a network drive under a different user. But services can't access mapped network drives, even if it was mapped under the same user:</p>  <p><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms685143.aspx" rel="nofollow">Services and Redirected Drives</a></p>  <p>Does anyone have a suggestion to what I could do? I'm the creator of the service so I can modify it as I please. Is there perhaps some way to let it access the network share as another user via a winapi call (unmanaged C++)?</p>