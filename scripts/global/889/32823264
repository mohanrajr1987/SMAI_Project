<p>I'm trying to take a screenshot of a window including all tooltips or opened popup menus that may be outside this window (see screenshot). I know that basically everything in Windows is a window, but I'm not sure how to get the menus. I don't know also if they're showing from the UI thread of the current app or some system thread.</p>  <p>My failed attempt was using <code>EnumWindows</code> to get all top-level windows and then <code>PrintWindow</code>. Any code or ideas will be appreciated, no matter of the language.</p>  <p><a href="http://i.stack.imgur.com/rBMlJ.png" rel="nofollow"><img src="http://i.stack.imgur.com/rBMlJ.png" alt="enter image description here"></a></p>