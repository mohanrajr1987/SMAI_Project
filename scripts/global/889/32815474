<p>I am using Delphi 6 and want to add the functionality of sorting a ListView, like it is done in Windows Explorer.</p>  <p>In a first test, I have (quick&amp;dirty) copied a few source codes from a few sources, and done some small adjustments:</p>  <p>This is what I have so far (only quick&amp;dirty for now):</p>  <pre><code>uses   CommCtrls;  var   Descending: Boolean;   SortedColumn: Integer;  const   { For Windows &gt;= XP }   {$EXTERNALSYM HDF_SORTUP}   HDF_SORTUP              = $0400;   {$EXTERNALSYM HDF_SORTDOWN}   HDF_SORTDOWN            = $0200;  procedure ShowArrowOfListViewColumn(ListView1: TListView; ColumnIdx: integer; Descending: boolean); var   Header: HWND;   Item: THDItem; begin   Header := ListView_GetHeader(ListView1.Handle);   ZeroMemory(@Item, SizeOf(Item));   Item.Mask := HDI_FORMAT;   Header_GetItem(Header, ColumnIdx, Item);   Item.fmt := Item.fmt and not (HDF_SORTUP or HDF_SORTDOWN);//remove both flags   if Descending then     Item.fmt := Item.fmt or HDF_SORTDOWN   else     Item.fmt := Item.fmt or HDF_SORTUP;//include the sort ascending flag   Header_SetItem(Header, ColumnIdx, Item); end;  procedure TUD2MainForm.ListView3Compare(Sender: TObject; Item1,   Item2: TListItem; Data: Integer; var Compare: Integer); begin   if SortedColumn = 0 then     Compare := CompareText(Item1.Caption, Item2.Caption)   else     Compare := CompareText(Item1.SubItems[SortedColumn-1], Item2.SubItems[SortedColumn-1]);   if Descending then Compare := -Compare; end;  procedure TUD2MainForm.ListView3ColumnClick(Sender: TObject;   Column: TListColumn); begin   TListView(Sender).SortType := stNone;   if Column.Index&lt;&gt;SortedColumn then   begin     SortedColumn := Column.Index;     Descending := False;   end   else     Descending := not Descending;   ShowArrowOfListViewColumn(TListView(Sender), column.Index, Descending);   TListView(Sender).SortType := stText; end; </code></pre>  <p>The colums can be sorted up- and downwards, but I can't see arrows.</p>  <p>According to <a href="http://stackoverflow.com/a/14792399/488539">this question</a> , my function ShowArrowOfListViewColumn() should have solved the problem.</p>  <p>Is it possible that Delphi 6 does not support this feature, or is there a problem in my code? On the other hand, ListView is IIRC a <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/bb774735(v=vs.85).aspx" rel="nofollow">Windows control</a>, and therefore I expect that the WinAPI renders the arrow graphics, and not the (very old) VCL.</p>  <p>I read at a <a href="http://development.mwcs.de/tutsortlistview.html" rel="nofollow">German website</a> that the arrow graphics have to be added manually, but the solution of that website has the requirement to change CommCtrl.pas of Delphi (because of a glitch when resizing column). But I really dislike modifing the VCL source, especially since I develop OpenSource, and I do not want that other developers change/recompile their Delphi Sources.</p>  <p>Note that I didn't add a XP manifest to my binary, so the app looks like Win9x.</p>