<p>My android app should recognize, via bluetooth, if there is appropriate arduino server around. If so, app will show toast messages depending of the presence of the desirable arduino server. If it is found it should taost message about that, and if it is not, another message.</p>  <p>Here is my code when user presses button to search for arduino server:</p>  <pre><code>public void onClick(View v) {              Set&lt;BluetoothDevice&gt; pairedDevices = mBluetoothAdapter.getBondedDevices();             if (pairedDevices.size() &gt; 0) {                 for (BluetoothDevice device : pairedDevices) {                     if (device.getName().equals("ARD_SPP")) {                         sendButton.setVisibility(View.VISIBLE);                         Toast.makeText(ConnectActivity.this, "Arduino server found, please sign up", Toast.LENGTH_SHORT);                         b = true;                         break;                     }                 }             }             mBluetoothAdapter.startDiscovery();             if (mBluetoothAdapter.startDiscovery()) {                 registerReceiver(discoveryResult, new IntentFilter(BluetoothDevice.ACTION_FOUND));             }             mBluetoothAdapter.cancelDiscovery();             if (b == false)                 Toast.makeText(ConnectActivity.this, "Server not found", Toast.LENGTH_SHORT).show();             } </code></pre>  <p>And this is code inside BroadcastReceiver:</p>  <pre><code>BroadcastReceiver discoveryResult = new BroadcastReceiver() {     @Override     public void onReceive(Context context, Intent intent) {         String deviceName = intent.getStringExtra(BluetoothDevice.EXTRA_NAME);         if (deviceName.equals("ARD_SPP")) {             Toast.makeText(ConnectActivity.this, "Arduino server found, please sign up", Toast.LENGTH_SHORT).show();                             b = true;         }     } </code></pre>  <p>(I didn't put part of the code about bluetooth, to make it easier to read, consider that bluetooth is already on)</p>  <p>The problem is that message that server is not found, is shown even if the server is around. So, at first, "server not found" is shown, and after that there is message that server is found. I don't know how to fix that. </p>  <p>I tried with using boolean variable b. I used condition with it in different places inside my code, inside onClick and BroadcastReceiver, but nothing gave appropriate result. Maybe I didn't use BroadcastReceiver in a good way...</p>  <p>Does anyone have idea how I can fix this ? It lools like solution is quite simple but I don't get it.   </p>