<p>I am trying to get <a href="http://socket.io/" rel="nofollow">http://socket.io/</a> working with <a href="https://github.com/tj/co" rel="nofollow">co</a>.</p>  <p>I am trying to do some tasks asynchronously in my code.</p>  <pre><code>io.on('connection', function (socket) {      // &lt;--- need to do something heavy here      socket.on('something', function (data) {          // &lt;--- need to do something heavy here      });      // &lt;--- need to do something heavy here  }); </code></pre>  <p>That's how socket.io works. I would like to add <code>co</code> to the mix now. I've tried the following:</p>  <pre><code>io.on('connection', function (socket) {     co(function* () {          yield something(); // &lt;--- this works          socket.on('something', function (data) {              yield something(); // &lt;--- this does not work          });          yield something(); // &lt;--- this works     }); }); </code></pre>  <p>Get this error: <code>SyntaxError: Unexpected strict mode reserved word</code></p>  <p>And this:</p>  <pre><code>io.on('connection', function (socket) {     co(function* () {          yield something(); // &lt;--- this works          socket.on('something', function (data) {              co(function* () {                 yield something(); // &lt;--- this works             });          });          yield something(); // &lt;--- this works     }); }); </code></pre>  <p>My question is, is this how it is supposed to be used, or is ther something I've missed. It seems like an awful lot of extra code to wrap everything?</p>