<p>I want to automate a process in regards to importing CSV files in SQL.</p>  <p>I work with projects, and for each project I need to do as follows:</p>  <ol> <li><p>I receive data from an external source as CSV files, there can be up to 17 different CSV files,         each file with a different structure <code>{1.CSV,2.CSV,3.CSV ... 17.CSV}</code>.         The names of the files does not change. But there will not always be 17 files,         for instance in project A there is not file <code>"5.CSV"</code> and <code>"16.CSV"</code>.</p></li> <li><p>I put all the CSV files into a folder <code>"C:\Dump"</code></p></li> <li><p>I then create a new database called Project A</p></li> <li><p>I then manually import every file from the <code>"Dump"</code> folder in relation to its structure.</p></li> <li><p>When done importing all the files,         I will then join the tables into the first table "1" in relation to some specific columns.</p></li> </ol>  <p>So I want to automate step 4, I know all the structures for each file. </p>  <p>So what I want SQL to do is to lookup all the filenames in "Dump" and then create a table with the same filename, import the file into the table with the known structure, and then repeat for every file in "Dump". </p>  <p>If possible I want to add step 5 into the script, so it automatically joins each table (if existing) with the corresponding column in table 1. Because I know how each table joins table 1.</p>  <p>I would like the rough code along with proper comments so that I understand it.</p>