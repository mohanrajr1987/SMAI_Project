<p>Suppose my data looks like this</p>  <pre><code>   student article.bought 1        A            pen 2        B         pencil 3        V           book 4        A            pen 5        A      inkbottle 6        B            pen 7        B         pencil 8        B         pencil 9        V           book 10       Z         marker 11       A      inkbottle 12       V           book 13       V            pen 14       V           book </code></pre>  <p>I need unique occurrences of articles probably in a different column like this</p>  <pre><code>   student article.bought Occurences 1        A            pen          1 2        B         pencil          1 3        V           book          1 4        A            pen          1   # as A is taking a pen again 5        A      inkbottle          2   # 'A' changed from pen to ink bottle 6        B            pen          2 7        B         pencil          3   # though B took pencil before, this is different as he took a pen in between 8        B         pencil          3 9        V           book          1 10       Z         marker          1 11       A      inkbottle          2 12       V           book          1 13       V            pen          2 14       V           book          3 </code></pre>