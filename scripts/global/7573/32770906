<p>I am using SAS 9.4.  I want to write a JSON Web Signature ("JWS") to complete my JSON Web Token ("JWT") - (I already have the header and claims encoded and tested).  I would like to make API calls to Google.  My problem is that I am not certain how to create the JWS.  Per all the docs and tutorial web sites I have researched the syntax to create the signature is (pseudo-code):</p>  <pre><code>encodedContent = base64UrlEncode(header) + "." + base64UrlEncode(payload); signature = hashHmacSHA256($encodedContent); </code></pre>  <p>and/or</p>  <pre><code>var encodedString = base64UrlEncode(header) + "." + base64UrlEncode(payload); HMACSHA256(encodedString, 'secret'); </code></pre>  <p>etc.</p>  <p>I have been attempting to create the JWS using SAS PROC GROOVY code found here: <a href="https://gist.github.com/FriedEgg/79ad315afa1b315e8ac3" rel="nofollow">https://gist.github.com/FriedEgg/79ad315afa1b315e8ac3</a> ...and other places.</p>  <p>Google's doc (<a href="https://developers.google.com/identity/protocols/OAuth2ServiceAccount" rel="nofollow">https://developers.google.com/identity/protocols/OAuth2ServiceAccount</a>) states: "Sign the UTF-8 representation of the input ('{Base64url encoded header}.{Base64url encoded claim set}') using SHA256withRSA (also known as RSASSA-PKCS1-V1_5-SIGN with the SHA-256 hash function) with the private key obtained from the Google Developers Console. The output will be a byte array."</p>  <p>However, I am confused about what key to use (or whether I should be using a key) as some sites (example above) just suggest hashing the encoded header+claims while others suggest hashing using a "secret key" while say "private key" - and the github page (URL above) just uses a "key".</p>  <p>I am also confused about sha1 vs. sha256.  The Google docs sate sha256 but some have suggested sha1 in this Stack Overflow thread: questions/18362327/creating-digital-signature-usining-sas-for-google-api-geocode</p>  <p>Again, I have verified my header and claims SAS code work using: <strong>jwt dot io</strong> and <strong>kjur dot github dot io/jsjws /tool_jwt.html</strong></p>  <p>Since SAS supports Groovy (PROC GROOVY) I assume that I can write my JWT successfully using java code but I have not yet been able to replicate any JWT in my SAS code using examples found on the sites I have mentioned above and others.</p>  <p>Has anyone ever done this before (using SAS to connect to Google APIs using JWT)?</p>  <p>Any help is appreciated!</p>