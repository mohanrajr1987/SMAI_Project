<p>I am trying to make a pugin in for gravity forms but my filter logic seems to be screwed up it doenst appear to be catching all the words and the form is just spinning on the ajax spinner ie not going to the thank you page or showing the validation error message.</p>  <p>What this block of code is ment to do is baslically pass back a true or false bld_strpost_arr and this is where I beleive the validation is failing its just not displaying a message to the user.</p>  <p>Custom Validation routine</p>  <pre><code>function bld_strpos_arr($haystack, $needle) {   if(!is_array($needle))  {   $needle = array($needle);  }   foreach($needle as $what) {    $pos = stripos($haystack, $what);   if( $pos !== false)   {  return true;   } } </code></pre>  <p>return false; }</p>  <pre><code>function bld_custom_validation($validation_result){   $form = $validation_result["form"];   $stop_words = array( 'outsource', 'Sir/Madam', 'Sir/ Madam', 'Sir / Madam', 'Sir /Madam', 'long term relationship', );   $stop_id = array();    foreach($_POST as $id =&gt; $post)   {     if(bld_strpos_arr($post, $stop_words))   {     /*      * We have a match so store the post ID and initiate validation error      */       $stop_id[] = $id;   } }  if(sizeof($stop_id) &gt; 0) { $validation_result['is_valid'] = false;  foreach($form['fields'] as &amp;$field)  {     foreach($stop_id as $id)     {         $the_id = (int) str_replace('input_', '', $id);          if($field['id'] == $the_id)         {             $field['failed_validation'] = true;             $field['validation_message'] = 'Please do not send us unsolicited messages';         }     } } }  //Assign modified $form object back to the validation result $validation_result["form"] = $form; return $validation_result;  } </code></pre>