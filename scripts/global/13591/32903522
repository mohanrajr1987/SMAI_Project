<p>I have two sets of code. For some reason, in the <strong>first one I get an error</strong>, and in the <strong>second one I don't</strong>.</p>  <p>1:</p>  <pre><code>Dim pi As PivotItem Dim pf As PivotField  Set pf = Sheets("Afname per school").PivotTables("Draaitabel3").PivotFields("school")  For Each pi In pf.PivotItems     If pi = "(leeg)" Then         pi.Visible = False     Else         pi.Visible = True 'ERROR HERE     End If Next pi </code></pre>  <p>2:</p>  <pre><code>Dim pi As PivotItem Dim pf As PivotField  Set pf = Sheets("Afname per school").PivotTables("Draaitabel3").PivotFields("naam locatie")  For Each pi In pf.PivotItems     If InStr(pi, "BSO") Then         pi.Visible = True     Else         pi.Visible = False     End If Next pi </code></pre>  <p>I get the error: "unable to get the visible property of the pivotitem class"</p>  <p>I read I should solve this the following:</p>  <blockquote>   <p>This is due to the Pivot table using the cached pivot items instead of   the current one. Make sure the table does not retain any old items. To   do so, right click on your pivot table, click on Data tab and set   "Number of itesm to retain per field" to "None". The code to do so in   VBA is:</p>      <p>Dim pt As PivotTable</p>      <p>pt.PivotCache.MissingItemsLimit = xlMissingItemsNone</p> </blockquote>  <p>I tried to add this line of code in two ways:</p>  <pre><code>Dim pi As PivotItem Dim pf As PivotField  Set pf = Sheets("Afname per school").PivotTables("Draaitabel3").PivotFields("school")  pt.PivotCache.MissingItemsLimit = xlMissingItemsNone  '1st TRY  For Each pi In pf.PivotItems     pt.PivotCache.MissingItemsLimit = xlMissingItemsNone   '2nd TRY     If pi = "(leeg)" Then         pi.Visible = False     Else         pi.Visible = True     End If Next pi </code></pre>  <p>This doesn't seem to solve my problem.</p>