<p>I am writing a method to convert C++ <code>std::map&lt;std::string,std::string&gt;</code> to <code>NSDictionary</code> as below:</p>  <pre><code>NSDictionary* NSDictionaryFromMap(const StringMap&amp; map){     NSMutableDictionary * dict = [NSMutableDictionary dictionary];      NSLog(@"NSDictonaryFromMap() - size:%d", (int)map.size());      for (auto it = map.begin(); it != map.end(); it++){         NSString * key = (0 == it-&gt;first.length())?(@""):(@(it-&gt;first.c_str()));         NSString * value = (0 == it-&gt;second.length())?(@""):(@(it-&gt;second.c_str()));          [dict setObject:value forKey:key];         NSLog(@"NSDictonaryFromMap() - key:%@ value:%@", key, value);     }      NSDictionary * nd = [NSDictionary dictionaryWithDictionary:dict];     dict = NULL;      NSLog(@"NSDictonaryFromMap() - dictionary:%@", nd);     return nd; } </code></pre>  <p>But I got some memory leaks when calling this method. Sorry I cannot post image here. In instrument, it highlights memory leaks on four function calls</p>  <pre><code>NSMutableDictionary * dict = [NSMutableDictionary dictionary]; NSString * key = (0 == it-&gt;first.length())?(@""):(@(it-&gt;first.c_str())); NSString * value = (0 == it-&gt;second.length())?(@""):(@(it-&gt;second.c_str())); [dict setObject:value forKey:key]; </code></pre>  <p>On iOS 7 and iOS 8, there is not any memory leaks, but on iOS 6,  it had. How to fix those leaks for iOS6?</p>  <p>I also posted this issue in Apple Forum: <a href="https://devforums.apple.com/message/1114878#1114878" rel="nofollow">https://devforums.apple.com/message/1114878#1114878</a></p>