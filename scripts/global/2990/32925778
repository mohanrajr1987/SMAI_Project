<p>I've been trying to add new record to database in netbeans using JPA controller generated from entities, but it doesn't seem to work. There is no new row in table when I execute code. I wonder what could be the cause?</p>  <p>Here is my entity class:</p>  <pre><code>@Entity public class Account implements Serializable {     private static final long serialVersionUID = 1L;     @Id     @GeneratedValue(strategy = GenerationType.IDENTITY)     private Integer id;     @Column(unique = true)     private String login;     private String password;     private Integer role;     @OneToMany(mappedBy = "account", cascade = CascadeType.ALL)     private  List&lt;Message&gt; messages;     ... } </code></pre>  <p>Here is create method from jpa controller:</p>  <pre><code>public class AccountJpaController implements Serializable {     private UserTransaction utx = null;     private EntityManagerFactory emf = null;     public AccountJpaController(UserTransaction utx, EntityManagerFactory emf) {         this.utx = utx;         this.emf = emf;     }     public EntityManager getEntityManager() {         return emf.createEntityManager();     }     public void create(Account account) throws RollbackFailureException, Exception {         if (account.getMessages() == null) {             account.setMessages(new ArrayList&lt;Message&gt;());         }         EntityManager em = null;         try {             utx.begin();             em = getEntityManager();             List&lt;Message&gt; attachedMessages = new ArrayList&lt;Message&gt;();             for (Message messagesMessageToAttach : account.getMessages()) {                 messagesMessageToAttach = em.getReference(messagesMessageToAttach .getClass(), messagesMessageToAttach .getId());                 attachedMessages.add(messagesMessageToAttach );             }             account.setMessages(attachedMessages);             em.persist(account);             for (Message messagesMessage : account.getMessages()) {                 Account oldAccountOfMessagesMessage = messagesMessage.getAccount();                 messagesMessage.setAccount(account);                 messagesMessage = em.merge(messagesMessage);                 if (oldAccountOfMessagesMessage != null) {                     oldAccountOfMessagesMessage.getMessages().remove(messagesMessage);                     oldAccountOfMessagesMessage = em.merge(oldAccountOfMessagesMessage);                 }             }             utx.commit();         } catch (Exception ex) {             try {                 utx.rollback();             } catch (Exception re) {                 throw new RollbackFailureException("An error occurred attempting to roll back the transaction.", re);             }             throw ex;         } finally {             if (em != null) {                 em.close();             }         }     }     ... } </code></pre>  <p>Calling create method from controller:</p>  <pre><code>    @ManagedBean     @ApplicationScoped     public class TestJpa implements Serializable {          public TestJpa() {            }             @Resource             UserTransaction utx;             public void test() throws DatabaseException, Exception {                 Account a = new Account();                 a.setLogin("login");                 a.setPassword("password");                 a.setRole(2);                 a.setMessages(new ArrayList&lt;Message&gt;());                 AccountJpaController ac = new AccountJpaController(utx, Persistence.createEntityManagerFactory("muza_prototyp-persistence"));                 ac.create(a);             }         } </code></pre>  <p>And here is my persistence.xml file:</p>  <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;persistence version="2.1" xmlns="http://xmlns.jcp.org/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd"&gt;   &lt;persistence-unit name="muza_prototyp-persistence" transaction-type="JTA"&gt;     &lt;provider&gt;org.eclipse.persistence.jpa.PersistenceProvider&lt;/provider&gt;     &lt;jta-data-source&gt;jdbc/muza_prototyp&lt;/jta-data-source&gt;     &lt;exclude-unlisted-classes&gt;false&lt;/exclude-unlisted-classes&gt;     &lt;properties&gt;       &lt;property name="javax.persistence.schema-generation.database.action" value="create"/&gt;       &lt;property name="eclipselink.ddl-generation" value="create-tables"/&gt;     &lt;/properties&gt;   &lt;/persistence-unit&gt; &lt;/persistence&gt; </code></pre>  <p>I'd appreciate any help.</p>