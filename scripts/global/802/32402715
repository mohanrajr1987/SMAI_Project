<p>My colleague recently ask me to help him with precommit hook which block push to central repo. This is famous <a href="https://hg.python.org/hooks/file/tip/checkheads.py" rel="nofollow">https://hg.python.org/hooks/file/tip/checkheads.py</a></p>  <p>Algorithm of <code>checkheads.py</code> gather heads in branch ignoring changes from another branches by piece:</p>  <pre><code>for x in xrange(p + 1, end):     if repo[x].branch() != branch:         continue </code></pre>  <p>History contains merges from <em>default</em> to <em>prod</em> and then back from <em>prod</em> to <em>default</em>.</p>  <p>So <code>checkheads.py</code> didn't find that changesets merged at <em>default</em> (connected in graph) becase any path from <em>prod</em> branch are stripped and script report several heads in <em>default</em> branch (but <code>hg heads</code> reports single as it is).</p>  <p>My question what useful DVCS workflow require merges between two branches in two way?</p>  <p>Famous <a href="http://nvie.com/posts/a-successful-git-branching-model/" rel="nofollow">http://nvie.com/posts/a-successful-git-branching-model/</a> doesn't have cris-cross merges.</p>  <p>Is it ok to prevent merges back and forth?</p>