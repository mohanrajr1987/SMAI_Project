<p>I have been searching, testing, and coming up with nothing for over a week.  I want to use FFMPEG to convert mp4's and mkv's to AVI files that will play on my DLink DSM-520.  Mencoder will do it. The files that FFMPEG generates cause the player to lock up less than a minute into the video.  First, here's what I use to encode the file using Mencoder (scraped from the test.bat file that PocketDIVXEncoder generates:</p>  <pre><code>mencoder.exe ftwd105.mp4 -af volnorm -srate 44100 -oac mp3lame -lameopts mode=0:cbr:br=128 -noodml -vf pp=ac,scale=720:404,crop=720:400,harddup -sws 9 -ovc lavc -lavcopts vcodec=mpeg4:mbd=1:last_pred=2:vstrict=1:threads=2:vmax_b_frames=0:vbitrate=1200 -ffourcc XVID -o ftwd105_HDTV.avi </code></pre>  <p>The output file plays perfectly on the DSM-520. Looking at the file using FFPROBE, I see this:</p>  <pre><code>Input #0, avi, from 'ftwd105_HDTV.avi':   Metadata:     encoder         : MEncoder Redxii-SVN-r37527-4.9.3 (x86_64)   Duration: 00:44:32.96, start: 0.000000, bitrate: 1193 kb/s     Stream #0:0: Video: mpeg4 (Simple Profile) (XVID / 0x44495658), yuv420p, 720x400 [SAR 1:1 DAR 9:5], 1053 kb/s, 23.98 fps, 23.98 tbr, 23.98 tbn, 24k tbc     Stream #0:1: Audio: mp3 (U[0][0][0] / 0x0055), 44100 Hz, stereo, s16p, 128 kb/s </code></pre>  <p>So now I try the same thing with FFMPEG.</p>  <pre><code>ffmpeg -i ftwd105.mp4 -vcodec mpeg4 -vtag XVID -b:v 1200k -s 720x400 -acodec libmp3lame -ab 128k -ar 44100 -ac 2 -f avi ftwd105_ffmpeg.avi </code></pre>  <p>This file does not play on the media player. It plays choppy with only clicking for sound for about 15-30 seconds, then it freezes.  Looking at it with FFPROBE, it looks exactly the same as the one created by Mencoder.</p>  <pre><code>Input #0, avi, from 'ftwd105_ffmpeg.avi':   Metadata:     encoder         : Lavf57.0.100   Duration: 00:44:33.14, start: 0.000000, bitrate: 1305 kb/s     Stream #0:0: Video: mpeg4 (Simple Profile) (XVID / 0x44495658), yuv420p, 720x400 [SAR 1:1 DAR 9:5], 1165 kb/s, 23.98 fps, 23.98 tbr, 23.98 tbn, 24k tbc     Stream #0:1: Audio: mp3 (U[0][0][0] / 0x0055), 44100 Hz, stereo, s16p, 128 kb/s </code></pre>  <p>So now I encode the video using Xvid4PSP. It plays perfectly fine and FFPROBE shows this:</p>  <pre><code>Input #0, avi, from 'ftwd105_ps2.avi':   Metadata:     encoder         : VirtualDubMod 1.5.10.3 | www.virtualdub-fr.org || (build 2550/release)   Duration: 00:44:33.09, start: 0.000000, bitrate: 861 kb/s     Stream #0:0: Video: mpeg4 (Advanced Simple Profile) (XVID / 0x44495658), yuv420p, 720x400 [SAR 1:1 DAR 9:5], 723 kb/s, 23.98 fps, 23.98 tbr, 23.98 tbn, 23.98 tbc     Stream #0:1: Audio: mp3 (U[0][0][0] / 0x0055), 48000 Hz, stereo, s16p, 128 kb/s </code></pre>  <p>It's using Advanced Simple Profile so I look this up and change my FFMPEG options:</p>  <pre><code>ffmpeg -i ftwd105.mp4 -vcodec mpeg4 -vtag XVID -b:v 1200k -s 720x400 -profile:v 15 -level 0 -acodec libmp3lame -ab 128k -ar 44100 -ac 2 -f avi ftwd105_ffmpeg.avi </code></pre>  <p>But though the output file looks the same using FFPROBE as the one made by Xvid4PSP, it still doesn't play on the DSM-520.</p>  <pre><code>Input #0, avi, from 'ftwd105_ffmpeg_asp.avi':   Metadata:     encoder         : Lavf57.0.100   Duration: 00:44:33.14, start: 0.000000, bitrate: 1305 kb/s     Stream #0:0: Video: mpeg4 (Advanced Simple Profile) (XVID / 0x44495658), yuv420p, 720x400 [SAR 1:1 DAR 9:5], 1165 kb/s, 23.98 fps, 23.98 tbr, 23.98 tbn, 24k tbc     Stream #0:1: Audio: mp3 (U[0][0][0] / 0x0055), 44100 Hz, stereo, s16p, 128 kb/s </code></pre>  <p>So now i'm at a loss. Is FFMPEG incapable of generating a file that the DSM-520 can play? The reason I want to use FFMPEG over Mencoder is that it's much faster. What takes FFMPEG 15 minutes takes Mencoder 40.</p>  <p>I should note that all the files created by FFMPEG play fine on the PC and on my Visio television.  The DSM-520 is hooked up to a bedroom tv that isn't a smart tv.</p>