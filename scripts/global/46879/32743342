<p>I hope that someone could help me out with my problem. I'm kind of stuck and don't know where to go from here. </p>  <p>I'm writing an app for parsing an xml file generated by krpano to allow certain actions be done without digging though the code. </p>  <p>The way the xml file is structured is by having multiple  tags and they correspond to each panorama.</p>  <p>I have a simple TKinter app that loads an xml, displays thumbnails, allows to move them around, add hotspots, delete scenes and saves it at the end. The problem starts at the function that moves scenes. I have  a drag and drop functionality, but in the interest of space, I'll post a test function that was written first and that moves scenes just by one position. </p>  <pre><code>from bs4 import BeautifulSoup  def load_xml(self):     f = tkFileDialog.askopenfile()     self.xml = BeautifulSoup(f,"xml") #Tried lxml and html5lib already     self.file_path = os.path.dirname(os.path.abspath(f.name))     return self.xml  def move_scene(self, scene_name, direction):      """Direction should be 1 for forward, -1 for backward."""     scenes = self.xml.find_all('scene')     for i, scene in enumerate(scenes):         if scene['name'] == scene_name:             if direction == 1:                 scenes[i+1].insert_after(scene)             else:                 scenes[i-1].insert_before(scene)     self.show_thumbs() </code></pre>  <p>And here is show_thumbs function</p>  <pre><code>def show_thumbs(self):     if not getattr(self, 'xml', None):         self.load_xml()     self.images = []     all_scenes = self.xml.find_all('scene')     ... </code></pre>  <p>The problems shows itself at <code>self.xml.find_all('scene')</code> part of <code>show_thumbs</code> function. When the image is moved forward(<code>insert_after</code> is used), it would always skip a scene ahead of which the current scene was moved and it wouldnt list it in <code>all_scenes</code>. It would show up if I printed <code>xml.prettify()</code> though... And if I save that output into xml file and reopen the app, the thumbnails would all be displayed properly according to how I moved them around before.</p>  <p>When <code>insert_before</code> is used, the find_all would just hang and not do anything past itself. Once again, prettify shows correct output.</p>  <p>Here is a <a href="http://krpano.com/tours/corfu/tour.xml" rel="nofollow">test xml file</a> that I'm using. I hope that someone can point me in the right direction. Let me know if you need more code posted and I'll oblige. </p>