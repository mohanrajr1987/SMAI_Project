<p>I need to use FTP Command Function from <code>wininet.dll</code> to send some FTP command. It's working when I use <code>QUIT</code> command. But when I try to use for example <code>LS</code> or <code>DIR</code> I get response 0. </p>  <pre><code>Private Declare Function FtpCommand Lib "wininet.dll" Alias "FtpCommandA" (ByVal hConnect As Long, ByVal fExpectResponse As Long, ByVal dwFlags As Long, ByVal lpszCommand As String, ByVal dwContext As Long, phFtpCommand As Long) As Long  Private Function test()     Dim Success As Long     Dim iRet As Integer     Dim lngInet As Long     Dim lngInetConn As Long     Dim sCommand As String     Dim test44 As Long     sCommand = "DIR"     Dim test5 As Long     Dim lError As Long     Dim strBuffer As String     Dim lBufferSize As Long     Dim retVal As Long     lngInet = InternetOpen("MyFTP Control", 1, vbNullString, vbNullString, 0)   'Open connection with fpt     If lngInet = 0 Then         iRet = MsgBox("bad")     Else         lngInetConn = InternetConnect(lngInet, Server.Value, 0, _             User.Value, Pass.Value, 1, 0, 0)                                 'Connect to server         If lngInetConn &gt; 0 Then             Login = True             blnRC = FtpCommand(lngInetConn, True, FTP_TRANSFER_TYPE_ASCII, sCommand, test44, test5)             retVal = InternetGetLastResponseInfo(lError, strBuffer, lBufferSize)         Else             Login = False             LoginError         End If     End If     InternetCloseHandle (lngInet)   'Close Ftp I thnik is not necessary     InternetCloseHandle (lngInetConn)   'Close Connection I thnik is not necessary End Function </code></pre>