<p>I have created a C# application for downloading file from FTP. I could not download files having size greater than 1 MB. I got an error "Data is corrupted" while downloading the file. Here is my code for download.</p>  <pre><code>int count = 0; do {     byte[] buffer = new byte[1024];     conn.ReadTimeout = 15000000;     count = istream.Read(buffer, 0, buffer.Length);     memoryStream.Write(buffer, 0, count); } while (istream.CanRead &amp;&amp; count &gt; 0);  byteArray = memoryStream.ToArray(); var workBook = new XLWorkbook(memoryStream); var workSheet = workBook.Worksheets.First(); </code></pre>  <p><a href="http://i.stack.imgur.com/RF9CD.png" rel="nofollow"><img src="http://i.stack.imgur.com/RF9CD.png" alt="enter image description here"></a></p>