<p>I never used proguard before, and now force to use it due to the nasty Samsung bug: <a href="https://code.google.com/p/android/issues/detail?id=78377" rel="nofollow">https://code.google.com/p/android/issues/detail?id=78377</a></p>  <p>So, basically, I followed all the explanations, and added this in my gradle file:</p>  <pre><code>buildTypes {     release {         minifyEnabled true         proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'      } } </code></pre>  <p>and my file contains the line I need to workaround the above bug:</p>  <pre><code>-keep class !android.support.v7.internal.view.menu.**,** {*;} </code></pre>  <p><a href="http://i.stack.imgur.com/nubfe.png" rel="nofollow"><img src="http://i.stack.imgur.com/nubfe.png" alt="enter image description here"></a></p>  <p>Note: I have followed many and many proguard template files, and tried a lot of code there, so don't know what to do.</p>  <p>The app compiles just fine in debug, on my phone, but once I try to compile the apk and upload it, I got this error:</p>  <pre><code>IllegalStateException: You need to use a Theme.AppCompat theme (or descendant) with this activity. </code></pre>  <p>Please, do not point me to the style.xml, the Theme IS Appcompat, and it works fine on debug.</p>  <p>Thank a lot for any help, or hint.</p>