<p>I have two conditions for my VB.NET code. There could be many  more than one <code>InterimConditionEvent</code> each with or without <code>ExpirationDate</code> child element in XML document.  I need to find <code>ExpirationDate</code> for the last <code>InterimConditionEvent</code> in the XML document.  If the last <code>InterimConditionEvent</code> does not have a <code>ExpirationDate</code> then find the previous <code>InterimConditionEvent</code> with <code>ExpirationDate</code>.</p>  <p><strong>how do I find the preceding <code>InterimConditionEvent</code> before the last one?</strong> </p>  <p><strong>My xml</strong></p>  <pre><code>&lt;Integration xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:tsg="http://tsgweb.com" xmlns:IXML="http://tsgweb.com" xmlns:CMCodeQueryHelper="urn:CMCodeQueryHelper"&gt; &lt;Case InternalID="1617095448" ID="12131576" xmlns:user="http://tylertechnologies.com"&gt;     &lt;InterimConditionEvent ID="160850209"&gt;         &lt;OrderDate&gt;08/14/2015&lt;/OrderDate&gt;         &lt;ExpirationDate&gt;08/14/2015&lt;/ExpirationDate&gt;         &lt;Deleted&gt;true&lt;/Deleted&gt;         &lt;InterimCondition&gt;             &lt;ConditionType Word="DOMNC"&gt;Domestic No Contact&lt;/ConditionType&gt;             &lt;EffectiveDate&gt;8/14/2015&lt;/EffectiveDate&gt;             &lt;EndDate&gt;8/14/2015&lt;/EndDate&gt;         &lt;/InterimCondition&gt;     &lt;/InterimConditionEvent&gt;     &lt;InterimConditionEvent ID="160850210"&gt;         &lt;OrderDate&gt;08/14/2015&lt;/OrderDate&gt;         &lt;Deleted&gt;true&lt;/Deleted&gt;         &lt;InterimCondition&gt;             &lt;ConditionType Word="DOMNC"&gt;Domestic No Contact&lt;/ConditionType&gt;             &lt;EffectiveDate&gt;8/14/2015&lt;/EffectiveDate&gt;             &lt;EndDate&gt;8/14/2000&lt;/EndDate&gt;         &lt;/InterimCondition&gt;     &lt;/InterimConditionEvent&gt; &lt;/Case&gt; </code></pre>  <p></p>  <p><strong>VB.NET Code</strong></p>  <pre><code>If Not objXmlCaseDoc.DocumentElement.SelectSingleNode("Case/InterimConditionEvent[(Deleted='true') and (InterimCondition/ConditionType/@Word='DOMNC')][position()=last()]/ExpirationDate") Is Nothing Then                         strOrderEndDate = objXmlCaseDoc.DocumentElement.SelectSingleNode("Case/InterimConditionEvent[(Deleted='true') and (InterimCondition/ConditionType/@Word='DOMNC')][position()=last()]/ExpirationDate").InnerText                     Else                         strOrderEndDate = objXmlCaseDoc.DocumentElement.SelectSingleNode("Case/InterimConditionEvent[position()=last()]/ExpirationDate").InnerText                     End If </code></pre>  <p>How do I change the following <code>Else</code> statement to include and has an <code>ExpirationDate</code> element</p>  <pre><code>strOrderEndDate = objXmlCaseDoc.DocumentElement.SelectSingleNode("Case/InterimConditionEvent/[position()=last()/ExpirationDate").InnerText </code></pre>