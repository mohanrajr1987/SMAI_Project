<p>I want to configure a redirect page on nginx.</p>  <p>I have some URLs here:</p>  <pre><code>http://example.com/target/section_a/P001 -&gt; not existing, return 404 http://example.com/target/section_b/P001 -&gt; not existing, return 404 http://example.com/target/section_c/P001 -&gt; existing, return 200 http://example.com/target/section_d/P001 -&gt; not existing, return 404 http://example.com/target/section_e/P001 -&gt; not existing, return 404 http://example.com/target/section_f/P001 -&gt; not existing, return 404 </code></pre>  <p>I want to redirect <a href="http://example.com/target/P001" rel="nofollow">http://example.com/target/P001</a> to <a href="http://example.com/target/" rel="nofollow">http://example.com/target/</a>{section}/P001</p>  <p>{section} is section_c in this case because <a href="http://example.com/target/section_c/P001" rel="nofollow">http://example.com/target/section_c/P001</a> exists, then redirect to that page</p>  <hr>  <p>other case:</p>  <pre><code>http://example.com/target/section_a/P002 -&gt; not existing, return 404 http://example.com/target/section_b/P002 -&gt; not existing, return 404 http://example.com/target/section_c/P002 -&gt; not existing, return 404 http://example.com/target/section_d/P002 -&gt; not existing, return 404 http://example.com/target/section_e/P002 -&gt; existing, return 200 http://example.com/target/section_f/P002 -&gt; not existing, return 404  http://example.com/target/P002 will redirect to http://example.com/target/section_e/P002 </code></pre>  <hr>  <pre><code>http://example.com/target/section_a/P003 -&gt; not existing, return 404 http://example.com/target/section_b/P003 -&gt; not existing, return 404 http://example.com/target/section_c/P003 -&gt; not existing, return 404 http://example.com/target/section_d/P003 -&gt; not existing, return 404 http://example.com/target/section_e/P003 -&gt; not existing, return 404 http://example.com/target/section_f/P003 -&gt; not existing, return 404 </code></pre>  <p>If all pages do not exist, no redirect needed.</p>  <p>Can nginx store a array? such as array <code>('section_a', 'section_b', 'section_c', 'section_d', 'section_e', 'section_f')</code></p>  <p>Then loop <a href="http://example.com/target/" rel="nofollow">http://example.com/target/</a>{section}/P001, if exists then redirect.</p>  <p>My draft:</p>  <pre><code>server {     server_name example.com;     index index.html index.htm index.php;      location ~ ^/target/!(section_a|section_b|section_c...)/(.*)/ { // prevent infinite loop         // loop array, if existing then rewrite         rewrite ^/target/(.*)/ http://$server_name/target/{section}/$1 permanent;     } } </code></pre>