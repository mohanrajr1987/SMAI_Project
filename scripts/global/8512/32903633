<p>I have a matrix like this:  </p>  <pre><code>Group   A   1   |   1   5   |   2   1   |   3   2   |   4   4   |   5   2   |   6   2   |   7   3   |   8   2   |   9   3   |   10   5   |   11   1   |   12  </code></pre>  <p>In this matrix A column is items and Group is the groups of A column. I have another matrix like this:  </p>  <pre><code>A    Value   1   |   5   2   |   3.5   3   |   2   4   |   0   5   |   1   6   |   2.5   7   |   4   8   |   3   9   |   0   10  |   0   11  |   1.5   12  |   0  </code></pre>  <p>Expected result:</p>  <pre><code>A    Value   1   |   5   2   |   3.5   3   |   2   4   |   3.25   5   |   1   6   |   2.5   7   |   4   8   |   3   9   |   3.25   10  |   3  11  |   1.5   12  |   3.5  </code></pre>  <p><em>I find from first Matrix that 1, 3, and 12 have same group, and then for calculate the value of 12 I Calculate average of values of 1 and 3.</em></p>  <p>In the second matrix value column is value of column A, I want to calculate zero values for every Item in A column with average of other items in the same group.  I used this:  </p>  <pre><code>for h=1:size(Matrix2,1)     group=find(Matrix1(:,1)==Matrix2(h,1));     group_items=find(Matrix1(:,2)==Matrix1(group,2));     f=ismember(Matrix2(:,1),Matrix1(group_items,1));     if Matrix2(h,2)==0         Matrix2(h,2)=sum(Matrix2(f,2))/size(nonzeros(f),1);     end end </code></pre>  <p>but this is very slow when the second matrix is large. Is there a faster way?</p>