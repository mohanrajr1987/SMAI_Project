<p>I've setup consul (<a href="http://consul.io/" rel="nofollow">http://consul.io/</a>) and dnsmasq so that I can have my own internal dns resolution.  I have tested with dig that consul supports reverse dns lookups:</p>  <pre><code>$ dig @127.0.0.1 -p 8600 +noall +answer -x  11.0.16.69 69.16.0.11.in-addr.arpa. 0      IN      PTR     ip-11-0-16-69.node.dc1.consul. </code></pre>  <p>However reverse dnslookups through dnsmasq fail. How do I configure dnsmasq to forward reverse lookup entries to consul?</p>  <p>I'm currently running consul with default configurations.  Each node has a consul agent started like so:</p>  <pre><code>consul agent -data-dir=/tmp/consul -bind &lt;ip&gt; -node &lt;short hostname&gt; </code></pre>  <p>Dnsmasq is running on each node with default configurations except for a single setting to forward dns requests to consul at port 8600.  There is a file at <code>/etc/dnsmasq.d/10-consul</code> that does this with content:</p>  <pre><code>server=/consul/127.0.0.1#8600 </code></pre>  <p>Finally, I added an entry in <code>/etc/resolve.conf</code> to point to localhost so dnsmasq is used:</p>  <pre><code>search us-gov-west-1.compute.internal nameserver 127.0.0.1 nameserver 11.0.0.2 </code></pre>  <p>I'm on AWS and it is vital that I can still leverage the dns service they provide in their environment as well as my own internal dns scheme.  </p>