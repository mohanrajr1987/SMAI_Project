<p>I'm trying to download the rendered HTML in <strong>.docx</strong> format. Its working fine when I try to download in <strong>.doc</strong> format. I need to download file in <strong>.docx</strong> format instead of <strong>.doc</strong></p>  <p>Below is my code when I try to download in <strong>.doc</strong> format:</p>  <pre><code>header('Content-Type: application/octet-stream'); header("Content-Disposition: attachment;filename=someName.doc"); header('Cache-Control: max-age=0'); header_remove('Pragma');  $this-&gt;renderPartial('viewExport', array(       'briefingId' =&gt; $briefingId )); </code></pre>  <p>Below is my code when I try to download in <strong>.docx</strong> format:</p>  <pre><code>header('Content-Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document'); header("Content-Disposition: attachment;filename=someName.docx"); header('Cache-Control: max-age=0'); header_remove('Pragma'); $this-&gt;renderPartial('viewExport', array(        'briefingId' =&gt; $briefingId )); </code></pre>  <p>Here is my ViewExport code:</p>  <pre><code>&lt;style type="text/css"&gt;     .container {         margin-left: auto;         margin-right: auto;         width: 940px;     }      .table th, .table td {         line-height: 20px;         text-align: left;         padding: 8px;     }      .table td {         border: 0;     }      ul {         font-size: 12px;         font-weight: 400;         font-style: normal;     }      p {         margin: 0;     }      li.name {         font-size: 10pt;         margin-bottom: 10px;     }      body {         font-family: Arial, Helvetica, sans-serif;         font-size: 12px;         line-height: 18px;     }      .center {         font-family: Arial, Helvetica, sans-serif;     }      .briefing-info, {         font-family: Arial, Helvetica, sans-serif;      }      table.agenda &gt; tr &gt; td {         padding-bottom: 1em;     }  &lt;/style&gt;   &lt;?php $agendaAttendeeInfo = AgendaItem::model()-&gt;getAgendaExportData($briefingId); $this-&gt;renderPartial('view', $agendaAttendeeInfo); ?&gt; </code></pre>  <p>Here is my view code:</p>  <pre><code>&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt; &lt;?php $wordForBriefing = HtmlHelper::encodeForXss(Yii::app()-&gt;settings-&gt;get("briefing", "wordForBriefing")); ?&gt; &lt;style type="text/css"&gt;     .header {         padding-top: 10px;         padding-bottom: 10px;     }      .left-logo, .right-logo {         width: 200px;     }      .left-logo img, .right-logo img {         vertical-align: top;     }      .right-logo {         text-align: right;     }      .center-head {         text-align: center;         color: #808080;         font-size: 16pt;         font-family: Arial, Helvetica, sans-serif;     }      .briefing-info {         color: #808080;         font-size: 10pt;         font-weight: bold;         font-family: Arial, Helvetica, sans-serif;     }      .attendee-header {         color: #000000;         font-size: 12pt;         font-weight: bold;     }      .table td {         border: 0;      }      .job-title {         font-style: italic;         color: #808080;         font-size: 10pt;     }      .name {         font-size: 10pt;         padding-bottom: 10px;     }      .other-than-topic {         font-weight: bold;         font-style: italic;     }      p {         margin: 0;     }      .name .time {         width: 200px;     }      .name .topic {         width: 380px;     }      .name .speaker {         width: 330px;     } &lt;/style&gt; &lt;div class="container"&gt; &lt;?php if(Yii::app()-&gt;settings-&gt;get("agenda", 'addInternalAttendeeListToAgenda') || Yii::app()-&gt;settings-&gt;get("agenda", 'addExternalAttendeeListToAgenda')) { ?&gt;     &lt;div class='header'&gt;         &lt;table width="100%"&gt;             &lt;tr&gt;                 &lt;td class='left-logo'&gt;                     &lt;?php                     $imageUrl = Yii::getPathOfAlias('application.images') . "/logo.png";                     $imageDimensions = Util::calculateImageDimensions($imageUrl);                     $logo = Yii::app()-&gt;getBaseUrl(true) . "/images/logo.png";                     echo CHtml::image($logo, '', array('height' =&gt; $imageDimensions[1], 'width' =&gt; $imageDimensions[0]));                     ?&gt;                &lt;/td&gt;                 &lt;td class='center-head'&gt;                     Welcome&lt;br/&gt;                     &lt;span style="font-weight: bold"&gt;                         &lt;?php                         if ($customerCompany != '')                             echo $customerCompany;                         ?&gt;                     &lt;/span&gt;                 &lt;/td&gt;                 &lt;td class='right-logo'&gt;                     &lt;?php                     if (!empty($briefing['customer_logo'])) {                         $imageUrl = Yii::app()-&gt;settings-&gt;get('upload', 'baseUploadPath') . 'briefings/' . $briefing['customer_logo'];                         $imageDimensions = Util::calculateImageDimensions($imageUrl);                         $customerLogo = $this-&gt;createAbsoluteUrl('briefing/downloadUploadedFile', array('fileName' =&gt; $briefing['customer_logo']));                         echo CHtml::image($customerLogo, '', array('height' =&gt; $imageDimensions[1], 'width' =&gt; $imageDimensions[0]));                     }                     ?&gt;                 &lt;/td&gt;             &lt;/tr&gt;         &lt;/table&gt;     &lt;/div&gt;     &lt;div style="margin-bottom: 20px"&gt;         &lt;div align="center" class="briefing-info"&gt;             &lt;?php             if ($briefing['scheduled_date'])                 echo date('l, F d, Y', strtotime($briefing['scheduled_date']));             ?&gt; &lt;br&gt;             &lt;?php echo $wordForBriefing; ?&gt; Room:             &lt;?php             if ($briefing['roomName'])                 echo $briefing['roomName'];             ?&gt; &lt;br&gt;             &lt;?php echo $wordForBriefing; ?&gt; Number:             &lt;?php echo $briefing['id']; ?&gt;         &lt;/div&gt;     &lt;/div&gt; &lt;?php } ?&gt; &lt;table class='table'&gt;     &lt;tbody&gt;      &lt;?php if ($externalAttendees &amp;&amp; Yii::app()-&gt;settings-&gt;get("agenda", 'addExternalAttendeeListToAgenda')) { ?&gt;         &lt;?php foreach ($externalAttendees as $company =&gt; $attendees) { ?&gt;             &lt;tr&gt;                 &lt;td class="attendee-header"&gt;                     &lt;p&gt;                         &lt;?php echo $company . " - Attendees" ?&gt;                     &lt;/p&gt;                 &lt;/td&gt;             &lt;/tr&gt;             &lt;tr&gt;                 &lt;td&gt;                     &lt;ul&gt;                         &lt;?php foreach ($attendees as $attendee) { ?&gt;                             &lt;?php                             $attendeeName = $attendee['name'];                             $attendeeName .= empty($attendee['job_title']) ? "" : ", &lt;span class='job-title'&gt;" . $attendee['job_title'] . "&lt;/span&gt;";                             echo CHtml::openTag('li', array('class' =&gt; 'name')) . $attendeeName . CHtml::closeTag('li');                             ?&gt;                         &lt;?php } ?&gt;                     &lt;/ul&gt;                 &lt;/td&gt;             &lt;/tr&gt;         &lt;?php } ?&gt;     &lt;?php }      if(Yii::app()-&gt;settings-&gt;get("agenda", 'addInternalAttendeeListToAgenda')) {         ?&gt;          &lt;tr&gt;             &lt;td class="attendee-header"&gt;                 &lt;p&gt;&lt;?php echo Yii::app()-&gt;settings-&gt;get('general', 'companyName'); ?&gt; - Attendees&lt;/p&gt;             &lt;/td&gt;         &lt;tr&gt;             &lt;td&gt;                 &lt;ul&gt;                     &lt;?php                     if ($internalAttendees) {                         foreach ($internalAttendees as $attendee) {                             $attendeeName = $attendee['name'];                             $attendeeName .= empty($attendee['job_title']) ? "" : ", &lt;span class='job-title'&gt;" . $attendee['job_title'] . "&lt;/span&gt;";                             echo CHtml::openTag('li', array('class' =&gt; 'name')) . $attendeeName . CHtml::closeTag('li');                         }                     } else                         echo "No Attendees";                     ?&gt;                 &lt;/ul&gt;             &lt;/td&gt;         &lt;/tr&gt;     &lt;?php } ?&gt;     &lt;/tbody&gt; &lt;/table&gt;  &lt;?php $briefingRooms = BriefingRoom::model()-&gt;forBriefing($briefing['id'])-&gt;findAll(); $briefingRooms = CHtml::listData($briefingRooms, 'briefing_date', 'room.name');  $briefingModel = Briefing::model()-&gt;findByPk($briefing['id']); $briefingDuration = $briefingModel-&gt;getTotalBriefingDuration();  foreach($briefingDuration as $date =&gt; $briefingData){     ?&gt;     &lt;br clear=all style='mso-special-character:line-break;page-break-before:always'&gt;     &lt;div&gt;         &lt;table width="100%"&gt;             &lt;tr&gt;                 &lt;td class='left-logo'&gt;                     &lt;?php                     $imageUrl = Yii::getPathOfAlias('application.images') . "/logo.png";                     $imageDimensions = Util::calculateImageDimensions($imageUrl);                     $logo = Yii::app()-&gt;getBaseUrl(true) . "/images/logo.png";                     echo CHtml::image($logo, '', array('height' =&gt; $imageDimensions[1], 'width' =&gt; $imageDimensions[0]));                     ?&gt;                 &lt;/td&gt;                 &lt;td class='center-head'&gt;                     Welcome &lt;br/&gt;                      &lt;div&gt;                             &lt;span style="font-weight: bold"&gt;                             &lt;?php                             if ($customerCompany != '')                                 echo $customerCompany;                             ?&gt;                             &lt;/span&gt;                     &lt;/div&gt;                 &lt;/td&gt;                 &lt;td class='right-logo'&gt;                     &lt;?php                     if (!empty($briefing['customer_logo'])) {                         $imageUrl = Yii::app()-&gt;settings-&gt;get('upload', 'baseUploadPath') . 'briefings/' . $briefing['customer_logo'];                         $imageDimensions = Util::calculateImageDimensions($imageUrl);                         $customerLogo = $this-&gt;createAbsoluteUrl('briefing/downloadUploadedFile', array('fileName' =&gt; $briefing['customer_logo']));                         echo CHtml::image($customerLogo, '', array('height' =&gt; $imageDimensions[1], 'width' =&gt; $imageDimensions[0]));                     }                     ?&gt;                 &lt;/td&gt;             &lt;/tr&gt;         &lt;/table&gt;     &lt;/div&gt;     &lt;div style="margin-bottom: 20px"&gt;         &lt;div align="center" class="briefing-info"&gt;             &lt;?php             if ($briefingData['scheduled_date']) {                 $date = new DateTime($date);                 echo $date-&gt;format("l, F d, Y");             }             ?&gt; &lt;br&gt;             &lt;?php echo $wordForBriefing; ?&gt; Room:             &lt;?php             echo (isset($briefingRooms[$date-&gt;format("Y-m-d")])) ? $briefingRooms[$date-&gt;format("Y-m-d")] : $briefing['roomName'];             ?&gt; &lt;br&gt;             &lt;?php echo $wordForBriefing; ?&gt; Number:             &lt;?php echo $briefing['id']; ?&gt;         &lt;/div&gt;     &lt;/div&gt;     &lt;table class="agenda"&gt;         &lt;?php         foreach ($agendaItems as $agendaItem) {             $agendaDate = new DateTime($agendaItem['agenda_date']);             ?&gt;             &lt;?php if ($agendaDate == $date) { ?&gt;                 &lt;tr class="name"&gt;                     &lt;td style="vertical-align: top;" class="time"&gt;                         &lt;?php echo date("h:i a", strtotime($agendaItem['start_time'])); ?&gt;                     &lt;/td&gt;                     &lt;td style="vertical-align: top;" class="topic"&gt;                         &lt;?php                          if ($agendaItem['type'] != AgendaItem::TYPE_TOPIC &amp;&amp; $agendaItem['type'] != AgendaItem::TYPE_CONFERENCING) {                             ?&gt;                             &lt;span class='other-than-topic'&gt;                         &lt;?php                         if (empty($agendaItem['display_title']) &amp;&amp; empty($agendaItem['meal_type'])) {                             echo ucfirst(strtolower($agendaItem['type']));                         } else if (empty($agendaItem['display_title'])) {                             echo trim($agendaItem['meal_type']);                         } else {                             echo trim($agendaItem['display_title']);                         }                         ?&gt;                         &lt;/span&gt;                         &lt;?php                         } else {                             echo empty($agendaItem['display_title']) ? trim($agendaItem['topic']) : trim($agendaItem['display_title']);                         }                         ?&gt;                     &lt;/td&gt;                     &lt;td style="vertical-align: top;" class="speaker"&gt;                         &lt;?php                         $agendaItemSpeakersWithTitles = AgendaItemSpeaker::model()-&gt;getAgendaItemSpeakersForAgenda($agendaItem['agendaId']);                         $speakers = array();                         foreach ($agendaItemSpeakersWithTitles as $speaker) {                             $speakerNameWithTitle = $speaker['name'];                             $speakerNameWithTitle .= empty($speaker['job_title']) ? '' : ', &lt;span class="job-title"&gt;' . $speaker['job_title'] . '&lt;/span&gt;';                             $speakers[] = $speakerNameWithTitle;                         }                         echo implode("&lt;br/&gt;", $speakers);                         ?&gt;                     &lt;/td&gt;                 &lt;/tr&gt;             &lt;?php } ?&gt;         &lt;?php } ?&gt;     &lt;/table&gt; &lt;?php } ?&gt; &lt;?php $agendaCount = isset($agendaItems) ? count($agendaItems) : 0; ?&gt; &lt;/div&gt;  &lt;script type="text/javascript"&gt;     window.onload = function () {         var print = &lt;?php echo isset($_GET['print']) ? $_GET['print'] : 0; ?&gt;;         if (print == 1) {             window.print();         }     }; &lt;/script&gt; </code></pre>