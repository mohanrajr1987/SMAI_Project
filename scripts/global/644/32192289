<p>I've been working on this for several hours, and I trust that you, the community, will be able to come up with the logic for the following:</p>  <p><strong>XML Nodes</strong></p>  <pre><code>&lt;Main&gt;  &lt;Info&gt;   &lt;Class Discipline="PHIL" Number="100" Gpa_grade_pts="3" Id_num="0030" Gpa_credits="3" &gt;   &lt;Class Discipline="HIST" Number="103" Gpa_grade_pts="6" Id_num="0005" Gpa_credits="3" &gt;   &lt;Class Discipline="HIST" Number="262" Gpa_grade_pts="9" Id_num="0026" Gpa_credits="3" &gt;  &lt;/Info&gt;  &lt;Section&gt;   &lt;Class Discipline="HIST" Number="103" Credits="3" Id_num="0030" Code="BAD"/&gt;   &lt;Class Discipline="HIST" Number="111" Credits="3" Id_num="0005" Code="GOOD"/&gt;   &lt;Class Discipline="HIST" Number="262" Credits="3" Id_num="0026" Code="BAD"  &lt;/Section&gt; &lt;/Main&gt; </code></pre>  <p>I need to essentially loop through and find courses where /Section/Class/Code="BAD" and EXCLUDE these from the following XSL (GPA) calculation...</p>  <p><strong>XSL</strong></p>  <pre><code> &lt;xsl:variable name="IdNum"&gt;   &lt;xsl:value-of select="Section/Class[@Code = 'BAD']/@Id_num" /&gt;    &lt;/xsl:variable&gt;     &lt;xsl:variable name="GpaGradePts"&gt;   &lt;xsl:value-of select="sum(Info/Class[@Id_num != $IdNum]/@Gpa_grade_pts)" /&gt;  &lt;/xsl:variable&gt;   &lt;xsl:variable name="GpaCredits"&gt;   &lt;xsl:value-of select="sum(Info/Class[@Id_num != $IdNum]/@Gpa_credits)" /&gt;  &lt;/xsl:variable&gt;   &lt;xsl:variable name="Gpa"&gt;   &lt;xsl:value-of select='format-number($GpaGradePts div $GpaCredits, "#.00")' /&gt; &lt;!-- New GPA --&gt;  &lt;/xsl:variable&gt;   &lt;!-- Display the new value --&gt;   &lt;xsl:value-of select="$Gpa" /&gt; </code></pre>  <p>Summary: </p>  <p>I need to compare the Id_num nodes from each respective portion of the XML, determine which Codes are "BAD".. and then exclude those courses from the GPA calculation. My logic only works if there is a single /Section/Class[@CODE='BAD']/@Id_num returned, thus I need to find a way for all "BAD" courses to be != (not included) in the calculation. </p>  <p>Using xsl version 1.0.</p>