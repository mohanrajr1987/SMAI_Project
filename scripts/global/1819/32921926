<p>I'm trying to update two circles on the map according to the user input of two locations. The circles update only the second time I hit the submit button and they are showing the location of the previous two locations entered. I guess the global markers are updated only at the end of the function but I can't see why.</p>  <pre><code>&lt;!DOCTYPE html&gt; &lt;html&gt;   &lt;head&gt;      &lt;meta name="viewport" content="initial-scale=1.0, user-scalable=no"&gt;     &lt;meta charset="UTF-8"&gt;     &lt;title&gt;map panel&lt;/title&gt;      &lt;link rel='shortcut icon' type='image/x-icon' href='img/favicon.ico'/&gt;     &lt;link rel="stylesheet" href="css/reset.css"&gt;     &lt;link rel='stylesheet prefetch' href='http://getbootstrap.com/dist/css/bootstrap.min.css'&gt;     &lt;link rel="stylesheet" href="css/style.css"&gt;     &lt;style&gt;       html, body {         overflow: hidden;         height: 100%;         margin: 0px;         padding:0px;         width: 100%;         float: left;       }       &lt;/style&gt;   &lt;script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=visualization&amp;sensor=true_or_false"&gt; &lt;/script&gt; &lt;script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true&amp;libraries=geometry"&gt;&lt;/script&gt;  &lt;script&gt;          var map;      //tel aviv     var distLatLng = {lat: 32.072369, lng: 34.783513};     //Binyamina     var distLatLng2 = {lat: 32.521128, lng: 34.945219};      var distmarker = new google.maps.Marker({position: distLatLng});     var distmarker2 = new google.maps.Marker({position: distLatLng2});       var geocoder = new google.maps.Geocoder();      var DistCircle1 = new google.maps.Circle({ strokeColor: 'rgb(255, 255, 0)', strokeOpacity: 0.9, strokeWeight: 2, fillColor: 'rgb(255, 255, 0)', fillOpacity: 0.10, map: map, center: distLatLng, radius: 30000});     var DistCircle2 = new google.maps.Circle({ strokeColor: 'rgb(255, 255, 0)', strokeOpacity: 0.9, strokeWeight: 2, fillColor: 'rgb(255, 255, 0)', fillOpacity: 0.10, map: map, center: distLatLng2, radius: 30000});        function geocodeAddress(geocoder, resultsMap) {     var address = document.getElementById('address').value;     var address2 = document.getElementById('address2').value;       geocoder.geocode({'address': address}, function(results, status) {     if (status === google.maps.GeocoderStatus.OK) {        resultsMap.setCenter(results[0].geometry.location);       distmarker.setPosition(results[0].geometry.location);       } else {       alert('Geocode was not successful for the following reason: ' + status);     }     })        geocoder.geocode({'address': address2}, function(results2, status) {     if (status === google.maps.GeocoderStatus.OK) {        distmarker2.setPosition(results2[0].geometry.location);        } else {       alert('Geocode was not successful for the following reason: ' + status);     }     })        DistCircle1.setOptions({center: distmarker.getPosition()});     DistCircle2.setOptions({center: distmarker2.getPosition()});     DistCircle1.setMap(resultsMap);     DistCircle2.setMap(resultsMap);       }       function initialize() {     var mapOptions = {         zoom: 10,         minZoom: 9,         maxZoom: 16,         streetViewControl: false,         center: new google.maps.LatLng(32.077, 34.644),         &lt;!--mapTypeId: google.maps.MapTypeId.SATELLITE--&gt;         };     map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);      document.getElementById('submit').addEventListener('click', function() {     geocodeAddress(geocoder, map);       });      }     //end of initalize      google.maps.event.addDomListener(window, 'load', initialize);  &lt;/script&gt; &lt;/head&gt; &lt;body&gt;    &lt;section&gt;     &lt;div id="map-canvas"&gt;&lt;/div&gt;     &lt;div id="searchpanel"&gt;                &lt;input id="address" type="textbox" value="tel aviv"&gt;             &lt;input id="submit" type="button" value="Geocode"&gt;             &lt;input id="address2" type="textbox" value="jerusalem"&gt;      &lt;/div&gt;   &lt;/section&gt;    &lt;/body&gt; &lt;/html&gt; </code></pre>