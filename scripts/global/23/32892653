<p>I have a problem selecting from a table. I'm running the following query:</p>  <pre><code>DECLARE @FactId nvarchar (MAX)  set @FactId = '2379233,2379237,2379244,2379246,2379249,2379250,2379254,2379255,2379257,2379260,2379262,2379264,2379266,2379268,2379270,2379276,2379279,2379284,2379285,2379293,2379294,2379298,2379300,2379305,2379308,2379310,2379313';  BEGIN  SELECT       (apd.USS) as USS, (apd.Area) as Area, P.[Description]  FROM     [gisoo].AdministrationPileDetail apd INNER JOIN      [gisoo].Locality L on L.LocalityId = apd.LocalityId INNER JOIN      [gisoo].Province P on P.CountryId = L.CountryId AND P.Provinceid = L.ProvinceId WHERE      apd.FactId IN (SELECT * FROM  [gisoo].[ItemListToTable](@FactId))     AND L.ProvinceId IS NOT NULL     AND L.DepartmentId IS NOT NULL END GO </code></pre>  <p>This select divides the <code>nvarchar</code> (<code>@FactId</code>) into a table with all separated id:</p>  <pre><code>SELECT *  FROM  [gisoo].[ItemListToTable](@FactId) </code></pre>  <p>The query has 12000 rows and it takes two seconds, but when I run the group by it takes 40 seconds.</p>  <pre><code>DECLARE @FactId nvarchar (MAX)  set @FactId = '2379233,2379237,2379244,2379246,2379249,2379250,2379254,2379255,2379257,2379260,2379262,2379264,2379266,2379268,2379270,2379276,2379279,2379284,2379285,2379293,2379294,2379298,2379300,2379305,2379308,2379310,2379313';  BEGIN  SELECT       SUM(apd.USS) AS USS,      SUM(apd.Area) AS Area,      P.[Description]  FROM      [gisoo].AdministrationPileDetail apd INNER JOIN      [gisoo].Locality L ON L.LocalityId = apd.LocalityId INNER JOIN      [gisoo].Province P ON P.CountryId = L.CountryId AND P.Provinceid = L.ProvinceId WHERE      apd.FactId IN (SELECT * FROM  [gisoo].[ItemListToTable](@FactId))     AND L.ProvinceId IS NOT NULL      AND L.DepartmentId IS NOT NULL GROUP BY      P.[Description] END GO </code></pre>  <p>Both tables don't have indexes.</p>  <p>I'm using SQL Server 2008 R2 and the query It was also tested in SQL Server 2012.</p>