<p>My table has a lot of columns but only the first two are needed</p>  <pre><code>Mtype   join_date   Other A   28/05/2014 00:00    xx B   04/11/2014 00:00    xx C   23/03/2007 00:00    xx D   04/09/2013 00:00    xx E   26/11/2014 00:00    xx F   24/07/2011 00:00    xxx G   28/05/2014 00:00    xx A   20/06/2013 00:00    x B   04/11/2014 00:00    x C   20/06/2013 00:00    x </code></pre>  <p>This is the result I would like to get</p>  <pre><code>+-------+---------+---------+---------+---------+---------+---------+--------+--------+--------+ | Mtype | 2015-03 | 2015-02 | 2015-01 | 2014-12 | 2014-11 | 2014-10 | 2014-9 | 2014-8 | 2014-7 | +-------+---------+---------+---------+---------+---------+---------+--------+--------+--------+ | A     |      45 |       7 |      54 |     875 |      45 |       7 |     54 |    875 |     25 | | B     |       7 |      78 |      78 |       7 |       7 |      78 |     78 |      7 |     78 | | C     |     546 |       6 |      87 |       5 |      45 |       6 |     87 |      5 |     25 | | D     |      54 |      78 |      54 |       8 |      54 |      78 |     54 |      7 |      7 | | E     |      78 |      78 |       7 |      45 |      78 |      78 |      7 |     45 |      6 | | F     |      46 |      54 |       6 |       8 |      46 |      54 |      6 |      8 |     75 | | G     |      54 |      87 |      87 |       7 |      54 |      87 |     87 |     45 |      8 | +-------+---------+---------+---------+---------+---------+---------+--------+--------+--------+ </code></pre>  <p>Code</p>  <pre><code>DECLARE @cols NVARCHAR (MAX) DECLARE @query NVARCHAR (MAX) SELECT @cols = COALESCE (@cols + ',[' + CONVERT(VARCHAR(7), join_date, 120) + ']',            '[' + CONVERT(VARCHAR(7), join_date, 120) + ']')            FROM    (SELECT DISTINCT CONVERT(VARCHAR(7), join_date, 120) as join_date FROM MD T0) PV              ORDER BY join_date DESC  SELECT @query = 'SELECT * FROM (    SELECT Mtype, CONVERT(VARCHAR(7), join_date, 120) as join_date FROM MD T0 ) AS t PIVOT  (   COUNT(join_date)    FOR join_date IN( ' + @cols + ')' + ') AS p ;'  EXEC SP_EXECUTESQL @query </code></pre>  <p>The issue I have is that I only see three columns Mtype, (date),(date) depending on  </p>  <pre><code>ORDER BY join_date DESC     +-------+---------+---------+     | Mtype | 2015-09 | 2015-08 |      +-------+---------+---------+-     | A     |      45 |       7 |      | B     |       7 |      78 |      | C     |     546 |       6 |      | D     |      54 |      78 |      | E     |      78 |      78 |      | F     |      46 |      54 |      | G     |      54 |      87 |      +-------+---------+---------+ </code></pre>  <p>those two columns are either DESC 2015-09 and 2015-08 or ASC 1989-07 and 1990-05.  My question is what is wrong with my query that I only see 2 date columns instead of all of them (over 100).</p>