<p>I am attempting to parse some XML data and place it into a nested dictionary for later use. However as the XML data is not structured, as I understand it in a child type format or blocked data format I am not sure on the best approach. I am currently trying to use XPath and think this is the best option with this data structure but I am not sure how to parse it in a fashion that will allow me to add it to my nested dictionary correctly. I have tried the below method, but as you may have guessed it's not correct. Could someone advice on the best method to parse this data? </p>  <p><strong>Data To Parse</strong></p>  <pre><code>&lt;address addr="192.168.1.74" addrtype="ipv4"/&gt; &lt;address addr="FC:75:16:03:D0:2A" addrtype="mac" vendor="D-Link International"/&gt; &lt;hostnames&gt; &lt;/hostnames&gt; &lt;ports&gt;&lt;extraports state="closed" count="994"&gt; &lt;extrareasons reason="resets" count="994"/&gt; &lt;/extraports&gt; &lt;port protocol="tcp" portid="80"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="http" product="lighttpd" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/a:lighttpd:lighttpd&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="139"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="netbios-ssn" product="Samba smbd" version="3.X" extrainfo="workgroup: WORKGROUP" method="probed" conf="10"/&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="443"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="http" product="lighttpd" tunnel="ssl" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/a:lighttpd:lighttpd&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="445"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="netbios-ssn" product="Samba smbd" version="3.X" extrainfo="workgroup: WORKGROUP" method="probed" conf="10"/&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="515"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="printer" product="LPRng" extrainfo="Not authorized" method="probed" conf="10"/&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="3306"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="mysql" product="MySQL" extrainfo="unauthorized" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/a:mysql:mysql&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;/ports&gt; &lt;times srtt="16241" rttvar="1850" to="100000"/&gt; &lt;/host&gt; &lt;host starttime="1443920156" endtime="1443920210"&gt;&lt;status state="up" reason="arp-response" reason_ttl="0"/&gt; &lt;address addr="192.168.1.126" addrtype="ipv4"/&gt; &lt;address addr="00:0C:29:30:A1:C9" addrtype="mac" vendor="VMware"/&gt; &lt;hostnames&gt; &lt;/hostnames&gt; &lt;ports&gt;&lt;extraports state="filtered" count="984"&gt; &lt;extrareasons reason="no-responses" count="984"/&gt; &lt;/extraports&gt; &lt;port protocol="tcp" portid="53"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="domain" product="Microsoft DNS" version="6.1.7601" ostype="Windows" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/o:microsoft:windows&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="88"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="kerberos-sec" product="Windows 2003 Kerberos" extrainfo="server time: 2015-10-04 00:56:07Z" ostype="Windows" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/a:microsoft:kerberos&lt;/cpe&gt;&lt;cpe&gt;cpe:/o:microsoft:windows&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="135"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="msrpc" product="Microsoft Windows RPC" ostype="Windows" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/o:microsoft:windows&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="139"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="netbios-ssn" method="probed" conf="10"/&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="389"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="ldap" method="probed" conf="10"/&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="445"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="netbios-ssn" method="probed" conf="10"/&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="464"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="kpasswd5" method="table" conf="3"/&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="593"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="ncacn_http" product="Microsoft Windows RPC over HTTP" version="1.0" ostype="Windows" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/o:microsoft:windows&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="636"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="tcpwrapped" method="probed" conf="8"/&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="3268"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="ldap" method="probed" conf="10"/&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="3269"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="tcpwrapped" method="probed" conf="8"/&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="49154"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="msrpc" product="Microsoft Windows RPC" ostype="Windows" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/o:microsoft:windows&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="49155"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="msrpc" product="Microsoft Windows RPC" ostype="Windows" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/o:microsoft:windows&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="49157"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="ncacn_http" product="Microsoft Windows RPC over HTTP" version="1.0" ostype="Windows" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/o:microsoft:windows&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="49158"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="msrpc" product="Microsoft Windows RPC" ostype="Windows" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/o:microsoft:windows&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;port protocol="tcp" portid="49161"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="128"/&gt;&lt;service name="msrpc" product="Microsoft Windows RPC" ostype="Windows" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/o:microsoft:windows&lt;/cpe&gt;&lt;/service&gt;&lt;/port&gt; &lt;/ports&gt; &lt;times srtt="5951" rttvar="5849" to="100000"/&gt; &lt;/host&gt; &lt;runstats&gt;&lt;finished time="1443920210" timestr="Sun Oct  4 01:56:50 2015" elapsed="53.38" summary="Nmap done at Sun Oct  4 01:56:50 2015; 2 IP addresses (2 hosts up) scanned in 53.38 seconds" exit="success"/&gt;&lt;hosts up="2" down="0" total="2"/&gt; &lt;/runstats&gt; &lt;/nmaprun&gt; </code></pre>  <p><strong>Current Attempt</strong></p>  <pre><code>from xml.etree import ElementTree import os  nmap_file = 'Test.xml'  dictionary = {} dictionary['host'] = {} dictionary['host']['port'] = {} dictionary['host']['port']['service'] = {}   with open(nmap_file, 'rt') as f:     tree = ElementTree.parse(f)  for node in tree.findall('.//address'):     if (node.attrib.get('addrtype') == 'ipv4'):         host = node.attrib.get('addr')         dictionary['host'] = host         for node in tree.findall('.//port'):             port = node.attrib.get('portid')             dictionary['host']['port'] = port          for node in tree.findall('.//service'):             product = node.attrib.get('product')             dictionary['host']['port']['service'] = product   print dictionary </code></pre>