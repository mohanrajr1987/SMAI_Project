<p>I am attempting to do very simple with HtmlAgilityPack. It appears that there is a bug but with it...</p>  <p>I have submitted my code in a rather full form beneath, because I feel that I could be the one at fault here, and fear that removing any code whatsoever could hinder or possibly prevent a solution.</p>  <p>The sequence works like this:</p>  <pre><code>int q = 0; foreach (RatingQuestion ratingQuestion in competency.ratingQuestionCollection) {       HtmlNode statementRatingTable = (q == 0) ? competencyRating.SelectSingleNode("//table[@class='statementRatingTable']") : HtmlNode.CreateNode(statementRatingHTML);        int r = 0;       foreach (RatingQuestionResponse response in ratingQuestion.ResponseCollection)       {            HtmlNode responseRow = (response.RelationshipID == 1) ? statementRatingTable.SelectSingleNode("//tr[@class='responseRow']") : HtmlNode.CreateNode(responseRowHTML);            responseRow.SelectSingleNode("//td[1]").InnerHtml = response.RelationshipName;             HtmlNode responseCell = responseRow.SelectSingleNode(String.Format("//td[{0}]", response.Response + 2));            responseCell.InnerHtml = "x";             if (r &gt; 0)            {             //HtmlNode x = statementRatingTable.SelectSingleNode(String.Format("tbody/tr[{0}]", r));             HtmlNode x = (HtmlNode)((from tbody in statementRatingTable.Descendants("tbody")                                      from tr in tbody.Descendants("tr")                                      where tr.Attributes["class"].Value == "responseRow"                                      select tr).FirstOrDefault());                         statementRatingTable.InsertBefore(responseRow, x);                         //statementRatingTable.InsertAfter(responseRow, statementRatingTable.SelectSingleNode(String.Format("tbody/tr[@class='responseRow'][{0}]", r)));            }             r++;       }        break;       q++; } </code></pre>  <ol> <li>Work through a collection of objects, we break on cycle 1, so ignore q</li> <li>Set statementRatingTable to competencyRating's (a bigger node in the containing document) table</li> <li>Work through a sub-collection of objects</li> <li>The first time, response.RelationshipID == 1, so responseRow is written to directly, inside of the statementRatingTable, a cell is marked with "x" in this row, no problems here</li> <li>r == 0, so r++</li> <li>The second time, response.RelationshipID != 1. A fresh HtmlNode is created from some HTML for responseRow, cached earlier, no problems here (innerhtml, outerhtml, childnodes etc look fine in the fresh responseRow HtmlNode), a child cell is marked with "x" again, no problems here</li> <li>r == 1, I want to insert the responseRow into statementRatingTable. Either after the preceding responseRow ( </ol>  <p>I can select these refNodes using LINQ and XPATH no problem. The code you can see above is variant 2000.</p>  <p>If HtmlNode x can be selected from statementRatingTable without any issue. Why can't I a fresh node using this as a ref?!</p>  <p>I have used this technique (or one that is seemingly identical) in many applications with great success in the past.</p>  <p>The error produced when attempting the insert:</p>  <pre><code> {"Node \"&lt;tr class=\"responseRow\"&gt;&lt;/tr&gt;\" was not found in the collection\r\nParameter name: node"} </code></pre>