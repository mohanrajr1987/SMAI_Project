<p>I followed <a href="https://satishratnaparkhi.wordpress.com/2013/10/11/export-to-excel-using-mvc-4/" rel="nofollow">this guide</a> which was recommended in another post about this but I can't quite get it to work. I get a 404 error when trying to redirect to /LogModelsController/ExportData which - as I understood it - was what I was supposed to do. </p>  <p><strong>_LogPartialLayout.cshtml</strong></p>  <pre><code>@using (Html.BeginForm("ExportData", "LogModelsController", FormMethod.Post, new { enctype = "multipart/form-data" })) {     &lt;table class="table"&gt;         &lt;tr&gt;             &lt;th&gt;                 @Html.ActionLink("message", "Index", new { sortOrder = ViewBag.NameSortParm, currentFilter = ViewBag.CurrentFilter })              &lt;/th&gt;             &lt;th&gt;                 @Html.ActionLink("timestamp", "Index", new { sortOrder = ViewBag.NameSortParm, currentFilter = ViewBag.CurrentFilter })             &lt;/th&gt;             &lt;th&gt;                 @Html.ActionLink("level", "Index", new { sortOrder = ViewBag.NameSortParm, currentFilter = ViewBag.CurrentFilter })             &lt;/th&gt;          &lt;/tr&gt;          @foreach (var item in Model)         {             &lt;tr&gt;                 &lt;td&gt;                     @Html.DisplayFor(modelItem =&gt; item.message)                 &lt;/td&gt;                 &lt;td&gt;                     @Html.DisplayFor(modelItem =&gt; item.timeStamp)                 &lt;/td&gt;                 &lt;td&gt;                     @Html.DisplayFor(modelItem =&gt; item.level)                 &lt;/td&gt;             &lt;/tr&gt;         }     &lt;/table&gt;     &lt;input type="submit" name="Export" id="Export" value="Export" /&gt; } </code></pre>  <p><a href="http://i.stack.imgur.com/yx0Kt.png" rel="nofollow"><img src="http://i.stack.imgur.com/yx0Kt.png" alt="_LogPartialLayout.cshtml"></a></p>  <p><strong>LogModelsController.cs</strong></p>  <pre><code>public ActionResult ExportData()         {             GridView gv = new GridView();             gv.DataSource = db.Log.ToList();             gv.DataBind();             Response.ClearContent();             Response.Buffer = true;             Response.AddHeader("content-disposition", "attachment; filename=Loglist.xls");             Response.ContentType = "application/ms-excel";             Response.Charset = "";             StringWriter sw = new StringWriter();             HtmlTextWriter htw = new HtmlTextWriter(sw);             gv.RenderControl(htw);             Response.Output.Write(sw.ToString());             Response.Flush();             Response.End();              return RedirectToAction("~/LogModels/Index");         } </code></pre>  <p><strong>LogModel.cs</strong></p>  <pre><code>namespace ASDMVC.Models {     [Table("Log")]     public class LogModel     {         [Key]         public long id { get; set; }         public string message { get; set; }         public DateTime timeStamp { get; set; }         public string level { get; set; }         public int customerId { get; set; }     }      public class LogDBContext:DbContext     {         public LogDBContext() : base("MySqlConnection")         {          }          public DbSet &lt;LogModel&gt; Log { get; set; }      } } </code></pre>  <p>TD;DR: How do I properly export this table to Excel? </p>  <p><em>Bonus: Does it work with PagedList too?</em></p>  <hr>  <h2>Edit 3 - SOLVED</h2>  <p><strong>Index.cshtml:</strong></p>  <pre><code>@using (Html.BeginForm("ExportData", "LogModels")) {     &lt;input type="submit" name="Export" id="Export" value="Export" /&gt; } </code></pre>  <p><strong>LogModelsController.cs</strong></p>  <pre><code>public ActionResult ExportData() {     DataTable dataTable = GetData();      using (ExcelPackage package = new ExcelPackage())     {         var ws = package.Workbook.Worksheets.Add("My Sheet");         //true generates headers         ws.Cells["A1"].LoadFromDataTable(dataTable, true);          var stream = new MemoryStream();         package.SaveAs(stream);          string fileName = "myfilename.xlsx";         string contentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";          stream.Position = 0;         return File(stream, contentType, fileName);     } }  public DataTable GetData() {     DataTable dt = new DataTable();     if (ModelState.IsValid)     {         using (SqlConnection conn = new SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings["MySqlConnection"].ConnectionString))         {             using (SqlCommand comm = conn.CreateCommand())             {                 comm.Parameters.AddWithValue("@val1", Session["myID"]);                 comm.CommandText = "SELECT * FROM dbo.Log WHERE CustomerId = @val1";                 try                 {                     conn.Open();                     dt.Load(comm.ExecuteReader());                 }                 catch (SqlException e)                 {                     throw new Exception(e.ToString());                 }             }         }     }     return dt; } </code></pre>  <p>I made a mistake in the CommandText and put "Id" instead of "CustomerId" - it now returns the entire table in the Excel file. </p>