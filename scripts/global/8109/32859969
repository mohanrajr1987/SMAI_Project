<p>I am using PHPExcel 1.8.0 in my project. When I want to generate and download a .xls file with some data from my database, the file is downloaded with garbage data. Here is my code:</p>  <pre><code>$result = mysql_query("select * from my_table"); ob_start();    //excel code   $this-&gt;load-&gt;library('excel');  //activate worksheet number 1         $this-&gt;excel-&gt;setActiveSheetIndex(0); //name the worksheet     $this-&gt;excel-&gt;getActiveSheet()-&gt;setTitle('test worksheet');      $rowNumber = 5;     while ($row = mysql_fetch_assoc($result)) {       $col = 'B';         foreach ($fields as $cell) {             $this-&gt;excel-&gt;getActiveSheet()-&gt;setCellValue($col .$rowNumber, $row[$cell]);             $col++;         }          $rowNumber++;     }        // ob_end_clean();     //  ob_clean() ;          $filename='report.xls'; //save our workbook as this file name     header('Content-Type: application/vnd.ms-excel'); //mime type     header('Content-Disposition: attachment;filename="'.$filename.'"');      header('Cache-Control: max-age=0'); //no cache      $objWriter = PHPExcel_IOFactory::createWriter($this-&gt;excel, 'Excel5'); $objWriter-&gt;save('php://output');   exit();  </code></pre>  <p>I have used both ob_end_clean() and ob_clean() but nothing works.</p>