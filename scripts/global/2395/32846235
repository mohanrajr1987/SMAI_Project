<p>I am using hive serDe(<a href="https://github.com/dvasilen/Hive-XML-SerDe/wiki/XML-data-sources" rel="nofollow">https://github.com/dvasilen/Hive-XML-SerDe/wiki/XML-data-sources</a>) for XML parsing and loading it to hive. Sample XML content:</p>  <pre><code>&lt;records&gt; &lt;record customer_id="0000-JTALA"&gt; &lt;income&gt;200000&lt;/income&gt; &lt;address type="M"&gt; &lt;Flatno&gt;345&lt;/FlatNo&gt; &lt;Street&gt;ABS&lt;/street&gt; &lt;city&gt;QWW&lt;/city&gt; &lt;country&gt;US&lt;/country&gt; &lt;pin&gt;3235&lt;/pin&gt; &lt;/address&gt;    &lt;address type="B"&gt; &lt;Street&gt;ABS&lt;/street&gt; &lt;city&gt;QWW&lt;/city&gt; &lt;country&gt;US&lt;/country&gt; &lt;pin&gt;3235&lt;/pin&gt; &lt;/address&gt;     &lt;/record&gt;  &lt;record customer_id="0001-JTALA"&gt; &lt;income&gt;200000&lt;/income&gt; &lt;address type="M"&gt; &lt;Flatno&gt;45&lt;/FlatNo&gt; &lt;Street&gt;fgBS&lt;/street&gt; &lt;city&gt;QWW&lt;/city&gt; &lt;country&gt;US&lt;/country&gt; &lt;pin&gt;3235&lt;/pin&gt; &lt;/address&gt;    &lt;address type="B"&gt; &lt;Street&gt;ABS&lt;/street&gt; &lt;city&gt;QWW&lt;/city&gt; &lt;country&gt;US&lt;/country&gt; &lt;pin&gt;325&lt;/pin&gt; &lt;/address&gt;    &lt;address type="P"&gt; &lt;Street&gt;ABS&lt;/street&gt; &lt;city&gt;QWW&lt;/city&gt; &lt;country&gt;UK&lt;/country&gt; &lt;pin&gt;325&lt;/pin&gt; &lt;/address&gt;    &lt;/record&gt; &lt;/records&gt; </code></pre>  <p>For every address a row should be created. As per the above sample for first customer 2 records should be created and for second customer 3 records should be created total 5 records, as per my current code only two records are created each for single customer and in address column all the address are concatenated so for the first customer street column has (first address street + second address street).     Sample query:</p>  <pre><code>CREATE external TABLE msg_details(customer_id STRING, income BIGINT, AType String,Flatno String, Street string,city string,country string,pin string) ROW FORMAT SERDE 'com.ibm.spss.hive.serde2.xml.XmlSerDe' WITH SERDEPROPERTIES ( "column.xpath.customer_id"="/record/@customer_id", "column.xpath.income"="/record/income/text()", "column.xpath.address_type"="/record/address/@type", "column.xpath.Flatno"="/record/address/Flatno/text()", "column.xpath.Street"="/record/address/Street/text()", "column.xpath.city"="/record/address/city/text()", "column.xpath.country"="/record/address/country/text()" "column.xpath.pin"="/record/address/pin/text()" ) STORED AS INPUTFORMAT 'com.ibm.spss.hive.serde2.xml.XmlInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat' location '/user/root/serdeinput' TBLPROPERTIES ( "xmlinput.start"="&lt;record customer", "xmlinput.end"="&lt;/record&gt;" ); </code></pre>