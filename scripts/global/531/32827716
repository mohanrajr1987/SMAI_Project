<p>I am working on a Powershell script to count the number of files in each sub-directory for 2 Network paths. The script I have works great when I run it in ISE Debug but when I try to run it Powershell the output is truncated and it doesn't provide a count. I am pretty sure it is due to me closing the foreach in the wrong location but I can't seem to figure this out. I am very new to Powershell.</p>  <pre><code>$dirs = "\\myserver\myshare\directory1" , "\\myserver\myshare\directory2" $txt = "\\myserver\myshare\output.txt"  ForEach ($dir in $dirs)     {     (Get-ChildItem $dirs -recurse -Directory | ForEach-Object{       $props = @{          Folder = $_.FullName          Count = (Get-ChildItem -Path $_.Fullname -File | Measure-    Object).Count                 } New-Object PSObject -Property $props } | Select-Object Folder , Count) |   Format-Table -AutoSize | Out-File $txt }  </code></pre>