<p>I am rewriting a few PowerShell scripts to work in PHP and this one has me stuck. I need to get a list of computers, but exclude those with -NEW and -OLD. Below is how I would think to do it, but when I try that I get <code>ldap_search(): Search: Bad search filter</code> as an error.</p>  <p><code>$LDAP_Search_String = "(&amp;(objectClass=computer)(name=NFDW*)(!name=NFDW*-NEW)(!name=NFDW*-OLD))";</code></p>  <p>If I remove <code>(!name=NFDW*-NEW)(!name=NFDW*-OLD)</code> from the query, it works fine.</p>  <p>Additional Info: I have tried <code>(&amp;(objectClass=computer)(name=NFDW*)(|(!name=NFDW*-NEW)(!name=NFDW*-OLD)))</code> as well as suggested by a deleted answer and the same result of a Bad search filter.</p>