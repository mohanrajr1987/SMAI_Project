<p>I am using <a href="https://github.com/haf/DotNetZip.Semverd" rel="nofollow"><code>DotNetZip</code></a> 1.9.6 in my application which uses a file structure similar to e.g. *.docx: Zip file containing XML files.<br> Now every module of the application can store such XML files to my custom file management and on "save" they are serialized to streams which are then saved to the Zip file via DotNetZip.<br> To update the entries I use <code>ZipFile.UpdateEntry(path, stream)</code>. This works fine and the first time I save my file via calling <code>ZipFile.Save()</code> everything works.  </p>  <p>But If I do this a second time (first some <code>UpdateEntry</code>calls then <code>Save</code>) on the same instance the Zip file is corrupted: The file structure and meta-data (e.g. uncompressed size of each file) is still there, but all files are 0 byte in compressed size.</p>  <p>If I create a new instance from the just saved file after saving everything works fine, but shouldn't it be possible to avoid that and "reuse" the same instance?</p>  <p>The following example (also see <a href="https://dotnetfiddle.net/mHxEIy" rel="nofollow">https://dotnetfiddle.net/mHxEIy</a>) can be used to reproduce the problem:</p>  <pre><code>using System.IO; using System.Text;  public class Program {     public static void Main()     {         var zipFile = new Ionic.Zip.ZipFile();          var content1 = new MemoryStream(Encoding.Default.GetBytes("Content 1"));         zipFile.UpdateEntry("test.txt", content1);          zipFile.Save("test.zip"); // here the Zip file is correct         //zipFile = new Ionic.Zip.ZipFile("test.zip"); // uncomment and it works too          var content2 = new MemoryStream(Encoding.Default.GetBytes("Content 2"));         zipFile.UpdateEntry("test.txt", content2);          zipFile.Save();  // after that it is corrupt     } } </code></pre>  <p>To run this you need to add the "DotNetZip 1.9.6" NuGet package.</p>  <p>After the first save, this is what you get:<br> <a href="http://i.stack.imgur.com/sHMlj.png" rel="nofollow"><img src="http://i.stack.imgur.com/sHMlj.png" alt="Correct"></a><br> and after the second save:<br> <a href="http://i.stack.imgur.com/YIGAo.png" rel="nofollow"><img src="http://i.stack.imgur.com/YIGAo.png" alt="Corrupt"></a></p>