<p>Example code:</p>  <pre><code>Using Zip As ZipFile = New ZipFile()     Zip.AddFile("E:\Projects\HOPS\HOPS v1.56\Website\Photos\Pubs.zip")     Zip.MaxOutputSegmentSize = 20 * 1024 * 1024     Zip.TempFileFolder = "E:\Temp\Photos\Temp"     Zip.Save("E:\Temp\Photos\Archive.zip") End Using </code></pre>  <p>Generates the following error message:</p>  <blockquote>   <p>Access to the path is denied.</p> </blockquote>  <p>Comment out the Zip.MaxOutputSegmentSize line and the code works generating a single zip file. When it fails, it has managed to create the file .z01 file. I don't <em>think</em> it's a permissions problems on the target folder because I've given "Everyone" full access to try and get it working plus it's able to create it when not attempting to break into 20MB chunks.</p>  <p>The full error message is this:</p>  <blockquote>   <p>[UnauthorizedAccessException: Access to the path is denied.]<br>   System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)   +10556971    System.IO.File.Move(String sourceFileName, String destFileName) +351<br>   Ionic.Zip.ZipSegmentedStream.TruncateBackward(UInt32 diskNumber, Int64   offset) +694    Ionic.Zip.ZipEntry.Write(Stream s) +1302<br>   Ionic.Zip.ZipFile.Save() +1162    Ionic.Zip.ZipFile.Save(String   fileName) +366    PhotoImport.Page_Load(Object sender, EventArgs e) in   E:\Projects\HOPS\HOPS v1.56\Website\Pubs\PhotoImport.aspx.vb:48<br>   System.EventHandler.Invoke(Object sender, EventArgs e) +0<br>   System.Web.UI.Control.OnLoad(EventArgs e) +132<br>   System.Web.UI.Control.LoadRecursive() +66<br>   System.Web.UI.Page.ProcessRequestMain(Boolean   includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)   +2428</p> </blockquote>  <p>Later - bit more information from Process Monitor:</p>  <blockquote>   <p>w3wp.exe CreateFile C:\Windows\System32\inetsrv   ACCESS DENIED</p> </blockquote>  <p>Hmm, why is it trying to write to that folder?</p>