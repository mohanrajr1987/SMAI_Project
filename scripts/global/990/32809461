<p>I have a file as follows:</p>  <pre><code>Scaffold2   GeneWise        mRNA    3038    6649  Scaffold2   GeneWise        CDS     3038    3480 Scaffold2   GeneWise        CDS     4175    4291 Scaffold3   GeneWise        mRNA    2824    15173 Scaffold3   GeneWise        CDS     2824    3302 Scaffold3   GeneWise        CDS     4143    4344 </code></pre>  <p>I want to have this output:</p>  <pre><code>Scaffold2   GeneWise        mRNA    3038    6649  Scaffold2   GeneWise        CDS     3038    **3480** Scaffold2   GeneWise        1st_intron     **3480    4175** Scaffold2   GeneWise        CDS     **4175**    4291 Scaffold3   GeneWise        mRNA    2824    15173 Scaffold3   GeneWise        CDS     2824    **3302** Scaffold3   GeneWise        1st_intron     **3302    4143** Scaffold3   GeneWise        CDS     **4143**    4344 </code></pre>  <p>It should go as follows: If column 3 is 'mRNA', take the 5th column of the next line and the 4th column of the line after and insert a new line between the two that contains the 4th and 5th columns (as bold numbers indicate) with the third column called '1st_intron'.</p>  <p>I have never dealt with such a problem, if you could give me some hint, that would be great.</p>