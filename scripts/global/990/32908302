<p>I have two files: <code>$wrkfile</code> and <code>$mapfile</code>.  I need to look at $5 in $wrkfile and IF $5 == "2R" then I need to pull the new rate from $2 in $mapfile and write that into $5 in $wrkfile.  If $5 = "2R" then do nothing and next.</p>  <p>Below is an an example of <code>$wrkfile</code>, <code>$mapfile</code>, and <code>$expected</code>.  I have also included the <code>awk</code> script I am using that is failing.  Any help would be greatly appreciated.</p>  <pre><code>awk -F"|" 'NR==FNR{a[$1]=$2} NR&gt;FNR{ if ( $5 == "2R" ) {print($1,$2,$3,$4,a[$1],$6} else   {print($1,$2,$3,$4,$5,$6} }' OFS="|" "$mapfile" "$wrkfile" &gt; "$output"   $wrkfile 12345678912|C|01|A|01|000000050.00| 12345678912|C|01|A|01|000000050.00| 12345678912|C|01|A|01|000000050.00| 12345678912|C|01|A|2R|000000050.00| 12345678912|C|01|A|2R|000000050.00| 12345678912|C|01|A|2R|000000050.00| 12345678912|C|01|A|2R|000000050.00| 12345678912|C|01|A|2R|000000050.00|  $mapfile 12345678912|9.00| 12345678914|10.00|  12345678993|11.00| 12345678983|12.00|  12345678963|13.00| 12345678917|14.00|  $expected 12345678912|C|01|A|01|000000050.00| 12345678912|C|01|A|01|000000050.00| 12345678912|C|01|A|01|000000050.00| 12345678912|C|01|A|2R|000000009.00| 12345678912|C|01|A|2R|000000009.00| 12345678912|C|01|A|2R|000000009.00| 12345678912|C|01|A|2R|000000009.00| 12345678912|C|01|A|2R|000000009.00| </code></pre>