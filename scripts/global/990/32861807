<p>I have 2 dat files, <strong>FILE1</strong> and <strong>FILE2</strong>. The first one has (for example) 1000 lines and the second 100 lines. The lines in both files have the same format, i.e. 5 numbers, separated by space. The lines with the values of <strong>FILE2</strong> are partially matching the lines from <strong>FILE1</strong>. For example, there is a line in <strong>FILE2</strong> that is:</p>  <pre><code>1 2 3 4 5 </code></pre>  <p>and there is a line in <strong>FILE1</strong> that is:</p>  <pre><code>1 2 3 9 5 </code></pre>  <p>It is always the 4th value that is not matching. 1st, 2nd, 3rd and 5th values are always match. I want to do this in a bash script. I have started  this script so far.</p>  <pre><code>#! /bin/bash  #USAGE: sh ./script.sh test.dat check.dat   TEST_FILE=$1  CHECK_FILE=$2 ## for each line in TEST_FILE  while read line ; do   arr=$(echo $line | tr " " "\n")  part_match=$(echo ${arr:0:8})  X=$(grep "$part_match" ${CHECK_FILE})  ## So up to here, if the partial match exists in FILE2, I save the line in X. ## Then I try to substitute them with awk or sed but none of them works.   awk '{gsub(/${X}/, "${line}")}' check.dat &gt; check_new.dat ## OR  sed -i "s/$X/$line/pw" check.dat  done &lt; ${TEST_FILE} </code></pre>  <p>None of them works. What am I doing wrong? Thank you very much!</p>