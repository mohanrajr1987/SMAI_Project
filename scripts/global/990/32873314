<p>The <code>awk</code> below using the sample input would output the following: Basically, it averages the text in <code>$5</code> that matches if <code>7 &lt; 30</code>.</p>  <pre><code>awk '{if(len==0){last=$5;total=$7;len=1;getline}if($5!=last){printf("%s\t%f\n", last, total/len);last=$5;total=$7;len=1}else{total+=$7;len+=1}}END{printf("%s\t%f\n", last, total/len)}' Input.txt &gt; output.txt </code></pre>  <p><strong>Sample Input</strong></p>  <pre><code>chr 1   955542  955763  +   AGRN:exon.1 1   0 chr 1   955542  955763  +   AGRN:exon.1 2   0 chr 1   955542  955763  +   AGRN:exon.1 3   0 chr 1   955542  955763  +   AGRN:exon.1 4   1 chr 1   955542  955763  +   AGRN:exon.1 5   1 chr 1   955542  955763  +   AGRN:exon.1 6   1 .... .... chr 1   955542  955763  +   AGRN:exon.1 218 32 chr 1   955542  955763  +   AGRN:exon.1 219 32 chr 1   955542  955763  +   AGRN:exon.1 220 32 chr 1   955542  955763  +   AGRN:exon.1 221 29 </code></pre>  <p><strong>Output</strong></p>  <pre><code>AGRN:exon.1 4.5714285 </code></pre>  <p>My question is I can not seem to add the correct syntax that will also output the total # of lines in <code>$6</code> that represent <code>$5</code> and the % of <code>7 &lt; 30</code>  I know my words may not be all that helpful so hopefully the desired output will help.  Thank you :).</p>  <p><strong>Desired output</strong></p>  <pre><code>AGRN:exon.1 4.5714285 3.16742% (221 (# of lines in `6' / 7 #3 of lines `&lt; 30`) </code></pre>