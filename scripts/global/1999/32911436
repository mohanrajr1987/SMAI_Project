<p>I have this weird problem. I have the same type of messages entering the network via two different routes (proxy server/gateway). They are both S/MIME (RNIF) and signed the same way for the same type of software. One works and verifies the signature (<a href="http://wasen.net/tmp/WorkingSMIME.txt" rel="nofollow">Working S/MIME verified</a>) while the other message fails verification (<a href="http://wasen.net/tmp/SignatureFails.txt" rel="nofollow">Signature Verification Fails</a>). The other two partners has no issues communicating.</p>  <p>I suspect something is modified in the non-working message (obviously as it doesn't verify) and my suspicion is some line-feeds. The partner sending the non-working messages has e-mailed me a bunch of samples and those verify when tested from disk on openssl. This indicates even stronger that the gateway proxy is messing them up.</p>  <p>I have not been able to find out what though...</p>  <p>In the working sample the signed part is between the boundary ----=732b55ae5039-45b3-ae4a-f3bebf560a68</p>  <p>In the non working sample it should be ------=_Part_62617_645539450.1443782950116</p>  <p>Attached also the <a href="http://wasen.net/tmp/DP_TEST_CERT-sscert.pem" rel="nofollow">Public key (PEM)</a></p>