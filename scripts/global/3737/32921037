<p>So I have this big headache trying to solve a bug that only happens sometimes... I have the following model for allowing a user to like something:</p>  <pre><code>class Like &lt; ActiveRecord::Base   belongs_to :user   belongs_to :likeable, polymorphic: true   validates :user, uniqueness: {scope: :likeable} end </code></pre>  <p>This is a set up to allow a user to like multiple other models and has a validation that prevents a user to like the same thing multiple times.</p>  <p>The thing I discovered after debugging is that the SELECT query run by rails seems to check only for the uniqueness of likeable_id (and not likeable_type):</p>  <pre><code>SELECT  1 AS one FROM "likes" WHERE ("likes"."user_id" = 1 AND "likes"."likeable_id" = 4) LIMIT 1 </code></pre>  <p>Logically, when a user had already liked a comment with id is 4, he couldn't like any other thing with the same ID.</p>  <p>Any ideas on how to solve this?</p>