<p>Can anyone help me with writing code in VB6 that reads input buffer events from a console window? The most important part is the mouse cursor position in cells and rows.</p>  <p>I am making a program in VB6 that uses a console as the main gui (or should I say cui) and I can't find an example in vb code that uses 'Input Buffer Events'.</p>  <p>This example code does exactly what I want but it's in c++ and i'm using VB6:     <a href="https://msdn.microsoft.com/en-us/library/ms685035(v=vs.85).aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/ms685035(v=vs.85).aspx</a></p>  <p>I have a lot of trouble converting the code because I don't know much about c++. Here are some other links that already gave me some idea of how to start:</p>  <ul> <li><a href="http://www.developer.com/net/vb/article.php/10926_1538861_6/Writing-Console-Mode-Applications-in-Visual-Basic.htm" rel="nofollow">http://www.developer.com/net/vb/article.php/10926_1538861_6/Writing-Console-Mode-Applications-in-Visual-Basic.htm</a></li> <li><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms682073(v=vs.85).aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/windows/desktop/ms682073(v=vs.85).aspx</a></li> <li><a href="http://www.xaprb.com/blog/2005/10/14/how-to-create-a-vb6-console-program/" rel="nofollow">http://www.xaprb.com/blog/2005/10/14/how-to-create-a-vb6-console-program/</a></li> <li><a href="http://blogs.msdn.com/b/oldnewthing/archive/2013/05/06/10416225.aspx" rel="nofollow">http://blogs.msdn.com/b/oldnewthing/archive/2013/05/06/10416225.aspx</a></li> <li><a href="http://microsoft.public.vb.winapi.narkive.com/avYXhXUG/readconsoleinput-and-input-record" rel="nofollow">http://microsoft.public.vb.winapi.narkive.com/avYXhXUG/readconsoleinput-and-input-record</a></li> <li><a href="http://www.pinvoke.net/default.aspx/kernel32/ReadConsoleInput.html" rel="nofollow">http://www.pinvoke.net/default.aspx/kernel32/ReadConsoleInput.html</a></li> </ul>  <p>Here is my module, its all I have:</p>  <pre><code>Private Const ENABLE_MOUSE_INPUT = &amp;H10 Private Const ENABLE_WINDOW_INPUT = &amp;H8 Private Const ENABLE_EXTENDED_FLAGS = &amp;H80  Private Const STD_INPUT_HANDLE = -10&amp; Private Const STD_OUTPUT_HANDLE = -11&amp;  Private Const MOUSE_MOVED = &amp;H1  Private Type COORD     x As Integer     y As Integer End Type  Private Type SMALL_RECT     Left As Integer     Top As Integer     Right As Integer     Bottom As Integer End Type  Type INPUT_RECORD     iEventType As Integer     abData(0 To 15) As Byte End Type  Private Type CONSOLE_SCREEN_BUFFER_INFO     dwSize As COORD     dwCursorPosition As COORD     wAttributes As Integer     srWindow As SMALL_RECT     dwMaximumWindowSize As COORD End Type  Type KEY_EVENT_RECORD     lKeyDown As Long     iRepeatCount As Integer     iVirtualKeyCode As Integer     iVirtualScanCode As Integer     iChar As Integer     lControlKeyState As Long End Type  Type MOUSE_EVENT_RECORD     CDMOUSEPOSITION As COORD     lButtonState As Long     lControlKeyState As Long     lEventFlags As Long End Type  Type FOCUS_EVENT_RECORD     lSetFocus As Long End Type  Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long) Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (pDestination As Any, pSource As Any, ByVal lByteCount As Long)  Private Declare Function AllocConsole Lib "kernel32" () As Long Private Declare Function FreeConsole Lib "kernel32" () As Long Private Declare Function GetStdHandle Lib "kernel32" (ByVal nStdHandle As Long) As Long Private Declare Function SetConsoleMode Lib "kernel32" (ByVal hConsoleOutput As Long, dwMode As Long) As Long Private Declare Function ReadConsoleInput Lib "kernel32" Alias "ReadConsoleInputA" (ByVal hConsoleInput As Long, lpBuffer As Any, ByVal nLength As Long, lpNumberOfEventsRead As Long) As Long  '##################################################################################################  Private Sub Main()     AllocConsole          Dim hConsoleIn As Long         Dim hConsoleOut As Long          Dim IR As INPUT_RECORD         Dim MER As MOUSE_EVENT_RECORD         Dim ret As Long          hConsoleIn = GetStdHandle(STD_INPUT_HANDLE)         hConsoleOut = GetStdHandle(STD_OUTPUT_HANDLE)          Call SetConsoleMode(hConsoleOut, ENABLE_WINDOW_INPUT Or ENABLE_MOUSE_INPUT Or ENABLE_EXTENDED_FLAGS)          Dim x As Long         Dim y As Long          Do             ReadConsoleInput hConsoleIn, MER, 1, ret              Select Case IR.iEventType                 Case MOUSE_EVENT                     Call CopyMemory(MER, IR.abData(0), Len(MER))                     x = MER.CDMOUSEPOSITION.x                     y = MER.CDMOUSEPOSITION.y                      If MsgBox(x &amp; "|" &amp; y, vbOKCancel) = vbCancel Then Exit Do             End Select          Loop      FreeConsole End Sub </code></pre>  <p>Can someone please help me? Kind regards!</p>