<p>QueryFullProcessImageName always return 0,can not retrieve process path,code below,need you help,thanks.</p>  <p><pre></p>  <code>Public Declare Function QueryFullProcessImageName Lib "Kernel32.dll" Alias "QueryFullProcessImageNameA" (hProcess As Long, ByVal dwFlags As Long, ByVal lpExeName As String, lpdwSize As Long) As Long  Private Function GetProcessImageName(ByVal lProcessID As Long) As String Dim hProcess As Long Dim sBuf As String Dim sChar As Long  hProcess = OpenProcess(PROCESS_QUERY_LIMITED_INFORMATION Or PROCESS_QUERY_INFORMATION, 0, lProcessID) If hProcess Then sBuf = String$(MAX_PATH, Chr$(0)) QueryFullProcessImageName hProcess, 0, sBuf, MAX_PATH sBuf = Left$(sBuf, sChar)  End If GetProcessImageName = sBuf CloseHandle hProcess End Function </code></pre>  <p></p>