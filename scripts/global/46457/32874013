<p>I am trying to do something rather complex in R, and I am not really sure where to start.</p>  <p>I have a dataframe that looks sort of like this:</p>  <pre><code>main_val sub_val bit_one bit_two  one      a        1       1  one      a        1       0  one      a        1       1  one      b        1       0  two      a        1       1  two      b        1       1  two      a        1       1 </code></pre>  <p>Now I to count the number of 0s, 1s, 2s, and 3s represented by the bits for each sub value of each main value. So this should return:</p>  <pre><code>main_val sub_val  0s  1s  2s  3s  one       a      0   0   1   2  one       b      0   0   1   0  two       a      0   0   0   2  two       b      0   0   0   1 </code></pre>  <p>Any thought on how to do this? I can only think of ugly for loops that would take forever (this will be run on ALOT of data).</p>