<p>For an assignment for my graduate program, I have been asked to extract data from datasets of English Premier League results (located <a href="http://www.football-data.co.uk/mmz4281/1516/E0.csv" rel="nofollow">here</a>). I am very close to being done but need help on the last two outputs. </p>  <p>We must create a function that can receive two arguments, a date and a season. The function must return a data frame with the table of the respective season on that date. It must include wins, losses, home record, away record, etc. The only ones I have not managed to figure out are W/L streak and the results of the last 10 matches.</p>  <p>Here is an example of what the initial dataset looks like:</p>  <pre><code>   e.Date           e.HomeTeam    e.AwayTeam   e.FTHG e.FTAG  e.FTR    1  2015-08-08    Bournemouth    Aston Villa      0      1     A    2  2015-08-08        Chelsea        Swansea      2      2     D    3  2015-08-08        Everton        Watford      2      2     D    4  2015-08-08      Leicester     Sunderland      4      2     H    5  2015-08-08     Man United      Tottenham      1      0     H </code></pre>  <p>My plan was to get Home and Away data sorted out for each club then merge them together before doing the analysis to find streak and last 10 results.</p>  <p>I manipulated the data to look like this:</p>  <pre><code>          HomeTeam FTR       Date freq  1         Arsenal   L 2015-08-09    1  2         Arsenal   D 2015-08-24    1  3         Arsenal   W 2015-09-12    1  4     Aston Villa   L 2015-08-14    1  5     Aston Villa   L 2015-09-19    1  6     Aston Villa   D 2015-08-29    1 </code></pre>  <p>And now I'm kinda lost. My idea was to run some kind of loop (for? ddply? data.table?) to create a data frame for each club with their results in it and then loop again to do whatever calculations to get the desired variables (streak and last 10) and somehow push those back into the main data frame where I am housing all of the other outputs.</p>  <p>I don't want to be told the answer outright since it's important I learn this on my own. However, if someone could point me in the right direction that would be great. Thanks so much.</p>