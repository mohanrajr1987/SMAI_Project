<p><strong>Hello, I am writing a simple chrome extension which will be used to:</strong> <br>  1. open new webpage<br>  2. fill timesheet form based on pasted string array<br>  3. submit timesheet (just clicking "ok" button in the form)<br>  4. open new webpage</p>  <p><strong>For this to work my extension needs to contain:</strong><br>  1. <strong>popup.html</strong> Browser Action popup, with <em>input textfield</em> for string array, and <em>submit button</em>.<br>  2. <strong>timesheet.js</strong> - javascript file to add logic to <strong>popup.html</strong><br>  3. <strong>background.js</strong> - background page to take care of filling form, after clicking <em>submit button</em><br>  4. <strong>content_script.js</strong> - to access newly opened webpage DOM, to fill the form.</p>  <p>For now, I made a simplified version, which is supposed to:<br>  1. open www.google.com in new tab<br>  2. wait few seconds (optionally, wait or page to finish loading)<br>  3. change background color</p>  <p>Everything seems to be woring fine, except for <strong>content_script.js</strong> listener doesn't react to message send by <strong>background.js</strong></p>  <h1>Here is the code:</h1>  <p><strong>manifest.json</strong>:</p>  <pre><code>{   "manifest_version": 2,    "name": "Timesheet Filler",   "description": "Description.",   "version": "1.0",    "background": {     "persistent": false,     "scripts": ["background.js"]   },    "content_scripts": [{         "matches": ["http://www.google.com/*"],         "js": ["content_script.js"]     }],    "browser_action": {     "default_title": "Timesheet Filler",     "default_popup": "popup.html"   },   "permissions": [     "tabs",     "activeTab",     "http://www.google.com/*"   ] } </code></pre>  <p><strong>popup.html</strong>:</p>  <pre><code>&lt;!DOCTYPE html&gt; &lt;html&gt; &lt;body&gt;     &lt;button id="btn" &gt;Click Me!&lt;/button&gt;     &lt;script src="timesheet.js"&gt;&lt;/script&gt; &lt;/body&gt; &lt;/html&gt; </code></pre>  <p><strong>timesheet.js</strong>:</p>  <pre><code>document.addEventListener('DOMContentLoaded', function(){     init(); });  function init(){     var btn = document.getElementById('btn');     btn.onclick = function() { onBtnClick(); } }  function onBtnClick(){     chrome.runtime.sendMessage({action:"btnClick"}, btnClickCallback); }  function btnClickCallback(any){     alert(any); } </code></pre>  <p><strong>background.js</strong></p>  <pre><code>chrome.runtime.onMessage.addListener(function(message, sender, sendResponse) {     if(message.action == "btnClick"){         chrome.tabs.create({url: "http://www.google.com", active:true});         setTimeout(function(){ delayed(); }, 3000);      }    });  function delayed(){     chrome.tabs.query({active:true}, queryCallback); }  function queryCallback(arr){     var tabId = arr[0].id;      console.log("message shown 3 second after clicking button") // THIS IS WORKING     chrome.tabs.sendMessage(tabId, {action:"doSomething"}); // CONTENT SCRIPT DOESNT REACT TO THIS }  function contentScriptCallback(any){     alert(any); } </code></pre>  <p><strong>content_script.js</strong>:</p>  <pre><code>chrome.runtime.onMessage.addListener(function(message, sender, sendResponse) {     if( message.action == "doSomething"){         document.body.style.backgroundColor='#000000';           alert("do something");     } }); </code></pre>  <p><a href="https://drive.google.com/file/d/0B-OftPVRoqqmM3ZBQ2l1bTBfUlE/view?usp=sharing" rel="nofollow">Download all files in one ZIP here</a></p>  <p>How to make <strong>content_script.js</strong> react to to message and change webpage bg color?</p>