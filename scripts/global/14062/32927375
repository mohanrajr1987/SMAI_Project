<p>I'm setting up and application using <code>Undertow</code>, I've set up a <code>ResourceHandler</code> for static files, and <code>Servlet</code> to be used by apache-camel to expose rest services.</p>  <p>I've done this using spring and servlet3.0 in an app container.</p>  <p>In a class extending <code>org.springframework.web.servlet.support.AbstractAnnotationConfigDispatcherServletInitializer</code></p>  <pre><code>@Override public void onStartup(ServletContext servletContext) throws ServletException {     super.onStartup(servletContext);     ServletRegistration.Dynamic servlet = servletContext.addServlet("RestServlet", new CamelHttpTransportServlet());     servlet.setLoadOnStartup(1);     servlet.addMapping("/rest/*"); } </code></pre>  <p>And in camel route</p>  <pre><code>restConfiguration()             .component("RestServlet")             .bindingMode(RestBindingMode.json)             .dataFormatProperty("prettyPrint", "true"); </code></pre>  <p>Pretty close to whats described in <a href="http://camel.apache.org/servlet.html" rel="nofollow">http://camel.apache.org/servlet.html</a></p>  <p>But if I do this in Undertow as an embedded I get <code>org.apache.camel.NoSuchBeanException: No bean could be found in the registry for: RestServlet of type: org.apache.camel.spi.RestConsumerFactory</code> as I guess Guice never finds the servlets created by Undertow. I tried to manually expose the CamelHttpTransportServlet as a Guice Binding but that doesn't seem to change things.</p>  <pre><code>ClassLoader classLoader = getClass().getClassLoader();     ResourceHandler staticHandler = new ResourceHandler(new ClassPathResourceManager(classLoader, STATIC_RESOURCE_ROOT))             .addWelcomeFiles(INDEX_HTML);      DeploymentInfo deploymentInfo = Servlets.deployment()             .setClassLoader(classLoader)             .setContextPath(ROOT_MAPPING)             .setDeploymentName(DEPLOYMENT_NAME)             .addServlet(                     Servlets.servlet("RestServlet", CamelHttpTransportServlet.class)                             .addMapping(REST_MAPPING)                             .setLoadOnStartup(1)             );      DeploymentManager manager = Servlets.defaultContainer().addDeployment(deploymentInfo);     manager.deploy();      PathHandler path = Handlers.path()             .addPrefixPath(REST_MAPPING, manager.start())             .addPrefixPath(ROOT_MAPPING, staticHandler);      undertow = Undertow.builder()             .addHttpListener(port, LOCALHOST)             .setHandler(path)             .build();     undertow.start(); </code></pre>  <p>The static resource work as expected, and it also seems the rest servlet is running and getting the responses but <code>CamelContext</code> won't start up.</p>  <p>I can't use restlet or anything in camel as then the port will be in use so I need to use different port for static files and rest. Is there any way to have camel identify the <code>Servlet</code> initiated by <code>Undertow</code>?</p>