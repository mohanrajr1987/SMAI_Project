<p>I need to set the <code>use-x-forwarded-headers</code> Http header in camel-cxf like the below and make it as an OSGi bundle to be deployed in Karaf.</p>  <pre><code>&lt;servlet&gt;       &lt;servlet-name&gt;cxf&lt;/servlet-name&gt;       &lt;servlet-class&gt;org.apache.cxf.transport.servlet.CXFServlet&lt;/servlet-class&gt;       &lt;init-param&gt;                    &lt;param-name&gt;use-x-forwarded-headers&lt;/param-name&gt;           &lt;param-value&gt;true&lt;/param-value&gt;       &lt;/init-param&gt;       &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;   &lt;/servlet&gt; </code></pre>  <p>I don't want to package this as a WAR, instead i want to make it an OSGi bundle. </p>  <p>Hence, i created a class which extends CXFNonSpringServlet as the code below and set the init-params, </p>  <pre><code>public class XForwadedServlet extends CXFNonSpringServlet {  @Override     protected void loadBus(ServletConfig sc) {         sc.getServletContext().setInitParameter("use-x-forwarded-headers",                 "true");         super.loadBus(sc);         Bus bus = getBus();         BusFactory.setDefaultBus(bus);         // createFactoryBean();     }       @Override     public void init(ServletConfig sc) throws ServletException {         sc.getServletContext().setInitParameter("use-x-forwarded-headers",                 "true");         super.init(sc);     } </code></pre>  <p>And here's my camel route, </p>  <pre><code>&lt;cxf:cxfEndpoint id="serviceEndpoint"         address="http://localhost:8123/cxf/testCxfRedirect"         loggingFeatureEnabled="true" serviceClass="com.redhat.HelloServiceImpl"&gt;     &lt;/cxf:cxfEndpoint&gt;     &lt;camelContext trace="false" xmlns="http://camel.apache.org/schema/spring"&gt;   &lt;route&gt;     &lt;from uri="cxf:bean:serviceEndpoint"/&gt;     &lt;log message="${body}" loggingLevel="INFO"/&gt;     &lt;bean ref="clientAddress" method="getClientAddress"/&gt;   &lt;/route&gt; &lt;/camelContext&gt;      &lt;bean id="destinationRegistry" class="org.apache.cxf.transport.http.DestinationRegistryImpl"&gt;     &lt;/bean&gt;     &lt;bean id="osgiServlet" class="com.redhat.XForwadedServlet"&gt;         &lt;constructor-arg ref="destinationRegistry"&gt;&lt;/constructor-arg&gt;         &lt;constructor-arg value="true"&gt;&lt;/constructor-arg&gt;     &lt;/bean&gt; </code></pre>  <p>Through soapui, i set the <code>X-Forwarded-For</code> header as below, </p>  <pre><code>Address: http://localhost:8123/cxf/testCxfRedirect Encoding: UTF-8 Http-Method: POST Content-Type: text/xml Headers: {Accept=[*/*], SOAPAction=[""], X-Forwarded-For=[http://google.com]} Payload: &lt;soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"&gt;&lt;soap:Body&gt;&lt;ns1:sayHello xmlns:ns1="http://redhat.com/"&gt;&lt;arg0 xmlns="http://redhat.com/"&gt;Test&lt;/arg0&gt;&lt;/ns1:sayHello&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt; -------------------------------------- </code></pre>  <p>How can i register the CXFNonSpringServlet in OSGi Blueprint container with setting that init-params ? Is there a way to do this in OSGi ?</p>