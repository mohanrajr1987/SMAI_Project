<p>I'm writing a driver to control GPIO pins. I have identified JP4 connector and added a LED on gpio91 (<code>JP4.06</code> => <code>/sys/class/gpio/gpio91</code>). After reading many tutorials I have written a simple kernel module. This module receives an input from user space and based on input I am setting gpio like <code>gpio_set_value(91,true)</code>. Before calling <code>gpio_set_value</code>, I am calling one more function i.e <code>gpio_direction_output</code>. And thus led is glowing. On the other hand when I am getting other command from user space to get status of PIN (for this I am relying on <code>gpio_get_value(91)</code> and for this also setting direction to input), here I am not getting proper value.</p>  <p>Am I missing any step to get desired value? How should I attempt doing this?</p>