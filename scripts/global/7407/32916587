<p>My IIS website is currently accessed as <a href="http://mywebsite.com" rel="nofollow">http://mywebsite.com</a> and I have 3 objectives related to url rewriting:</p>  <ol> <li>Redirect to the website's new name, mynewwebsite.com</li> <li>Remove www prefix if it exists (eg www.mywebsite.com -> mywebsite.com or www.mynewwebsite.com --> mynewwebsite.com</li> <li>Redirect to SSL</li> </ol>  <p>So in summary I want to redirect all inbound requests to <a href="https://mynewwebsite.com/" rel="nofollow">https://mynewwebsite.com/</a><em>anything</em>*.</p>  <p>The input cases that must be accounted for are</p>  <ul> <li><a href="http://mynewwebsite.com/" rel="nofollow">http://mynewwebsite.com/</a><em>anything</em>*</li> <li><a href="http://www.mynewwebsite.com/" rel="nofollow">http://www.mynewwebsite.com/</a><em>anything</em>*</li> <li><a href="http://mywebsite.com/" rel="nofollow">http://mywebsite.com/</a><em>anything</em>*</li> <li><a href="http://www.mywebsite.com/" rel="nofollow">http://www.mywebsite.com/</a><em>anything</em>*</li> <li><a href="https://mywebsite.com/" rel="nofollow">https://mywebsite.com/</a><em>anything</em>*</li> <li><a href="https://www.mywebsite.com/" rel="nofollow">https://www.mywebsite.com/</a><em>anything</em>*</li> <li><a href="https://www.mynewwebsite.com/" rel="nofollow">https://www.mynewwebsite.com/</a><em>anything</em>*</li> </ul>  <p>My rewrite rules look as follows:</p>  <pre><code>&lt;rewrite&gt;   &lt;rules&gt;     &lt;rule name="Do stuff" enabled="true"&gt;       &lt;match url="(.*)" ignoreCase="false" /&gt;       &lt;conditions logicalGrouping="MatchAny"&gt;         &lt;add input="{HTTPS}" pattern="off" /&gt;         &lt;add input="{HTTP_HOST}" pattern="mywebsite.com" /&gt;         &lt;add input="{HTTPS}" pattern="^www.mynewwebsite\.com$" /&gt;       &lt;/conditions&gt;       &lt;action type="Redirect" url="https://mynewwebsite.com/{R:1}" appendQueryString="true" redirectType="Permanent" /&gt;     &lt;/rule&gt;   &lt;/rules&gt; &lt;/rewrite&gt; </code></pre>  <p>With this rule set the following input case is failing (the www isn't stripped): <a href="https://www.mynewwebsite.com/" rel="nofollow">https://www.mynewwebsite.com/</a><em>anything</em>*</p>  <p>I've banged my head against this sufficiently that I question my fundamental understanding of how rule definitions work.</p>  <ul> <li><em>anything</em> could be present or not exist at all</li> </ul>