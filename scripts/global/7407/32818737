<p>I'm trying to setup a local CDN on IIS. All JS and CSS files are compressed. So in order load them correctly I have to set gzip for content encoding. This works fine for all JS and CSS files, however gzip content encoding header is applied to all images which makes browsers unable to load them correctly. I managed to add outbound rewrting rule, but it works only for the first defined type ex. png files. If I put jpg rule first then only it works? Can I merge those rules? </p>  <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;configuration&gt;   &lt;system.webServer&gt;     &lt;rewrite&gt;       &lt;outboundRules&gt;         &lt;rule name="Set Content Encoding header PNG"&gt;           &lt;match serverVariable="RESPONSE_Content_Encoding" pattern=".*" /&gt;           &lt;conditions&gt;             &lt;add input="{REQUEST_URI}" pattern="\.png$" /&gt;           &lt;/conditions&gt;           &lt;action type="Rewrite" value="image/png"/&gt;                           &lt;/rule&gt;         &lt;rule name="Set Content Encoding header JPG"&gt;                            &lt;match serverVariable="RESPONSE_Content_Encoding" pattern=".*" /&gt;           &lt;conditions&gt;             &lt;add input="{REQUEST_URI}" pattern="\.jpg\.jpeg$" /&gt;           &lt;/conditions&gt;            &lt;action type="Rewrite" value="image/jpeg"/&gt;         &lt;/rule&gt;         &lt;rule name="Set Content Encoding header GIF"&gt;           &lt;match serverVariable="RESPONSE_Content_Encoding" pattern=".*" /&gt;           &lt;conditions&gt;             &lt;add input="{REQUEST_URI}" pattern="\.gif$" /&gt;           &lt;/conditions&gt;           &lt;action type="Rewrite" value="image/gif" /&gt;         &lt;/rule&gt;       &lt;/outboundRules&gt;     &lt;/rewrite&gt;     &lt;httpProtocol&gt;       &lt;customHeaders&gt;         &lt;add name="Content-Encoding" value="gzip" /&gt;       &lt;/customHeaders&gt;     &lt;/httpProtocol&gt;   &lt;/system.webServer&gt; &lt;/configuration&gt; </code></pre>