<p>Deep in the Delphi VCL framework of <code>Vcl.Printers</code> is a call to the Windows function <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd183505%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396" rel="nofollow"><code>CreateIC</code></a>. On my Windows 10 desktop, the calls fails (returns <strong>NULL</strong> rather than a valid <em>information context</em>).</p>  <p>The <code>CreateIC</code> function does not document any way in which it can fail. Nor does it document that it supports calling <code>GetLastError</code> to get the error. But if i call <code>GetLastError</code> i get error code <strong>50</strong>:</p>  <pre><code>ERROR_NOT_SUPPORTED   50 (0x32)   The request is not supported.   </code></pre>  <h2>Minimum reproducible</h2>  <p>I extracted the code from <strong>Vcl.Printers.pas</strong> and boiled it down to a simple reproducable sample:</p>  <pre><code>procedure TForm1.Button1Click(Sender: TObject); var     driver, device, output: string;     dc: HDC;     le: DWORD; begin     driver := '';     device := 'Microsoft XPS Document Writer';     output := '';      dc := CreateIC(PChar(driver), PChar(device), PChar(output), nil);     if dc = 0 then     begin         le := GetLastError;         raise Exception.CreateFmt('Could not get information context for printer "%s": %s (%d)', [device, SysErrorMessage(le), le]);     end; end;     </code></pre>  <p>The code fails on my Windows 10 desktop, but works on Windows 7.</p>  <p>And in both cases i'm using the same printer:</p>  <ul> <li><p>Windows 7</p>  <p><a href="http://i.stack.imgur.com/S6xaT.png" rel="nofollow"><img src="http://i.stack.imgur.com/S6xaT.png" alt="enter image description here"></a></p></li> <li><p>Windows 10 <a href="http://i.stack.imgur.com/AKaqN.png" rel="nofollow"><img src="http://i.stack.imgur.com/AKaqN.png" alt="enter image description here"></a></p></li> </ul>  <p>What am i<sup>1</sup> doing wrong?</p>  <h1>CreateDC also fails</h1>  <p><code>CreateIC</code> is just a <em>"lightweight"</em> form of <code>CreateDC</code> (you can use it to get information about a device, but you can't draw GDI with it). It also means that <code>CreateDC</code> also fails on Windows 10:</p>  <pre><code>procedure TForm1.Button1Click(Sender: TObject); var     driver, device: string;     dc: HDC;     le: DWORD; begin     driver := '';     device := 'Microsoft XPS Document Writer';      dc := CreateDC(PChar(driver), PChar(device), nil, nil);     if dc = 0 then     begin         le := GetLastError;         raise Exception.CreateFmt('Could not get device context for printer "%s": %s (%d)', [device, SysErrorMessage(le), le]);     end; end;     </code></pre>  <h1>Bonus Reading</h1>  <ul> <li><a href="http://qc.embarcadero.com/wc/qcmain.aspx?d=127390" rel="nofollow">QC127390: Operation not supported on selected printer</a></li> <li><a href="http://stackoverflow.com/questions/31137253/random-printer-selected-is-not-valid-errors-on-win2k8r2">Random &quot;Printer selected is not valid&quot; errors on Win2K8R2</a></li> </ul>  <p><sup>1</sup> Not me; Embarcadero</p>