<p>I am working on a report for our company which is a Speed Report. This is data that is collected from our fleet of vehicles. We have configured parameters to flag who is speeding above a certain threshold based on State they were driving, posted speed limit for that location, etc.</p>  <p>My SQL query is using a CTE. When selecting from my CTE I am wrapping inside of it two select statements. One select statement is for the records that meet or exceed the threshold requirement. I have a field named SpeedingEvent and those records contain a value of "Y" for Yes. The second select statement is returning the records that do not meet or exceed the threshold, and the SpeedingEvent value is "N" for No. The results of these two select statements are joined with a UNION.</p>  <p>Kind of odd, but my company wants the ability to also see the speeding events that occurred even though they did not meet the threshold. My problem is that some of those excluded records, those with a SpeedingEvent value of "N", do not have a matching record in the dataset where the SpeedingEvent = "Y" and where the Date and Fleet number are a match.</p>  <p>So, when my SSRS report is generated I am seeing these rows of data that are excluded but don't have any relationship with an existing record that does meet the threshold.</p>  <p>I have tried creating a subquery, but that is not working as I am getting an error message stating that the subquery returned more than 1 value and it is not permitted when using certain comparison values.</p>  <p>Here is a sample of my code. It is not everything, as there are many fields that are being returned.</p>  <pre><code>WITH cteSpeedReport([List of fields]) AS ( SELECT DISTINCT      [List of fields] FROM      [4 views that are being joined] WHERE      [Criteria for meeting threshold] ) SELECT DISTINCT      [List of Fields] FROM ( SELECT DISTINCT DStartDate, DEndDate, DAssetID, DFleet, (DMax - DStateLimit) as DMaxOver, DEventStart, DEventEnd, DTotalEventSpeedingTime, EventSpeedingTimeInSeconds, DLimit, DStateLimit, DMax, EquipTypeQualifier, NDAssetID, NDFleet, NDDate, NDDriveTime, NDTotalDriveTimeInSeconds, SpeedPercentage, MilesSpeeding, CLatLong, CMapLink, CLocation, CMaxReportedSpeed, hlvl1no, hlvl1name, hlvl2no, hlvl2name, hlvl3no, hlvl3name, hlvl9no, hlvl9name, asset_id, asset_descr, equip_type, equiptype_code, insp_fleet, MaxSpdStartTime, MaxSpdEndTime, cast('Y' as char(1)) SpeedingEvent from cteSpeedReport cteSR where        (EquipTypeQualifier = 'Y'      AND ((CLocation = 'Michigan' AND              (DLimit = 70 AND DMax &gt;= 70)             OR (DLimit = 65 AND DMax &gt;= 71.5)             OR (DLimit = 60 AND DMax &gt; 66)             OR (DLimit &lt;= 55 AND DMax &gt;= (DLimit * 1.10)))         OR (CLocation = 'Indiana' AND             (DLimit = 70 AND DMax &gt; 71.5)             OR (DLimit = 65 AND DMax &gt; 71.5)             OR (DLimit &lt;= 55 AND DMax &gt;= (DLimit * 1.10)))))     OR (DMax &gt;= (DLimit * 1.10)) UNION SELECT DISTINCT DStartDate, DEndDate, DAssetID, DFleet, (DMax - DStateLimit) as DMaxOver, DEventStart, DEventEnd, DTotalEventSpeedingTime, EventSpeedingTimeInSeconds, DLimit, DStateLimit, DMax, EquipTypeQualifier, NDAssetID, NDFleet, NDDate, NDDriveTime, NDTotalDriveTimeInSeconds, SpeedPercentage, MilesSpeeding, CLatLong, CMapLink, CLocation, CMaxReportedSpeed, hlvl1no, hlvl1name, hlvl2no, hlvl2name, hlvl3no, hlvl3name, hlvl9no, hlvl9name, asset_id, asset_descr, equip_type, equiptype_code, insp_fleet, MaxSpdStartTime, MaxSpdEndTime, cast('N' as char(1)) SpeedingEvent from cteSpeedReport cteSRN where        (EquipTypeQualifier = 'Y'     AND ((CLocation = 'Michigan' AND              (DLimit = 70 AND DMax &lt; 70)             OR (DLimit = 65 AND DMax &lt; 71.5)             OR (DLimit = 60 AND DMax &lt;= 66)             OR (DLimit &lt;= 55 AND DMax &lt; (DLimit * 1.10)))         OR (CLocation = 'Indiana' AND             (DLimit = 70 AND DMax &lt;= 71.5)             OR (DLimit = 65 AND DMax &lt;= 71.5)             OR (DLimit &lt;= 55 AND DMax &lt; (DLimit * 1.10))))     )     OR (DMax &lt; (DLimit * 1.10)) ) a where     a.NDTotalDriveTimeInSeconds =     (SELECT sr.NDTotalDriveTimeInSeconds FROM cteSpeedReport sr     where sr.DStartDate = a.DStartDate and sr.DFleet = a.DFleet     ) order by SpeedingEvent desc, DStartDate, hlvl9name, DFleet, DEventStart </code></pre>  <p>Any assistance would be greatly appreciated.</p>