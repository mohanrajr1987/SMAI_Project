<p>I'd like to do a <code>prorata</code> calculation in PL/SQL but I have no clue how to do so.</p>  <p>Here my exemple :</p>  <pre><code>ID  class  Wages  Premium 1     A    15000     250 2     A    10000      0 </code></pre>  <p>I'd like to compute premium on a prorata basis within class, i.e. for every ID in each CLASS, I'd like to compute the premium on a prorata basis with respect to Wages.</p>  <p>Here, for ID 1,  it would : </p>  <pre><code>premium = (15000 *sum(premium))/(sum(wages)) = (15000 * 250)/(25000) = 150 </code></pre>  <p>Thus, for ID 2 : </p>  <pre><code>premium = (10000 * 250)/(25000) = 100 </code></pre>  <p>Obviously I have to do that on more voluminous data... But I haven't done much PL/SQL till now...</p>  <p>I may add that I MUST do it throgh an update statement...</p>  <p>Please could you help me ?</p>  <p>Thanks a lot</p>