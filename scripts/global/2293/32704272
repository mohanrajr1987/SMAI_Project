<p>I am working with Push Notification for ios devices. Bulk push notification not working properly with apple APNs. Apple push notification service in Bulk but does work with multiple times connection open close in a day.But if you think to reconnect with rest of device tokens in multiple times, then server will block you. So In loop send push notification  for every device token. it working fine for small range of device token ex. 50. But when go with 1000 devices , it fails and break its connection and shows broken pipe issue . For ex. for 1st time it breaks over 700 devices but 2nd time breaks over 500 devices  and 3rd time it disconnected from server . </p>  <p>My code is bellow.</p>  <pre><code>$ctx = stream_context_create(); stream_context_set_option($ctx, 'ssl', 'local_cert', $localcert); stream_context_set_option($ctx, 'ssl', 'passphrase', $passphrase);  // Open a connection to the APNS server $fp = stream_socket_client(     'ssl://gateway.push.apple.com:2195', $err,     $errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx);  // Create the payload body  $body['aps'] = array(     'alert' =&gt; $message,     'sound' =&gt; 'default'     );  // Encode the payload as JSON $payload = json_encode($body);  // Build the binary notification  foreach($deviceToken as $key=&gt;$value) {  $msg = chr(0) . pack('n', 32) . pack('H*', $value) . pack('n', strlen($payload)) . $payload;  // Send it to the server  $result = fwrite($fp, $msg, strlen($msg)); }  fclose($fp); </code></pre>  <p>Please tell me what Iâ€™m doing wrong?. Is there any way to send multiple push notification from Php server to all devices without using any Loop. Thank you .</p>