<p>I have these entities:</p>  <ul> <li>User</li> <li>Role</li> <li>Permission</li> </ul>  <p>A user has many roles and a role has many permissions.</p>  <p>What is the best way to retrieve a set of permission a user has?</p>  <p>I need a method to check if a User has a particular Permission.</p>  <p>This is what I have so far:</p>  <pre><code>public boolean hasPermission(String permissionString) {     if (!authenticated) return false;     for (Role role : user.getRoles()) {         for (Permission permission : role.getPermissions()) {             if (permission.getName().equals(permissionString)) {                 return true;             }         }     }     return false; } </code></pre>  <p>A second, but related question -- where should I put the code that checks if a user has a particular permission?</p>  <ul> <li>In the User entity?</li> <li>In the UserBean EJB?</li> <li>In the Authentication JSF Managed Bean?</li> </ul>