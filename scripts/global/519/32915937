<p>I was referring to the example program provided <a href="https://msdn.microsoft.com/en-us/library/dd389098(v=vs.85).aspx" rel="nofollow">here</a> to run a video file, <em>in my case mp4 format</em> using DShow.</p>  <p>Refer to the complete code:</p>  <pre><code>#include &lt;dshow.h&gt; #pragma comment (lib, "strmiids.lib") void main(void) {     IGraphBuilder *pGraph = NULL;     IMediaControl *pControl = NULL;     IMediaEvent   *pEvent = NULL;      // Initialize the COM library.     HRESULT hr = CoInitialize(NULL);     if (FAILED(hr))     {         printf("ERROR - Could not initialize COM library");         return;     }      // Create the filter graph manager and query for interfaces.     hr = CoCreateInstance(CLSID_FilterGraph, NULL, CLSCTX_INPROC_SERVER,                          IID_IGraphBuilder, (void **)&amp;pGraph);     if (FAILED(hr))     {         printf("ERROR - Could not create the Filter Graph Manager.");         return;     }      hr = pGraph-&gt;QueryInterface(IID_IMediaControl, (void **)&amp;pControl);     hr = pGraph-&gt;QueryInterface(IID_IMediaEvent, (void **)&amp;pEvent);      // Build the graph. IMPORTANT: Change this string to a file on your system.     hr = pGraph-&gt;RenderFile(L"C:\\Example.avi", NULL);     if (SUCCEEDED(hr))     {         // Run the graph.         hr = pControl-&gt;Run();         if (SUCCEEDED(hr))         {             // Wait for completion.             long evCode;             pEvent-&gt;WaitForCompletion(INFINITE, &amp;evCode);              // Note: Do not use INFINITE in a real application, because it             // can block indefinitely.         }     }     pControl-&gt;Release();     pEvent-&gt;Release();     pGraph-&gt;Release();     CoUninitialize(); } </code></pre>  <p>However when I build the program, the build is sucessful but when I run it, the console window pops up and disappears within a second.</p>  <p>I referred to the comments on the same page and many others faced the same issue. However a few were able to successfully run the program.</p>  <p>What is it that I am doing wrong?</p>  <p>Is it the type of project I am selecting? I am selecting <code>win32 console application</code>. Should I select something else? Or is there something else that I am doing wrong?</p>