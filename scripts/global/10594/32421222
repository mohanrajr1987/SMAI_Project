<p>I am trying to parse URLs containing <code>&amp;</code> with <code>preg_replace</code>.</p>  <pre><code>$content = preg_replace('#https?://[a-z0-9._/\?=&amp;-]+#i', '&lt;a href="$0" target="_blank"&gt;$0&lt;/a&gt;', $content); </code></pre>  <p>But I use it for user comments, so I'm also using htmlspecialchars() function to prevent XSS.</p>  <pre><code>function formatContributionContent($content) {     $content = nl2br(htmlspecialchars($content));      // Regexp for mails     $content = preg_replace('#[a-z0-9._-]+@[a-z0-9._&amp;-]{2,}\.[a-z]{2,4}#', '&lt;a href="mailto:$0"&gt;$0&lt;/a&gt;', $content);      // Regexp for urls     $content = preg_replace('#https?://[a-z0-9._/\?=&amp;-]+#i', '&lt;a href="$0" target="_blank"&gt;$0&lt;/a&gt;', $content);      var_dump($content); }  formatContributionContent('https://openclassrooms.com/index.php?page=3&amp;skin=blue'); </code></pre>  <p>And htmlspecialchars transforms <code>&amp;</code> into <code>"&amp;amp;"</code> so my regexp produce a wrong result. Indeed, with the following URL.</p>  <pre><code>http://www.siteduzero.com/index.php?page=3&amp;skin=blue </code></pre>  <p>I obtain <code>;</code></p>  <pre><code>&lt;a href="https://openclassrooms.com/index.php?page=3&amp;amp" target="_blank"&gt;https://openclassrooms.com/index.php?page=3&amp;amp&lt;/a&gt;;skin=blue </code></pre>