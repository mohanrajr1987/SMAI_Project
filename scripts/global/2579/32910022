<p>I have a application using local web services that output the data into a csv file. The application works well the only problem its that in the final output (csv file) its only getting the data from the last <code>url(https://localhost/test3).</code></p>  <p>I need to have all 3 data from the urls with the all the information </p>  <pre><code>(ProjectID, ProjectTitle and url) </code></pre>  <p>Here you have my <code>XMLSchema:</code></p>  <pre><code>public static string GetXMLInfo() {             var datasSource = @"&lt;?xml version=""1.0"" encoding=""utf-16""?&gt;             &lt;xs:schema id=""NewDataSet"" xmlns="""" xmlns:xs=""http://www.w3.org/2001/XMLSchema"" xmlns:msdata=""urn:schemas-microsoft-com:xml-msdata""&gt;                &lt;xs:element name=""NewDataSet"" msdata:IsDataSet=""true"" msdata:UseCurrentLocale=""true""&gt;                   &lt;xs:complexType&gt;                      &lt;xs:choice minOccurs=""0"" maxOccurs=""unbounded""&gt;                         &lt;xs:element name=""Table""&gt;                            &lt;xs:complexType&gt;                               &lt;xs:sequence&gt;                                 &lt;xs:element name = ""url"" type=""xs:string"" minOccurs=""0""/&gt;                                 &lt;xs:element name=""key"" type=""xs:string"" minOccurs=""0""/&gt;                               &lt;/xs:sequence&gt;                            &lt;/xs:complexType&gt;                         &lt;/xs:element&gt;                      &lt;/xs:choice&gt;                   &lt;/xs:complexType&gt;                &lt;/xs:element&gt;             &lt;/xs:schema&gt;             ";             return datasSource; } </code></pre>  <p>Here you have my code: where the key and the url are mandatory to be able to extract data.</p>  <pre><code>DataSet dataSet = new DataSet(); using (var reader = new StringReader(GetXMLInfo())) {     dataSet.ReadXmlSchema(reader);         for (int i = 0; i &lt; dataSet.Tables.Count; ++i)             {                 var row = dataSet.Tables["Table"].NewRow();                 row["url"] = "https://localhost/test1";                 row["url"] = "https://localhost/test2";                 row["url"] = "https://localhost/test3";                 row["key"] = "2b7346bc-6fb2";                 row["key"] = "f8df7455-2898";                 row["key"] = "0132d900-ee44";                 dataSet.Tables["Table"].Rows.Add(row);             } }  Url = dataSet.Tables[0].Rows[i]["url"].ToString();  KeyHeaderValue = new GetStatus.KeyHeader();  //where GetStatus its one of the web services that I am calling                       KeyHeaderValue.Value = dataSet.Tables[0].Rows[i]["key"].ToString();  using (FileStream fs = new FileStream(outCsvFile, FileMode.Append, FileAccess.Write)) {     using (StreamWriter file = new StreamWriter(fs))     {         file.WriteLine("ProjectID, ProjectTitle,URL");         foreach (ProjectData proj in pr.Distinct(new ProjectEqualityComparer()))             {                 file.WriteLine("{0},\"{1}\",{2}",                 proj.ProjectID,                 proj.ProjectTitle,                 dataSet.Tables[0].Rows[i]["url"].ToString());             }                              } }            </code></pre>  <p>What I am suppose to have its the <code>projectID, the ProjectTitle and the URL</code> for all 3 sites being separated with the header coming from the first <code>file.WriteLine</code>                  </p>  <p>How I could achieve this?</p>