<p>In one COM library I have defined several constants. If I do not put them in a 'module' block they do not appear to be added to the library at all.</p>  <pre class="lang-cpp prettyprint-override"><code>// Type1Lib.idl  // Required system imports. import "oaidl.idl"; import "ocidl.idl";  [     uuid(B777544C-77D9-4417-8302-4EAC8272DEDC),     version(1.0), ] library Type1Lib {    // Required system import.    importlib("stdole2.tlb");     const int Constant1 = 5;   // Does not appear in type library.     module Constants    {       const int Constant2 = 5;    };     // Other types... }; </code></pre>  <p>I have another COM library that consumes the first library and which needs to use the constants defined in it.</p>  <pre class="lang-cpp prettyprint-override"><code>// Type2Lib.idl  // Required system imports. import "oaidl.idl"; import "ocidl.idl";   import "Type1Lib.idl";  [    uuid(D40AC182-8744-42D1-B194-602AEDDC6E7C),    version(1.0), ] library Type2Lib {    // Required system import.    importlib("stdole2.tlb");     importlib("Type1Lib.dll");     // An enum that needs to use the constant values defined in Type1Lib.    typedef enum Enum1    {       A = Constant2,    // FAIL.       B = Type1Lib.Constant2,    // FAIL.       C = Type1Lib.Constants.Constant2,    // FAIL.       D = Type1Lib.Constants::Constant2    // FAIL.    } Enum1;     // Other types... }; </code></pre>  <p>In the second library I've tried importlib on the library itself, and import'ing the first library's IDL file directly, yet no matter what syntax I use am unable to access any of the constants defined in the first library. It fails every time with "error MIDL2035: constant expression expected".</p>  <p>What is the correct syntax for this please?</p>