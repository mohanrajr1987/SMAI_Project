<p>I have a Windows Forms app that opens an instance of Excel.  If the user quits the app early, I want to make sure that this Excel instance has been quit.  I tried calling the Excel instance's <code>Quit()</code> method if the instance was not <code>null</code>, like this:</p>  <pre><code>static class Program     {         [STAThread]         static void Main()         {             Application.EnableVisualStyles();             Application.SetCompatibleTextRenderingDefault(false);             Form1 form1 = new Form1();             Application.Run(form1);             form1.logFile.close();             if (form1.xlApp != null)             {                 form1.xlApp.Quit();             }         }     } </code></pre>  <p>But if I quit the Excel app in Task Manager and then close the GUI, I get this error:</p>  <pre><code>System.Runtime.InteropServices.COMException (0x800706BA):  The RPC server is unavailable. (Exception from HRESULT: 0x800706BA) </code></pre>  <p>A check of <code>(xlApp==null)</code> in the Immediate window showed that <code>xlApp</code> was not null, even though there was no instance of Excel running.</p>  <p>So I tried removing the <code>Quit()</code> line and using this instead:</p>  <pre><code>Marshal.ReleaseComObject(form1.xlApp); </code></pre>  <p>This worked fine for closing without error when the user quits the Excel app early, but if the instance is still running in Task Manager when the GUI is closed, the <code>ReleaseComObject()</code> call does not end the Excel instance.</p>