<p>I need to add lines and labels to a chart I've got in an Excel file. Currently I'm using Apache POI to read the file and modify it. At the moment I am able to read it and read the chart with either <code>XSSFWorkbook</code> (if the file is XLSX) and <code>HSSFWorkbook</code> if it is a plain old XLS file</p>  <p>(as a side note: with <code>HSSF*</code> I am a little bit able to read info about the graphic disposition (coordinates) of the chart, while with the <code>XSSL*</code> classes I get only zeros for the coordinates of the chart and other UI data, so I stick with <code>HSSF*</code>).</p>  <p>I am able to get a handle to the chart, either with a <code>Chart</code> or with a <code>Shape</code> class. I've opted to use the <code>Shape</code> class so I can (hopefully) add a sub-shape to it.</p>  <p>My test aims to just add a single diagonal red line to the chart, but so far I've failed:</p>  <ol> <li>if I create the shape via the patriarch, the shape is displayed, but the chart disappears</li> <li>if I create the shape as a child to the chart, no shape is displayed, but the chart is still visible.</li> </ol>  <p>What am I missing? Can anybody help? This is my code so far:</p>  <pre><code>private static void decorateExcel(String inFile, String outFile) throws Exception{     FileInputStream fis = new FileInputStream(inFile);     HSSFWorkbook wb = new HSSFWorkbook(fis);     HSSFSheet chartSheet = (HSSFSheet)wb.getSheetAt(0);     HSSFPatriarch patriarch = (HSSFPatriarch)chartSheet.getDrawingPatriarch();      for(HSSFChart chart : HSSFChart.getSheetCharts(chartSheet)){          //chart is reference to my Graph, but is pretty useless     }      //chart is the only child     HSSFShape chart=null;     for(HSSFShape shape: patriarch.getChildren()) {         chart=shape;     }      //these are known data     int colStart=3;     int colEnd=23;     int rowStart = 2;     int rowEnd = 15;      if(chart!=null){         HSSFAnchor a= chart.getAnchor();         System.out.println("Shape child is "+a.getDx1()+","+a.getDy1()+" "+a.getDx2()+","+a.getDy2()+" ");          //shape is graph         HSSFClientAnchor a1 = patriarch.createAnchor(228, 0, 229, 255,  colStart, rowStart, colEnd, rowEnd);  //      If I uncomment this, shape "overwrites" chart //      HSSFSimpleShape shape1 = patriarch.createSimpleShape(a1);  //      While this way, shape does not appear         HSSFSimpleShape shape1=new HSSFSimpleShape(chart,a1);          shape1.setShapeType(ShapeTypes.LINE);          shape1.setLineStyleColor(255, 10, 10);         shape1.setNoFill(true);          shape1.setLineWidth(5);     }      FileOutputStream fileOut = new FileOutputStream(outFile);     wb.write(fileOut);     fileOut.close(); } </code></pre>  <p>That's all.. If I open the ooutput file either i can see the Chart, but with no diagonal line, or I can see the line, (well at the moment it's a rectangle) but I cannot see the chart anymore, it has vanished.</p>