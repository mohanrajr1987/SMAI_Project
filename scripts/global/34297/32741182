<p>I use the <strong>Apache POI 3.13-beta1</strong> and other set of the latest extra libs from maven's repo.</p>  <p>The main problem is that I have to edit a old MS word document with .doc extension. <strong>NOT .docx</strong><br> I use this code as default:</p>  <pre><code>public static void replaceLinksInWordDoc() {         String filePath = "d:\\doc\\file1.doc";         Range docRange = null;         Paragraph paragraph = null;         CharacterRun charRun = null;         try {             // Create an instance of the POIFSFileSystem class and attach it to the Word document using an InputStream.             HWPFDocument document = new HWPFDocument(new FileInputStream(new File(filePath)));             // Get a reference to the overall Range for the document and discover how many Paragraphs objects there are in the document.             docRange = document.getRange();             int numParagraphs = docRange.numParagraphs();              // Step through each Paragraph             for (int i = 0; i &lt; numParagraphs; i++) {                 paragraph = docRange.getParagraph(i);                 // Get the number of CharacterRuns in the Paragraph and step through each one.                 int numCharRuns = paragraph.numCharacterRuns();                 for (int j = 0; j &lt; numCharRuns; j++) {                     charRun = paragraph.getCharacterRun(j);                     // Get the text from the CharacterRun and recover an Iterator to step through the Set of keys.                     String text = charRun.text();                     if (text.contains("www")) {                         int start = text.indexOf("www");                         // HERE I HAVE a problem                         charRun.replaceText("www", "rrr", start);                         // it is not work correct too                         // charRun.replaceText("www", "rrr");                     }                 }             }             document.write(new FileOutputStream(new File(filePath.replace("file", "file_result"))));         } catch (Exception e) {             e.printStackTrace();         }     } </code></pre>  <p>My test file contains 10 pages. I found that when I remove 4th and 5th pages this file is saved correct and can be opened, but when it contains these 4th and 5th pages - it has a problem like:</p>  <pre><code>Word experienced an error trying to open the file </code></pre>  <p>I tried to remove others pages. It didn't help. I think that it depends on some markup on these 2 pages. Does anyone know any bad paragraph marks, other  hidden formatting symbols or anything else for saving .doc files? Maybe I can set them by default value or remove them.</p>  <p>Thanks!</p>