<p>So i'm using Apache POI library for reading an Excel file (.xlsx), and what i'm trying to do is simple: I want to iterate through all the cells but read the text of only red\yellow\green\blue cells, and skip all the others.</p>  <p>Assume this:</p>  <ul> <li>The file loaded is not empty and contains colorated cells,</li> <li>I imported all the needed libraries.</li> </ul>  <p>Following the guide (<a href="http://poi.apache.org/spreadsheet/quick-guide.html#Iterator" rel="nofollow">http://poi.apache.org/spreadsheet/quick-guide.html#Iterator</a>), i ended up coding this:</p>  <pre><code>... ...             // why 15? 1400? no idea.. the guide doesn't explain... also isn't it dangerous??          int rowStart = Math.min(15, sheet.getFirstRowNum());          int rowEnd = Math.max(1400, sheet.getLastRowNum());              // iterate through ROWS:              for (int rowNum = rowStart; rowNum &lt; rowEnd; rowNum++) {                  // returns 'rowNum' row of current sheet:                 Row r = sheet.getRow(rowNum);                  if(r == null) {                            System.out.println("empty row skipped");                            continue;                            }                   // iterate through CELLS:                  for (Cell cell : r) {                      if(cell == null) {                         System.out.println("empty cell");                         continue;                         }                          XSSFColor colore = (XSSFColor) cell.getCellStyle().getFillForegroundColorColor();                          if (colore == null) {                                 System.out.println("something wrong?");                                 continue;                             }                             // checking colors like this:                         if(colore.getARGBHex().substring(2, 5).equals("FFFF")){                                 // working on cell                                 continue;                             }                          if(colore.getARGBHex().substring(4, 5).equals("FF")){                                 // working on cell                                 continue;                             }                          if(colore.getARGBHex().substring(6, 7).equals("FF")){                                 // working on cell                                 continue;                             }                          if(colore.getARGBHex().substring(2, 3).equals("FF")){                                 // working on cell                                 continue;                             }                          } </code></pre>  <p>When i execute the code, it ends up printing "Something wrong?" thousand times, as if colore is alwais null in all the cells. So questions are:</p>  <ol> <li>why it alwais find colore null? (i also tried .getFillBackgroundColorColor())</li> <li>is there a smarter way for checking the colors rather than using those  horrible if-statements?</li> </ol>  <p>Thanks in advance!</p>