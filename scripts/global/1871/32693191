<p>I am trying to compile a Fortran file with an external precompiled module. First I compile the module file with:</p>  <pre><code>ifort /c KDTree_mod.f90 </code></pre>  <p>it generates some .mod files (kdtree2_module.mod, kdtree2_precision_module.mod, kdtree2_priority_queue_module.mod).</p>  <p>At the beginning of the subroutine I have:</p>  <pre><code>subroutine film(h,tinf,ts,n,time) use kdtree2_module </code></pre>  <p>but when I launch the program it gives me this error:</p>  <pre><code>user_film.obj : error LNK2019: unresolved external symbol KDTREE2_MODULE_mp_KDTREE2_CREATE referenced in function FILM user_film.obj : error LNK2019: unresolved external symbol KDTREE2_MODULE_mp_KDTREE2_N_NEAREST referenced in function FILM user_film.exe : fatal error LNK1120: 2 unresolved externals link failed for user_film.obj </code></pre>  <p>Procedure:<br> 1. compile the module with <code>ifort /c KDTree_mod.f90</code><br> 2. launch MSC Marc with user subroutine film.<br>      <code>run_marc -j name_input_file -u user_subroutine</code><br> 3. Error</p>  <p>MSC Marc is a commercial software that has the possibility to create user subroutine.</p>  <p><strong>Update:</strong><br> I tried:<br> 1. <code>ifort /c KDTree_mod.f90</code> --> generate .obj file<br>    <code>run_marc -j name_input_file -obj name_obj.obj -u name_input_file</code><br>    It compiles fine but suddenly error:</p>  <blockquote>   <p>forrtl: severe (170): Program Exception - stack overflow Image<br>   PC                Routine            Line        Source</p>      <p>user_film.exe   0000000141D63717  Unknown               Unknown    Unknown user_film.exe   000000013FD45C96  Unknown<br>   Unknown  Unknown user_film.exe   000000013FF1CCC7  Unknown<br>   Unknown  Unknown user_film.exe   000000013FD9495E  Unknown<br>   Unknown  Unknown user_film.exe   00000001405A819A  Unknown<br>   Unknown  Unknown user_film.exe   0000000140236B11  Unknown<br>   Unknown  Unknown user_film.exe   000000013FFE32DB  Unknown<br>   Unknown  Unknown user_film.exe   000000013FFEE6C1  Unknown<br>   Unknown  Unknown user_film.exe   000000013FE70FAE  Unknown<br>   Unknown  Unknown user_film.exe   000000013FD51592  Unknown<br>   Unknown  Unknown user_film.exe   000000013FD4105D  Unknown<br>   Unknown  Unknown user_film.exe   00000001424CE3DC  Unknown<br>   Unknown  Unknown user_film.exe   0000000141D638B2  Unknown<br>   Unknown  Unknown kernel32.dll       0000000077475A4D  Unknown<br>   Unknown  Unknown ntdll.dll          00000000775AB831  Unknown<br>   Unknown  Unknown</p> </blockquote>  <ol start="2"> <li><p><code>ifort /c KDTree_mod.f90 ifort /c user_film.f run_marc -j name_input_file -obj KDtree_mod.obj user_film.obj<br> read error: no such option: user_film.obj or input value: -b</code><br> So seems that I am not able to pass both .obj files.</p></li> <li><p><code>ifort /c KDTree_mod.f90 ifort /c user_film.f KDTree_mod.obj ifort: warning #10146: no action performed for specified object file(s)</code></p></li> </ol>  <p>Marc in verbose: <a href="http://pastebin.com/6rd8v5Eh" rel="nofollow">http://pastebin.com/6rd8v5Eh</a></p>  <p><strong>Update 2</strong> I am able to compile a dll file with these commands:</p>  <pre><code>ifort /nologo /iface:stdcall /libs:dll /threads /c KDTree_mod.f90 link /NOLOGO /SUBSYSTEM:WINDOWS /manifest /dll /out:KDTree_mod.dll KDTree_mod.obj mt /nologo “/outputresource:KDTree_mod.dll;#2″ /manifest KDTree_mod.dll.manifest </code></pre>