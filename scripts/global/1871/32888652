<p>I have the following Fortran code</p>  <pre><code>DO ir = 1, N      cfac = exp( ci*B ) / dble( degen(ir) )      C(:,:) = C(:,:) + cfac*D(:,:, ir ) ENDDO </code></pre>  <p>This loop take 14.00s with gcc -02. </p>  <p>I would like to optimize it. I tried with the BLAS routine that does matrix-vector multiplication:</p>  <pre><code>DO ir = 1, N    cfac(ir) = exp( ci*B ) / dble( degen(ir) ) ENDDO  DO j = 1, M   CALL zgemv ('n', M, N, cone, D(j,:,:), M,cfac(:),1,czero, C(j,:), 1 ) ENDDO </code></pre>  <p>Turns out, I get the same result but in ... 17.67s.</p>  <p>Why is it slower and how can I improve the code (without changing compiler option)?</p>  <p>Thank you, </p>  <p>Samuel</p>