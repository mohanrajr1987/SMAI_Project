<p>I am using the Rails Tutorial 3 to roll my own authentication system and it works until I try the password reset part. When I submit the password reset form a token is created and stored in the database as <code>reset_password_token</code>. Then an email is sent with a link to the password reset form which looks like this:</p>  <pre><code>&lt;a href="http://localhost:3000/password_resets/$2a$10$UU.bHK5V4o6BFRFPqjtPoOV12aSwq9nvy7OQuxFp.rFjK6lqfJali/edit?email=myemail"&gt;Reset password&lt;/a&gt; </code></pre>  <p>When I click the link (or copy/paste it because it's local) I get an error:</p>  <pre><code>No route matches [GET] "/password_resets/$2a$10$XAh7yOyphGR84n5fSBUZhuM4WpuyVwLayIZgB0QTTF.q3PgKX9Kz6/edit" </code></pre>  <p>But the rake routes shows the route does exist:</p>  <pre><code>edit_password_reset_path    GET /password_resets/:id/edit(.:format) password_resets#edit </code></pre>  <p>The only difference between my code and the code in the tutorial is that the my token seems to be longer. It is around 60 characters whereas Hartl's is around 22. Also, when I type <code>SecureRandom.urlsafe_base64</code> into the console I get a 22 character token. I'm not sure why it is creating a longer one but also I'm not sure it matters.</p>  <p><strong>Update</strong></p>  <p>Mailer template:</p>  <pre><code>To reset your password click the link below:  &lt;%= edit_password_reset_url(@user.reset_password_token, email: @user.email) %&gt;  This link will expire in two hours.  If you did not request your password to be reset, please ignore this email and your password will stay as it is. </code></pre>