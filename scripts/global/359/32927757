<p>I am trying to make an app in Rails 4.</p>  <p>I am using CanCanCan for permissions and Role_Model for roles management.</p>  <p>In my ability.rb, I have defined student abilities as:</p>  <pre><code> elsif user.try(:profile).present? &amp;&amp; user.profile.has_role?(:student)        student_abilities </code></pre>  <p>and then:</p>  <pre><code>def student_abilities can :read, Project.visible.current.available </code></pre>  <p>In my project.rb I have defined scopes as:</p>  <pre><code>    scope :visible, lambda { joins(:sweep =&gt; :disclosure).where('disclosures.allusers' =&gt; 'true')         .joins(:sweep =&gt; :finalise).where('finalises.draft' =&gt; 'false') }   scope :current, lambda { where('project.start_date &gt;= ?', Date.today)}   scope :available, lambda { where('closed =', 'false')} </code></pre>  <p>When I try to start the server and generate a view, I get this error:</p>  <pre><code>NoMethodError at /project_invitations undefined method `available' for #&lt;Project::ActiveRecord_Relation:0x007fdde41f2ee8&gt; </code></pre>  <p>When I try removing available from the end of the ability, so that its just:</p>  <pre><code>can :read, Project.visible.current </code></pre>  <p>I get this error:</p>  <pre><code> entry for table "project" LINE 1: ..." = 'true' AND "finalises"."draft" = 'false' AND (project.st...                                                              ^ </code></pre>  <p>I don't know why it won't let me read the end of the error message.</p>  <p>Can anyone see what I've done wrong?</p>