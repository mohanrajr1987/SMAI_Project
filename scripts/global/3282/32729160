<p>help me please with implementing semantic code from manual about SCRAM-SHA-1 authorization in XMPP server. So, we got:</p>  <pre><code>clientFinalMessageBare = "c=biws,r=" .. serverNonce saltedPassword = PBKDF2-SHA-1(normalizedPassword, salt, i) clientKey = HMAC-SHA-1(saltedPassword, "Client Key") storedKey = SHA-1(clientKey) authMessage = initialMessage .. "," .. serverFirstMessage .. "," .. clientFinalMessageBare clientSignature = HMAC-SHA-1(storedKey, authMessage) clientProof = clientKey XOR clientSignature clientFinalMessage = clientFinalMessageBare .. ",p=" .. base64(clientProof) </code></pre>  <p>My PHP code:</p>  <pre><code>$cfmb = 'c=biws,r='.$salt;      $saltpass = hash_pbkdf2('sha1', 'IDoMdGuFE9S0', $ps, $iter);         //hash_pbkdf2('sha1', 'IDoMdGuFE9S0', $salt, $iter, 0, true); maybe like that??? $ckey = hash_hmac('sha1', $saltpass, 'Client Key'); $sckey = sha1($ckey); $authmsg = $im.','.$chal.','.$cfmb; $csign = hash_hmac('sha1', $sckey, $authmsg); $cproof = bin2hex(pack('H*',$ckey) ^ pack('H*',$csign)); $cfm = $cfmb.',p='.base64_encode($cproof); </code></pre>  <p>Somewhere error (maybe ALL big error ;)) and I very need your help for correcting my code, maybe I am use wrong functions, or arguments in wrong positions? Because result - fail, server sends me that:</p>  <p>"The response provided by the client doesn't match the one we calculated."</p>  <p>PS: Sorry for my bad English ;)</p>