<p>I am searching for the solution to create, edit and delete the <code>Virtual directory entry</code>  in <strong>IIS</strong>. </p>  <p>I am using following code:  <strong>Get the IIS Server root virtuakl directory</strong></p>  <pre><code>function GetIISWebServer(WebServerIndex: integer = 1): Variant; var   BindContext: IBindCtx;   Eaten: longint;   Moniker: IMoniker;   ServerRootDispatch: IDispatch;   MonikerString: WideString; const   WebServiceMoniker = 'IIS://localhost/W3SVC'; begin   MonikerString := WebServiceMoniker + '/' + IntToStr(WebServerIndex);   OleCheck(CreateBindCtx(0, BindContext));   OleCheck(MkParseDisplayName(BindContext, PWideChar(MonikerString), Eaten, Moniker));   OleCheck(Moniker.BindToObject(BindContext, nil, IDispatch, ServerRootDispatch));    if (ServerRootDispatch = nil) then     raise Exception.Create('Unable to retrieve Server Root object using the Moniker "' + MonikerString + '"');    Result := ServerRootDispatch; end;  function GetIISWebServerRootVirtualDir(WebServerIndex: Integer = 1): Variant; begin   Result := GetIISWebServer(WebServerIndex).GetObject('IisWebVirtualDir', 'Root'); end; </code></pre>  <p><strong>Check if Virtual Directory already exist</strong></p>  <pre><code>function VirtualDirectoryExists(VirtualDirectoryName : String) : Boolean; var   BindContext: IBindCtx;   Eaten: longint;   Moniker: IMoniker;   ObjectDispatch: IDispatch;   VariantObject: Variant;   WebVirtualDir: Variant; begin   OleCheck(CreateBindCtx(0, BindContext));  try   OleCheck(MkParseDisplayName(BindContext, 'IIS://localhost/W3SVC', Eaten, Moniker));  except   on E : Exception do   begin     ShowMessage(E.Message);     Result := False;     Exit;   end;  end;   OleCheck(Moniker.BindToObject(BindContext, nil, IDispatch, ObjectDispatch));   VariantObject := ObjectDispatch;  try   WebVirtualDir := VariantObject.GetObject('IisWebVirtualDir', '1/Root/' + VirtualDirectoryName);   Result := True;  except    Result := False;  end; end; </code></pre>  <p><strong>Remove the virtual directory</strong></p>  <pre><code>function RemoveVirtualDirectory(VirtualDirectoryName, AppId : String; RemoveApp : Boolean) : Boolean; var   ServerRoot : Variant;   Cat : ICOMAdminCatalog;   Apps : ICatalogCollection;   TmpComp : ICatalogObject;   LTest: Variant;   Idx : Integer;   TmpStr: String;  begin   Result := True;   // check if virtual derectory exist      if VirtualDirectoryExists(VirtualDirectoryName) then   begin     ServerRoot := GetIISWebServerRootVirtualDir;    try     ServerRoot.Delete('IisWebVirtualDir', VirtualDirectoryName);    except     Result := False;    end;    if RemoveApp then    begin      Cat := CoCOMAdminCatalog.Create;      Apps := Cat.GetCollection('Applications') as ICatalogCollection;      Apps.Populate;      Idx := 0;      TmpComp := GetCatalogObjectByName(Apps, AppId);      if TmpComp &lt;&gt; nil then      begin        while Idx &lt; Apps.Count do        begin          if Apps.Item[Idx] = TmpComp then          begin            TmpComp.Value['Deleteable'] := True;            Apps.SaveChanges;            Apps.Remove(Idx);            Apps.SaveChanges;          end          else            Inc(Idx);        end;      end;    end;   end; end; </code></pre>  <p>But the problem is when I am searching and deleting for the virtual directory it convert the web application icon to folder but does not delete it physically.</p>  <p>So because of that I am not able to recreate the same directory. While creating the virtual directory I am getting error as <code>Can not create a file which is already present at the specified path</code></p>  <p>Can anyone help me to find put the cause of the same . and How I can delete and create a virtual directory using delphi.</p>  <p>I am using IIS 7.5 with windows 7 OS.</p>  <p>Any type of suggestion or help me be appreciated.</p>  <p>Thank you in advance.</p>