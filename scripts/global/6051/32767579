<p>So what I am trying to do is difficult for me to articulate but very straightforward, and I can easily show you.  The title is my best guess at the verbage, edits appeciated. </p>  <pre><code>set.seed(1) theta=matrix(rnorm(6,0,1),2,3) M =  c(    0 ,    0   ,   0  ,      0,   1  ,  1,      0   ,   0    ,  0 ,    1,               2 ,     0   ,   0   ,   0, 2,           0  ,    1   ,   0   ,   0 ,2,           1   ,   1    ,  0   ,   0, 3,           0    ,  2   ,   0 ,     0, 3)  M = matrix(M, nrow = 6,ncol= 5,byrow=T)         theta               [,1]     [,2]     [,3] [1,] 0.4418121 1.962053 2.236691 [2,] 1.0931398 1.273616 1.050373  M   prod11 prod12 prod21 prod22 d 1      0      0      0      0 1 2      1      0      0      0 1 3      2      0      0      0 2 4      0      1      0      0 2 5      1      1      0      0 3 7      0      2      0      0 3   OUTPUT DESIRED    prod11 prod12 prod21 prod22 d theta1    theta2 1      0      0      0      0 1 0.4418121 1.0931398 2      1      0      0      0 1 0.4418121 1.0931398 3      2      0      0      0 2 1.962053  1.273616 4      0      1      0      0 2 1.962053  1.273616 5      1      1      0      0 3 2.236691  1.050373 7      0      2      0      0 3 2.236691  1.050373 </code></pre>