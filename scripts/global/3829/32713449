<p>I have a first table with raw data, with just two columns <code>time</code> and <code>temperature</code>:</p>  <pre><code>                            time  temperature 40953 2015-01-01 12:00:00.493000     88.75951 40954 2015-01-01 12:01:00.494000     88.76033 40955 2015-01-01 12:02:00.495000     88.75979 40956 2015-01-01 12:03:00.480000     88.75938 40957 2015-01-01 12:04:00.496000     88.75944 40958 2015-01-01 12:05:00.497000     88.76046 40959 2015-01-01 12:06:00.560000     88.76008 40960 2015-01-01 12:07:00.498000     88.75940 40961 2015-01-01 12:08:00.484000     88.75938 40962 2015-01-01 12:09:00.484000     88.75933 ... </code></pre>  <p>then I have a second table with periods of data taking.</p>  <pre><code>                     start                stop run                                            248523 2015-01-05 16:13:09 2015-01-05 17:42:17 248529 2015-01-05 17:47:03 2015-01-05 18:29:27 248530 2015-01-05 18:30:24 2015-01-05 18:33:24 248531 2015-01-05 18:39:31 2015-01-05 18:40:31 248532 2015-01-05 18:43:57 2015-01-06 09:00:17 ... </code></pre>  <p>As you can see the the runs are not contiguous: a lot of temperature measurements don't belong to any run. There are much more data than periods.</p>  <p>What I need to do is to compute the average temperature for every run, averaging all the temperature measurements belonging to a run. I guess that the first step to do is to join the two tables, but I am not able to express the predicate "<code>time</code> between <code>start</code> and <code>stop</code>". Suggestions?</p>