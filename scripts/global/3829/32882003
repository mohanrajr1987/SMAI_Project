<p>In a test consisting of Maths and Science papers the following is the selection rule:</p>  <ul> <li>Everyone should attempt either one or both of Maths and Science.</li> <li>Those who attempt for Maths will be selected based on time taken in solving Maths only.</li> <li>Those who don't attempt for Maths will be selected based on time taken in solving Science.</li> </ul>  <p>Not attempted papers is recorded as Time = 0, which should not be counted for selection.</p>  <pre><code>--------------------------  Student | Subject | Time --------------------------  1       | S       | 24  2       | S       | 60  1       | M       | 65  2       | M       | 0  3       | S       | 0  3       | M       | 0 -------------------------- </code></pre>  <p>Here the selected value should be <code>2  -  S  -  60</code>, as he took minimum time for the qualifying attempt (Science) as he did not attempt Maths.</p>  <p>How to do this in a <em>single</em> MySQL Query?</p>  <p>I cannot use the following as they fail in one or the other case:</p>  <pre><code>SELECT     student_id, subject_id, time_taken FROM test_stats WHERE     time_taken &gt; 0 ORDER BY     time_taken ASC,     subject_id ASC LIMIT 0, 1; </code></pre>  <p>OR</p>  <pre><code>SELECT     student_id, subject_id, time_taken FROM test_stats WHERE     time_taken &gt; 0 ORDER BY     subject_id ASC,     time_taken ASC, LIMIT 0, 1; </code></pre>  <p>Not even <code>GROUP BY</code> is helpful, as we cannot set <code>ORDER BY</code> within group sets.</p>  <p>Let me know if I need to elaborate on anything further.</p>