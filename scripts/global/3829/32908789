<p>I have this example table:</p>  <pre><code>  sort_order  product      color    productid   price   ----------  -------      ------   ---------   -----       1       bicycle       red      2573257     50       2       bicycle       red      0983989     40       3       bicycle       red      2093802     45       4       bicycle       blue     9283409     55       5       bicycle       blue     3982734     60       1       teddy bear    brown    9847598     20       2       teddy bear    black    3975897     25       3       teddy bear    white    2983428     30       4       teddy bear    brown    3984939     35       5       teddy bear    brown    0923842     30       1       tricycle      pink     2356235     25       2       tricycle      blue     2394823     30       3       tricycle      blue     9338832     35       4       tricycle      pink     2383939     30       5       tricycle      blue     3982982     35 </code></pre>  <p>I would like a query that returns the product, the average price and the most frequent color.</p>  <p>So my query in this example would be expected to return:</p>  <pre><code>product      most_frequent_color     average_price -------      -------------------     ------------- bicycle      red                     50 teddy bear   brown                   28 tricycle     blue                    31 </code></pre>  <p>The average part seems easy just grouping by product and using avg(price), but how can I solve the most frequent color part?</p>  <p>This is the query I can figure out myself so far, but i don't know how to get the most_frequent_color for each group:</p>  <pre><code>SELECT product, avg(price) AS average_price from products WHERE sort_order &lt;= 5 GROUP BY product </code></pre>  <p>In my real world table there are usually way more rows for each group than I'm interested in so I just get a limited amount of them using the sort_order field</p>  <p>For the rare groups that either have null in all the rows for "color" or that have more than one most frequent color I would like to return null in the most_frequent_color colum returned</p>  <p>Thank you for any help on this!</p>