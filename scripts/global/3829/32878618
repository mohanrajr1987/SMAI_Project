<p>My data is like below:  </p>  <pre><code>ClassId ClassName   StudentId   Subject     SubjectId   ----------------------------------------------------- 1         ESL        12         English      20   1         ESL        13         Science      30   1         ESL        12         Social       40   1         ESL        12         Maths        50   </code></pre>  <p>Required output: parameters are Subject column values  </p>  <pre><code>ClassId ClassName   TotalStudents   SubjectIds    -----------------------------------------------     1        ESL         2               20, 40, 50, 30   </code></pre>  <p>When one student takes multiple subjects then count student only once, so in the above data 12 is one student id takes multiple subjects so counted only once. <code>TotalStudents</code> value is 2 (1 from student id 12 and 1 from student id 13)</p>  <p>I wrote this query:  </p>  <pre><code>Declare @subjectids string   set @subjectids = '20,30,40,50'    -- will split @subjectids  and store in temp table      select      classname, classid, Count(Distinct StudentId)   from      mytable   where      SubjectsIds in @subjectIds   group by      ClassId, ClassName, SubjectId,   </code></pre>  <p>but I get this output:</p>  <pre><code>ClassId ClassName   TotalStudents   SubjectIds   ----------------------------------------------     1        ESL         1               20   1        ESL         1               30   1        ESL         1               40   1        ESL         1               50   </code></pre>  <p>Any help in eliminating duplicates?<br> Edited: My basic question is how to count student only once when the same students takes multiple subjects from same class? While counting eliminate duplicates.</p>