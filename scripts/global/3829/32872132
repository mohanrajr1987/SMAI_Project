<p>I am trying to create a numerator(num) and denominator(den) column that I will later use to create a metric value. In my numerator column, I need to have a criteria that my denominator column does not have. When I add the where clause to my sub query, I am getting the error below. I do not want to add INRInRange to my Group By clause.</p>  <blockquote>   <p>Column 'dbo.PersonDetailB.INRInRange' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause."</p> </blockquote>  <pre><code>SELECT          dbo.PersonDetailSpecialty.PracticeAbbrevName,          (SELECT COUNT(DISTINCT dbo.Problem.PID) WHERE PersonDetailB.INRInRange='True') AS num,          COUNT(DISTINCT dbo.Problem.PID) AS den  FROM                  dbo.PersonDetailB RIGHT OUTER JOIN         dbo.PersonDetailSpecialty ON dbo.PersonDetailB.PID = dbo.PersonDetailSpecialty.PID LEFT OUTER JOIN         dbo.Problem ON dbo.PersonDetailSpecialty.PID = dbo.Problem.PID  GROUP BY          practiceabbrevname </code></pre>