<p>My data is like below:</p>  <pre><code>ClassId ClassName   StudentId   Subject     SubjectId   ----------------------------------------------------- 1         ESL        12         English      20   1         ESL        13         Science      30   1         ESL        12         Social       40   1         ESL        12         Maths        50   </code></pre>  <p>Required output: parameters are Subject column values</p>  <pre><code>ClassId ClassName   TotalStudents   SubjectIds    -----------------------------------------------     1        ESL         2               20, 40, 50, 30   </code></pre>  <p>When one student takes multiple subjects then count student only once, so in the above data 12 is one student id takes multiple subjects so counted only once. TotalStudents value is 2 (1 from student id 12 and 1 from student id 13)</p>  <p>I am not looking for how to display subjectIds column value in comma separated string.</p>  <p>Thanks in advance</p>