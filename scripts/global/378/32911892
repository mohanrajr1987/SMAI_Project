<p>My app has a <code>Window</code> with a <code>TextBox</code> in it. My <code>Window</code>'s <code>SizeToContent</code> is set to <code>WidthAndHeight</code>. I show this window from a background thread using <code>Dispatcher.Invoke()</code>. The problem is that the Window doesn't size to its contents when it first appears. As soon as I change text of the <code>TextBox</code>, the <code>Window</code> shrinks to correct size.</p>  <p>I have tried calling the following too in <code>Dispatcher.Invoke()</code>:</p>  <ol> <li><code>Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Render, new Action(() =&gt; { }));</code></li> <li><code>WindowObject.InvalidateVisual();</code></li> <li><code>WindowObject.UpdateLayout();</code></li> </ol>  <p>but it doesn't affect initial window size. What do I need to do?</p>  <p><strong>UPDATE</strong>: I also confirmed that <code>Window</code> shrinks to correct size if I assign a value to <code>TextBox</code>'s <code>Text</code> property programmatically. Adding the following 3 lines after calling <code>WindowObject.Show()</code> in <code>Dispatcher</code>-invoked function sets it to correct size:</p>  <pre><code>var Old = WindowObject.TXT.Text; WindowObject.TXT.SetCurrentValue(TextBox.TextProperty, ""); WindowObjectTXT.SetCurrentValue(TextBox.TextProperty, Old); </code></pre>