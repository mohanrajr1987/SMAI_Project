<p>I am desperately trying to fill a matrix with values from a data frame.  It is trade data, so the data frame looks something like this:</p>  <pre><code>country1 country2 value 1 Afghanistan  Albania    30 2 Afghanistan  Albania    81 3 Afghanistan    China     5 4     Albania  Germany     6 5       China  Germany     8 6       China   Turkey   900 7     Germany   Turkey    12 8     Germany      USA     3 9     Germany   Zambia   700 </code></pre>  <p>Using the unique and sort commands I have created a list of all countries that occur in the df (and converted it to a matrix):</p>  <pre><code>     countries_sorted [1,] "Afghanistan"    [2,] "Albania"        [3,] "China"          [4,] "Germany"        [5,] "Turkey"         [6,] "USA"            [7,] "Zambia"     </code></pre>  <p>Using this "list", I have created an empty trade matrix (7x7):</p>  <pre><code>             Afghanistan Albania China Germany Turkey USA Zambia Afghanistan          NA      NA    NA      NA     NA  NA     NA Albania              NA      NA    NA      NA     NA  NA     NA China                NA      NA    NA      NA     NA  NA     NA Germany              NA      NA    NA      NA     NA  NA     NA Turkey               NA      NA    NA      NA     NA  NA     NA USA                  NA      NA    NA      NA     NA  NA     NA Zambia               NA      NA    NA      NA     NA  NA     NA </code></pre>  <p>I am now hopelessly failing to fill this matrix with the numbers/sums from the value column of df. I have tried something like this: </p>  <pre><code>a&lt;-cast(df, country1~country2 , sum) </code></pre>  <p>which works to a degree BUT the matrix does not retain its original 7x7 format, which is what I need to have a matrix where the diagonal is all 0s.</p>  <pre><code>&gt; a      country1 Albania China Germany Turkey USA Zambia 1 Afghanistan     111     5       0      0   0      0 2     Albania       0     0       6      0   0      0 3       China       0     0       8    900   0      0 4     Germany       0     0       0     12   3    700 </code></pre>  <p>Please, anyone with a solution????</p>