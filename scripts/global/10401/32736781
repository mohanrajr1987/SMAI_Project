<p>I am trying to produce an organisational structure chart using ASP Classic. The code I am working on uses a single LDAP query to get all information for the sake of performance. I have the following code:</p>  <pre><code> &lt;%@ Language="VBScript"%&gt;  &lt;% response.Buffer = True  dim ADUser 'Holds the OU  dim RecordList 'Holds the RecordList object  %&gt;  &lt;html&gt;  &lt;head&gt;  &lt;link rel="stylesheet" href="../style.css"&gt;  &lt;/head&gt;  &lt;body&gt;  &lt;!--#include virtual="//includes/functions.asp"--&gt;  &lt;!--#include virtual="//includes/display.asp"--&gt;  &lt;h1&gt;Organisational Structure&lt;/h1&gt;  &lt;div class="commandspace"&gt;  &lt;p class="infotext"&gt;The org structure can be viewed with or without staff, indented or left justified.&lt;/p&gt;  &lt;/div&gt;  &lt;%   ADUser = "LDAP://OU=Staff,OU=Users,DC=company,DC=internal"  ' Make AD connection and run query  Set objCon = Server.CreateObject("ADODB.Connection")  objCon.provider ="ADsDSOObject"  objCon.Properties("User ID") = "EXAMPLE\User"  objCon.Properties("Password") = "PaSsWoRd"  objCon.Properties("Encrypt Password") = TRUE  objCon.open "Active Directory Provider"  Set objCom = CreateObject("ADODB.Command")  Set objCom.ActiveConnection = objCon  objCom.CommandText ="select company, department, givenName, sn, title, telephoneNumber FROM '"&amp; ADUser &amp;"' where company ='*'"   Set objRS = objCom.Execute  RecordList = objRS.GetRows()  ' Loop over returned recordset and output HTML  for i = 0 to uBound(RecordList, 2)       u = i + 1       if RecordList(5,i) &lt;&gt; RecordList(5,u) then            Response.Write "&lt;div class='Structure_Item_1'&gt;" &amp; RecordList(5,i) &amp; "&lt;/div&gt;" &amp; vbCrLf       end if       if RecordList(4,i) &lt;&gt; RecordList(4,u) then            Response.Write "&lt;div class='Structure_Item_2'&gt;" &amp; RecordList(4,i) &amp; "&lt;/div&gt;" &amp; vbCrLf       end if       Response.Write  "&lt;div class='Structure_Item_3'&gt;" &amp; RecordList(3,i) &amp; " " &amp; RecordList(2,i) &amp; "&lt;/div&gt;" &amp;vbCrLf  next  objRS.Close  objCon.Close  Set objRS = Nothing  Set objCon = Nothing  Set objCom = Nothing  %&gt;  &lt;/body&gt;  &lt;/html&gt; </code></pre>  <p>The page will list the different service areas, departments within and people in the departments. My problem is that I am getting duplicate data. </p>  <p>I have considered putting the departments in a Scripting Dictionary but realise that won't work since it wouldn't be multidimensional, so I couldn't have the service area and the department in the same dictionary unless I set the service area as the key and the department as the value. </p>  <p>This would, however, mean that keys are not unique. The same would go for the department and the staff member name. </p>  <p>I was thinking of two arrays, one with the service areas and departments in, one with the department and staff name. I was planning to, then, do a comparison operation which would dictate the formatting  </p>  <p>Help would be much appreciated. This made a bit more sense in my head I fear</p>