<p>I have been working on how to transfer an image using UDP in C, I have created a code that sometimes works, sometimes it doesn't. In what I think the issue is that sometimes the server receives more packages than writes. I know that I am trying to create the TCP, but that is what I am kind looking for, but not sure how to do it.</p>  <p>I think to fix it the client should send the buff of the img and only sends the second part when the server reply back to the client.</p>  <p>Here is the code:</p>  <p>Client:</p>  <pre><code>while (!feof(p))     {             fread(*&amp;c, 1, BLEN, p);             sprintf(buf, "%s", *&amp;c);             temp=sendto(s,buf,BLEN, 0, (struct sockaddr *) &amp;si_other, slen);             //sleep(3);             //printf("%d ",temp);             if(temp &lt; 0)             {                     fprintf(stderr,"sendto error.\n");                     printf("erro");                     exit(1);             }             i++;     } </code></pre>  <p>Server:</p>  <pre><code>while(1){     if(recvfrom(s, buf, BLEN, 0, (struct sockaddr *) &amp;si_other, (unsigned int *) &amp;slen)==-1){         perror("recvfrom error.\n");         exit(1);     }     //printf("%s ", &amp;si_other);     flagr[0] = buf[0];     flagr[1] = buf[1];     flagr[2] = buf[2];     if (strcmp(flagr, flag) == 0 ){             break;     }     fwrite(buf, 1, BLEN, pp);     i++; } </code></pre>