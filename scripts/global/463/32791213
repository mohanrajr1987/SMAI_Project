<p>I have searched the archives and I cannot find the answer to this question. Basically, what I am doing is FTP'ing several folders and files to a remote server. The code I have now will create the root folder, and transfer the 11 files that are in the root as well as create all of the folders under the root. What is not happening is the files for each folder are not being transferred. In addition, the 11 files in the root folder get resent each time a folder is being created. I am attaching my code with comments.</p>  <pre><code>    &lt;!--- Open an FTP connection ---&gt;         &lt;cfftp action = "open"             connection = "MyConnection"             username = "#getSiteList.TMS_USERNAME#"             password = "#getSiteList.TMS_PASSWORD#"             server = "#getSiteList.TMS_FTPADDRESS#"             secure = "no"             stopOnError = "yes"&gt;          &lt;!--- If an FTP connection has been made ---&gt;         &lt;cfif cfftp.Succeeded EQ "YES"&gt;          &lt;!--- FTP folder contents ---&gt;             &lt;cfset folderName = ListLast(#request.FileURL#, "\\")&gt;             &lt;cfset local_path = "#request.FileURL#"&gt;             &lt;cfset remote_path = "#folderName##getSiteList.TMS_DIRECTORY#"&gt;              &lt;!--- Loop through the number of folders ---&gt;            &lt;cfloop index="i" from="1" to="#NumberOfPages#"&gt;               &lt;cfscript&gt;                 KeywordStart=getPageBreaks.TMP_PAGESTART[i];                 if (i eq NumberOfPages)                 {                     KeywordEnd=getAllKeywords.RecordCount;                 }                 else                 {                     KeywordEnd=getPageBreaks.TMP_PAGESTART[i+1]-1;                 }                 PageKeywordStart=Trim(getAllKeywords.TML_KEYWORD[KeywordStart]);                 PageKeywordRange=PageKeywordStart &amp; " to " &amp; Trim(getAllKeywords.TML_KEYWORD[KeywordEnd]);                 KeyFolder=MakeFolderTitle(PageKeywordStart);                 request.thisFolder=KeyFolder;                 create_remote_folder=KeyFolder;             &lt;/cfscript&gt;           &lt;!--- Add slash to end of local path if necessary ---&gt;         &lt;cfif Right(local_path, 1) NEQ "\"&gt;             &lt;cfset local_path = local_path &amp; "\"&gt;         &lt;/cfif&gt;          &lt;!--- Add slash to end of remote path if necessary ---&gt;         &lt;cfif Right(remote_path, 1) NEQ "/"&gt;             &lt;cfset remote_path = remote_path &amp; "/"&gt;         &lt;/cfif&gt;          &lt;!--- Ensure that the root folder is there. ---&gt;         &lt;cfftp action="existsDir"              connection="MyConnection"              directory="#remote_path#/#folderName#"              stopOnError = "no"&gt;          &lt;!--- If it doesn't exist create it ---&gt;         &lt;cfif cfftp.succeeded NEQ "YES"&gt;              &lt;!--- Create directory ---&gt;              &lt;cfftp action="createDir"                  connection="MyConnection"                  directory="#folderName#"                  stopOnError = "no"&gt;           &lt;/cfif&gt;           &lt;!--- Get the local directory contents ---&gt;           &lt;cfdirectory directory="#local_path#" name="local_dir_contents" action="list"&gt;           &lt;!--- Check if create_remote_folder exists ---&gt;         &lt;cfftp action="existsDir"              connection="MyConnection"              directory="#remote_path##create_remote_folder#"              stopOnError = "Yes"&gt;               &lt;cfif cfftp.Succeeded NEQ "YES"&gt;                  &lt;cfoutput&gt;                     The following error occured: #cfftp.ErrorCode# : #cfftp.ErrorText#                  &lt;/cfoutput&gt;                  &lt;/cfif&gt;          &lt;!--- If it doesn't exist create it ---&gt;         &lt;cfif cfftp.succeeded NEQ "YES"&gt;             &lt;!--- Create directory ---&gt;              &lt;cfftp action="createDir"                  connection="MyConnection"                  directory="#remote_path##create_remote_folder#"                  stopOnError = "Yes"&gt;                   &lt;cfif cfftp.Succeeded NEQ "YES"&gt;                  &lt;cfoutput&gt;                     The following error occured: #cfftp.ErrorCode# : #cfftp.ErrorText#                  &lt;/cfoutput&gt;                  &lt;/cfif&gt;            &lt;/cfif&gt;          &lt;!--- Loop through contents and put the file on the SFTP server ---&gt;         &lt;cfloop query="local_dir_contents" startrow="1" endrow="20"&gt;              &lt;cfif local_dir_contents.type EQ "File"&gt;                 &lt;!--- Put the file on the server ---&gt;                 &lt;cfftp action="putFile"                      connection="MyConnection"                      localFile="#local_path##local_dir_contents.name#"                      remoteFile="#remote_path##local_dir_contents.name#"                      stoponerror="yes"&gt;                       &lt;cfif cfftp.Succeeded NEQ "YES"&gt;                  &lt;cfoutput&gt;                     The following error occured: #cfftp.ErrorCode# : #cfftp.ErrorText#                  &lt;/cfoutput&gt;                  &lt;/cfif&gt;             &lt;cfelse&gt;                  &lt;!--- Recursively call THIS function with the new directory ---&gt;                 &lt;cfset folderName = ListLast(#request.FileURL#, "\\")&gt;                 &lt;cfset local_path = "#request.FileURL#"&gt;                 &lt;cfset remote_path = "#folderName##getSiteList.TMS_DIRECTORY#"&gt;                 &lt;cfscript&gt;                     KeywordStart=getPageBreaks.TMP_PAGESTART[i];                     if (i eq NumberOfPages)                     {                         KeywordEnd=getAllKeywords.RecordCount;                     }                     else                     {                         KeywordEnd=getPageBreaks.TMP_PAGESTART[i+1]-1;                     }                     PageKeywordStart=Trim(getAllKeywords.TML_KEYWORD[KeywordStart]);                     PageKeywordRange=PageKeywordStart &amp; " to " &amp; Trim(getAllKeywords.TML_KEYWORD[KeywordEnd]);                     KeyFolder=MakeFolderTitle(PageKeywordStart);                     request.thisFolder=KeyFolder;                     create_remote_folder=KeyFolder;                 &lt;/cfscript&gt;                  &lt;cfftp action="createDir"                  connection="MyConnection"                  directory="#remote_path##create_remote_folder#"                  stopOnError = "Yes"&gt;                   &lt;cfif cfftp.Succeeded NEQ "YES"&gt;                  &lt;cfoutput&gt;                     The following error occured: #cfftp.ErrorCode# : #cfftp.ErrorText#                  &lt;/cfoutput&gt;                  &lt;/cfif&gt;             &lt;/cfif&gt;     &lt;/cfloop&gt;       &lt;/cfloop&gt;      &lt;cfftp action="close" connection="MyConnection"&gt; </code></pre>  <p></p>  <p>Thanks,</p>  <p>Bruce</p>