<p>I'm taking a site that used to be static html (generated by an offline tool) and converting it to PHP.  I'm sending all page urls to a single PHP file which parses the url.  At first I just stuck <code>FallbackResource MyPage.php</code> in the .htaccess file, and it worked fine... except for urls with a fragment part.  Many of the old urls were like <code>/some-page.html#part2</code>, and in the new scheme, part2 is a whole separate page, so I can't ignore that part of the url.  With FallbackResource, all that MyPage.php would ever see is <code>/some-page.html</code>.</p>  <p>Now I've read some other questions on here about the topic, such as <a href="http://stackoverflow.com/questions/371791/htaccess-redirect-with-fragment">this one</a>, and it seemed clear that mod_rewrite should in theory be able to do the job, but I can't get it to work.  Here's my most current attempt:</p>  <pre><code>Options +Indexes DirectoryIndex MyPage.php RewriteEngine on #RewriteCond %{REQUEST_FILENAME} !-f RewriteRule ^[^:/.?#&amp;]+\.html#(\w+)  MyPage.php#$1    [NC,NE] RewriteRule ^[^:/.?#&amp;]+\.(html|php)  MyPage.php       [NC] </code></pre>  <p>This works, again, for everything except anchors.  It works no better than the old FallbackResource command did.  I've tried juggling various parts of this in random ways, such as looking for %23 instead of #, omitting the NE flag, passing the value in a querystring instead of as a fragment, and whatnot.</p>  <p>I will note that I don't want to use redirection to translate the urls -- the PHP has to perform a lookup on it.</p>