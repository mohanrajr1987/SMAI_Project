<p>I have meteor app and want to test some angular controllers. So in <code>package.js</code></p>  <pre><code>Package.onTest(function(api) {   var CLIENT = 'client',     SERVER = 'server',     BOTH = [CLIENT, SERVER];    api.use('sanjo:jasmine@0.13.6', BOTH);   api.use('angular', BOTH);   api.use('angular:angular-mocks@1.4.4', BOTH);   api.use('mdg:camera@1.1.5', BOTH);    api.use('underscore', BOTH);   api.use('session', BOTH);   api.use('mongo', BOTH);   api.use('tracker', BOTH);   api.addFiles([     'tests/jasmine/server/integration/permission.js'   ], BOTH); }); </code></pre>  <p>and in test file</p>  <pre><code>describe('пермишны', function () {   beforeEach(function () {     angular.mock.module('myapp.myModule');     angular.mock.inject(function (_$meteorUtils_, _$rootScope_) {       $meteorUtils = _$meteorUtils_;       $rootScope = _$rootScope_;       // Creates a new child scope.       $scope = $rootScope.$new();     });   });   ... }); </code></pre>  <p>When i run <code>VELOCITY_TEST_PACKAGES=1 meteor test-packages --driver-package velocity:html-reporter ./</code> it gives me an error <code>ReferenceError: angular is not defined</code> (in browser). So the question is how to use angular and other modules defined in <code>onTest</code> function in this test?</p>  <p><code>packages</code> file:</p>  <pre><code>angularui:angular-ui-router angular:angular-material less ncuillery:angular-breadcrumb accounts-ui accounts-base service-configuration accounts-google meteorhacks:ssr meteorhacks:npm  momentjs:moment   npm-container liyu:sprintfjs standard-minifiers meteor-base mobile-experience mongo blaze-html-templates session jquery tracker logging reload random ejson spacebars check angular velocity:html-reporter velocity:console-reporter sanjo:jasmine angular:angular-mocks </code></pre>