<p>After many research, I've been unable to correctly test an Angular directive, since I can't access to functions inside its controller.</p>  <p>Here is the directive code:</p>  <pre><code>angular.module('app').     directive("accordionItem", function () {         return{             restrict: 'E',             replace: true,             templateUrl: function (elem, attr) {                 return 'partials/invoice/' + attr.temp + '.html';             },             scope: {                 invoice: '=',                 temp: '@'             },             controller: function ($scope, listSelectionService, $state) {              $scope.selectItem = function () {                 if ($scope.isOpen()) {                     listSelectionService.selectedItem = -1;                 }                 else {                     listSelectionService.selectedItem = $scope.invoice;                 }             };             $scope.isOpen = function () {                 return listSelectionService.selectedItem === $scope.invoice;             };             $scope.showFaturasSubscription = function () {                 $state.go('app.ultimasFaturasSubscription', {subscriptionId: $scope.invoice.subscriptionId});             };         }     }; }); </code></pre>  <p>And my test:</p>  <pre><code>describe('Invoice', function() {     var $scope = {}, controller, $httpBackend, $controller, form, element;     beforeEach(module('app'));      describe('Directives', function() {         beforeEach(inject(function($compile, $rootScope, _$httpBackend_, _$controller_) {             $httpBackend = _$httpBackend_;             $httpBackend.expect('GET', 'data/translation/?lang=pt').respond(200, []);             $httpBackend.when('GET', 'partials/invoice/undefined.html').respond(200, []);             $httpBackend.when('GET', 'partials/templates/loading.html').respond(200, []);             $httpBackend.when('GET', 'partials/invoice/invoiceContent.html').respond(200, []);             $scope = $rootScope.$new();             $controller = _$controller_;              form = $compile("&lt;accordion-item temp='invoiceContent'&gt;&lt;/accordion-item&gt;")($scope);             $scope.$digest();          }));         it('should submitButtonDisabled', inject(function($injector) {             var listSelectionService = $injector.get("listSelectionService");             $scope.selectItem();             expect(listSelectionService.selectedItem).toBe(-1);         }));     }); }); </code></pre>  <p>According to many documents I've read, after the $digest() function we can have access to the controller of the directive. This is not happening since it gives me the following error:</p>  <blockquote> <pre><code>TypeError: $scope.selectItem is not a function at null.&lt;anonymous&gt; (http://localhost:8234/spec/invoice/invoiceDirectivesSpec.js:27:20) at Object.invoke (http://localhost:8234/src/main/webapp/vendor/angular/angular.js:4452:17) at workFn (http://localhost:8234/src/main/webapp/vendor/angular-mocks/angular-mocks.js:2420:20) at jasmine.Block.execute (http://localhost:8234/?:1164:19) at jasmine.Queue.next_ (http://localhost:8234/?:2196:33) at jasmine.Queue.start (http://localhost:8234/?:2149:10) at jasmine.Spec.execute (http://localhost:8234/?:2476:16) at jasmine.Queue.next_ (http://localhost:8234/?:2196:33) at jasmine.Queue.start (http://localhost:8234/?:2149:10) at jasmine.Suite.execute (http://localhost:8234/?:2621:16) Error: Declaration Location     at window.inject.angular.mock.inject (http://localhost:8234/src/main/webapp/vendor/angular-mocks/angular-mocks.js:2391:25)     at null.&lt;anonymous&gt; (http://localhost:8234/spec/invoice/invoiceDirectivesSpec.js:25:43)     at jasmine.Env.describe (http://localhost:8234/?:919:23)     at describe (http://localhost:8234/?:703:29)     at null.&lt;anonymous&gt; (http://localhost:8234/spec/invoice/invoiceDirectivesSpec.js:10:5)     at jasmine.Env.describe (http://localhost:8234/?:919:23)     at describe (http://localhost:8234/?:703:29)     at http://localhost:8234/spec/invoice/invoiceDirectivesSpec.js:5:1 </code></pre> </blockquote>  <p>Any help would be really appreciated.</p>