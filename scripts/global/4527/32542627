<p>Suppose I have a Customers Table:</p>  <pre><code>Customers ----------------------------------------------- Id INTEGER SSN NCHAR(11) FullName NVARCHAR(100) LastPurchaseDate DATETIME </code></pre>  <p>There are many stores around the city, and the customer can be registered in any of them, each one giving him a different <code>Id</code>. Wherever he buys, the corresponding <code>Id</code> gets it's <code>LastPurchaseDate</code> updated.</p>  <p>Now I need to get the <code>Id</code> corresponding to the 'latest' <code>LastPurchaseDate</code> <strong>by person</strong>. Problem is, due to X different reasons, there can be typos on either the <code>SSN</code> or the <code>FullName</code>. Let's say I have the next data:</p>  <pre><code>Id          SSN            FullName      LastPurchaseDate ----------- -----------    ------------- ----------------- 200123      123-45-6789    John Doe      10-09-2015  201978      456-78-9012    Mary Jane     15-08-2015  380789      789-01-2345    Pete Zahut    01-08-2015  389236      123-45-6789    Jhon Doe      23-07-2015  215875      456-87-9012    Mary Jane     30-08-2015  974186      123456789      John Doe      28-04-2015  123758      789-01-2345    Pete Zaut     18-08-2015  </code></pre>  <p>A customer is considered to be the same person if it has either the same <code>SSN</code> or the same <code>FullName</code>. So in this sample, customers <code>200123</code>, <code>389236</code> and <code>974186</code> are the same person. Therefore, the resulting <code>Id</code>s should be</p>  <pre><code>200123 215875 123758 </code></pre>  <p>How can I achieve this?</p>  <p><strong>Edit</strong></p>  <p>So, the match has to be on either <code>SSN</code> or <code>FullName</code>, but it has to be exact; if both fields are different, even if it's by one character, it will be considered a different person. I hope the data will be eventually cleansed but it'll take it's time as it is a lot of info to trace and correct.</p>