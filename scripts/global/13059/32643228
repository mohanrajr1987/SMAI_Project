<p>I am trying to set the access_control_allow_origin flag in a response to an options request so that I can allow credentials across domains. On the server, I have an HttpServletRequest object. I need to know how to get the proper domain from this object. Everything I have tried has not worked. The referrer is the url complete with all of the request parameters. <code>.getRequestUrl</code> returns a url that is too verbose. <code>request.getScheme() + "://" + request.getServerName()</code> doesn't work because the scheme is the scheme of the request, not of the referrer. The client is on http where as the request is being sent over https. How do I get the origin domain complete with the protocol for use in the access_control_allow_origin flag?</p>