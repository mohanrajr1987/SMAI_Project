<p>While instrumenting my app I found that CPU usage jumps to 90% when writing data to output stream. Specifically, when network speed is very high. When I profile it With Timer instrument, found that most of the cpu is used for NSStream delegate call. Please Help to optimize writing technic as to low down the cpu usage.</p>  <pre><code>- (void)stream:(NSStream *)aStream handleEvent:(NSStreamEvent)eventCode { switch (eventCode) {      case NSStreamEventOpenCompleted: {         _isConnected = YES;         if([self.delegate respondsToSelector:@selector(isFTPConnectionFoundForUpload:)])             [self.delegate performSelector:@selector(isFTPConnectionFoundForUpload:) withObject:_isConnected?@"YES":@"NO"];     } break;      case NSStreamEventHasSpaceAvailable: {              bytesWritten = [self.producerStream write:&amp;self.buffer[0] maxLength:512];             if (bytesWritten == -1) {                 [self stopSendWithStatus:@"Network write error"];             }      } break;      case NSStreamEventErrorOccurred: {         NSLog(@"producer stream error %@", [aStream streamError]);         [self stopSendWithStatus:@"Stream open error"];     } break;     case NSStreamEventEndEncountered: {      } break;     default: {      } break; } </code></pre>  <p>}</p>