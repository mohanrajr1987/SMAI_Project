<p>In Xcode's Instruments, there is a tool called <a href="https://developer.apple.com/library/mac/documentation/AnalysisTools/Reference/Instruments_User_Reference/CountersInstrument/CountersInstrument.html">Counters</a> that exposes low-level counter information provided by the CPU, such as the number of instructions executed or number of cache misses:</p>  <p><a href="https://developer.apple.com/library/mac/documentation/AnalysisTools/Reference/Instruments_User_Reference/CountersInstrument/CountersInstrument.html"><img src="http://i.stack.imgur.com/lG4K1.png" alt="screenshot of Counters tool in Instruments"></a></p>  <p>This is similar to the Linux syscall <a href="http://man7.org/linux/man-pages/man2/perf_event_open.2.html"><code>perf_event_open</code></a> introduced in Linux 2.6.32. On Linux, I can use <code>perf_event_open</code> then start/stop profiling around the section of my code I'm interested in. I'd like to record the same type of stats on OS X: counting the instructions (etc) that a certain piece of code takes, and getting the result in an automated fashion. (I don't want to use the Instruments GUI to analyze the data.)</p>  <p>Are there any APIs that allow this (e.g., using dtrace or similar)? From some searching it sounds like the private AppleProfileFamily.framework might have the necessary hooks, but it's unclear how I might go about linking to and using it.</p>