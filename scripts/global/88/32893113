<p>I'm trying to use Content-Security-Policy (CSP) headers for a site that has social media buttons (youtube, twitter, facebook). However these widgets run scripts on a poorly specified list of 3rd party sites. The social media sites don't specify all the sites their scripts will access and so you need to run your page and one-by-one look and see the domains that were blocked, then add them to the CSP header.</p>  <p>This seems very fragile. If the social media sites change their scripts and add new domains, the page will break because the browser will block access to the new domain.</p>  <p>CSP is very effective in stopping XSS, but it seems social media sites do not provide buttons / widgets designed to work with it. At a minimum, they should require only ONE domain and should specific what that domain is.</p>  <p>I end up with a CSP header like:</p>  <p>Content-Security-Policy: default-src 'self' <a href="https://www.google.com" rel="nofollow">https://www.google.com</a> <a href="http://csi.gstatic.com" rel="nofollow">http://csi.gstatic.com</a> <a href="http://www.google-analytics.com" rel="nofollow">http://www.google-analytics.com</a> <a href="https://apis.google.com" rel="nofollow">https://apis.google.com</a> <a href="https://accounts.google.com" rel="nofollow">https://accounts.google.com</a> <a href="https://platform.twitter.com" rel="nofollow">https://platform.twitter.com</a> <a href="https://www.youtube" rel="nofollow">https://www.youtube</a>.   com <a href="http://platform.twitter.com" rel="nofollow">http://platform.twitter.com</a>; img-src 'self' data: <a href="https://www.google.com" rel="nofollow">https://www.google.com</a> <a href="http://www.google-analytics.com" rel="nofollow">http://www.google-analytics.com</a> <a href="http://ssl.gstatic.com" rel="nofollow">http://ssl.gstatic.com</a> <a href="https://ssl.gstatic.com" rel="nofollow">https://ssl.gstatic.com</a> data:; style-src 'self' <a href="https://fonts.googleapis.com" rel="nofollow">https://fonts.googleapis.com</a> 'unsafe-inline'; font-src 'self' <a href="https://fonts.gstatic.com" rel="nofollow">https://fonts.gstatic.com</a> data:</p>  <p>Is there a better way to do this?</p>