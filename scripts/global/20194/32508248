<p>I'm using Cucumber with Capybara in Rails 4.2, but I'm not using RSpec. I've been sticking with Minitest. I've been using minitest:spec in most of my tests.</p>  <p>Whenever I try to use make an assertion with minitest or minitest:spec syntax in a Cucumber step I get an error saying the assertion method is undefined. For example this step:</p>  <pre><code>Then (/^the state selector has no states$/) do   page.wont_have_selector(".my-css-class", :visible) end </code></pre>  <p>gives this error</p>  <pre><code>undefined method `refute_selector' for nil:NilClass (NoMethodError) </code></pre>  <p>(<code>page.wont_have_selector</code> is the minitest:spec syntax for the minitest method <code>refute_selector</code>)</p>  <p>I have a file <code>features/support/minitest.rb</code> with this content</p>  <pre><code>require 'minitest' require "minitest/rails/capybara" require "minitest/spec"  module MiniTestAssertions    def self.extended(base)     base.extend(MiniTest::Assertions)     base.assertions = 0   end    attr_accessor :assertions  end  World(MiniTestAssertions) </code></pre>  <p>Here is my test section of Gemfile</p>  <pre><code>group :development, :test do   gem 'byebug'   gem 'web-console', '~&gt; 2.0'   gem 'spring'   gem 'mocha', require: false   gem 'cucumber-rails', require: false   gem 'database_cleaner' end  group :test do   gem 'minitest-reporters'   gem 'minitest-rails-capybara'   gem 'minitest-spec-rails'   gem 'capybara_minitest_spec'   gem 'launchy'   gem 'selenium-webdriver'   gem 'poltergeist' end </code></pre>  <p>the <code>Gemfile.lock</code> includes the following</p>  <pre><code>capybara (2.4.4) capybara_minitest_spec (1.0.5) cucumber (1.3.20) cucumber-rails (1.4.2) minitest (5.7.0) minitest-capybara (0.7.2) minitest-metadata (0.5.3) minitest-rails (2.2.0) minitest-rails-capybara (2.1.1) minitest-spec-rails (5.2.2) rails (4.2.1) </code></pre>  <p><strong>Edit</strong></p>  <p>It is only Capybara specific Minitest assertions that are not recognised in the Cucumber step file. If I change the step content to this:</p>  <pre><code>assert true refute false </code></pre>  <p>then it passes. Also the Capybara Minitest assertions work fine in the <code>test/features</code> directory for doing integration testing outside Cucumber.</p>  <p>I think I have to add something to <code>features/suport/minitest.rb</code> so that the Capybara Minitest assertions get added to the Cucumber World, but I don't know what it is.</p>  <p><strong>Edit</strong></p>  <p>It's actually only the spec version of Capybara's minitest assertions that are giving the problem. If I change the content of the step to this:</p>  <pre><code>refute_selector(".my-css-class", :visible) </code></pre>  <p>then it works.</p>  <p><strong>Edit</strong></p>  <p>I think it's <a href="https://github.com/ordinaryzelig/capybara_minitest_spec/issues/10" rel="nofollow">bug #10</a> in capybara_minitest_spec gem that I got reopened.</p>