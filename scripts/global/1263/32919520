<p>I want to calculate the difference between two dates in format YYYY-MM-DD. When I write df["diff"] = df["date1"] - df["date2"] I get a value like 75 days which I can't sort.</p>  <p>How can I write it such that I map to function calc_diff(date1,date2) where</p>  <pre><code>def calc_diff(date1,date2): x = float(date2-date1) return x </code></pre>  <p>I.e. I df["diff"] = df["date1"],df["date2"].map(calc_diff)</p>  <p>when I write the following, I get:</p>  <pre><code>df["until_payable"] = map(calc_diff, df["ex_div_date"], "date_payable")  def calc_diff(d1,d2):     y = pd.to_datetime(d1)     x = pd.to_datetime(d2)     return x-y </code></pre>  <p>Error:</p>  <pre><code>&lt;ipython-input-167-b151c936730f&gt; in calc_diff(d1, d2)      39     y = pd.to_datetime(d1)      40     x = pd.to_datetime(d2) ---&gt; 41     return x-y      42       43 #convert the data in columns to data types  pandas/tslib.pyx in pandas.tslib._Timestamp.__sub__ (pandas/tslib.c:17620)()  TypeError: descriptor '__sub__' requires a 'datetime.datetime' object but received a 'str' </code></pre>