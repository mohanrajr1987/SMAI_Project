<p>I have a data.frame with one factor and two string character columns(nationality). The factor has 2662 levels each denoting a team. Teams have multiple members, thus each level has ~6 rows. </p>  <p>What I want to do is loop through the levels of the teams and compare a members nationality and see if this nationality is present in any of the levels the other character column. When there is a match I want a vector to be marked with 1, when there is no match I want a variable to be marked with 2. </p>  <p>Illustration</p>  <pre><code>Team    N1  N2 1      JPN  US 1      US   GER 1      DNK  RUS 2      …    … 2      …    … </code></pre>  <p>Ideally my code would register a 1 for US and a 2 for JPN</p>  <p>I've seen functions like split, tapply, etc... but I am having problems writing an anonymous function to achieve the goal I want:</p>  <pre><code>tapply(Data, TEAM_ID, function () for (i in N1){if (N1 %in% N2) Identifyingvect &lt;= 1} else {Identifyingvect &lt;= 2}) </code></pre>