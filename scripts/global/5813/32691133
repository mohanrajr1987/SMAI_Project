<p>The following code simulate the pipe and grep operation by forking process and using execve system call. The output seems fine, however, the grep process seems never exit (still running in the back) until the whole process ends. What's the problem? It is abnormal since using grep in shell always exit.</p>  <pre><code>#include &lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;unistd.h&gt; #include &lt;stdlib.h&gt; #include &lt;sys/wait.h&gt; #include &lt;fcntl.h&gt; int main(int argc, char *argv[], char *env[]) { char ch[32]; while (1) {     scanf("%s", ch);     int pd[2];     if (pipe(pd) == -1) {         perror("Pipe failed");         exit(1);     }      int childPid, pid;     if ((childPid = fork()) &lt; 0) {         perror("fork failed\n");         exit(1);     } else {         // parent process         if (childPid) {             int status;             wait(&amp;status);             // print exit code of child process             printf("Exit code %d\n", status);         }         // child process, execute command         else {             // fork a child             if ((pid = fork()) &lt; 0) {                 perror("fork failed\n");                 exit(1);             }             if (pid) {   // parent as pipe WRITER                 close(pd[0]);                 close(1);                 // replace input with pipe                 dup(pd[1]);                 char* cmds[] = { "/bin/cat", "aa", 0 };                 execve(cmds[0], cmds, env);                  exit(0);             } else {   // child as pipe READER                 close(pd[1]);                 close(0); // close its READ end                 dup(pd[0]);                  char* cmds[] = { "/bin/grep", "rw", 0 };                 execve(cmds[0], cmds, env);                 exit(0); // never been here             }         }     } } return 0; } </code></pre>  <p>Here is the output I monitor the process before and after running this program once.</p>  <pre><code>hengstar@ubuntu:~$ ps -ef | grep "grep" hengstar 58073 58038  0 01:43 pts/26   00:00:00 grep --color=auto grep hengstar@ubuntu:~$ ps -ef | grep "grep" hengstar 58075  1886  0 01:43 pts/11   00:00:00 /bin/grep drw hengstar 58077 58038  0 01:43 pts/26   00:00:00 grep --color=auto grep </code></pre>