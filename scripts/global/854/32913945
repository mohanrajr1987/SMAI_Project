<p>I have two vectors of length 16. The first one, <code>r</code>, for example is:</p>  <pre><code>r = [1;3;5;7;1;3;6;7;9;11;13;16;9;11;13;16]; </code></pre>  <p><code>r</code> contains a list of IDs.  I want to collect the indices of the duplicate IDs in <code>r</code> so that each group is a list of indices for one ID.  I would then use these indices to access a second vector <code>a</code> and find the maximum value incident on the indices for each group.</p>  <p>Therefore, I would like to produce an output vector using <code>r</code> and <code>a</code> such that:</p>  <pre><code>max(a(1),a(5)), max(a(2),a(6)), a(3), a(7), max(a(4),a(8)), max(a(9),a(13)), max(a(10),a(14)), max(a(11),a(15)), max(a(12),a(16)) </code></pre>  <p>I also want to keep the indices of the maximum values.  How can I efficiently implement this in MATLAB?</p>