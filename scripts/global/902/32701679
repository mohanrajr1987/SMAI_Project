<p>Working on a project which uses RequireJS, and loads dojo / dijit / dojox / dgrid using Require rather than the Dojo loader.</p>  <p>I'm trying to optimize the javascript to reduce http calls, and RequireJS optimizer doesn't seem to be able to optimize the Dojo modules.</p>  <p>Would it be possible to create a Dojo custom build and then load it with RequireJS? I've tried a few builds and haven't been able to get it to work yet. The last Dojo build configuration I tried (which ran successfully) was:</p>  <pre><code>var profile = { basePath: '../src/', action: 'release', cssOptimize: 'comments', mini: true, optimize: 'closure', layerOptimize: 'closure',  packages: [     'dgrid',     'dijit',     'dojo',     'dojox',     'put-selector',     'xstyle' ],  stripConsole: 'all', selectorEngine: 'lite',  layers: {     'dojo/dojo': {         boot: false,         customBase: true,         include: [             'dojo/_base/array',             'dojo/_base/declare',             'dojo/_base/fx',             'dojo/_base/lang',             'dojo/_base/window',             'dojo/_base/xhr',             'dojo/aspect',             'dojo/cache',             'dojo/Deferred',             //'dojo/dojo',             'dojo/dom-class',             'dojo/dom-construct',             'dojo/dom-geometry',             'dojo/dom-style',             'dojo/dom',             'dojo/fx',             'dojo/has',             'dojo/keys',             'dojo/mouse',             'dojo/on',             'dojo/promise/all',             'dojo/query',             'dojo/request/registry',             'dojo/request/util',             'dojo/sniff',             'dojo/string',             'dojo/store/Cache',             'dojo/store/JsonRest',             'dojo/store/Memory',             'dojo/store/Observable',             'dojo/store/util/QueryResults',             'dojo/topic',             'dojo/when',             'dojox/uuid/generateRandomUuid',             'put-selector/put',         ]     },     'dijit/dijit': {         include: [             'dijit/_TemplatedMixin',             'dijit/_Widget',             'dijit/dijit',             'dijit/form/CheckBox',             //'dijit/form/DateTextBox', // For some reason including this module causes the Dojo build to fail?             //'dijit/form/FilteringSelect', // For some reason including this module causes the Dojo build to fail?             //'dijit/form/MappedTextBox', // For some reason including this module causes the Dojo build to fail?             'dijit/form/TextBox',             'dijit/Menu',             'dijit/MenuItem',             'dijit/Tooltip',         ]     },     'dgrid/dgrid': {         include: [             'dgrid/CellSelection', // Set the cell selection model             'dgrid/ColumnSet', //Adds frozen column capabilities.             'dgrid/Editor',             //'dgrid/extensions/ColumnHider', // For some reason including this module causes the Dojo build to fail?             'dgrid/extensions/ColumnReorder',             'dgrid/extensions/ColumnResizer',             'dgrid/extensions/CompoundColumns',             'dgrid/Grid',             'dgrid/Keyboard',             'dgrid/OnDemandGrid',             'dgrid/Tree',             'dgrid/util/misc',             'dgrid/util/touch',         ]     },  },  staticHasFeatures: {     'config-deferredInstrumentation': 0,     'config-dojo-loader-catches': 0,     'config-tlmSiblingOfDojo': 0,     'dojo-amd-factory-scan': 0,     'dojo-combo-api': 0,     'dojo-config-api': 1,     'dojo-config-require': 0,     'dojo-debug-messages': 0,     'dojo-dom-ready-api': 1,     'dojo-firebug': 0,     'dojo-guarantee-console': 1,     'dojo-has-api': 1,     'dojo-inject-api': 1,     'dojo-loader': 0,     'dojo-log-api': 0,     'dojo-modulePaths': 0,     'dojo-moduleUrl': 0,     'dojo-publish-privates': 0,     'dojo-requirejs-api': 0,     'dojo-sniff': 1,     'dojo-sync-loader': 0,     'dojo-test-sniff': 0,     'dojo-timeout-api': 0,     'dojo-trace-api': 0,     'dojo-undef-api': 0,     'dojo-v1x-i18n-Api': 1,     'dom': 1,     'host-browser': 1,     'extend-dojo': 1 }, </code></pre>  <p>}</p>  <p>However, when I try to load the optimized layer files in require, it returns this fairly cryptic error and the application doesn't load:</p>  <blockquote>   <p>Failed to load root module. Details: has.add is not a function</p> </blockquote>  <p>Also, some modules which I marked with comments above will cause the Dojo build to fail if I include them. Any ideas there?</p>  <p>Is it possible to make this work? Currently we're tied to using dgrid, so the only option if this doesn't work, will be to rip out RequireJS.</p>  <p>Thanks in advance!</p>