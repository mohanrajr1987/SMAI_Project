<p>I have 3 tables</p>  <p><strong>Users</strong>        </p>  <pre><code>ID, UserID, balance,  name,     email  1    Test1      5.44    Jan     jan@mail.com 2    Test2      9.22    Ken     kenmail.com </code></pre>  <p><strong>Modules</strong>     </p>  <pre><code>ID,    ModuleID, Price, Active (bit) 1       JAlert     2        1 2       jFeed      1        1 3       jCross     4        1 </code></pre>  <p><strong>Subs</strong>        </p>  <pre><code>ID,    ModuleID, UserID, Timeline   (all nvarchar, except ID) 1       jAlert    Test1   0A12 2       jAlert    Test2   B241 4       jfeed     Test2   011A </code></pre>  <p>I need to make a list with all Users and for each user need to have as column Nam all Active ModuleID from Modules and in the row the timeline like</p>  <pre><code>UserID Name Balance Jalert  jFeed   jCross Test1   Jan   5.44    0A12  Null    Null Test2   Ken   9.22    B241  011A    Null </code></pre>  <p>I've understood I have to use Pivot to translate rows into column.. and googling around I found a way to create dynamically the column head:</p>  <pre><code>SELECT      @cols = ISNULL(@cols + ',','') +              QUOTENAME(ModuleID)  FROM      (SELECT TOP 20 ModuleID      FROM modules       WHERE Active = '1'       ORDER BY SortOrder ASC ) AS Columns;  </code></pre>  <p>but I have problems with the other query:</p>  <pre><code>SET @sql = N'SELECT UID, ' + @cols +    ' FROM (select ID, uid,  timeline from subscriptions) a     PIVOT (count(id) for timeline IN (' + @cols + ')) AS p ' </code></pre>  <p>that returns all zeroes, but the parameter has no sense.. </p>  <p>while this that seems more reasonable...</p>  <pre><code>SET @sql = N'SELECT UID, ' + @cols +    ' FROM (select ID, uid,  timeline from subscriptions) a    PIVOT (count(id) for id IN (' + @cols + ')) AS p ' </code></pre>  <p>returns an error during conversion from <code>nvarchar</code> to int</p>  <p>Problem is that I do not need aggregation but seems pivot requires such feature..</p>  <p>Can you suggest a solution or a workaround?</p>  <p>Thanks</p>