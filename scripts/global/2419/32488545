<p>I have a situation here where I created this table and inserted the value below</p>  <pre><code>CREATE TABLE temp1 ( ProcessName varchar(50), ProcessNo varchar(50), ProcessPages varchar(50)     )  INSERT INTO temp1 VALUES ('PRO1','PR012','5'); INSERT INTO temp1 VALUES ('PRO1','PR012','4'); INSERT INTO temp1 VALUES ('PRO1','PR012','10'); INSERT INTO temp1 VALUES ('PRO1','PR012','7'); INSERT INTO temp1 VALUES ('PRO1','PR012','6'); INSERT INTO temp1 VALUES ('PRO1','PR012','14'); INSERT INTO temp1 VALUES ('PRO1','PR012','23'); INSERT INTO temp1 VALUES ('PRO1','PR012','45'); INSERT INTO temp1 VALUES ('PRO1','PR012','52'); INSERT INTO temp1 VALUES ('PRO2','PR022','3'); INSERT INTO temp1 VALUES ('PRO2','PR022','5'); INSERT INTO temp1 VALUES ('PRO2','PR022','6'); INSERT INTO temp1 VALUES ('PRO2','PR022','5'); INSERT INTO temp1 VALUES ('PRO2','PR022','5'); INSERT INTO temp1 VALUES ('PRO2','PR022','8'); INSERT INTO temp1 VALUES ('PRO2','PR022','5'); INSERT INTO temp1 VALUES ('PRO2','PR022','2'); INSERT INTO temp1 VALUES ('PRO2','PR022','3'); INSERT INTO temp1 VALUES ('PRO2','PR022','3'); INSERT INTO temp1 VALUES ('PRO3','PR032','5'); INSERT INTO temp1 VALUES ('PRO3','PR032','10'); INSERT INTO temp1 VALUES ('PRO3','PR032','15'); INSERT INTO temp1 VALUES ('PRO3','PR032','25'); INSERT INTO temp1 VALUES ('PRO3','PR032','35'); INSERT INTO temp1 VALUES ('PRO3','PR032','45'); INSERT INTO temp1 VALUES ('PRO3','PR032','55'); INSERT INTO temp1 VALUES ('PRO3','PR032','25'); INSERT INTO temp1 VALUES ('PRO3','PR032','25'); INSERT INTO temp1 VALUES ('PRO3','PR032','20'); INSERT INTO temp1 VALUES ('PRO3','PR032','3'); INSERT INTO temp1 VALUES ('PRO3','PR032','3'); </code></pre>  <p>I am trying to write a dynamic pivot to achieve this </p>  <pre><code>Process_No_In_Cases PR01    PR02    PR03 1p                  2       8       3 2p                  3       2       1 3p                  1       0       1 4p                  2       0       1 5p                  1       0       6 Total               9       10      12 </code></pre>  <p>Using the code below:</p>  <pre><code>DECLARE @ColumnNames NVARCHAR(MAX) DECLARE @SQL NVARCHAR(MAX)  SELECT @ColumnNames=Stuff((SELECT DISTINCT ',' + Quotename(ProcessName)                    FROM temp1                    FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 1, '') SET @SQL= 'SELECT * FROM      ( SELECT        ProcessPages          ,ProcessName       ,ProcessNo        FROM temp1 AS BaseData PIVOT(       COUNT(ProcessNo)      FOR ProcessName      IN('+@ColumnNames +            ')   ) As PivotTable' --print @sql   EXECUTE sp_executesql @SQL </code></pre>  <p>How to do I incoporate the code below with the code above to achieve the data below(I provided the same data at the top of the post) :</p>  <pre><code>SELECT *   FROM  (SELECT [ProcessName],          COUNT(CASE WHEN ProcessPages &gt;=1 and ProcessPages&lt;=5  THEN '1p' END) AS [1p],         COUNT(CASE WHEN ProcessPages &gt;=6 and ProcessPages&lt;=10 THEN '2p' END) AS [2p],         COUNT(CASE WHEN ProcessPages &gt;=11 and ProcessPages&lt;=16  THEN '3p' END) AS [3p],         COUNT(CASE WHEN ProcessPages &gt;=17 and ProcessPages&lt;=50 THEN '4p' END) AS [4p],         COUNT(CASE WHEN  ProcessPages&gt;50 THEN '5p' END) AS [5p],         COUNT([ProcessName]) AS Total    FROM temp1   GROUP BY [ProcessName]) AS SOURCE </code></pre>  <p>Desired output:</p>  <pre><code>Process_No_In_Cases PR01    PR02    PR03 1p                  2       8       3 2p                  3       2       1 3p                  1       0       1 4p                  2       0       1 5p                  1       0       6 Total               9       10      12 </code></pre>