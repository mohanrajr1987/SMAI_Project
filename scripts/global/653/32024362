<p>I try to set the default install path from the registry:</p>  <pre><code>DefaultDirName={reg:HKCU\Software\Microsoft\VisualStudio\14.0,VisualStudioLocation|{userdocs}\Visual Studio 2015} </code></pre>  <p>The directory path that I expect to obtain is the registry value data, which is a value of type <code>REG_EXPAND_SZ</code> then I need to expand its variable(s), the reg value in my case points to the same path as the default value I set, which, once the <code>{userdocs}</code> constant is expanded at runtime by <em>InnoSetup</em>, should be this:</p>  <blockquote>   <p>C:\Users\Administrator\Documents\Visual Studio 2015</p> </blockquote>  <p>But instead of that i get this as directory path:</p>  <blockquote>   <p>C:\Users\Administrator\Desktop\%USERPROFILE%\Documents\Visual Studio   2015</p> </blockquote>  <p><a href="http://i.stack.imgur.com/MW7jY.png" rel="nofollow"><img src="http://i.stack.imgur.com/MW7jY.png" alt="enter image description here"></a></p>  <p>I execute the installer from "<strong>C:\Users\Administrator\Desktop</strong>" path, so here seems to happens two things, the first is that the path of the registry value is just appended, and the second is that of course the <code>%USERPROFILE%</code> variable is not expanded.</p>  <p>How I could do this properly?.</p>