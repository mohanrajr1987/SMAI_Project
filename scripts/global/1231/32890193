<p>I am trying to copy a set of folders using <a href="http://support.sas.com/documentation/cdl/en/hostwin/63285/HTML/default/viewer.htm#win-cmd-x.htm" rel="nofollow">sas x command</a>. The folders contain  a mix of files of various types.</p>  <p>Let's assume the following file structure </p>  <pre><code>D:\tmp\Src - directory with source folders D:\tmp\Dest - destination directory </code></pre>  <p>within the source directory I am interested in a subset of folders with names <code>Data*</code> eg: <code>Data 1</code>, <code>Data 2</code> etc.</p>  <p>Defining source and destination main directories as macro variables:</p>  <pre><code>%let srcLoc=D:\tmp\Src; %let destLoc=D:\tmp\Dest; </code></pre>  <p>we can run</p>  <pre><code>x xcopy "&amp;SrcLoc.\Data 1" "&amp;destLoc.\Data 1" /q /i /y; x xcopy "&amp;SrcLoc.\Data 2" "&amp;destLoc.\Data 2" /q /i /y; /*etc */ </code></pre>  <p>And all works fine.</p>  <p><strong>Intended modification</strong></p>  <p>As with time, new folders will be added to source directory there is a need to write a universal code that would process all the folders that conform to naming <code>Data*</code>.</p>  <p>The following performs the task required task when executed directly within windows command line</p>  <pre><code>FOR /F "tokens=*"  %G IN ('dir /B /A:D "D:\tmp\Src\Data*"') DO xcopy "D:\tmp\Src\%G" "D:\tmp\Dest\%G" /q /i /y </code></pre>  <p><strong>Issue:</strong></p>  <p>When attempting to execute the same from within SAS:</p>  <pre><code>%let srcLoc=D:\tmp\Src; %let destLoc=D:\tmp\Dest;  /* just to test resolving of macro variables */ %put FOR /F "tokens=*"  %G IN ('dir /B /A:D "&amp;srcLoc.\Data*"') DO xcopy "&amp;srcLoc.\%G" "&amp;destLoc.\%G" /q /i /y;  /* the actual x-command */ x FOR /F "tokens=*"  %G IN ('dir /B /A:D "&amp;srcLoc.\Data*"') DO xcopy "&amp;srcLoc.\%G" "&amp;destLoc.\%G" /q /i /y; </code></pre>  <p>There are the following issues:</p>  <ul> <li>a warning <code>WARNING: Apparent invocation of macro G not resolved.</code> and </li> <li>the resolved string is actually <code>FOR /F "tokens=*"  %G IN ('dir /B /A:D "&amp;srcLoc.\Data*"') DO xcopy "D:\tmp\Src\%G" "D:\tmp\Dest\%G" /q /i /y</code> </li> </ul>  <p>As you can see the <code>&amp;srcLoc.</code> did not resolve to a value as it is enclosed with single quotation marks needed to call <code>('dir /B /A:D "&amp;srcLoc.\Data*"')</code></p>  <p><strong>Question:</strong></p>  <p>How to ensure that <code>%G</code> is not treated as macro and also ensure that <code>&amp;srcLoc.</code> resolves to the actual value? </p>  <p>Also is there a better way to accomplish the above task within sas?</p>