<p><strong>Example file:</strong></p>  <pre><code>&lt;p&gt; some content &lt;a href="1#fn3" class="fn-ref"&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt; some content&lt;/p&gt; &lt;p&gt; some content &lt;a href="1#fn4" class="fn-ref"&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt; some content&lt;a href="1#fn5" class="fn-ref"&gt;&lt;sup&gt;5&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt; &lt;div class="footnote"&gt; &lt;li id="fn3"&gt;           &lt;p&gt;             content3             &lt;a href="1#fnref3"&gt;&amp;#x21A9;&lt;/a&gt;           &lt;/p&gt;         &lt;/li&gt; &lt;li id="fn4"&gt;           &lt;p&gt;            content4            &lt;a href="1#fnref4"&gt;&amp;#x21A9;&lt;/a&gt;           &lt;/p&gt;         &lt;/li&gt; &lt;li id="fn5"&gt;           &lt;p&gt;             content5             &lt;a href="1#fnref5"&gt;&amp;#x21A9;&lt;/a&gt;           &lt;/p&gt;         &lt;/li&gt; &lt;div&gt; </code></pre>  <p>I need to place reference footnote at the bottom of the paragraph where the footnote is referenced.(i.e.)if the content in <code>p</code>tag has <code>a</code>element with class <code>fn-ref</code>(one or many <code>a</code>tags in a paragraph), I need to place related footnote at the bottom of that paragraph. Related footnote reference can be found in the <code>div class="footnotes"</code></p>  <p>I should search in every <code>p</code>tag for <code>a class="fn-ref"</code>, If I found, I should create a <code>div class="footnote"</code> in which the related footnote reference content should be placed. If it is more than one, then within that <code>div</code> element itself reference content should be placed one by one.</p>  <p><strong>Expected output:</strong></p>  <pre><code>&lt;p&gt;     some content     &lt;a href="1#fn3" class="fn-ref"&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;     some content&lt;/p&gt;     &lt;div class=footnote&gt;        &lt;p&gt;        &lt;span class="label-fn"&gt;        &lt;a href="1#fnref3" class="ref-fn-ref"&gt;3&lt;/a&gt;        &lt;/span&gt;        content3        &lt;/p&gt;     &lt;/div&gt;     &lt;p&gt;     some content     &lt;a href="1#fn4" class="fn-ref"&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt;     some content&lt;a href="1#fn5" class="fn-ref"&gt;&lt;sup&gt;5&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;     &lt;div class=footnote&gt;        &lt;p&gt;        &lt;span class="label-fn"&gt;        &lt;a href="1#fnref4" class="ref-fn-ref"&gt;4&lt;/a&gt;        &lt;/span&gt;        content4        &lt;/p&gt;         &lt;p&gt;        &lt;span class="label-fn"&gt;        &lt;a href="1#fnref5" class="ref-fn-ref"&gt;5&lt;/a&gt;        &lt;/span&gt;        content5        &lt;/p&gt;     &lt;/div&gt; </code></pre>  <p>I should try like <code>parent().clone().html()</code>  then before and after add stuff but I don't  know where to get started as am newbie in  DOM parser class.</p>  <p>Tried so far:</p>  <pre><code>$dom = new DOMDocument; $dom-&gt;loadHTMLFile("test.html", LIBXML_HTML_NOIMPLIED | LIBXML_HTML_NODEFDTD); $xp = new DOMXPath($dom); $xp-&gt;registerNamespace("php", "http://php.net/xpath"); $pElement = $xp-&gt;query("//*[contains(@class, "fn-ref")]");  foreach($pElement as $pNode) {     if ($pNode-&gt;nodeName[0] === 'p') {      //?? </code></pre>