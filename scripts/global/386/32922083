<p>I'm trying to connect to a EC2 ubuntu instance behind a private VPC through a mac terminal. I have configured my ~/.ssh/config file as follows. </p>  <pre><code>Host myhost User ubuntu IdentityFile ~/.ssh/mykey.pem Hostname ip-my-host-ip.ap-southeast-2.compute.internal ProxyCommand ssh -A my-bastion-host nc %h %p </code></pre>  <p>This always returns the following error </p>  <blockquote>   <p>Permission denied (publickey). ssh_exchange_identification:   Connection closed by remote host</p> </blockquote>  <p>Here is the verbose output </p>  <pre><code>OpenSSH_6.2p2, OSSLShim 0.9.8r 8 Dec 2011 debug1: Reading configuration data /Users/myuser/.ssh/config debug1: /Users/myuser/.ssh/config line 5: Applying options for myhost debug1: /Users/myuser/.ssh/config line 11: Applying options for * debug1: Reading configuration data /etc/ssh_config debug1: /etc/ssh_config line 20: Applying options for * debug1: Executing proxy command: exec ssh -A my-bastion-host nc ip-my-host-ip.ap-southeast-2.compute.internal 22 debug1: identity file /Users/myuser/.ssh/mykey.pem type -1 debug1: identity file /Users/myuser/.ssh/mykey.pem-cert type -1 debug1: permanently_drop_suid: 501 debug1: Enabling compatibility mode for protocol 2.0 debug1: Local version string SSH-2.0-OpenSSH_6.2 Permission denied (publickey). </code></pre>  <p>But if I try SSH to bastion host with agent forwarding and then connect to the instance with my-ip, it works.</p>  <pre><code>$ ssh -A mybastion  ubuntu@mybastion:~ $ ssh my-host-ip  </code></pre>  <p>I just can't get my head around this. Any advice ? </p>  <p>PS : the permission for the key file is correct ( $  chmod 400 ~/.ssh/mykey.pem ) </p>