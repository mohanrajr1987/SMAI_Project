<p>I have an emr cluster and could able to run teragen without any issues with the settings defaultFS as hdfs:///  While set the defaultFS as s3://my-bucket the teragen failing where copyFromLocal works without any issue.  Also tried to set the mapreduce framework as 'local' ie MRv1 in mapred-site.xml, the teragen running against s3:/// but if we set to 'yarn' ie., MRv2 the job failing with below error message.   Appreciate your help.</p>  <pre><code>[hadoop@ip-ec2]$ hadoop jar /usr/lib/hadoop-mapreduce/hadoop-mapreduce-examples.jar teragen 100 s3://my-bucket/teragen_out 15/09/25 05:29:59 INFO metrics.MetricsSaver: MetricsConfigRecord disabledInCluster: false instanceEngineCycleSec: 60 clusterEngineCycleSec: 60 disableClusterEngine: false maxMemoryMb: 3072 maxInstanceCount: 500 lastModified: 1443092751461 15/09/25 05:29:59 INFO metrics.MetricsSaver: Created MetricsSaver j-1FCESGSE2SEXW0CE:i-cc51234s:RunJar:26408 period:60 /mnt/var/em/raw/i-cc51234s_20150928_RunJar_26408_raw.bin 15/09/25 05:30:00 INFO fs.EmrFileSystem: Consistency enabled, using com.amazon.ws.emr.hadoop.fs.s3n2.S3NativeFileSystem2 as filesystem implementation 15/09/25 05:30:01 DEBUG mapreduce.Cluster: Trying ClientProtocolProvider : org.apache.hadoop.mapred.YarnClientProtocolProvider 15/09/25 05:30:01 INFO client.RMProxy: Connecting to ResourceManager at ip-ec2.internal/172.22.2.10:8032 15/09/25 05:30:02 INFO mapreduce.Cluster: Failed to use org.apache.hadoop.mapred.YarnClientProtocolProvider due to error: Error in instantiating YarnClient 15/09/25 05:30:02 DEBUG mapreduce.Cluster: Trying ClientProtocolProvider : org.apache.hadoop.mapred.LocalClientProtocolProvider 15/09/25 05:30:02 DEBUG mapreduce.Cluster: Cannot pick org.apache.hadoop.mapred.LocalClientProtocolProvider as the ClientProtocolProvider - returned null protocol java.io.IOException: Cannot initialize Cluster. Please check your configuration for mapreduce.framework.name and the correspond server addresses.         at org.apache.hadoop.mapreduce.Cluster.initialize(Cluster.java:120)         at org.apache.hadoop.mapreduce.Cluster.&lt;init&gt;(Cluster.java:82)         at org.apache.hadoop.mapreduce.Cluster.&lt;init&gt;(Cluster.java:75)         at org.apache.hadoop.mapreduce.Job$9.run(Job.java:1266)         at org.apache.hadoop.mapreduce.Job$9.run(Job.java:1262)         at java.security.AccessController.doPrivileged(Native Method)         at javax.security.auth.Subject.doAs(Subject.java:415)         at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)         at org.apache.hadoop.mapreduce.Job.connect(Job.java:1261)         at org.apache.hadoop.mapreduce.Job.submit(Job.java:1290)         at org.apache.hadoop.mapreduce.Job.waitForCompletion(Job.java:1314)         at org.apache.hadoop.examples.terasort.TeraGen.run(TeraGen.java:305)         at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:70)         at org.apache.hadoop.examples.terasort.TeraGen.main(TeraGen.java:309)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:606)         at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:71)         at org.apache.hadoop.util.ProgramDriver.run(ProgramDriver.java:144)         at org.apache.hadoop.examples.ExampleDriver.main(ExampleDriver.java:74)         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)         at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)         at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)         at java.lang.reflect.Method.invoke(Method.java:606)         at org.apache.hadoop.util.RunJar.run(RunJar.java:221)         at org.apache.hadoop.util.RunJar.main(RunJar.java:136) </code></pre>  <p>Thanks, Siva</p>