<p>I have a .NET library (dll) of helper methods specific to installing my product, that targets .NET 4.</p>  <p>However, the "main" WIX project is targeting .NET 3.5 (as specified in the documentation) (meaning it runs on the 2.0 runtime). It has custom actions that call into the above 4.0 dll.</p>  <p>When running the generated MSI, i get "BadImageFormat" exceptions, when the WIX runtime (running on 2.0 runtime) tries to load my 4.0 dll.</p>  <p>If I had direct access to a .NET 3.5 .exe, I could convince it to load a 4.0 dll by using the  trick in its app.config.</p>  <p>However, the WIX runtime is loaded (by msiexec), as far as I can tell from the stack trace, through Interop. </p>  <p>Does anybody have a suggestion on how I could get this to run?</p>  <p>PS. I also tried making the "main" Wix project target 4.0 directly instead of 3.5, but then my setup dialogs will just fail to show.</p>