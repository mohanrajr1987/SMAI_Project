<p>I have a DLL named <code>FSSetup.dll</code> that I want to call from InstallScript code. And I want to call the InstallScript code from an MSI custom action. But there seems to be a problem in that I don't know where to find FSSetup.dll. The InstallScript function is starting and the whole install aborts when it gets to the line where it calls the DLL function. The MSI log reports:</p>  <pre><code>MSI (c) (1C:3C) [09:39:52:261]: Invoking remote custom action. DLL: C:\Users\bmarty\AppData\Local\Temp\MSIBEAE.tmp, Entrypoint: f1 Action ended 9:39:55: BrowseFSKeyFile. Return value 3. Info 2896. Executing action BrowseFSKeyFile failed. Action ended 9:39:55: InstallWelcome. Return value 3. </code></pre>  <p>The InstallScript code looks like this:</p>  <pre><code>export prototype BrowseFSKeyFile(HWND); prototype FSSetup.FSBrowseFile( BYVAL STRING, BYVAL STRING, BYVAL STRING, BYREF STRING );     function BrowseFSKeyFile(hMSI) NUMBER  nKeyFile; STRING  svKeyFile, szKPath, szKFile, szTemp, szTemp1; begin     MessageBox("Hi", INFORMATION);     svKeyFile = "";     FSBrowseFile( "*.key", "key", "Please select a KEY File...", svKeyFile );     MessageBox("Bye", INFORMATION);     ... end; </code></pre>  <p>I see the "Hi" message, but the install aborts before "Bye". I suspect it's because FSSetup.dll doesn't exist in my <code>%temp%</code> directory where MSIBEAE.tmp resides, which presumably represents the extracted name of the ISSetup.dll that was generated by the InstallScript compile.</p>  <p><strong>Edit:</strong> The MSI debugger is showing a different value for SUPPORTDIR than the InstallScript is seeing. FSSetup.dll exists in the SUPPORTDIR provided by MSI, but not in the one seen from InstallScript.</p>