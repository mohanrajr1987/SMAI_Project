<p>I'm creating RoR app. I have a model named 'User'. I want to create a 'Many to many' relationship between Users. It's then self referential association. </p>  <p>I generated 'Friendship' model with corresponding controller:<br> rails g model Friendship friend1:integer, friend2:integer, active:boolean<br> rails g controller Friendships create destroy</p>  <p>After clicking on 'Add friend',  friendship_controller is called with 'create' action. This action should create new 'Friendship', but when I click on 'Add friend', mistake appears: unknown attribute 'user_id' for Friendship.</p>  <p>Here is code that I wrote:</p>  <p>VIEW: (@user is a guy who I want to add as friend)</p>  <pre><code>&lt;%= link_to 'Add friend', create_friendship_path(:friend2 =&gt; @user), :method =&gt; :post %&gt; </code></pre>  <p>ROUTES: </p>  <pre><code>post 'create_friendship' =&gt; 'friendships#create' </code></pre>  <p>CONTROLLER:</p>  <pre><code>class FriendshipsController &lt; ApplicationController   def create     @friendship = current_user.friendships.build(:friend2 =&gt; params[:friend2])     if @friendship.save       flash[:notice] = 'Friend added'     else       flash[:error] = 'Friend was not added'     end   end end </code></pre>  <p>USER MODEL:</p>  <pre><code>class User &lt; ActiveRecord::Base   has_many :friendships   has_many :friends, through: :friendships end </code></pre>  <p>FRIENDSHIP MODEL: </p>  <pre><code>class Friendship &lt; ActiveRecord::Base   belongs_to :user   belongs_to :friend, class_name: 'User'   validates :friend1, presence: true   validates :friend2, presence: true end </code></pre>  <p>I have never used self referential associations with Rails, so there is a mistake which I can't find. Thanks for advices.</p>  <p>Schema.rb</p>  <pre><code>ActiveRecord::Schema.define(version: 20150904134846) do    create_table "friendships", force: :cascade do |t|     t.integer  "friend1"     t.integer  "friend2"     t.boolean  "accepted"     t.datetime "created_at", null: false     t.datetime "updated_at", null: false   end    add_index "friendships", ["friend1", "friend2"], name: "index_friendships_on_friend1_and_friend2", unique: true   add_index "friendships", ["friend1"], name: "index_friendships_on_friend1"   add_index "friendships", ["friend2"], name: "index_friendships_on_friend2"    create_table "users", force: :cascade do |t|     t.string   "name"     t.string   "email"     t.boolean  "admin",           default: false     t.string   "password_digest"     t.string   "remember_digest"     t.datetime "created_at",                      null: false     t.datetime "updated_at",                      null: false   end    add_index "users", ["email"], name: "index_users_on_email"  end </code></pre>