<p>i have this to calculate net profit </p>  <pre><code>CREATE TABLE #getvalues2 ( CGNo int, SCGNo int, Cost decimal (15,6), GrsRtl decimal (15,6), NetRtl decimal (15,6) ) INSERT INTO #getvalues2  SELECT    p.CGNo ,p.SCGNo   ,sum([Cost])/NULLIF(SUM(Pieces),0)   ,sum([Retail])/NULLIF(SUM(Pieces) ,0)   ,sum([RetailNet])/NULLIF(SUM(Pieces),0)    FROM [RECEIVING]r lEFT JOIN Product p on r.ProductCode =p.ProductCode Where datepart(YEAR,DayEndDate) = DATEPART(year,getdate())-1 and CGNo in (@CGNo) and CGNo+SCGNo in (@SCGNo)    GROUP BY     p.CGNo, p.SCGNo     HAVING sum(Cost) &gt;0   ORDER BY p.CGNo,p.SCGNo asc   --WORK OUT NP%  CREATE TABLE #np2 (CGNo int, SCGNo int, NP decimal (15,6) )       INSERT INTO #np2   SELECT  CGNo,  SCGNo, (NetRtl-Cost)/NULLIF(GrsRtl,0)   FROM #getvalues2       select * from #np2    drop table #getvalues2  drop table #np2 </code></pre>  <p>it shows the data like so i dont want it this way</p>  <pre><code>CGNO|||||SCGNO|||||NP%  01   ||||     0101   ||||    0.18  01   ||||     0102    ||||   0.15  02    ||||    0201   ||||    0.19 </code></pre>  <p>how i want the data</p>  <p>CGNO|||||NP%|||||SCGNO|||||NP%</p>  <p>01   ||||   0.18 ||||   0101  ||||    0.15</p>  <p>01    ||||  0.18 ||||   0102   ||||   0.13 </p>