<p>I have a problem with xml external entity injection. When I use this xml:</p>  <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;Records&gt;   &lt;Row&gt;      &lt;data&gt;data1&lt;/data&gt;   &lt;/Row&gt; &lt;/Records&gt; </code></pre>  <p>With this stylesheet:</p>  <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;!DOCTYPE a [ &lt;!ENTITY e SYSTEM "/etc/passwd"&gt; ]&gt;     &lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"&gt;         &lt;xsl:template match="/"&gt;            &lt;Row&gt;              &amp;e;           &lt;/Row&gt;         &lt;/xsl:template&gt;     &lt;/xsl:stylesheet&gt; </code></pre>  <p>The result is really bad for me:</p>  <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;Row&gt;user1:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin xxxx:x:2:2:bin:/bin:/usr/sbin/nologin xxx:x:3:3:sys:/dev:/usr/sbin/nologin..... </code></pre>  <p>My groovy code:</p>  <pre><code> def transform(File xslt, File input) {     TransformerFactory factory = TransformerFactory.newInstance();     factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);      StreamSource xsltStream = new StreamSource(xslt)      Transformer transformer = factory.newTransformer(xsltStream);     StreamSource ins = new StreamSource(input);     File tmp = File.createTempFile("tmpfile", "xslttransform")     StreamResult out = new StreamResult(tmp);     transformer.transform(ins, out);     return tmp  } </code></pre>  <p>What can I do to avoid this problem?</p>