<p>i trying to read image i inserted before in the excel sheet along with its position with this code, it work fine on my machine but when i migrate the code to another pc i get null pointer exception in the <strong>sheet.getDrawingPatriarch.getChildren()</strong>,i try to googled the problem but i didnt find a solution, anyone mind to help me? Below is the code:</p>  <pre><code>   /* loop the sheet */       for (int i = 0; i &lt; sheetNumbers; i++) {            sheet = wb.getSheetAt(i);           /* create map to store id map with picture */         Map&lt;String, PictureData&gt; sheetIndexPicMap = new HashMap&lt;String, PictureData&gt;();             /* determine to use 2003's excel get pic method or 2007++ get picture method */         if (fileExt.equals("xls")) {               if(((HSSFSheet) sheet).getDrawingEscherAggregate() != null)                 sheetIndexPicMap = getSheetPictrues03(i, (HSSFSheet) sheet, (HSSFWorkbook) wb);           }           /* store the picture and id map into a list */         sheetList.add(sheetIndexPicMap);       }        printImg(sheetList);    }     public static Map&lt;String, PictureData&gt; getSheetPictrues03(int sheetNum,           HSSFSheet sheet, HSSFWorkbook workbook) {        Map&lt;String, PictureData&gt; sheetIndexPicMap = new HashMap&lt;String, PictureData&gt;();       List&lt;HSSFPictureData&gt; pictures = workbook.getAllPictures();      if (pictures.size() != 0) {           for (HSSFShape shape : sheet.getDrawingPatriarch().getChildren()) {               HSSFClientAnchor anchor = (HSSFClientAnchor) shape.getAnchor();               if (shape instanceof HSSFPicture) {                   HSSFPicture pic = (HSSFPicture) shape;                   int pictureIndex = pic.getPictureIndex() - 1;                   HSSFPictureData picData = pictures.get(pictureIndex);                   HSSFRow row = sheet.getRow(anchor.getRow1());                 HSSFCell cell = row.getCell(0);                 String picIndex = "ID"+String.valueOf(cell);                    sheetIndexPicMap.put(picIndex, picData);               }           }           return sheetIndexPicMap;       } else {           return null;       }   }     public static void printImg(List&lt;Map&lt;String, PictureData&gt;&gt; sheetList) throws IOException {        for (Map&lt;String, PictureData&gt; map : sheetList) {           Object key[] = map.keySet().toArray();           for (int i = 0; i &lt; map.size(); i++) {               /*get picture data*/              PictureData pic = map.get(key[i]);               /*get row id where the picture reside*/             String picName = key[i].toString();               /*get file extension of the pictur*/             String ext = pic.suggestFileExtension();                byte[] data = pic.getData();                FileOutputStream out = new FileOutputStream("pic" + picName + "." + ext);               out.write(data);               out.close();           }       }    }   </code></pre>