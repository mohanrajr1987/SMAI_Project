<p>the follow is a function in <code>t_zset.c</code> in redis source. The purpose of <code>zslRandomLevel</code> is to get height for a new inserted node by stochastic algorithm. What makes me confused is the while condition. As I can understand, the probability of while condition to be true is 0.25,should the probability of this condition be 0.5? So, can someone help me understanding how much the probability of this condition and what is the theory of <code>(random() &amp; 0xFFFF) &lt; (ZSKIPLIST_P * 0xFFFF)</code>, cause I can replace it simply with <code>random()&lt;ZSKIPLIST_P</code>?</p>  <pre><code>int zslRandomLevel(void) {     int level = 1;      while ((random() &amp; 0xFFFF) &lt; (ZSKIPLIST_P * 0xFFFF))//ZSKIPLIST_P=0.25         level += 1;      return (level &lt; ZSKIPLIST_MAXLEVEL) ? level : ZSKIPLIST_MAXLEVEL; } </code></pre>