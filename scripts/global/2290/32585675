<p>Regards on this result set from this Query :</p>  <p>Select * from [My_Table]</p>  <pre><code>FK_id| name   | code  | ___________________ 1 | first  | 21500 | ___________________ 1 | first  | 0     | ___________________ 2 | second | 21500 | ___________________ 4 | four   | 21500 | ___________________ 4 | four   | 42000 | ___________________ 4 | four   | 0     | ___________________ 5 | fifth  | 0     | ___________________ 5 | fifth  | 42000 | ___________________ 6 | six  | 0       | ___________________ </code></pre>  <p>I need to select lines (distinct Fk_ID) where those condition are satisfied :</p>  <p>If code is different to <code>0</code> we take the one with the code we want(its a parameter to the query) If there is no line equal to this parameter we take the one with <code>0</code>.</p>  <p>This is what I need :</p>  <p>If <code>code = 21500</code> :</p>  <pre><code>Fk_id| name   | code  | ___________________ 1 | first  | 21500 | ___________________ 2 | second | 21500 | ___________________ 4 | four   | 21500 | ___________________ 5 | fifth  | 0     | ___________________ 6 | six  | 0       | ___________________ </code></pre>  <p>If <code>code = 42000</code> :</p>  <pre><code>Fk_id| name   | code  | ___________________ 1 | first  | 0     | ___________________ 4 | four   | 42000 | ___________________ 5 | fifth  | 42000 | ___________________ 6 | six  | 0       | ___________________ </code></pre>  <p>I need to have the SQL queries first, no need to have doctrine Query builder.</p>