<p>I need some help here with a restriction in Rails. I created a transport site and the duration of the whole route should be greater than the time between two stops. This is my model file 'section.rb'</p>  <pre><code>section.rb  class ValidatoreOffset &lt; ActiveModel::Validator     def validate(record)         if record.controllo_offset             record.errors[:base] &lt;&lt; 'Error! Orario fermate intermedie maggiore dell orario della tratta di percorrenza'         end     end end     class Section &lt; ActiveRecord::Base     has_many :departures     has_many :reservations     has_many :stops     attr_accessible :travel_time, :location_arrival, :type_of_section, :start_location, :id, :id_departure, :stop_id     validates :type_of_section, inclusion: { in: %w(festivo feriale scolastico giornaliero)} , :allow_nil =&gt; false     delegate :offset, :to =&gt; :stop, prefix: true, :allow_nil =&gt; true      validates_with ValidatoreOffset      def controllo_offset         if section.stop.offset &gt;= section.travel_time             return true         end      end  end </code></pre>  <p>offset is an attribute of Stop that indicates the time between two stops. What is wrong with that?</p>  <p>EDIT: full error message: </p>  <pre><code>Started POST "/sections" for ::1 at 2015-09-30 16:50:02 +0200 Processing by SectionsController#create as HTML   Parameters: {"utf8"=&gt;"âœ“", "authenticity_token"=&gt;"ywua04ZmGKKsv0OvkrealyAZ4s4iQ7IF1nFg41aYNpdtlXj9kPy4rRC/wkWzH5EoG+d23/QSvEhF4vdErkTNuA==", "section"=&gt;{"start_location"=&gt;"kbh", "location_arrival"=&gt;"gfx", "type_of_section"=&gt;"gfehmw,", "travel_time"=&gt;"17", "stop_id"=&gt;"6"}, "commit"=&gt;"Create Section"} Unpermitted parameter: stop_id    (0.2ms)  BEGIN    (0.1ms)  ROLLBACK Completed 500 Internal Server Error in 18ms (ActiveRecord: 2.8ms)  NameError (undefined local variable or method `section' for #&lt;Section:0x007f8a093691e8&gt;):   app/models/section.rb:23:in `controllo_offset'   app/models/section.rb:3:in `validate'   app/controllers/sections_controller.rb:30:in `block in create'   app/controllers/sections_controller.rb:29:in `create'     Rendered /Library/Ruby/Gems/2.0.0/gems/actionpack-4.2.1/lib/action_dispatch/middleware/templates/rescues/_source.erb (5.7ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/actionpack-4.2.1/lib/action_dispatch/middleware/templates/rescues/_trace.html.erb (2.5ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/actionpack-4.2.1/lib/action_dispatch/middleware/templates/rescues/_request_and_response.html.erb (0.8ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/actionpack-4.2.1/lib/action_dispatch/middleware/templates/rescues/diagnostics.html.erb within rescues/layout (20.5ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/web-console-2.2.1/lib/web_console/templates/_markup.html.erb (0.4ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/web-console-2.2.1/lib/web_console/templates/_inner_console_markup.html.erb within layouts/inlined_string (0.2ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/web-console-2.2.1/lib/web_console/templates/_prompt_box_markup.html.erb within layouts/inlined_string (0.2ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/web-console-2.2.1/lib/web_console/templates/style.css.erb within layouts/inlined_string (0.4ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/web-console-2.2.1/lib/web_console/templates/console.js.erb within layouts/javascript (12.8ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/web-console-2.2.1/lib/web_console/templates/main.js.erb within layouts/javascript (0.3ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/web-console-2.2.1/lib/web_console/templates/error_page.js.erb within layouts/javascript (0.3ms)   Rendered /Library/Ruby/Gems/2.0.0/gems/web-console-2.2.1/lib/web_console/templates/index.html.erb (27.2ms) </code></pre>