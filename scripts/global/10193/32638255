<p>I am trying to get messages with their corresponding users, in order to display a chat list of profiles with their last message in chronological order.</p>  <pre><code>array(     0 =&gt; array(         'Recepient' =&gt; array(             'id' =&gt; ...             'name' =&gt; ...             ...         ),         'Message' =&gt; array(             'content' =&gt; ...             'created' =&gt; ...             ...         )     ),     1 =&gt; ... ) </code></pre>  <p>and in order to retrieve the results, I've written this find() method:</p>  <pre><code>$msgs = $this-&gt;Message-&gt;find('all', array(     'group' =&gt; array('Recepient.id'),     'order'=&gt;'Message.created DESC',     'conditions'=&gt;         array(             'OR'=&gt; array(                 array('recepient_id'=&gt;$pid),                 array('sender_id' =&gt; $pid)             )     ) )); </code></pre>  <p>What I have:</p>  <ul> <li>message with corresponding "Recepient",</li> <li>in chronological order</li> </ul>  <p>The problem:</p>  <ul> <li>the query DOES NOT retrieve the most recent message from $recepient_id/$sender_id combination. </li> </ul>  <p>So instead of list of users with the last message, I have a list of users with a message. What's wrong with my query? Thanks for help!</p>  <h1>METHOD 2 results</h1>  <p>I've created "chat_id" field in the database which is basically recepient_id+sender_id sorted alphabetically (because if user1 send user2 a message user1 is sender, later when user2 responds, he becomes the sender, so sorting will ensure two users will always have the same chat_id). </p>  <p>Than I added DISTINCT to the query: </p>  <p><code>$this-&gt;Message-&gt;recursive = 0;         $msgs = $this-&gt;Message-&gt;find('all', array(             'fields' =&gt; array('DISTINCT Message.chat_id','Message.*','Recepient.*'),             'order'=&gt;'Message.created DESC',             'conditions'=&gt;                 array(                     'OR'=&gt; array(                         array('recepient_id'=&gt;$pid),                         array('sender_id' =&gt; $pid)                     )             )         ));</code></p>  <p>and it does NOT work! I am now getting multiple messages for the same conversation.</p>  <p>If I remove Message fields and Recipient fields from the query, I get correct amount of "chats". <code>'fields' =&gt; array('DISTINCT Message.chat_id'),</code> but that's not the solution.</p>  <p>CakePHP version 2.7.0 MySQL DB</p>  <h1>METHOD 3 results</h1>  <p><code>$msgs = $this-&gt;Message-&gt;find('all', array(             'order'=&gt;'Message.created DESC',             'fields' =&gt; 'recepient_id, content, max(Message.created) as max_created',             'group'=&gt;'recepient_id',             // 'contain' =&gt; array('Recepient'),             'conditions'=&gt;array( 'chat_id' =&gt; $chats )         )); </code></p>  <p>I gave up on single-find method to resolve this, so now 1.I am getting list of chats, 2.I want to find the last message from each chat. Acording to <a href="http://www.xaprb.com/blog/2006/12/07/how-to-select-the-firstleastmax-row-per-group-in-sql/" rel="nofollow">http://www.xaprb.com/blog/2006/12/07/how-to-select-the-firstleastmax-row-per-group-in-sql/</a> my find query should work. What happens is </p>  <pre><code>(int) 0 =&gt; array(         'Message' =&gt; array(             'recepient_id' =&gt; '55e6d764-1444-4aad-a909-9042f07f76da',             'content' =&gt; '1st msg',             'created' =&gt; '2015-09-20 18:24:17',             'created_nice' =&gt; '2  hours ago'         ),         (int) 0 =&gt; array(             'max_created' =&gt; '2015-09-20 18:24:28'         )     ), </code></pre>  <p>the field <code>max(</code>Message<code>.</code>created<code>)</code> is indeed showing the latest message from conversation but the 0=>Message array is for different message! As you can see <code>$results[0]['Message']['created']</code> time and <code>$results[0][0]['max_created']</code> are different!</p>