<p>I want to understand how STK (Short Term Key) generation works in a Bluetooth Low Energy. </p>  <p>I don't want to go deep at a packets exchange level of a Security Manager Protocol, but I want to understand a general sequence of actions performed by Master and Slave in order to exchange security keys. </p>  <p>More specifically, what is the difference between <em>Just Works</em> and <em>Passkey Enter</em> schemes? Why the first one does not protect from <strong>MITM</strong> attacks, but the second one does?</p>