<p>Suppose the following scenario:</p>  <ul> <li><p>A Queue that have multiple producers and multiple consumers. Each message might be consumed only once.</p></li> <li><p>This queue will handle messages from N distinct groups. There might be dozens of messages for each group on this queue.</p></li> <li><p>Each message will be enqueued sequentially at each 'group domain'</p></li> <li><p>Each message will be enqueued by a different transaction.</p></li> </ul>  <p>Not, let´s imagine that our queue have the following messages:</p>  <pre><code>Group | Sequence | Payload          | ------------------------------------- Grp01 | 00000001 | Message Data...  | Grp01 | 00000002 | Message Data...  | Grp01 | 00000003 | Message Data...  | Grp01 | 00000004 | Message Data...  | Grp01 | 00000005 | Message Data...  | Grp02 | 00000001 | Message Data...  | Grp02 | 00000002 | Message Data...  | Grp02 | 00000003 | Message Data...  | Grp02 | 00000004 | Message Data...  | Grp02 | 00000005 | Message Data...  | Grp03 | 00000001 | Message Data...  | Grp03 | 00000002 | Message Data...  | Grp03 | 00000003 | Message Data...  | Grp03 | 00000004 | Message Data...  | Grp03 | 00000005 | Message Data...  | </code></pre>  <p>Suppose that we have 5 consumers. The 1st consumer will get the message <code>Grp01-00000001</code>. </p>  <p>Is there a way to make all messages to the specified group 'Locked' when a message of that group is being consumed? Something that produces that following flow result:</p>  <pre><code> 1. Consumer1 =&gt; Start processing message `Grp01-00000001`  2. Consumer2 =&gt; Start processing message `Grp02-00000001`  3. Consumer3 =&gt; Start processing message `Grp03-00000001`  4. Consumer4 =&gt; Block (no message available. All groups are being processed)  5. Consumer5 =&gt; Block (no message available. All are groups being processed)  6. Consumer1 =&gt; Finish processing message `Grp01-00000001`  7. Consumer4 =&gt; Start processing message `Grp01-00000002`  8. Consumer1 =&gt; Block (no message available. All groups are being processed)  9. Consumer2 =&gt; Finish processing message `Grp02-00000001`  10. Consumer5 =&gt; Start processing message `Grp02-00000002`  11. Consumer2 =&gt; Block (no message available. All groups are being processed)  12. ... </code></pre>  <p>The sequence in which each consumer is activated doesn´t matter. What I really want to achieve is a way to block all messages of a specified group while a single message of that group is being processed. When that message is processed, the group is released and the next message on that group will be available. This is because we could never have two consumers processing <strong>more than one</strong> message of the same group at same time.</p>