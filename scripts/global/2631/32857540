<p>I have a folder with thousands of filenames like this. I need to put them inside folders and remove the useless parts from the filenames. I need to do this before adding the files inside my XBMC library.</p>  <pre><code>[ www.AnnoyingSpam.com ] Some.File.Name.With.A.Very.Long.String.avi [ www.AnnoyingSpam.com ] Another.File.With.A.Very.Long.String.mpg [ www.AnnoyingSpam.com ] Again.And.Again.mp4 </code></pre>  <ul> <li>First, I want to strip the AnnoyingSpam.com tags in the files</li> <li>Then, create a folder based on the file name without the tag and without the extension</li> <li>Finally, move the file to the new folder</li> <li>Repeat for the rest of the files in the root directory of the batch file</li> </ul>  <p>So far all I got is a script that will create folder and move files. But it adds the tag "Folder" to each folder and it doesn't remove the AnnoyingSpam.com tag</p>  <pre><code>@echo off  for /f "usebackq delims=?" %%a in (`dir /a-d /b`) do (   if not "%%~dpnxa"=="%~dpnx0" call :func "%%~a" )  goto :EOF  :func set file=%~1 set dir=%file% Folder md "%dir%" Folder 2&gt;nul move "%file%" "%dir%"  goto :EOF </code></pre>  <p>So my question is how can i remove these strings from the folder names that are being created in the above script:</p>  <p>"[ www.AnnoyingSpam.com ]"</p>  <p>" Folder"</p>