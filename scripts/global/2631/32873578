<p>I'm writing a batch script to read from a file. The file contains lines such as token=value. I have code to parse each line of the file and it is stored in %%i. The following code tries to extract the value of token:  </p>  <p><strong>Take note that this script is using delayed expansion, as mentioned in the comments.</strong></p>  <pre><code>   for /f "tokens=1* delims==" %%a in ("%%i") do (         if "%%a"=="password" ( set password=%%b )      ) </code></pre>  <p>If value of token password contains "!", then the "!" is skipped and only rest of the string is stored in variable password. Example, if the line is:  </p>  <p>password=Test! </p>  <p>then variable password=Test . I have tried to change the input file various ways and batch script reads everything except "!".  I have used:  </p>  <ol> <li>password="Test!" </li> <li>password="Test^!"</li> <li><p>password=Test%!</p>  <p>password=Test%!</p></li> </ol>  <p>and everything skips "!". Any idea how I can read a string with "!" into a variable? </p>