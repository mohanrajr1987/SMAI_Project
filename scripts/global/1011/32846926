<p>I use python-docx to generate word document. the user want that he create a template(in a field description) and when he write for example %(company_logo)s in the template, I replace this expression by the picture of the company that I recupered from the database. as a first issue, I recupered the logo of a company from the database(Postgresql) and I use this code to replace this expression:</p>  <pre class="lang-python prettyprint-override"><code>    cr.execute("select name, logo_web from res_company where id=%s",[soc_id])     r=cr.fetchone()     if r :         company_name=r[0]         logo_company = r[1]       output = cStringIO.StringIO()     doc = docx.Document()      contenu=contenu % {'company_logo': logo_company, 'company_name': company_name,}     doc.add_paragraph(contenu) </code></pre>  <p>The output was a document word that contains the base 64 code of the image as a string. I decoded this code and I tried to add it as a picture with the following code:</p>  <pre class="lang-python prettyprint-override"><code>logo_company = base64.b64decode(r[1]) doc.add_picture(logo_company) </code></pre>  <p>But I have this error that tells to me that argument must be the path to the picture.</p>  <pre><code>TypeError: file() argument 1 must be encoded string without NULL bytes, not str </code></pre>