<p>I am trying to base64 encode a unicode string. I am running into problems, after the encoding, the output is my string base64'ed however, there is null bytes at random places in throughout the code, I don't know why, or how to get them out.</p>  <p>Here is my Base64Encode function:</p>  <pre><code>static char Base64Digits[] = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"; int Base64Encode(const BYTE* pSrc, int nLenSrc, wchar_t* pDst, int nLenDst) {    int nLenOut= 0;    while ( nLenSrc &gt; 0 ) {   if (nLenOut+4 &gt; nLenDst) return(0); // error    // read three source bytes (24 bits)    BYTE s1= pSrc[0];   // (but avoid reading past the end)   BYTE s2= 0; if (nLenSrc&gt;1) s2=pSrc[1]; //------ corrected, thanks to  jprichey   BYTE s3= 0; if (nLenSrc&gt;2) s3=pSrc[2];    DWORD n;   n =  s1;    // xxx1   n &lt;&lt;= 8;    // xx1x   n |= s2;    // xx12     n &lt;&lt;= 8;    // x12x   n |= s3;    // x123      //-------------- get four 6-bit values for lookups   BYTE m4= n &amp; 0x3f;  n &gt;&gt;= 6;   BYTE m3= n &amp; 0x3f;  n &gt;&gt;= 6;   BYTE m2= n &amp; 0x3f;  n &gt;&gt;= 6;   BYTE m1= n &amp; 0x3f;      //------------------ lookup the right digits for output   BYTE b1 = Base64Digits[m1];   BYTE b2 = Base64Digits[m2];   BYTE b3 = Base64Digits[m3];   BYTE b4 = Base64Digits[m4];    //--------- end of input handling   *pDst++ = b1;   *pDst++ = b2;   if ( nLenSrc &gt;= 3 ) {  // 24 src bits left to encode, output xxxx      *pDst++ = b3;      *pDst++ = b4;   }   if ( nLenSrc == 2 ) {  // 16 src bits left to encode, output xxx=      *pDst++ = b3;      *pDst++ = '=';      }   if ( nLenSrc == 1 ) {  // 8 src bits left to encode, output xx==      *pDst++ = '=';      *pDst++ = '=';   }   pSrc    += 3;   nLenSrc -= 3;   nLenOut += 4;  }  // Could optionally append a NULL byte like so:  // *pDst++= 0; nLenOut++;  return( nLenOut );   } </code></pre>  <p>Not to fool anyone, but I copied the function from <a href="http://www.experts-exchange.com/articles/3216/Fast-Base64-Encode-and-Decode.html" rel="nofollow">here</a></p>  <p>Here is how I call the function:</p>  <pre><code>wchar_t base64[256];  Base64Encode((const unsigned char *)UserLoginHash, lstrlenW(UserLoginHash) * 2, base64, 256); </code></pre>  <p>So, why is there random null-bytes or "whitespaces" in the generated hash? What should be changed so that I can get rid of them?</p>