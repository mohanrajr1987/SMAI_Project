<p>Assume we have a file of <code>FILE_SIZE</code> bytes, and:</p>  <ul> <li><code>FILE_SIZE &lt;= min(page_size, physical_block_size)</code>;</li> <li>file size never changes (i.e. <code>truncate()</code> or append <code>write()</code> are never performed);</li> <li><p>file is modified only by completly overwriting its contents using:</p>  <pre> pwrite(fd, buf, FILE_SIZE, 0); </pre></li> </ul>  <hr>  <p>Is it guaranteed on <code>ext4</code> that:</p>  <ol> <li>Such writes are atomic with respect to concurrent reads?</li> <li><p>Such writes are transactional with respect to a system crash?</p>  <p>(i.e., after a crash the file's contents is completely from some previous write and we'll never see a partial write or empty file)</p></li> </ol>  <p>Is the second true:</p>  <ul> <li>with <code>data=ordered</code>?</li> <li><p>with <code>data=journal</code> or alternatively with journaling enabled for a single file?</p>  <p>(using <code>ioctl(fd, EXT4_IOC_SETFLAGS, EXT4_JOURNAL_DATA_FL)</code>)</p></li> <li><p>when <code>physical_block_size &lt; FILE_SIZE &lt;= page_size</code>?</p></li> </ul>  <hr>  <p>I've found <a href="http://stackoverflow.com/questions/10650861/atomicity-of-write2-to-a-local-filesystem">related question</a> which links <a href="http://permalink.gmane.org/gmane.comp.file-systems.ext4/27225" rel="nofollow">discussion</a> from 2011. However:</p>  <ul> <li>I didn't find an explicit answer for my question <code>2</code>.</li> <li>I wonder, if the above is true, is it <strong>documented</strong> somewhere?</li> </ul>