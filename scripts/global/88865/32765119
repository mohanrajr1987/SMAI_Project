<p>I have a controller that looks like this:</p>  <pre><code>angular.module('msfLogger', ['offClick', 'ngBootstrap', 'ngSanitize','ngCsv', 'angularFileUpload', 'pouchdb'])  .controller('LoggerCtrl',['$scope', 'dataService', 'pouchDB', function($scope, dataService, pouchDB){   var db = pouchDB('FleetDB');  $scope.addTodo = function() {     var movement = {         _id: moment().format("YYYYMMDDHHmmss"),         type: 'move',         duration:''     };     db.put(movement, function(err, res) {     if (err) { console.log(err); }     }); }  $scope.recordlist = dataService.get(); console.log($scope.recordlist); </code></pre>  <p>The first function works OK and saves data into the DB.</p>  <p>But then, I try to retrieve this data using a service: <code>dataService.get();</code>  </p>  <p>The service looks like this:</p>  <pre><code>angular.module('msfLogger').service('dataService', extractRecords);  function extractRecords() {      var data = db.allDocs({startkey: 'move_', endkey: 'move_\uffff', include_docs: true})     return {         get: data;     } }; </code></pre>  <p>I'm getting a <code>db is not defined</code> error.</p>  <p>How can I make db available in the service and send the data back to the controller?</p>