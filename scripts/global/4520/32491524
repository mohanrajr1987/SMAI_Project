<p>We have a msi package which installs a Windows Service. At end-of-day, the windows service downloads a new msi package from a public blob location and kick off reinstalls.</p>  <p>The reinstall command = </p>  <p><code>msiexec /i GatewayService.msi /qn REINSTALL=ALL REINSTALLMODE=vamus /L*V msi.log</code></p>  <p>What we want is as follows:</p>  <ol> <li>This should reinstall the whole msi package again w/o any check on any conditions</li> <li>Whatever files are in the new msi should be copied to installed dir and files not in the new msi should be trashed.</li> </ol>  <p>So essentially what we want is like UNINSTALL old msi and RE-INSTALL new MSI in one command. </p>  <p>We were wondering </p>  <ol> <li>if the <code>REINSTALL/REINSTALLMODE</code> flags value are correct ?</li> <li>Sometimes we see an orphaned Windows Service in TaskManager. Any idea why the re-install command resulted in 2 instance of Window Service?</li> </ol>  <p>Suggestions would be grateful!</p>