<p>Below command is not executing from MSI.</p>  <pre><code>    &lt;CustomAction Id="DeleteInstallDir" BinaryKey="CommandPrompt"         ExeCommand="cmd /C pushd &amp;quot;[APPINSTALLDIR]&amp;quot; &amp;amp;&amp;amp; (rd /s /q &amp;quot;[APPINSTALLDIR]&amp;quot; 2&gt;nul &amp;amp; popd)"         Execute="deferred" Return="ignore" HideTarget="no" Impersonate="no" /&gt; </code></pre>  <p>While looking into verbose logs, it is throwing below error:</p>  <pre><code>Info 1721. There is a problem with this Windows Installer package. A program required for this install to complete could not be run. Contact your support personnel or package vendor. Action: DeleteInstallDir, location: C:\WINDOWS\Installer\MSI22.tmp, command: cmd /C pushd "C:\CompanyName\AppName\" &amp;&amp; (rd /s /q "C:\CompanyName\AppName\" 2&gt;nul &amp; popd) </code></pre>  <p>As a result it is not removing log files which are created during application use. These log files are not part of MSI.</p>  <p>Same MSI (same command) is working in Windows-7 and Windows-8. And I tried to run the same command from command line it is working fine.</p>  <p>I have used below suggestion also (from : <a href="http://stackoverflow.com/questions/17940364/wix-how-to-delete-non-empty-folder">wix - how to delete non-empty folder</a>), still not working.</p>  <pre><code>&lt;Component Id="deeletall" Guid="PUT-GUID-HERE"&gt; &lt;util:RemoveFolderEx Id="RemoveiDocDir" On="uninstall" Property="APPINSTALLDIR" /&gt; </code></pre>  <p></p>  <p>Please help in this.</p>