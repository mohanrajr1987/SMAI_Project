<p>I'm trying to make a floating widget (service) which does the following:</p>  <p>on touch, movable - seems to work fine.</p>  <p>on click, opening a simple alert dialog box - not working.</p>  <p>code:</p>  <pre><code>public class Service1 extends Service {  private WindowManager windowManager; private ImageView serviceIcon;     @Override public IBinder onBind(Intent intent) {     // Not used     return null; }   @Override  public void onCreate() {     super.onCreate();      windowManager = (WindowManager) getSystemService(WINDOW_SERVICE);      serviceIcon = new ImageView(this);      serviceIcon.setImageResource(R.drawable.icon);      final WindowManager.LayoutParams params = new WindowManager.LayoutParams(             WindowManager.LayoutParams.WRAP_CONTENT,             WindowManager.LayoutParams.WRAP_CONTENT,             WindowManager.LayoutParams.TYPE_PHONE,             WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE,             PixelFormat.TRANSLUCENT);      params.gravity = Gravity.TOP | Gravity.LEFT;     params.x = 0;     params.y = 100;      windowManager.addView(serviceIcon, params);       //making the icon movable      serviceIcon.setOnTouchListener(new View.OnTouchListener() {          private int initialX;          private int initialY;          private float initialTouchX;          private float initialTouchY;           @Override          public boolean onTouch(View v, MotionEvent event) {              switch (event.getAction()) {                  case MotionEvent.ACTION_DOWN:                      initialX = params.x;                      initialY = params.y;                      initialTouchX = event.getRawX();                      initialTouchY = event.getRawY();                      return true;                  case MotionEvent.ACTION_UP:                      return true;                  case MotionEvent.ACTION_MOVE:                      params.x = initialX + (int) (event.getRawX() - initialTouchX);                      params.y = initialY + (int) (event.getRawY() - initialTouchY);                      windowManager.updateViewLayout(serviceIcon, params);                      return true;              }              return false;           }      });       serviceIcon.setOnClickListener(new View.OnClickListener() {          @Override         public void onClick(View v) {             dialog();          }     });  }  @Override public void onDestroy() {     super.onDestroy();     if (serviceIcon != null) windowManager.removeView(serviceIcon); }  public void dialog() {     AlertDialog.Builder alert = new AlertDialog.Builder(this);     alert.setMessage("set message");     alert.setTitle("set title");     alert.setPositiveButton("positive", new DialogInterface.OnClickListener() {          @Override         public void onClick(DialogInterface dialog, int which) {          }     });     alert.show(); }    } </code></pre>  <p>i called the dialog method inside the setOnClickListener.</p>  <p>i did not forget the .show in my dialog method</p>  <p>What am i missing?</p>  <p>when i click the widget nothing happens. nothing pop and nothing crush, there is no error on the log. i do able to drag it though.</p>  <p>after commenting the onTouch method, in order to focus only at the onClickListener, i moved the dialog method to the main activity instead, and called it back inside the onClickListener, in order to try to fix the problem. now i get an error and i can show the stack trace:</p>  <pre><code>java.lang.NullPointerException: Attempt to invoke virtual method 'android.content.pm.ApplicationInfo android.content.Context.getApplicationInfo()' on a null object reference         at android.content.ContextWrapper.getApplicationInfo(ContextWrapper.java:150)         at android.view.ContextThemeWrapper.getTheme(ContextThemeWrapper.java:110)         at android.app.AlertDialog.resolveDialogTheme(AlertDialog.java:222)         at android.app.AlertDialog$Builder.&lt;init&gt;(AlertDialog.java:452)         at com.example.daniel.myproject.MainActivity.dialog(MainActivity.java:171)         at com.example.daniel.myproject.Service1$1.onClick(Service1.java:101)         at android.view.View.performClick(View.java:5198)         at android.view.View$PerformClick.run(View.java:21147)         at android.os.Handler.handleCallback(Handler.java:739)         at android.os.Handler.dispatchMessage(Handler.java:95)         at android.os.Looper.loop(Looper.java:148)         at android.app.ActivityThread.main(ActivityThread.java:5417)         at java.lang.reflect.Method.invoke(Native Method)         at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:726)         at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616) </code></pre>