<p>I have 3 tables ClientVisit, Location and the join table ClientVisitLocation the join table contains the history of the visits locations.</p>  <p>a basic join of the 3 tables could return a parent record or a child record. location table has a column [parentGuid] if the record is the parent level then this = 0 otherwise it is the guid for the parent location.</p>  <p>to put it into context the locationID stored in the clientVisitLocation table could reference a Ward or a Bed. i want my query to return the Ward</p>  <p>i've joined the location table a second time but this gives me empty columns for l2 where l already contained the ward level. i want the ward level locations to appear in the same column.</p>  <pre><code>Select cvl.*, l2.* from cv3clientvisit cv inner join CV3ClientVisitLocation cvl on cv.guid = cvl.clientvisitguid inner join cv3Location l on CVl.locationguid = l.guid left join cv3location l2 on l.locngrpguid = l2.guid </code></pre>  <p>returns</p>  <pre><code>-+ | visitid | Locn1ID |   Locn1Name   | Locn1parent | locn2ID | Locn2Name | Locn2Parent |  | +---------+---------+---------------+-------------+---------+-----------+-------------+--+ |       1 |       1 | ward F - bed2 |        1234 | 1234    | WardF     | NULL        |  | |       1 |       2 | ward F - bed4 |        1234 | 1234    | WardF     | NULL        |  | |       1 |       3 | Ward B        |           0 | NULL    | NULL      | NULL        |  | +---------+---------+---------------+-------------+---------+-----------+-------------+--+ </code></pre>  <p>i want it to return</p>  <pre><code>+---------+---------+----------+ | visitid | Locn1ID | LocnName | +---------+---------+----------+ |       1 |       1 | Ward F   | |       1 |       2 | Ward F   | |       1 |       3 | Ward B   | +---------+---------+----------+ </code></pre>  <p>i could use a coalesce in the select part but as this is part of a join in a larger query that wouldnt give me the desired result. i'm sure its fairly simple but i've got a mind block now.</p>