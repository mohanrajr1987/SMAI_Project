<p>I am trying to collapse a table maintaining the hierarchy.</p>  <p>I am using SQL Server 2008 R2.</p>  <p>Data looks like this. Id is unique:</p>  <pre><code>ID  Country City        District            Street          amount ------------------------------------------------------------------ 1   USA     New York    NULL                NULL            1 1   USA     New York    Manhattan           NULL            1 2   EU      Paris       NULL                NULL            1 2   EU      Paris       arrondissement II   NULL            1 2   EU      Paris       arrondissement II   Rue Vivienne    1 2   EU      Paris       arrondissement IV   NULL            1 2   EU      Paris       arrondissement IV   Rue de Rivoli   1 </code></pre>  <p>to this:</p>  <pre><code>ID  Country City      District          Street        amount ------------------------------------------------------------ 1   USA     New York  Manhattan         NULL            1 2   EU      Paris     arrondissement II Rue Vivienne    1 2   EU      Paris     arrondissement IV Rue de Rivoli   1 </code></pre>  <p>Sample code:</p>  <pre><code>create table DataTab (     ID  [varchar](10),     Country [varchar](10),     City [varchar](10),     District [varchar](50),     Street [varchar](50),     amount [int] );  Insert into DataTab values (1, 'USA', 'New York', NULL, NULL, 1);  Insert into DataTab values (1, 'USA', 'New York', 'Manhattan', NULL, 1);  Insert into DataTab values (2, 'EU', 'Paris', NULL, NULL, 1);  Insert into DataTab values (2, 'EU', 'Paris', 'arrondissement II', NULL, 1);  Insert into DataTab values (2, 'EU', 'Paris', 'arrondissement II', 'Rue Vivienne', 1);  Insert into DataTab values (2, 'EU', 'Paris', 'arrondissement IV', NULL, 1);  Insert into DataTab values (2, 'EU', 'Paris', 'arrondissement IV', 'Rue de Rivoli', 1);  select * from DataTab; </code></pre>  <p>I have tried to solve the problem using CTE but somehow I cannot find a viable solution.</p>  <p>Hope you have time to help.</p>