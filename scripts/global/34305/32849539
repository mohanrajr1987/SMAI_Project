<p>I would like to populate a table based on a given table:</p>  <p>Given table t1: </p>  <pre><code> id1 (string), id2 (string), value (float)  tyb            uanwe_A        6963         tyb            uanwe_B        979         tyb            uanwe_C        931        </code></pre>  <p>I need :</p>  <pre><code> id1, id2,   vA,   vB,    vC  tyb  uanwe  6963   979  931  </code></pre>  <p>My SQL server query: </p>  <pre><code> select case substring(id2, 6, 1)         when 'A' then [value]         end as [vA]  from t1 </code></pre>  <p>but, this does not work for me <strong>because I got many "null" in the case that substring(id2, 6, 1) is not 'A'.</strong></p>  <pre><code> select case substring(id2, 6, 1)         when 'A' then [value]  end as [vA]         when 'B' then [value]  end as [vB]         when 'C' then [value]  end as [vC]      end   from t1 </code></pre>  <p>I GOT ERROR: </p>  <pre><code>  Incorrect syntax near the keyword 'when'. </code></pre>  <p>Any help would be appreciated.</p>