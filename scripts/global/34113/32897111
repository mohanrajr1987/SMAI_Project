<p>I added the below code above the <code>User.create</code> method in the <code>register</code> action at <code>api/services/protocols/local.js</code> file:</p>  <pre><code>var query   = {}; query.username = username; User.findOne(query, function (err, user) {   if (user) {     req.flash('error', 'Error.Passport.User.Exists');     return next(err);   }  });  var query   = {}; query.email = email; User.findOne(query, function (err, user) {   if (user) {     req.flash('error', 'Error.Passport.Email.Exists');     return next(err);   } }); </code></pre>  <p><p> Although I added the custom error messages in my locales <code>en.json</code> file, I get the below error:</p>  <pre><code>events.js:85       throw er; // Unhandled 'error' event             ^ Error: Can't set headers after they are sent.   at ServerResponse.OutgoingMessage.setHeader (_http_outgoing.js:335:11)   at ServerResponse.res.setHeader (/usr/local/lib/node_modules/sails/node_modules/express/node_modules/connect/lib/patch.js:133:22) ... </code></pre>  <p><p> Any idea how to solve this? thanks for your time.  </p>