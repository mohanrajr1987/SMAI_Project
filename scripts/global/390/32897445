<p>I have an input json document as so: </p>  <pre><code>[   {     "Name": "one",     "Tags": [       {         "Key": "Name",         "Value": "important"       },       {         "Key": "OtherTag",         "Value": "irrelevant"       }     ]   },   {     "Name": "two",     "Tags": [       {         "Key": "OtherTag",         "Value": "irrelevant2"       },       {         "Key": "Name",         "Value": "important"       }     ]   },   {     "Name": "three",     "Tags": [       {         "Key": "Name",         "Value": "important2"       },       {         "Key": "OtherTag",         "Value": "irrelevant3"       }     ]   } ] </code></pre>  <p>I want to use <code>jq</code> to group the three records by tag Value where the Key = "Name". The result would be two arrays, one with two records in it and one with one. The array with two records would have two because both records share the same tag with a value of "important". Here is what the result would look like:</p>  <pre><code>[   [     {       "Name": "one",       "Tags": [         {           "Key": "Name",           "Value": "important"         },         {           "Key": "OtherTag",           "Value": "irrelevant"         }       ]     },     {       "Name": "two",       "Tags": [         {           "Key": "OtherTag",           "Value": "irrelevant2"         },         {           "Key": "Name",           "Value": "important"         }       ]     },   ],   [     {       "Name": "three",       "Tags": [         {           "Key": "Name",           "Value": "important2"         },         {           "Key": "OtherTag",           "Value": "irrelevant3"         }       ]     }   ] ] </code></pre>  <p>I just can't figure out how to do this with <code>jq</code>. Does anyone have any ideas?</p>