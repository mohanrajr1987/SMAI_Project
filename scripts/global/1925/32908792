<p>Let's imagine a dummy subset of Brainf*ck: </p>  <p><code>+</code> increments the counter</p>  <p><code>-</code> decrements the counter</p>  <p>A simple program:</p>  <p><code>program = "++++--" -- should evaluate to 2</code></p>  <p>And a stateful evaluation function:</p>  <pre><code>eval :: Char -&gt; State Int Char eval '+' = do x &lt;- get               put (x + 1)               return 'I' eval '-' = do x &lt;- get               put (x - 1)               return 'D' </code></pre>  <p>How would you evaluate the program? (Looks like a <code>fold</code> to me but can't get my head around it, and it doesn't feel like it's the way to do it properly...)</p>