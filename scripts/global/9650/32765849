<p>I'm writing a C# Word 2013 Add-in that obfuscates the clipboard contents if the content being copied is within a managed Word application.</p>  <p>I have a few questions.</p>  <ol> <li>I've ran into a FatalExecutionEngineError when attempting to call Clipboard.GetDataObject().GetData() if the Data Format is "EnhancedMetaFile". Apparently, from my research, this is a known issue. The most relevant question I've found is from 2007, is the recommended solution still to use the Clipboard APIs instead of the built-in .NET Clipboard library? References below with code snippet.</li> </ol>  <p><a href="http://bytes.com/topic/net/answers/689572-fatalexecutionengineerror-calling-clipboard-getdataobject-getdata-enhancedmetafile" rel="nofollow">http://bytes.com/topic/net/answers/689572-fatalexecutionengineerror-calling-clipboard-getdataobject-getdata-enhancedmetafile</a></p>  <p><a href="https://support.microsoft.com/en-us/kb/323530" rel="nofollow">https://support.microsoft.com/en-us/kb/323530</a></p>  <pre><code>public static void ClipboardEvent(Object sender, EventArgs e) {     IDataObject contentObj = Clipboard.GetDataObject();      if (contentObj != null)     {         foreach (string dataFormat in contentObj.GetFormats())         {             try             {                 object data = contentObj.GetData(dataFormat); // throws here                 object obfuscatedData = Obfuscate(data);                 contentObj.SetData(dataFormat, obfuscatedData);             }             catch (Exception ex)             {                             }         }          Clipboard.SetDataObject(contentObj);     } } </code></pre>  <ol start="2"> <li><p>I need to differentiate between a copy operation and my own modification to the clibpoard. I currently have a event watcher on the API method AddClipboardFormatListener(IntPtr hwnd), but this informs me every time the clipboard changes, including when I obfuscate the data and add it to the clipboard, therefore I basically end up in a infinite loop. How can I differentiate between a copy operation and my own modifications to the clipboard contents?</p></li> <li><p>If the contents of the clipboard are obfuscated, and I detect a paste of obfuscated data using my Add-in, I want to deobfuscate the data and show it as it would normally appear. How do I detect the paste and deobfuscate before the paste actually happens? Can I just override the following method in my Add-in?</p></li> </ol>  <p><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms649038(v=vs.85).aspx" rel="nofollow">https://msdn.microsoft.com/en-us/library/windows/desktop/ms649038(v=vs.85).aspx</a></p>  <p>Thanks for any help you can provide.</p>