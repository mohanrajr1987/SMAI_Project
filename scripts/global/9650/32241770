<p>I have done quite a few research, but there were no fruits so far...</p>  <p>The only links that I found are somewhat similar to my situation don't even work either:</p>  <ul> <li><a href="http://www.jonasjohn.de/snippets/csharp/drag-and-drop-example.htm" rel="nofollow">Simple drag and drop example</a></li> <li><a href="http://stackoverflow.com/questions/3207732/how-can-i-tell-a-shortcut-from-a-file-in-a-c-sharp-drag-and-drop-operation">How can I tell a shortcut from a file in a C# drag and drop operation?</a></li> <li><a href="http://www.csharphelp.com/2006/10/drag-and-drop-files-with-c/" rel="nofollow">Drag and Drop Files with C#</a></li> <li><a href="http://stackoverflow.com/questions/9464001/drag-and-drop-file-into-textbox">drag and drop file into textbox</a></li> <li><a href="http://stackoverflow.com/questions/2850870/e-data-getdatapresent-not-working-in-winforms-drag-and-drop-handler">e.Data.GetDataPresent not working in WinForms drag-and-drop handler?</a></li> </ul>  <p><strong>Basically</strong>, first of all, I want the code to be able to recognize that the file is of a "<em>.url</em>" extension, or rather, an internet shortcut, most typically employed by Google Chrome, as well as Mozilla Firefox, and most likely, all other web browsers which I did not extensively test.</p>  <p>In case you do not know what type of shortcut I am referring to, I mean something like in the picture below.</p>  <p><a href="http://i.stack.imgur.com/hpnLx.png" rel="nofollow"><img src="http://i.stack.imgur.com/hpnLx.png" alt="enter image description here"></a></p>  <p>Below is the current code that I am using in the DragDrop event handler of a textbox, and it doesn't seem to work:</p>  <pre><code>string file = (string)(e.Data.GetData(DataFormats.FileDrop, false)); if (Path.GetExtension(file) == ".url") {      //Do Stuff Here } </code></pre>  <p>Apparently, the code can't even get the supposed file name of the shortcut. This shortcut is the kind that has already been dragged and dropped to the desktop from a browser. Thus, in this case, that shortcut is the one being dragged and dropped for the code to process.</p>  <p>(Not sure if this will make any difference, but I tried substituting "<em>DataFormats.FileDrop</em>" with "<em>DataFormats.Serialization</em>" as well as "<em>DataFormats.Html</em>" with no postitive effects.)</p>  <p>Also, for some weird reason, the program immediately breaks off at the very first line of the code block above. (It also happens to be the very first line in my DragDrop event)</p>  <p><strong>My question is:</strong> How can the code be corrected or modified (to any extent, even if completely changing the code) so that it can recognize the internet shortcut file of <em>.url</em> extension, then proceed to treat it like a normal file. </p>  <p><strong>Also</strong>, why is the execution of the code immediately stopping right after executing the first line, even though breakpoints have been set for the few lines after the first line (as in skipping the if statement completely)?</p>  <p>And if it is not too much, how to only let the line below:</p>  <pre><code>e.Effect = DragDropEffects.Link; </code></pre>  <p>work when the file is only of the internet shortcut type, "<em>.url</em>", in the DragEnter event handler, or is that impossible?</p>  <p>I know that Notepad++ is able to open and read the contents and even edit the internet shortcut files. Although if I can get the code to recognize the shortcut, I think I will then be able to read from it like a normal file.</p>  <p>I would prefer an answer with working code, if possible. Sorry for the long question, as I wanted to try to be as precise as possible with my question.</p>