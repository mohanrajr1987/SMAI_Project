<p>I am trying to create a function that takes an already formatted  json.loads(). </p>  <pre><code>def data_fp(fp):     for line in fp:     try:          data=json.loads(line)          json_data.append(data)     except:         continue </code></pre>  <p>I take the json_data and am trying to clean it. I created a blank dataframe and made a function.</p>  <pre><code>df=pd.DataFrame()  def data_clean(liste):     df['col1'] = map(lambda datas: datas['col1'] if 'col1' in datas else 'NA', liste)     df['col2'] = map(lambda datas: datas['col2'] if 'col2' in datas else 'NA', liste)     df=df[df['col2']=='foo'] </code></pre>  <p>The problem comes from the last line. When I include it in the function, I get an error </p>  <blockquote>   <p>UnboundLocalError: local variable 'df' referenced before   assignment</p> </blockquote>  <p>But when I run the function without the last line in it, I get no errors, and I can run the == line in the console and get the desired result.</p>  <p>Why does it not work in the function?</p>