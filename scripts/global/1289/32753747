<p>I am trying to write a piece of software that would preferably be database agnostic, i.e., a user should be able to give any connection string, and things should 'just work'. </p>  <p>I already figured out how to create a database connection based on the <code>ProviderName</code> (using <code>DbProviderFactories</code>), and how to create a command (using <code>DbConnection.CreateCommand()</code>). </p>  <p>One problem that I haven't been able to solve is how to use parameters in a query: For example, an ODBC connection expects a question mark (<code>select * from table where field=?</code>), but other types of connection expect a name (<code>select * from table where field=:value</code>). </p>  <p>I could do something like this (pseudo code)</p>  <pre><code>if dbConnection is OdbcConnection      sql = ... else if dbConnection is OracleConnection      sql = ... else ... </code></pre>  <p>But obviously that is not an ideal situation.</p>  <p>Is there a way to get some information about the required parameter syntax for a given connection? I was thinking about <code>DbConnection.QualifyParameterName("name")</code> which would return a <code>?</code> in case of an <code>OdbcConnection</code>, and <code>:name</code> (or some other syntax I haven't thought about) otherwise.</p>  <p>Any ideas?</p>