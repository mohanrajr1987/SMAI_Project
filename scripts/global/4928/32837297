<p>I am trying to get the total results like wins, loss etc using the sum function of sql and i need to get it for different operations under different competitors but when i am applying the sum function now as below it is taking the first competitor and first operation and creating the sum of all wins and providing improper results is there way to do it correctly.</p>  <pre><code>&lt;?php ini_set('max_execution_time', 300); $sql ="DROP  TABLE t_comp"; $stat = $_pdo-&gt;query($sql);  $sql ="CREATE  TABLE t_comp (competitors varchar(50),territory varchar(50),brand varchar(50),seae varchar(50),material varchar(50),operation varchar(50),engineer varchar(50),win varchar(50),loss varchar(50),cl varchar(50),tie varchar(50),emptied varchar(50),total varchar(50))"; $stat = $_pdo-&gt;query($sql);   $sql = "select competitor,operation,territory,brand,seae,material,engineer,(sum(win)* 100 / (sum(win)+sum(loss)+sum(cl)+sum(emptied)+sum(tie))) win,(sum(loss)* 100 / (sum(win)+sum(loss)+sum(cl)+sum(emptied)+sum(tie))) loss,(sum(cl)* 100 / (sum(win)+sum(loss)+sum(cl)+sum(emptied)+sum(tie))) cl,(sum(emptied)* 100 / (sum(win)+sum(loss)+sum(cl)+sum(emptied)+sum(tie))) emptied,(sum(tie)* 100 / (sum(win)+sum(loss)+sum(cl)+sum(emptied)+sum(tie))) tie,(sum(win)+sum(loss)+sum(cl)+sum(emptied)+sum(tie)) total from t_against  group by competitor";  foreach($_pdo-&gt;query($sql) as $row)   {  $competitor = $row["competitor"]; $operation = $row["operation"]; $brand = $row["brand"]; $seae = $row["seae"]; $engineer = $row["engineer"]; $material = $row["material"]; $territory = $row["territory"]; $win = $row["win"]; $loss = $row["loss"]; $cl = $row["cl"]; $null = $row["emptied"]; $tie = $row["tie"]; $total = $row["total"];  $win = round($win,2); $loss = round($loss,2); $cl = round($cl,2); $null = round($null,2); $tie = round($tie,2);  $sql = "INSERT INTO t_comp (competitors,operation,brand,seae,material,territory,engineer,win,loss,cl,tie,emptied,total) VALUES ('$competitor','$operation','$brand','$seae','$material','$territory','$engineer','$win','$loss','$cl','$tie','$null','$total')";  $stat = $_pdo-&gt;query($sql);   } </code></pre>  <p>please let me know how can i divide the result under operation and competitor.</p>