<p>Oracle 11g is giving me a headache and I am not able to find any answer that's relevant to my question.</p>  <p>I am trying to calculate revenue <em>per work order</em>, this is not available as a calculated field and is only available through a calculation.</p>  <p>Columns available:</p>  <ul> <li>Item code</li> <li>Item price (int)</li> <li>Quantity (int)</li> <li>Charge? (0 when not charged, -1 when charged)</li> </ul>  <p>There's been made a difference between "Labour" and "Materials", both of which can create a charge for the customer.</p>  <p>My code right now is as follows:</p>  <pre><code>SUM(     CASE WHEN ("BOL/BOM Items"."BOLBOM Code") IN ('1-845413','1-845911','1-845912', '1-MW-222') THEN     0     ELSE          ("Workorder BOL Items"."Quantity MW (BOL)" * -("Workorder BOL Items"."Charge MW (BOL)")) * "Workorder BOL Items"."Price Incl BTW MW (BOL)"         +         ("Workorder BOM Items"."Quantity MW (BOM)" * -("Workorder BOM Items"."Charge MW (BOM)")) * "Workorder BOM Items"."Price Incl BTW MW (BOM)"      END      BY     "Work Orders"."CallID" ) </code></pre>  <p>This adds up all the charges for each work order perfectly, but <strong>only</strong> when the column for "Item code" is added to the query. It doesn't matter when I exclude it from the view.</p>  <p>An example is a result that returns 112 (2x16 (labour) + 1x 80 (material)) when the column is added, but only 80 when the item code column is not present.</p>  <p>Is there a way this could work without the query asking for the additional column?</p>  <p>Below is a sample data set with the column "CalcRevenue" being the desired result.</p>  <pre><code>CallID  BOLBOM Code CalcRevenue Quantity MW (BOM)   Charge MW (BOM) Price Incl BTW MW (BOM) Quantity MW (BOL)   Charge MW (BOL) Price Incl BTW MW (BOL) 0010000065554342    1-SW-004    0   0   0   0,00    0   0   0,00 0010000065554342    1-SW-006    0   0   0   0,00    0   0   0,00 0010000065554342    1-SW-008    0   0   0   0,00    0   0   0,00 0010000065554342    1-SW-012    0   0   0   0,00    0   0   0,00 0010000066233542    1-845921    112 1   -1  80,00   0   0   0,00 0010000066233542    1-MW-009    112 0   0   0,00    2   -1  16,00 0010000066233542    1-MW-222    112 0   0   0,00    2   -1  0,00 0010000066233542    1-SW-044    112 0   0   0,00    0   0   0,00 0050001100208165    3-842753    0   1   0   90,75   0   0   0,00 0050001100208165    3-SW-102    0   0   0   0,00    0   0   0,00 0050001100208165    3-SW-104    0   0   0   0,00    0   0   0,00 0050001100208165    3-SW-105    0   0   0   0,00    0   0   0,00 0050001100208165    3-SW-108    0   0   0   0,00    0   0   0,00 0050001100208165    3-SW-109    0   0   0   0,00    0   0   0,00 0050001100208165    3-SW-110    0   0   0   0,00    0   0   0,00 </code></pre>  <p>Each CallID can have multiple "BOLBOM Code", which in turn have the Charge/Quantity and Price columns.</p>  <p>This is what happens to the same data if I remove the "BOLBOM" (and related) columns.</p>  <pre><code>CallID  CalcRevenue 0010000065554342    0 0010000066233542    208 0050001100208165    0 </code></pre>  <p>I'd like to calculate the revenue per CallID (work order) - Which is calculated as follows: </p>  <pre><code>Revenue = (Quantity * -(Charge)) * Price </code></pre>  <p>Charge will be -1 when it is charged to the customer, 0 otherwise.  It is calculated on the "BOLBOM" level of the order, but should be SUMmed to the "Work Order" level.</p>