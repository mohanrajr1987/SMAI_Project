<p>I have sensors on Tricycles, defined by 'Name', that tell me when one of the three Tire Groups are changed.  The Tire Groups are sorted in columns labeled "Tire A", "Tire B", and "Tire C".  Under each of these columns are groups of tires that corresponds to dates that bicycle rides occurred.</p>  <p>The shop gets returned tires which were removed.  Those returns are logged in the returns table ('Table B' below) with the following information:  --> Name, Tire Group (A, B, or C), Return Date, and Serial Number.</p>  <p>GOAL: match each returned Serial Number from the shop returns table ('Table B' below) to a tire that was installed on a Tricycle being monitored by sensors.  </p>  <p>Basic assumption: a returned tire was installed on the 1st group before recorded return date.  As an examble, Serial Number 1132 below was installed on 'Tire B' group 1 on 'Hot'.  This is because 1132 was received at the shop between group 2's first ride (5/5/01 15:02) and group 2's last ride (7/16/02 4:21).  Therefore, when this condition is true, the tire group is group 2 - 1 = group 1.</p>  <p>Serial number 6846 was installed on 'Tire B' group 2 on 'Hot'.  See Table C for an example of results (I need to be able to join to either table).</p>  <p>I can do this using for loops and if/then statements, however in Python this is very time consuming when analyzing millions of datapoints.  I'm wondering if this can be done in Pandas with a much more optimized method?</p>  <p>Day/Month/Year Hour:Minutes  all matter in the comparisons.</p>  <p>TableA:</p>  <pre><code>Ride Date      Name   Tire A    Tire B  Tire C 1/12/01 20:44   Hot     1        1        1 2/15/01 7:44    Hot     1        1        1 2/28/01 0:44    Hot     1        1        1 3/5/01 9:10     Hot     1        1        1 5/5/01 15:01    Hot     1        2        1 8/29/01 3:01    Hot     2        2        1 9/20/01 6:12    Hot     2        2        1 11/11/01 14:23  Hot     2        2        1 1/2/02 16:54    Hot     2        2        2 1/5/02 5:08     Hot     2        2        2 3/6/02 18:09    Hot     2        2        3 4/2/02 22:24    Hot     3        2        3 4/9/02 16:23    Hot     3        2        3 6/6/08 3:21     Hot     3        2        3 7/16/02 4:21    Hot     3        2        3 10/1/02 23:52   Hot     3        3        3 10/28/02 18:21  Hot     3        3        3 12/23/02 17:30  Hot     3        3        4 2/5/08 5:30     Cold    1        1        1 5/20/08 22:25   Cold    1        1        1 6/3/08 13:42    Cold    2        1        1 7/8/08 20:04    Cold    2        1        1 8/2/08 8:09     Cold    2        1        1 9/20/08 4:35    Cold    2        1        2 10/15/08 3:18   Cold    3        1        2 12/21/08 14:47  Cold    3        2        2 3/12/09 4:09    Cold    3        2        3 5/25/09 17:34   Cold    3        2        3 6/1/09 12:28    Cold    4        3        3 8/23/09 2:02    Cold    4        3        3 9/18/09 20:40   Cold    4        3        4 6/20/00 18:27   Medium  …        …        … </code></pre>  <p>Here's the shop returns, Table B:</p>  <pre><code>Name    Tire Group  Tire S/N    Tire Return Date Cold        C         3265        10/12/08 15:32 Cold        B         4856        6/2/09 9:43 Hot         C         4873        1/3/02 16:54 Hot         B         1132        5/5/01 15:46 Hot         B         6846        12/23/01 16:30 Cold        A         9542        7/7/08 1:42 Cold        C         5624        3/12/09 4:08 Medium      …          …              … </code></pre>  <p>Table C:</p>  <pre><code>Name    Tire Group  Tire S/N    Tire Return Date    Tire A  Tire B  Tire C Cold         C        3265       10/12/08 15:32       N/A     N/A      1 Cold         B        4856       6/2/09 9:43          N/A      2      N/A Hot          C        4873       1/3/02 16:54         N/A     N/A      1 Hot          B        1132       5/5/01 15:46         N/A      1      N/A Hot          B        6846       12/23/01 16:30       N/A      2      N/A Cold         A        9542       7/7/08 1:42           1      N/A     N/A Cold         C        5624       3/12/09 4:08         N/A     N/A      1 Medium       …         …    …        </code></pre>