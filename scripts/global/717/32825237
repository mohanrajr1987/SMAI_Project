<p>After merging two unequal time series I want to fill the blanks with a custom function. Lets say my Series1 is daily data and Series2 is monthly data. So now Series1 has for example 30 data points for one month and Series2 only one. If I make a left join Series 2 has 29 NAs which I don't like. Ideally I would like a fill function so that Series 2 takes always the previous value to fill these 29 days.</p>  <p>So for example if the 31. of January has a value of 10 and the 28th of February a value of 15, February 1-27. should have a value of 10 as well. Of course in the beginning this doesn't work (since the first row is probably also a NA), so the first row should take the value of the first row containing a value at all.</p>  <p>At the moment I have this, but still, all NAs are present:</p>  <pre><code>Test&lt;-merge.xts(Series1, Series2, join="left", fill=function(x) x[index(x)-1,]) </code></pre>  <p>Series1:</p>  <pre><code>structure(c(1.51762156049755, 1.52103159497526, 1.51401262063846,  1.5226927459172, 1.52933295052158, 1.52409353403389, 1.52292452830189,  1.5268928035982, 1.53555449785816, 1.54004946727549, 1.54031650339111,  1.53987556561086, 1.53733857383492, 1.52781969068276, 1.5303624813154,  1.53149347601615, 1.53200449185851, 1.53034081463009, 1.52689961175818,  1.52616010353115, 1.52004035586536, 1.52604263206673, 1.53170366207736,  1.53332707472775, 1.5400318381871, 1.53717071341521, 1.53998696583186,  1.53676880222841, 1.53316818056702, 1.53512014787431, 1.54153071688263,  1.53692449355433, 1.53382906453686, 1.53159514756473, 1.5344496294263,  1.53717866027826, 1.53445133065986, 1.53503822351656, 1.5306399132321,  1.53633694255827, 1.53748747380887, 1.54019086070839, 1.54068532372772,  1.53600669892073, 1.53977166385926, 1.53468288606184, 1.53986928104575,  1.54024911693623, 1.5402127262549, 1.54151119402985, 1.53934776549289,  1.53958085476343, 1.53900838497995, 1.53818540787939, 1.53465613216017,  1.53500719942405, 1.53537650054565, 1.53317195624888, 1.53192246131958,  1.53136958262882, 1.53666845974538, 1.53503754022167, 1.53098678960901,  1.52377172091382, 1.52796773627915, 1.52584842623527, 1.52760075397182,  1.52793296089385, 1.52820374854273, 1.52947558770344, 1.52752869440459,  1.52590880810595, 1.51771286513362, 1.52378827099884, 1.52171596056488,  1.52387303280875, 1.52663662867745, 1.53114232706069, 1.52827140549273,  1.52923132443161, 1.52939594909482, 1.53232585173925, 1.53195117573147,  1.53853103261361, 1.53776866137519, 1.54085533920156, 1.5410640956972,  1.54313041923661, 1.54222657292872, 1.54302034987504, 1.54211182336182,  1.54181785998761, 1.5424089337942, 1.53578353604795, 1.53286652078775,  1.53120629370629, 1.53219713608012, 1.53192052980132, 1.53522245762712,  1.53543098889476, 1.53283647523016, 1.5296408481177, 1.52531916716648,  1.52295699845811, 1.52777060191165, 1.52890571231934, 1.5233980665583,  1.52386256533288, 1.51978021978022, 1.52140011865412, 1.51797040169133,  1.51707941929974, 1.52089868588385, 1.52408100748809, 1.52491920394625,  1.52068065032432, 1.52637418914305, 1.52848101265823, 1.52656088306313,  1.52858618908214, 1.53068778514246, 1.52826643894108, 1.52470085470085,  1.51927185710623, 1.52041166380789, 1.51975945017182, 1.52318452637941,  1.51831155433287, 1.51966908661151, 1.52143645470753, 1.52183128444256,  1.52286417239331, 1.52149627623561, 1.52065908330545, 1.51957958976098,  1.52554186145346, 1.52094733242134, 1.51794915836482, 1.51173708920188,  1.51222222222222, 1.5101414692347, 1.5068328319725, 1.50393081761006,  1.50417972831766, 1.50391986062718, 1.50638741635526, 1.50589880276151,  1.51000264387063, 1.50961116475029, 1.50934456435904, 1.50983477576711,  1.51314636283961, 1.50903004140604, 1.51011752231157, 1.50968426638366,  1.50718251520226, 1.50750460809269, 1.50457827082233, 1.50718301061836,  1.51371392834807, 1.51775147928994, 1.51589595375723, 1.51878256100905,  1.51964269437608, 1.52107244513819, 1.51828822238478, 1.51868515287852,  1.52112289685443, 1.52031478770132, 1.5218941402322, 1.51964269437608,  1.51789300712069, 1.51745137247773, 1.51548186148772, 1.51610254538819,  1.51619929213177, 1.51333333333333, 1.51241134751773, 1.51200286635614,  1.51837734821672, 1.5163433908046, 1.49981738495252, 1.50498640072529,  1.5011387446479, 1.49350888500138, 1.4836323284631, 1.48080845540515,  1.47762023908813, 1.47091566935708, 1.44464775846295, 1.46478356566398,  1.46516563624619, 1.47632234837995, 1.48080808080808, 1.47685016405396,  1.48288833837967, 1.48791693466875, 1.48385916780979, 1.48779368575624,  1.4842056932966, 1.48020986745214, 1.48406538215688, 1.48219003370684,  1.4840747090138, 1.48181569592562, 1.47840712792072, 1.48482921511628,  1.48070841239722, 1.47882236069719, 1.47693552738063, 1.47952903398448,  1.47818343722173, 1.48081910042028, 1.47554444841128, 1.47437042328987,  1.47387958352196, 1.46947082767978, 1.47113912651959, 1.47202166064982,  1.47102365047843, 1.47226211849192, 1.47248814529838, 1.46853962839961,  1.46421559878636, 1.46491463305623, 1.46394424090787, 1.47141221037794,  1.46876654314452, 1.46473285134897, 1.46621860629643, 1.45898901098901,  1.45649677590319, 1.4541381128097, 1.45816872969889, 1.46286215978929,  1.46461267605634, 1.46386925795053, 1.46151797603196, 1.46911608093717,  1.47140552169236, 1.4750490108715, 1.47230138938368, 1.47392733410322,  1.47497537827917, 1.47591916674085, 1.48151776966242, 1.47590146376294,  1.47583108715184, 1.47547136091502, 1.47256621169665, 1.47307171853857,  1.47527795353882, 1.47582605564059, 1.46818468184682, 1.46878890272097,  1.48522318688065, 1.48453427065026, 1.48568912373404, 1.4814585908529,  1.48118303373771, 1.47687244262587, 1.47909624621953, 1.48514136031072,  1.48368539325843, 1.47950599606229, 1.47334107350183, 1.47758127902822,  1.47985739750446, 1.48092011412268, 1.47403176869534, 1.48108736475007,  1.47305653710247, 1.46450017661604, 1.4681413589495, 1.46912050964431,  1.46845174973489, 1.47360950944735, 1.46758608573436, 1.46957056292263,  1.47418043421849, 1.47130794416681, 1.47095489568003, 1.47372954349699,  1.47756961155036, 1.47673216132368, 1.47682004001044, 1.47401301518438,  1.47194032439934, 1.47180647406892, 1.47518534670737, 1.47624474053296,  1.47794826830338, 1.48057829646403, 1.48357504805172, 1.48148471615721,  1.47989206128134, 1.47923238696109, 1.47960337479342, 1.47915397336583,  1.47995097180879, 1.47630640813842, 1.47675825125281, 1.47637181928337,  1.47504781777082, 1.47135191275749, 1.47813993915689, 1.47672594142259,  1.47480059602069, 1.47183284845279, 1.46386701662292, 1.47050586381936,  1.46995971273428, 1.46776454099509, 1.46059482834701, 1.45992231638418,  1.46362994350282, 1.4642195358687, 1.46497830514478, 1.46292372881356,  1.46326046879115, 1.46075594141892, 1.4626918018413, 1.46522991013001,  1.46767729569611, 1.46556834030683, 1.46354350123283, 1.46293202005101,  1.46216192405955, 1.46279539664412, 1.46416652028807, 1.46635751159332,  1.46744206538021, 1.46897280168999, 1.46536662843025, 1.46557031043884,  1.46789797713281, 1.46835554770942, 1.4694150120203, 1.46747460345749,  1.46710702490404, 1.46860547847741, 1.46663705019991, 1.4664345652562,  1.46345186781609, 1.46563852813853, 1.46283081925752, 1.45655110310671,  1.45227952506118, 1.45321531791908, 1.4547789396441, 1.45564738292011,  1.45421278931479, 1.45517865219358, 1.45266890970265, 1.45443743716296,  1.45503465888362, 1.45726148569365, 1.45540762356374, 1.45618509746766,  1.45435302779312, 1.45287885766928, 1.45133394664213, 1.45226409852764,  1.45390070921986, 1.45874769797422, 1.45672988399926, 1.46178846689572,  1.4674146797569, 1.4640179910045, 1.46468609865471, 1.47339173024395,  1.47045561296383, 1.47032863849765, 1.47437233538607, 1.47061043494669,  1.47251605591235, 1.47473215132265, 1.47768657420511, 1.47433962264151,  1.47615894039735, 1.47619047619048, 1.47506661591169, 1.47083612680778,  1.47052580800772, 1.4673786407767, 1.46719083673073, 1.46737852664577,  1.4680161147686, 1.47064637280095, 1.46837200079318, 1.47009818506397,  1.46631153201144, 1.46435925090695, 1.46418085731063, 1.46629705281587,  1.47042504706232, 1.47244016287615, 1.46962801741195, 1.46572500987752,  1.47040745514028, 1.46655971122029, 1.46671388101983, 1.46569960713206,  1.46444107233182, 1.45887708649469, 1.45496722138174, 1.4528824285573,  1.45116001194862, 1.4471463022508, 1.44598993785144, 1.45799803729146,  1.45748550083554, 1.45195033727637, 1.44973909618982, 1.44844597927972,  1.45353852185846, 1.45797913446677, 1.45808966861598, 1.46286266924565,  1.45828482731859, 1.4618320610687, 1.46203029706866, 1.46219309400372,  1.46284480219888, 1.46597735105859, 1.46784424709671, 1.4689243417833,  1.46860898567785, 1.47238907188529, 1.47246010120669, 1.47172011661808,  1.46688286163522, 1.46971327918583, 1.47072714749582, 1.47229862475442,  1.47179285222014, 1.46633416458853, 1.46399523903987, 1.46048587010412,  1.45797329143755, 1.45885579937304, 1.45979140267083, 1.46490971205466,  1.46888496270122, 1.46831875607386, 1.46836546846236, 1.46927047823123,  1.46807470421433, 1.462829499457, 1.46497003046084, 1.46442900479499,  1.46273932253314, 1.46406951767233, 1.4673116388156, 1.46543100912033,  1.45540647198106, 1.46271003242606, 1.45876085240726, 1.45973718012054,  1.46011549378487, 1.46333792018872, 1.46617056692451, 1.46380829785127,  1.4638067061144, 1.46371087192653, 1.46229022704837, 1.46666666666667,  1.4661108386464, 1.46767617938264, 1.46891393044492, 1.47142439879272,  1.46808094632906, 1.46796059689847, 1.46733815763739, 1.46692037470726,  1.4646265866378, 1.46480534801416, 1.46492177506642, 1.4623687858982,  1.46242774566474, 1.46307385229541, 1.4626074785043, 1.4633068968979,  1.46385298869144, 1.46180344478217, 1.46254927726675, 1.46241896272285,  1.46647171523646, 1.46721558389397, 1.46642431586388, 1.46720484359233,  1.46822373696872, 1.46890958245719, 1.46962101463806, 1.47268740031898,  1.47340742210756, 1.47341746993938, 1.47524262230145, 1.47560369671072,  1.47479367604653, 1.47198963317384, 1.47108097327483, 1.47302572315084,  1.4712827696618, 1.47083753784057, 1.47290739991913, 1.47313237221494,  1.47367359289893, 1.47733523479678, 1.47741935483871, 1.47505622572071,  1.46778337272634, 1.46253469010176, 1.46209942481512, 1.46357003391224,  1.45595482546201, 1.45030384179627, 1.45351356929109, 1.45500778412039,  1.44706984490476, 1.45556604763404, 1.45198866617693), .indexTZ = "UTC", .indexCLASS = "Date", tclass = "Date", tzone = "UTC", class = c("xts",  "zoo"), index = structure(c(978307200, 978393600, 978480000,  978566400, 978652800, 978912000, 978998400, 979084800, 979171200,  979257600, 979516800, 979603200, 979689600, 979776000, 979862400,  980121600, 980208000, 980294400, 980380800, 980467200, 980726400,  980812800, 980899200, 980985600, 981072000, 981331200, 981417600,  981504000, 981590400, 981676800, 981936000, 982022400, 982108800,  982195200, 982281600, 982540800, 982627200, 982713600, 982800000,  982886400, 983145600, 983232000, 983318400, 983404800, 983491200,  983750400, 983836800, 983923200, 984009600, 984096000, 984355200,  984441600, 984528000, 984614400, 984700800, 984960000, 985046400,  985132800, 985219200, 985305600, 985564800, 985651200, 985737600,  985824000, 985910400, 986169600, 986256000, 986342400, 986428800,  986515200, 986774400, 986860800, 986947200, 987033600, 987120000,  987379200, 987465600, 987552000, 987638400, 987724800, 987984000,  988070400, 988156800, 988243200, 988329600, 988588800, 988675200,  988761600, 988848000, 988934400, 989193600, 989280000, 989366400,  989452800, 989539200, 989798400, 989884800, 989971200, 990057600,  990144000, 990403200, 990489600, 990576000, 990662400, 990748800,  991008000, 991094400, 991180800, 991267200, 991353600, 991612800,  991699200, 991785600, 991872000, 991958400, 992217600, 992304000,  992390400, 992476800, 992563200, 992822400, 992908800, 992995200,  993081600, 993168000, 993427200, 993513600, 993600000, 993686400,  993772800, 994032000, 994118400, 994204800, 994291200, 994377600,  994636800, 994723200, 994809600, 994896000, 994982400, 995241600,  995328000, 995414400, 995500800, 995587200, 995846400, 995932800,  996019200, 996105600, 996192000, 996451200, 996537600, 996624000,  996710400, 996796800, 997056000, 997142400, 997228800, 997315200,  997401600, 997660800, 997747200, 997833600, 997920000, 998006400,  998265600, 998352000, 998438400, 998524800, 998611200, 998870400,  998956800, 999043200, 999129600, 999216000, 999475200, 999561600,  999648000, 999734400, 999820800, 1000080000, 1000166400, 1000252800,  1000339200, 1000425600, 1000684800, 1000771200, 1000857600, 1000944000,  1001030400, 1001289600, 1001376000, 1001462400, 1001548800, 1001635200,  1001894400, 1001980800, 1002067200, 1002153600, 1002240000, 1002499200,  1002585600, 1002672000, 1002758400, 1002844800, 1003104000, 1003190400,  1003276800, 1003363200, 1003449600, 1003708800, 1003795200, 1003881600,  1003968000, 1004054400, 1004313600, 1004400000, 1004486400, 1004572800,  1004659200, 1004918400, 1005004800, 1005091200, 1005177600, 1005264000,  1005523200, 1005609600, 1005696000, 1005782400, 1005868800, 1006128000,  1006214400, 1006300800, 1006387200, 1006473600, 1006732800, 1006819200,  1006905600, 1006992000, 1007078400, 1007337600, 1007424000, 1007510400,  1007596800, 1007683200, 1007942400, 1008028800, 1008115200, 1008201600,  1008288000, 1008547200, 1008633600, 1008720000, 1008806400, 1008892800,  1009152000, 1009238400, 1009324800, 1009411200, 1009497600, 1009756800,  1009843200, 1009929600, 1010016000, 1010102400, 1010361600, 1010448000,  1010534400, 1010620800, 1010707200, 1010966400, 1011052800, 1011139200,  1011225600, 1011312000, 1011571200, 1011657600, 1011744000, 1011830400,  1011916800, 1012176000, 1012262400, 1012348800, 1012435200, 1012521600,  1012780800, 1012867200, 1012953600, 1013040000, 1013126400, 1013385600,  1013472000, 1013558400, 1013644800, 1013731200, 1013990400, 1014076800,  1014163200, 1014249600, 1014336000, 1014595200, 1014681600, 1014768000,  1014854400, 1014940800, 1015200000, 1015286400, 1015372800, 1015459200,  1015545600, 1015804800, 1015891200, 1015977600, 1016064000, 1016150400,  1016409600, 1016496000, 1016582400, 1016668800, 1016755200, 1017014400,  1017100800, 1017187200, 1017273600, 1017360000, 1017619200, 1017705600,  1017792000, 1017878400, 1017964800, 1018224000, 1018310400, 1018396800,  1018483200, 1018569600, 1018828800, 1018915200, 1019001600, 1019088000,  1019174400, 1019433600, 1019520000, 1019606400, 1019692800, 1019779200,  1020038400, 1020124800, 1020211200, 1020297600, 1020384000, 1020643200,  1020729600, 1020816000, 1020902400, 1020988800, 1021248000, 1021334400,  1021420800, 1021507200, 1021593600, 1021852800, 1021939200, 1022025600,  1022112000, 1022198400, 1022457600, 1022544000, 1022630400, 1022716800,  1022803200, 1023062400, 1023148800, 1023235200, 1023321600, 1023408000,  1023667200, 1023753600, 1023840000, 1023926400, 1024012800, 1024272000,  1024358400, 1024444800, 1024531200, 1024617600, 1024876800, 1024963200,  1025049600, 1025136000, 1025222400, 1025481600, 1025568000, 1025654400,  1025740800, 1025827200, 1026086400, 1026172800, 1026259200, 1026345600,  1026432000, 1026691200, 1026777600, 1026864000, 1026950400, 1027036800,  1027296000, 1027382400, 1027468800, 1027555200, 1027641600, 1027900800,  1027987200, 1028073600, 1028160000, 1028246400, 1028505600, 1028592000,  1028678400, 1028764800, 1028851200, 1029110400, 1029196800, 1029283200,  1029369600, 1029456000, 1029715200, 1029801600, 1029888000, 1029974400,  1030060800, 1030320000, 1030406400, 1030492800, 1030579200, 1030665600,  1030924800, 1031011200, 1031097600, 1031184000, 1031270400, 1031529600,  1031616000, 1031702400, 1031788800, 1031875200, 1032134400, 1032220800,  1032307200, 1032393600, 1032480000, 1032739200, 1032825600, 1032912000,  1032998400, 1033084800, 1033344000, 1033430400, 1033516800, 1033603200,  1033689600, 1033948800, 1034035200, 1034121600, 1034208000, 1034294400,  1034553600, 1034640000, 1034726400, 1034812800, 1034899200, 1035158400,  1035244800, 1035331200, 1035417600, 1035504000, 1035763200, 1035849600,  1035936000, 1036022400, 1036108800, 1036368000, 1036454400, 1036540800,  1036627200, 1036713600, 1036972800, 1037059200, 1037145600, 1037232000,  1037318400, 1037577600, 1037664000, 1037750400, 1037836800, 1037923200,  1038182400, 1038268800, 1038355200, 1038441600, 1038528000, 1038787200,  1038873600, 1038960000, 1039046400, 1039132800, 1039392000, 1039478400,  1039564800, 1039651200, 1039737600, 1039996800, 1040083200, 1040169600,  1040256000, 1040342400, 1040601600, 1040688000, 1040774400, 1040860800,  1040947200, 1041206400, 1041292800), tzone = "UTC", tclass = "Date"), .Dim = c(522L,  1L), .Dimnames = list(NULL, "Series1"))  Series2:  structure(c(100, 100.32, 100.57, 100.82, 100.98, 101.01, 101.16,  101.3, 101.75, 102.07, 102.12, 102.3, 102.44, 102.59, 102.62,  102.74, 102.84, 103.09, 103.25, 103.31, 103.35, 103.48, 103.6,  103.72, 103.84, 103.96, 104.1, 104.35, 104.52, 104.69, 104.82,  104.96, 104.9, 105.03, 105.08, 105.27, 105.46, 105.55, 105.78,  105.94, 106.11, 106.36, 106.52, 106.6, 106.7, 106.92, 107.1,  107.27, 107.39, 107.41, 107.54, 107.72, 107.96, 108.13, 108.3,  108.43, 108.56, 108.68, 108.77), .indexCLASS = "Date", tclass = "Date", .indexTZ = "UTC", tzone = "UTC", class = c("xts",  "zoo"), index = structure(c(1010102400, 1010707200, 1011312000,  1011916800, 1012435200, 1012521600, 1013126400, 1013731200, 1014336000,  1014854400, 1014940800, 1015545600, 1016150400, 1016755200, 1017360000,  1017964800, 1018569600, 1019174400, 1019779200, 1020124800, 1020384000,  1020988800, 1021593600, 1022198400, 1022803200, 1023408000, 1024012800,  1024617600, 1025222400, 1025827200, 1026432000, 1027036800, 1027641600,  1028073600, 1028246400, 1028851200, 1029456000, 1030060800, 1030665600,  1031270400, 1031875200, 1032480000, 1033084800, 1033344000, 1033689600,  1034294400, 1034899200, 1035504000, 1036022400, 1036108800, 1036713600,  1037318400, 1037923200, 1038528000, 1039132800, 1039737600, 1040342400,  1040947200, 1041292800), tzone = "UTC", tclass = "Date"), .Dim = c(59L,  1L), .Dimnames = list(NULL, "Series2")) </code></pre>