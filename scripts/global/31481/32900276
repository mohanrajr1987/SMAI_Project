<p>I'm hoping someone here might be able to help me with a Crystal Reports problem that's been bugging me on and off for days.</p>  <p>I have a report that is used as a picking slip for our warehouse staff to tell them which products to pack for each order that comes through our sales system.</p>  <p>The report contains all the products for the order and the quantities that need to be packed in the details section of the report which come from a number of joined tables.</p>  <p>My problem is that I have to then query the database again in order to get the total amount of items for each product on the order that have been packed across all orders throughout the warehouse.  The report datasource only returns records relating to the order on the picking slip so I need a sub query.</p>  <p>I've tried to use a SQL command with the following query:</p>  <pre><code>SELECT ISNULL(SUM(QtyPacked), 0)   FROM tblPackingSlipLines   WHERE Status = 'Packed'     AND ProductId = '[ProductId]' </code></pre>  <p>I'm stuck on passing the <code>product id</code> into the command as it is held in a text field on the report itself which is populated from <code>tblProducts.ProductId</code> (one of the joined tables).</p>  <p>Is it even possible to access this value from the command?</p>  <p>I've tried things like <code>ProductId = '{tblProducts.ProductId}', @ProductId, ?ProductId</code> and numerous other weird and wonderful permutations.</p>  <p>I can't use a parameter as that would require either user interaction; not possible as the report is auto generated by a Windows service or passing a static value in from the service.</p>  <p>I've also tried using a formula but that only pulls back the sum of <code>QtyPacked</code> for that distinct order line and not all packed orders in the DB:</p>  <pre><code>SUM('{tblPickingSlipLines.QtyPacked}', '{tblProducts.ProductId}') </code></pre>  <p>Any help would be greatly appreciated.</p>