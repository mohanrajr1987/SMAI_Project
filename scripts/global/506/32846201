<p>I have created an Image and I want to add a rectangle around the image and recreate it as Image again to be drawn in a <code>PictureBox</code>  but I'm getting out of memory exception </p>  <p>How can I modify the image. </p>  <pre><code>public void Draw(SizeF size)     {         int scale = 100;         Graphics refGraph = this.CreateGraphics();         IntPtr hdc = refGraph.GetHdc();           SolidBrush brush = new SolidBrush(Color.Black);         Pen pen = new Pen(Color.Black, 4);         try         {             Metafile image = new Metafile(hdc, EmfType.EmfOnly, "Shapes");             using (Graphics g = Graphics.FromImage(image))             {                 PointF center = new PointF((float)base.Width / 2, base.Height / 2);                  //Draw a rect                 RectangleF Block = new RectangleF(new PointF(center.X - size.Width * scale / 2, center.Y - size.Height * scale / 2), new SizeF(size.Width * scale, size.Height * scale));                 g.FillRectangle(brush, Block);           }             //Image = image;             ModifyImage(image);         }         finally         {             refGraph.ReleaseHdc(hdc);             refGraph.Dispose();             pen.Dispose();             brush.Dispose();         }          Invalidate();     }      public void ModifyImage(Metafile image)     {         Graphics g = Graphics.FromImage(image);             PointF center = new PointF((float)Image.Width / 2, Image.Height / 2);             int bufferAmount = 5;             g.DrawRectangle(Pens.White, center.X - (Image.Width + bufferAmount) / 2, center.Y - (Image.Height + bufferAmount) / 2, Image.Width + bufferAmount, Image.Height + bufferAmount);          pictureBox.Image = image;     } </code></pre>  <p>Thanks </p>