<p>running into issues while plotting stock data in ggplot2 and with an x-axis that contains gaps from weekends and holidays. <a href="http://stackoverflow.com/questions/5169366/r-ggplot2-how-to-hide-missing-dates-from-x-axis">this</a> post has been very helpful, but i run into a variety of issues when trying to use ordered factors.</p>  <pre><code>library(xts) library(grid) library(dplyr) library(scales) library(bdscale) library(ggplot2) library(quantmod)  getSymbols("SPY", from = Sys.Date() - 1460, to = Sys.Date(), adjust = TRUE, auto.assign = TRUE)  input &lt;- data.frame(SPY["2015/"]) names(input) &lt;- c("Open", "High", "Low", "Close", "Volume", "Adjusted")  # i've tried changing rownames() to index(), and the plot looks good, but the x-axis is inaccurate # i've also tried as.factor() xaxis &lt;- as.Date(rownames(input))  input$xaxis &lt;- xaxis  p &lt;- ggplot(input) p &lt;- p + geom_segment(aes(x = xaxis, xend = xaxis, y = Low, yend = High), size = 0.50)           # body p &lt;- p + geom_segment(aes(x = xaxis - 0.4, xend = xaxis, y = Open, yend = Open), size = 0.90)    # open p &lt;- p + geom_segment(aes(x = xaxis, xend = xaxis + 0.4, y = Close, yend = Close), size = 0.90)  # close p &lt;- p + scale_y_continuous(scale_y_log10()) p + ggtitle("SPY: 2015") </code></pre>  <p><a href="http://i.stack.imgur.com/TnuqG.png" rel="nofollow"><img src="http://i.stack.imgur.com/TnuqG.png" alt="enter image description here"></a></p>  <p>The plot above (sans red boxes) is generated with the above code segment. And the following charts are some of the issues when attempting some solutions. First, if I try using the data frame's index, I will generate I nice looking graph, but the x-axis is inaccurate; the data currently ends in October, but in the plot below it ends in July: <a href="http://i.stack.imgur.com/Sbqqt.png" rel="nofollow"><img src="http://i.stack.imgur.com/Sbqqt.png" alt="enter image description here"></a></p>  <pre><code>xaxis &lt;- as.Date(index(input)) </code></pre>  <p>Second, if I try coercing the rownames to an ordered factor, I lose my horizontal tick data (representing the open and the close).<br> <a href="http://i.stack.imgur.com/119wt.png" rel="nofollow"><img src="http://i.stack.imgur.com/119wt.png" alt="enter image description here"></a></p>  <pre><code>xaxis &lt;- factor(rownames(input), ordered = TRUE)  </code></pre>  <p>The same issue of removing the horizontal ticks happens if I use the package bdscale, but the gridlines are cleaner:</p>  <p><a href="http://i.stack.imgur.com/AvwkN.png" rel="nofollow"><img src="http://i.stack.imgur.com/AvwkN.png" alt="enter image description here"></a></p>  <pre><code>p &lt;- p + scale_x_bd(business.dates = xaxis) </code></pre>