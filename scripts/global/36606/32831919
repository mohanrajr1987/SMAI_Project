<p>I am using the density function in R and then computing some results from the obtained densities. After that, I use the ggplot2 to display the PDFs of the same data.</p>  <p>However, the results are slightly different from what is shown in the respective plot - something that is confirmed by plotting the density output directly (using plot {graphics}).</p>  <p>Any idea why? How can I correct it, so the results and plot (from ggplot2) do match / are from exact same data?</p>  <p>An example of this (code and images):</p>  <pre><code>srcdata = data.frame("Value" = c(4.6228, 1.7942, 4.2738, 2.1502, 2.2665, 5.1717, 4.1015, 2.5126, 4.4270, 4.4729, 2.5112, 2.3493, 2.2787, 2.0114, 4.6931, 4.6582, 3.3162, 2.2995, 4.3954, 1.8488), "Type" = c("Positive", "Negative", "Positive", "Negative", "Negative", "Positive", "Positive", "Negative", "Positive", "Positive", "Negative", "Negative", "Negative", "Negative", "Positive", "Positive", "Positive", "Negative", "Positive", "Negative"))  bwidth &lt;- ( density ( srcdata$Value ))$bw  sample &lt;- split ( srcdata$Value, srcdata$Type )[ 1:2 ]  xmin = min(srcdata$Value) - 0.2 * abs(min(srcdata$Value)) xmax = max(srcdata$Value) + 0.2 * abs(max(srcdata$Value))  densities &lt;- lapply ( sample, density, bw = bwidth, n = 512, from = xmin, to = xmax )  #plotting densities result plot( densities [[ 1 ]], xlim = c(xmin,xmax), col = "steelblue", main = "" ) lines ( densities [[ 2 ]], col = "orange" )  #plot using ggplot2 ggplot(data = srcdata, aes(x=Value)) + geom_density(aes(group=Type, colour=Type)) + xlim(xmin, xmax)  #or with ggplot2 (using easyGgplot2) ggplot2.density(data=srcdata, xName='Value', groupName='Type', alpha=0.5, xlim=c(xmin,xmax)) </code></pre>  <p>image: </p>  <p><a href="http://i.stack.imgur.com/ONRKw.png" rel="nofollow"><img src="http://i.stack.imgur.com/ONRKw.png" alt="enter image description here"></a></p>