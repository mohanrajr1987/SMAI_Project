<blockquote>   <p>Fatal error: Uncaught exception 'Zend\Mail\Exception\RuntimeException'   with message 'Malformed header detected' in   /var/www/html/plugins/ZendFramework/ZendFramework-2.4.7/library/Zend/Mail/Headers.php   on line 88</p> </blockquote>  <p>This is the error message that I get when I try use the <code>Zend\Mail\Storage\Imap::getMessage()</code> function. If I comment out the line, where the error is thrown(to be more precise I have to comment out both lines where this same error is thrown from the same function), I am able to read the subject of the message, but later on on some e-mails I get a:</p>  <blockquote>   <p>Fatal error: Uncaught exception   'Zend\Mail\Header\Exception\InvalidArgumentException' with message   'Invalid header value detected' in   /var/www/html/plugins/ZendFramework/ZendFramework-2.4.7/library/Zend/Mail/Header/GenericHeader.php   on line 61</p> </blockquote>  <p>As I was testing the plugin, I didn't use any other extension or plugin while I got these errors, only the xDebug php extension, for debugging purposes. Here's my whole code:</p>  <pre><code>try { $mail = new Zend\Mail\Storage\Imap(array('host'     =&gt; 'my.mail.host',                                      'user'     =&gt; 'mymail@mymail.com',                                      'password' =&gt; 'xxxxxxxxx')); } catch (Zend\Mail\Exception $e) { print_r($e); }  $undecodable=array(); $mail-&gt;selectFolder('INBOX');  $list=array(1,2,3,4);  foreach ($list as $mid) { $message=$mail-&gt;getMessage($mid); $content=array(     'html'  =&gt; array(         'part'      =&gt;  null,         'content'   =&gt;  null     ),     'plain' =&gt;  array(         'part'      =&gt;  null,         'content'   =&gt;  null     ) ); foreach (new RecursiveIteratorIterator($message) as $part) {     try {         $strtok=strtok($part-&gt;contentType, ';');         if (($strtok == 'text/html') || ($strtok == 'text/plain')) {             switch ($part-&gt;contentTransferEncoding) {                 case 'base64':                     $contentDecoded = base64_decode($part-&gt;getContent());                     break;                 case 'quoted-printable':                     $contentDecoded = quoted_printable_decode($part-&gt;getContent());                     break;                 case 'default':                     $contentDecoded='undecodable';                     $undecodable[]=$part-&gt;contentTransferEncoding;                     break;             }             $strtok=explode("/",$strtok);             $strtok=$strtok[1];             $content[$strtok]['part']=$part;             $content[$strtok]['content']=$contentDecoded;         }     } catch (Zend\Mail\Exception $e) {         // ignore     } } echo "Message: " . $message-&gt;subject."&lt;BR&gt;"; if (!empty($content['html']['content'])) echo "HTML part found! "; if (!empty($content['plain']['content'])) echo "Plain part found! "; echo "&lt;BR&gt;&lt;BR&gt;Next message"; } exit; </code></pre>  <p><strong>NOTE:</strong> The message id's are correct, I can fetch all of the by telneting the mail server, they all exist</p>