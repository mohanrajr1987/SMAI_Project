<p>This is the query I'm riding on the repository of my Ad:</p>  <pre><code>    $query-&gt;andWhere($query-&gt;expr()-&gt;lte(':date', 'ad.date'));     if (array_key_exists('date', $paramFetcher)) {         $query-&gt;setParameter('date', new \DateTime($paramFetcher['date']));     } else {        $query-&gt;setParameter('date', new \DateTime('now'));     }      if (array_key_exists('dateFinal', $paramFetcher)) {        $query             -&gt;andWhere($query-&gt;expr()-&gt;lte('ad.dateFinal', ':dateFinal'))             -&gt;setParameter('dateFinal', new \DateTime($paramFetcher['dateFinal']));     } else {// Ad of treatment that has expired        $query             -&gt;andWhere($query-&gt;expr()-&gt;gte('ad.dateFinal', ':dateFinal'))             -&gt;setParameter('dateFinal', new \DateTime('now'));     } </code></pre>  <p>My intention is to make the intersection between the date passed by parameter (which is the start date and end) and the period of my Ad (which is the date and dateFinal).</p>  <p>what better way to do?</p>  <p>Because I was thinking of apena use to_date to make the last date for paremetro is understood to date. Of course as he has no to_date in Doctrine2 I would have to make a custom DQL.</p>  <p>But I would like you to help me find a better solution to cleaner.</p>  <p><strong>UPDATE</strong></p>  <p>I fixed my logic:</p>  <pre><code>//the start date of the search must be less than the end date of Ad if (array_key_exists('date', $paramFetcher)) {     $query         -&gt;andWhere($query-&gt;expr()-&gt;lte('to_date(:date)', 'ad.dateFinal'))         -&gt;setParameter('date', new \DateTime($paramFetcher['date'])); }  //the search deadline must always be greater than the date of the Ad if (array_key_exists('dateFinal', $paramFetcher)) {     $query         -&gt;andWhere($query-&gt;expr()-&gt;gte('to_date(:dateFinal)', 'ad.date'))         -&gt;setParameter('dateFinal', new \DateTime($paramFetcher['dateFinal'])); } </code></pre>  <p>to the treatment of ad has expired, the search is always done, where the final date of the announcement must be greater than today's date</p>  <pre><code>-&gt;andWhere($query-&gt;expr()-&gt;gte('ad.dateFinal', 'to_date(:today)')) -&gt;setParameter('today', new \DateTime('now')) </code></pre>  <p>config.yml</p>  <pre><code>orm:     ...     dql:         ...         datetime_functions:             to_date: Delivve\WebBundle\DQL\ToDate </code></pre>  <p>ToDate.php</p>  <pre><code>class ToDate extends FunctionNode {     public $date;      /**      * @override      */     public function getSql(SqlWalker $sqlWalker)     {         return "to_date(" . $this-&gt;date-&gt;dispatch($sqlWalker) . ", 'YYYY-MM-DD')";     }      /**      * @override      */     public function parse(Parser $parser)     {         $parser-&gt;match(Lexer::T_IDENTIFIER);         $parser-&gt;match(Lexer::T_OPEN_PARENTHESIS);         $this-&gt;date = $parser-&gt;ArithmeticPrimary();         $parser-&gt;match(Lexer::T_CLOSE_PARENTHESIS);     } } </code></pre>  <p>however this still not working, this having any errors.</p>