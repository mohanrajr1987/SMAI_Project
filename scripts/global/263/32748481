<p>I have a VBScript to change the desktop wallpaper on the fly. I can't for the life of me figure out why it works only sometimes, but not every time I run it. If I run the script enough times it will eventually make it through all 6 bmp images.</p>  <pre><code>Dim WshShell  Const HKEY_CURRENT_USER = &amp;H80000001  strComputer = "."  Set objReg = GetObject("winmgmts:\\" &amp; strComputer &amp; "\root\default:StdRegProv")  intLowNumber = 1 intHighNumber = 6  Randomize  intNumber = Int((intHighNumber - intLowNumber + 1) * Rnd + intLowNumber) msgbox intNumber  Select Case intNumber Case 1    strValue = "C:\Windows\Web\Wallpaper\Nature\img1.bmp" Case 2    strValue = "C:\Windows\Web\Wallpaper\Nature\img2.bmp" Case 3    strValue = "C:\Windows\Web\Wallpaper\Nature\img3.bmp" Case 4    strValue = "C:\Windows\Web\Wallpaper\Nature\img4.bmp" Case 5    strValue = "C:\Windows\Web\Wallpaper\Nature\img5.bmp" Case 6    strValue = "C:\Windows\Web\Wallpaper\Nature\img6.bmp" End Select  strKeyPath = "Control Panel\Desktop" ValueName = "Wallpaper"  objReg.SetStringValue HKEY_USERS, strKeyPath, ValueName, strValue  Set WshShell = WScript.CreateObject("Wscript.Shell")  WshShell.RegWrite "HKCU\Control Panel\Desktop\Wallpaper", strValue WshShell.Run "%WinDir%\System32\RUNDLL32.EXE user32.dll," &amp; "UpdatePerUserSystemParameters", 1, True  Set WshShell = Nothing wscript.quit </code></pre>