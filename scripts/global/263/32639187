<p>I have a script to change registry values.  Running it from an elevated command window it changes the key ok. Running it directly as an administrator (right click) it does nothing, same thing running it from task scheduler with elevated privileges.</p>  <p>Any idea why?</p>  <p>Code, basically it checks IP number and according to that it changes autoconfig proxy script with several option of .reg files with the different internet connection setup key.</p>  <pre><code>@ECHO OFF SETLOCAL ENABLEEXTENSIONS SETLOCAL ENABLEDELAYEDEXPANSION SET Target=%computername% IF %Target%.==. ECHO Missing target!&amp;PAUSE&amp;GOTO :EOF FOR /F "tokens=2 delims=[]" %%A in ('PING %Target% -4 -n 1 ^| FIND "["') DO (     SET TargetIP=%%A     SET TargetIP ) IF NOT DEFINED TargetIP ECHO NO IP found!&amp;PAUSE&amp;GOTO :EOF  :Compare SET PartialIP=%TargetIP:~0,9% IF "%PartialIP%"=="172.20.25" (     REGEDIT /S conbae.reg     goto :eof) IF "%PartialIP%"=="172.20.22" (     REGEDIT /S conbna.reg     goto :eof) SET PartialIP=%TargetIP:~0,6% SET PartialIP IF "%PartialIP%"=="172.20" (     REGEDIT /S conweb.reg  ) ELSE (     REGEDIT /S sinbae.reg  )   </code></pre>