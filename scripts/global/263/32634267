<p>I try using sub and retrive Registry values but in my code it don't work and I don't know why. Someone you check this code?</p>  <blockquote>   <p>Key I define us KeyPath in this example is "SOFTWARE\1del\Oi"<br>      Names define us StringName in this example is "NameApp"<br>      strValue receive the value in this example is "OiKey"<br></p> </blockquote>  <pre><code>hDefKey = HKEY_LOCAL_MACHINE key = "SOFTWARE\1del\Oi" Set objRegistry=GetObject("winmgmts:{impersonationLevel=impersonate}!\\.\root\default:StdRegProv")  call RecurseKey(key)  Sub RecurseKey(key)  'enumerate values (your existing code)  objRegistry.EnumValues hDefKey, key, names, types   If Not IsNull(names) Then  For i = 0 To UBound(names)    name = names(i)    Select Case types(i)       Case REG_SZ                   objRegistry.GetStringValue hDefKey, key, names, strValue         wscript.echo "  " &amp; names &amp; " (REG_SZ) = " &amp; strValue    End Select   Next   End If   'enumerate subkeys and recurse  objRegistry.EnumKey hDefKey, key, subKeys  If Not IsNull(subKeys) Then    For Each sk In subKeys      RecurseKey key &amp; "\" &amp; sk  '&lt;-- recursion happens here    Next  End If  End Sub </code></pre>