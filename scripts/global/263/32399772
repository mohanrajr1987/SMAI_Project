<pre><code>System.Diagnostics.Process process = new System.Diagnostics.Process();  System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo(); startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Normal; startInfo.FileName = "cmd.exe"; startInfo.Arguments = @"/K reg add ""HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer"" /V IconUnderline /T REG_DWORD /D 1 /F";  process.StartInfo = startInfo; process.Start(); </code></pre>  <p>If I run the program with admin privileges, it says: </p>  <blockquote>   <p>The operation completed successfully</p> </blockquote>  <p>The problem is that the registry key remains unchanged.</p>  <p>What did I do wrong? I tried to run a .bat, and it has the same problem. No errors, it just does not modify the registry key. If I run the .bat or the command in CMD, it works. If I try to run the CMD command or the .bat file (containing the command) from a program, it just says "The operation completed successfully." and does nothing. Thanks in advance.</p>  <p>With the registry class (no results):</p>  <pre><code>        RegistryKey RegKey1 = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer", true);         RegKey1.SetValue("IconUnderline", 1, RegistryValueKind.DWord);         RegKey1.Close(); </code></pre>