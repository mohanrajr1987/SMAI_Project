<p>A geometry shader gives an output greatly different from what was expected.</p>  <p>The problem is most likely linked to strange behavior of goniometric functions I experinced.</p>  <p>When computing <code>S</code>, that is passed to the fragment shader, results for</p>  <pre><code>float e = u - 3.14159 / 2; float f = v - 3.14159 / 2;  float p = (- sin (f) * a - cos (f) * b) / D;  vec2 S = A + vec2 (-sin (u), - cos (u)) * p; </code></pre>  <p>and</p>  <pre><code>float p = (cos (v) * a - sin (v) * b) / D;  vec2 S = A + vec2 (sin (u), - cos (u)) * p; </code></pre>  <p>are different, which they obviously shouldn't be.</p>