Positive 804 pIm trying to use JNI to pass a file pointer of a drawable resource to SDL.p  pWhat I have for now are the codejfieldIDcode, the codejobjectcode and the codejclasscode of the resource using this code p  precodeJNIEnv env  JNIEnvSDLAndroidGetJNIEnv static const char const drwClassName  commyapplicationandroidRdrawable jclass Rclazz  envgtFindClassdrwClassName jfieldID Rfield  envgtGetStaticFieldIDRclazz , grass, I int fid  envgtGetStaticIntFieldRclazz, Rfield jobject activity  jobjectSDLAndroidGetActivity jclass AclazzenvgtGetObjectClassactivity jmethodID methodid  envgtGetMethodIDAclazz, getResources, LandroidcontentresResources jobject jresources  envgtCallObjectMethodactivity, methodid jclass resclazz  envgtGetObjectClassjresources codepre  pAnd the code to get the resource file in SDL is the followingp  precodeint fp SDLRWops rw  SDLRWFromFPFILEfp, SDLTRUE SDLSurface alphaSurfaceIMGLoadRWrw, 1 codepre  pHow can I get the file pointer from Java using JNI or any other method If its not possible to get the file pointer, is there a way to get the address of the file in memory and its size in order to use p  precodeSDLRWops SDLRWFromMemvoid mem, int size codepre  pP.S.  I use the Android coderesdrawablecode folder instead of codeassetscode because Im trying to support different screen resolutionsp
Positive 804 pI want to know how will I write My C code to map the Java Object Variables to a Struct  MY java class is calling a native method written in C ,below is my  code.p  pJavaCodep  precodepublic class JNIWrapper   static     System.loadLibraryJNIDemo   public native int packetminingstartpaxstoreminingqueryparams   packetminingparams  codepre  pMy class paxstoreminingqueryparams p  precodepublic class paxstoreminingqueryparams  String queryid                         A unique number, if applicable.                          A unique number, if applicable. String flowid                      String timestart String timeend  codepre  pHeader Files  1samapip  precode     DO NOT EDIT THIS FILE  it is machine generated      include ltjni.hgt     Header for class demoJNIWrapper      ifndef IncludeddemoJNIWrapper    define IncludeddemoJNIWrapper    include paxstoremining.hContains my C structures     ifdef cplusplus    extern C     endif    JNIEXPORT jint JNICALL JavademoJNIWrapperpacket1mining1start      JNIEnv , jobject, jobject      codepre  p3My Second Header File containing The struct p  precode     ifndef PAXSTOREQUERYH define PAXSTOREQUERYH  include ltsystypes.hgt include ltunistd.hgt include ltstdint.hgt include ltstdio.hgt include ltstdlib.hgt include lterrno.hgt struct paxstoreminingqueryparams      uint32t queryid                       A unique number, if applicable.     uint64t flowid                            uint64t timestart     uint64t timeend     codepre  p4Below is my C code p  precodeincludeltstdio.hgt include ltjni.hgt include demoJNIWrapper.h  JNIEXPORT jint JNICALL JavademoJNIWrapperpacket1mining1start   JNIEnv  env, jobject jobj, jobject packetminingparams  return 0     codepre  pI want to map this packetminingparams struct from my java object which has the same name and params as this. Will this be automatically mappedp
Positive 804 pIm trying to use the NDK with C,and there are some problemsp  pcomevenevenfacerecognizerutilJNIFaceUtil.hp  precode DO NOT EDIT THIS FILE  it is machine generated  include ltjni.hgt  Header for class comevenevenfacerecognizerutilJNIFaceUtil   ifndef IncludedcomevenevenfacerecognizerutilJNIFaceUtil define IncludedcomevenevenfacerecognizerutilJNIFaceUtil ifdef cplusplus extern C  endif  JNIEXPORT jint JNICALL       JavacomevenevenfacerecognizerutilJNIFaceUtilnativeFacerec JNIEnv , jclass, jlong, jstring, jlong, jint, jint  JNIEXPORT jdouble JNICALL    JavacomevenevenfacerecognizerutilJNIFaceUtilnativeFaceConfidence JNIEnv , jclass, jlong, jstring, jlong, jint, jint  ifdef cplusplus  endif endif codepre  pFaceUtil.cppp  precodeinclude comevenevenfacerecognizerutilJNIFaceUtil.h JNIEXPORT jint JNICALL   JavacomevenevenrecognizerutilJNIFaceUtilnativeFacerec     JNIEnv  jenv, jclass jclazz, jlong xfacerec, jstring jmodelpath,     jlong mataddr, jint width, jint height  ......  JNIEXPORT jdouble JNICALL   JavacomevenevenfacerecognizerutilJNIFaceUtilnativeFaceConfidence     JNIEnv  jenv, jclass jclazz, jlong xfacerec, jstring jmodelpath,     jlong mataddr, jint width, jint height  ......  codepre  pthe method nativeFacerec works,but the method nativeFaceConfidence doesnt work.p  precode0917 105304.922 Eart21633 No implementation found for double     com.even.evenfacerecognizer.util.JNIFaceUtil.nativeFaceConfidencelong,  java.lang.String, long, int, int tried  JavacomevenevenfacerecognizerutilJNIFaceUtilnativeFaceConfidence  and  JavacomevenevenfacerecognizerutilJNIFaceUtilnativeFaceConfidenceJLjavalangString2JII 0917 105304.923 EAndroidRuntime21633 FATAL EXCEPTION Thread2859 0917 105304.923 EAndroidRuntime21633 Process      com.example.employee, PID 21633 0917 105304.923 EAndroidRuntime21633    java.lang.UnsatisfiedLinkError No implementation found for double  com.even.evenfacerecognizer.util.JNIFaceUtil.nativeFaceConfidencelong,  java.lang.String, long, int, int tried  JavacomevenevenfacerecognizerutilJNIFaceUtilnativeFaceConfidence  and  JavacomevenevenfacerecognizerutilJNIFaceUtilnativeFaceConfidenceJLjavalangString2JII codepre
Positive 804 pI have a JNI function in C which is getting passed in a Java FILE class which represents a directory listing. I would like to call the list function and get the list of strings files in the directory. What is the best way to do thisp  pRight now I havep  precodestatic void myfunctionJNIEnv env, jobject obj, jobject dir     jarray listRet     jclass cls  envgtGetObjectClassenv, dir     jmethodID method  envgtGetMethodIDenv, cls, list, [LjavalangString     listRet  envgtCallObjectMethodenv, cls, method      jsize stringCount  envgtGetArrayLengthenv, listRet  codepre  pHowever, by adding logging statements, it seems that it never gets past the GetObjectClass call. So, is this call correct Further, is the GetMethodID call correct The return type of list is a java String[]. Is there anywhere else that Im going wrongp
Positive 804 pI am trying to refactor some android jni code. It was initially setup to use static variables in JNI and static calls on the android side. I would like to change that to improve compatibility with other code.p  pcurrent method signaturesp  precodestatic jclass mainactivity  static jmethodID oninit static jmethodID onupdate static jmethodID onrender static jmethodID onexit static jmethodID ongetinput codepre  pthese bindings were setup in the beginning of the code like thisp  precodemainactivity  jclassmEnvgtNewGlobalRefmEnv, cls  oninit  mEnvgtGetStaticMethodIDmEnv, mainactivity,                             onnativeinit,V onupdate  mEnvgtGetStaticMethodIDmEnv, mainactivity,                             onnativeupdate,V onrender  mEnvgtGetStaticMethodIDmEnv, mainactivity,                             onnativerender,V onexit  mEnvgtGetStaticMethodIDmEnv, mainactivity,                             onnativeexit, V codepre  pThen later in the code they would be used like thisp  precodevoid AndroidJNISwapEGLwindowvoid      JNIEnv aenv  getandroidjnienv     mEnvgtCallStaticVoidMethodaenv, mainactivity, onupdate  codepre  pSince this project is currently setup to store the main activity and the function addresses as a static reference with only the call to codegetandroidjnienvcode allowing me access to get the current android jni environment.p  pHow can I restructure this code to be able to get an instance instead of holding on to a static referencep
Positive 804 pSo Im trying to use libcurl with JNI but it returns CURLESSLCACERTBADFILE error. This is my code.p  pstrongJNI sidestrongp  precodestatic sizet WriteCallbackvoid contents, sizet size, sizet nmemb, void userp      stringuserpgtappendcharcontents, size  nmemb     return size  nmemb    jList is an array containing the certificate.   JavapackageNameMainActivityTestJNIEnv env, jobject thiz, jobject jList               vectorltstringgt certificatesPinning           Convert jobject to jobjectArray          retrieve the java.util.List interface class         jclass cList  envgtFindClassjavautilList          retrieve the toArray method and invoke it         jmethodID mToArray  envgtGetMethodIDcList, toArray, [LjavalangObject         jobjectArray stringArray  jobjectArrayenvgtCallObjectMethodjList, mToArray           Add each certificate to the list         int stringCount  envgtGetArrayLengthstringArray         for int i0 i lt stringCount i                      jstring certificateString  jstringenvgt GetObjectArrayElementstringArray, i             const char cert  envgtGetStringUTFCharscertificateString, 0             const jsize len  envgtGetStringUTFLengthcertificateString              string certificatePinningObjcert,len              certificatesPinning.pushbackcertificatePinningObj             envgtReleaseStringUTFChars certificateString, cert                   string readBuffer         CURL curl  curleasyinit         curleasysetoptcurl, CURLOPTCUSTOMREQUEST, POST         curleasysetoptcurl, CURLOPTURL, httpstheapi.com         curleasysetoptcurl, CURLOPTWRITEFUNCTION, WriteCallback Fill the response in the readBuffer         curleasysetoptcurl, CURLOPTWRITEDATA, ampreadBuffer         curleasysetoptcurl, CURLOPTCONNECTTIMEOUT, 120  120 s connect timeout         curleasysetoptcurl, CURLOPTENCODING, GZIP         curleasysetoptcurl,CURLOPTSSLCERTTYPE,der          curleasysetoptcurl, CURLOPTSSLVERIFYPEER , 1         curleasysetoptcurl, CURLOPTSSLVERIFYHOST , 2L         curleasysetoptcurl, CURLOPTSSLVERSION, CURLSSLVERSIONTLSv12         curleasysetoptcurl, CURLOPTCAINFO,certificatesPinning[0].cstrbuf           CURLcode res         res  curleasyperformcurl         ifreadBuffer.empty                     printfsuccess n                  else                      printferror n         int a  intres this is 77  CURLESSLCACERTBADFILE                codepre  pstrongJAVA sidestrongp  precode Define the function native void TestArrayListltStringgt certificates   Prepare the certificate ArrayListltStringgt certificatesPinning  new ArrayListltStringgt certificatesPinning.addsaveCertPemFile   Call the function TestcertificatesPinning     Helpers     private String saveCertPemFile              Context contextgetApplicationContext         String assetFileNamecertificateName.der          ifcontextnull  FileExistInAssetsassetFileName,context                      Log.iTestActivity, Context is null or asset file doesnt exist             return null                  destination path is datadatapackagename         String destPathgetApplicationContext.getApplicationInfo.dataDir         String CertFilePath destPath   assetFileName         File file  new FileCertFilePath         iffile.exists                      delete file             file.delete                  copy to internal storage         ifCopyAssetscontext,assetFileName,CertFilePath1 return CertFilePath          return CertFilePathnull            private int CopyAssetsContext context,String assetFileName, String toPath              AssetManager assetManager  context.getAssets         InputStream in  null         OutputStream out  null         try              in  assetManager.openassetFileName             new FiletoPath.createNewFile             out  new FileOutputStreamtoPath             byte[] buffer  new byte[1024]             int read             while read  in.readbuffer  1                              out.writebuffer, 0, read                          in.close             in  null             out.flush             out.close             out  null             return 1          catchException e              Log.etag, CopyAssetse.getMessage                   return 0            private boolean FileExistInAssetsString fileName,Context context              try              return Arrays.asListcontext.getResources.getAssets.list.containsfileName          catch IOException e               TODO Autogenerated catch block              Log.etag, FileExistInAssetse.getMessage                   return false      codepre  pcertificateName.der is the certificate stored in the assets folder.p  pAnd this is the certificate path being sent to the jnip  pdatadatapackageNamecertificateName.derp  pa hrefhttpcoderclubs.comquestions1728116howtomakesslpeerverifyworkonandroid relnofollowReferenceap
Positive 804 pI set codendk.dircode in my codelocal.propertiescode file. But, when codegradecode builds, this linep  precodetask buildNativetype Exec, description Compile JNI source via NDK          def ndkDir  android.ndkDirectory codepre  pthrows an error saying that codeandroid.ndkDirectorycode is not set. How can I prevent myself to hard code the absolute path of codendkDirectorycode p
Positive 804 pI am fairly new to emQtem, and I am trying to do some Android Development. I am working with Qt and using the emQAndroidJNIEnvironmentem. In the code, I am implementing my native method using codeQMetaObjectinvokeMethodcode to invoke a slot in the QMainWindow header. The problem is that the native method in the java file has a parameter that is a java integer arrayequivalent type I believe in QAndroindJniObject is  jintArray. I cant find the corresponding cQt type to place in the QARGtype, value  macro to resolve the argument. Please help me understand what I am doing wrong, as i thought the equivalent type to jintArray was int [], but I receive error when I use that. Thanks in advance for the help.p  precodeonReceiveNativeMounted JNIEnv  env, jobject obj,jint arrayindex,jintArray version   QMetaObjectinvokeMethodampMainWindowinstance, onReceiveMounted                           , QtQueuedConnection, QARGint, arrayindex,QARGint[], version   return arrayindex  codepre  pthe error i receive is belowp  precodeerror no matching function for call to  QArgumentltint []gtQArgumentconst char [6], jarrayamp  define QARGtype, data QArgumentlttype gttype, data                                                         codepre  pAs requested, the java function signature is belowp  precodepublic static native int onReceiveNativeMountedint arrayindex, int[] version codepre
Positive 804 pI am writing a java application. It is an mp3 player. I want to use the pulseaudio server because my bluetooth speaker is accessible with pulseaudio.p  pI have written a shared library using the simple pulseaudio interface.p  pNow i get the error p  phomerainerNetBeansProjectsaudioserversrcmainnativeaudioserver.so undefined symbol pasimplenewp  pwhich library i have to add to my java program to get access to the symbol pasimplenew p
Positive 804 pHi Im trying to get a File object from the Uri of a drawable resource. Im using this codep  precodejclass clazz jmethodID methodID jstring string1, string2, string3 jobject object1, object2  clazz  envgtFindClassandroidnetUri methodID  envgtGetStaticMethodIDclazz, parse, LjavalangStringLandroidnetUri string1  envgtNewStringUTFandroid.resourcecom.appsite.androiddrawablegrass object1  envgtCallStaticObjectMethodclazz, methodID, string1 methodID  envgtGetMethodIDclazz, toString, LjavalangString string1  jstringenvgtCallObjectMethodobject1, methodID  clazz  envgtFindClassjavanetURLEncoder methodID  envgtGetStaticMethodIDclazz, encode, LjavalangStringLjavalangStringLjavalangString string2  jstringenvgtNewStringUTFUTF8 string3  jstringenvgtCallStaticObjectMethodclazz, methodID, string1, string2   clazz  envgtFindClassjavanetURI methodID  envgtGetMethodIDclazz, ltinitgt, LjavalangStringV object1  envgtNewObjectclazz, methodID, string3  clazz  envgtFindClassjavaioFile methodID  envgtGetMethodIDclazz, ltinitgt, LjavanetURIV object2  envgtNewObjectclazz, methodID, object1 codepre  pThe application crashes at the last call to codeNewObjectcode. What are the possible reasons for thatp  pstrongEDITstrongp  pIt seems like a problem with passing a codejobjectcode as parameter to codeNewObjectcode like that. What is the proper way to pass a codejobjectcode to codeNewObjectcodep
Positive 804 pIn Oracles Java 8 on Linux 64bit, when a segmentation fault occurs, I get a useful log of information to standard outputp  precode A fatal error has been detected by the Java Runtime Environment    SIGSEGV 0xb at pc0x00007ff98a6d3467, pid21380, tid140709678728960   JRE version JavaTM SE Runtime Environment 8.040b25 build 1.8.040b25  Java VM Java HotSpotTM 64Bit Server VM 25.40b25 mixed mode linuxamd64 compressed oops  Problematic frame  C  [photocollection.so0x1e467]  photocollectionPhotoDataGrabberworkerRoutine0x87 codepre  pEspecially useful is the native code location eg codephotocollection.so0x1e467code.p  pHowever, when a C exception is thrown, I see only the printout from the C runtime, and the JVM gives no information.p  pIs there a way to produce the JVM crash log information for a C exception as wellp
Positive 804 pI am doing some work with the SDL library for android but im having a little obstacle.p  pThis function is defined in Javap  precode   This method is called by SDL using JNI.   return an array which may be empty but is never null.   public static int[] inputGetInputDeviceIdsint sources      int[] ids  InputDevice.getDeviceIds     int[] filtered  new int[ids.length]     int used  0     for int i  0 i lt ids.length i          InputDevice device  InputDevice.getDeviceids[i]         if device  null ampamp device.getSources amp sources  0              filtered[used]  device.getId                   return Arrays.copyOffiltered, used  codepre  pon the JNIC sidep  precode returns number of found touch devices as return value and ids in parameter ids  int AndroidJNIGetTouchDeviceIdsint ids      JNIEnv env  AndroidJNIGetEnv     jint sources  4098   InputDevice.SOURCETOUCHSCREEN      jmethodID mid  envgtGetStaticMethodIDenv, mActivityClass, inputGetInputDeviceIds, I[I     jintArray array  jintArray envgtCallStaticObjectMethodenv, mActivityClass, mid, sources     int number  0     ids  NULL     if array          number  int envgtGetArrayLengthenv, array         if 0 lt number              jint elements  envgtGetIntArrayElementsenv, array, NULL             if elements                  int i                 ids  SDLmallocnumber  sizeof ids                 for i  0 i lt number i   not assuming sizeof jint  sizeof int                      ids[i]  elements[i]                                  envgtReleaseIntArrayElementsenv, array, elements, JNIABORT                               envgtDeleteLocalRefenv, array          return number  codepre  pNow this works, but I would like to edit this to make the call non static. I changed the Java side code to thisp  precodepublic int[] inputGetInputDeviceIdsint sources      int[] ids  InputDevice.getDeviceIds     int[] filtered  new int[ids.length]     int used  0     for int i  0 i lt ids.length i          InputDevice device  InputDevice.getDeviceids[i]         if device  null ampamp device.getSources amp sources  0              filtered[used]  device.getId                   return Arrays.copyOffiltered, used  codepre  premoving the static from the function name.p  pOn the JNI side I do thisp  precode returns number of found touch devices as return value and ids in parameter ids  int AndroidJNIGetTouchDeviceIdsint ids      JNIEnv env  AndroidJNIGetEnv     jint sources  4098   InputDevice.SOURCETOUCHSCREEN      jmethodID mid  envgtGetStaticMethodIDenv, mActivityClass, inputGetInputDeviceIds, I[I          jclass clazz  envgtFindClassenv, orglibsdlappSDLActivity     if clazz  0          androidlogprintANDROIDLOGINFO, SDL, find class failed SDLandroid.c line 1409         return          jmethodID javamethod  envgtGetMethodIDenv, clazz, inputGetInputDeviceIds, I[I     if javamethod  0          androidlogprintANDROIDLOGINFO, SDL, find non static method failed SDLandroid.c line 1414         return          androidlogprintANDROIDLOGINFO, SDL, SUCCESS GETTING JNI METHOD FROM ENV SDLandroid.c line 1416 lt i reach this line successfully      jintArray array  envgtCallObjectMethodenv, clazz, javamethod, sources lt this line segfaults      androidlogprintANDROIDLOGINFO, SDL, made it to SDLandroid.c line 1418     ifarray              androidlogprintANDROIDLOGINFO, SDL, SUCCESS GETTING array line 1421          else              androidlogprintANDROIDLOGINFO, SDL, FAILED GETTING array line 1425               jintArray array  jintArray envgtCallStaticObjectMethodenv, mActivityClass, mid, sources     int number  0     ids  NULL     if array          number  int envgtGetArrayLengthenv, array         if 0 lt number              jint elements  envgtGetIntArrayElementsenv, array, NULL             if elements                  int i                 ids  SDLmallocnumber  sizeof ids                 for i  0 i lt number i   not assuming sizeof jint  sizeof int                      ids[i]  elements[i]                                  envgtReleaseIntArrayElementsenv, array, elements, JNIABORT                               envgtDeleteLocalRefenv, array          androidlogprintANDROIDLOGINFO, SDL, reached the end of inputGetInputDeviceIds func     return number  codepre  pwith this errorp  precode0919 224053.514 Alibc29636 Fatal signal 11 SIGSEGV at 0x00000001 code1, thread 29650 Thread22463 codepre  pI then recompile the c libs, clean the project and reinstall the app. The code segfaults at that line while the static version is fine. From looking around the code, theres no other static references in this function.p  pWhat could be causing that segfault Ive done a few tests and changing other static functions, grabbing the env getting the class, looking up the function and calling it actually works.p  pAny idea why this one will fail p
Positive 804 pI am having some trouble getting this sorted out.p  pI am doing some JNI stuff with SDL. The code is structured like thisp  precodeclass.c int AndroidJNIGetTouchDeviceIdsint ids      JNIEnv env  AndroidJNIGetEnv      jint sources  4098   InputDevice.SOURCETOUCHSCREEN      jmethodID mid  envgtGetStaticMethodIDenv, mActivityClass, inputGetInputDeviceIds, I[I     jintArray array  jintArray envgtCallStaticObjectMethodenv, mActivityClass, mid, sources     int number  0     ids  NULL     if array          number  int envgtGetArrayLengthenv, array         if 0 lt number              jint elements  envgtGetIntArrayElementsenv, array, NULL             if elements                  int i                 ids  SDLmallocnumber  sizeof ids                 for i  0 i lt number i   not assuming sizeof jint  sizeof int                      ids[i]  elements[i]                                  envgtReleaseIntArrayElementsenv, array, elements, JNIABORT                               envgtDeleteLocalRefenv, array          return number   class.h int AndroidJNIGetTouchDeviceIdsint ids codepre  pNow in another classp  precodeclass2.h int AndroidJNIGetTouchDeviceIdsint ids class2.c const int number  AndroidJNIGetTouchDeviceIdsampids codepre  pThe glue code between C and Java is in class.c and I know how to pass the instance to that class from the java side.p  pThe thing is I dont want to edit the class.c function signature but I was thinking that if I could somehow have this functionp  precodeint AndroidJNIGetTouchDeviceIdsint ids codepre  pget the instance variable so that instead of doing a static method lookup, I am not using a static global reference but make it use a non static instance instead.p  pHow can I restructure this code to have strongAndroidJNIGetTouchDeviceIdsstrong use an instance variable to do the function callingp
Positive 804 pI followed the line a hrefhttpqnalist.comquestions6142919androidstudio13rc3ndkdebugginghelpbreakpointsnotgettinghit relnofollowherea to add jniDebuggable  option to my build.gradle file and changed my run configuration to Android Native. I am using Android Studio, and I ensured the app runs on the phone before I attempt to debug. i also compiled my native code with ndkbuild ndkdebug1. Before you ask why are you posting if the app works the answer is I am running into problems with additional code that I like to have in the apk. The problem is when I add a break point in my native code, nothing happens on the phone. The debug console says Waiting for device. I added the break point right next to the JNIEXPORT ... statement. The only line that is in my native code is envNewStringUTFenv,Hello from JNI. What should I do for my break point to work p
Positive 804 pIm working with SDL and Ive almost sorted out all the issues that I am having.p  pI am making a jni call to init the framework, then creating a global reference from that because thats the best way that I can think of for the moment.p  pMost of my JNI functions use the instance variables except for one to read files. This is how I am setting up the globalref.p  precodeJNIEXPORT void JNICALL SDLAndroidInitJNIEnv mEnv, jobject instance      AndroidJNISetupThread     mInstance  instance      jclass clazz  mEnvgtGetObjectClassmEnv, instance     mActivityClass  jclassmEnvgtNewGlobalRefmEnv, clazz .....  codepre  pI only use this mActivityClass global reference twice in this code to read do some functions that can be called at anytime.p  pThe main question, specifically for android JNI. If I hold on to that globalref, since android controls its applications lifecycle that ref will cause my app to resume even though i am attempting to quit.p  pIf I try to clear that globalref with something like codeDeleteLocalRefcode, the app still seems to want to resume instead of quitting. Is there a way to stop this behaviorp  pAnother question, is it possible to create a non static JNI function that gets called from the c side of the code world, so that I can get an instance jobject and use that to get a hold of the class instancep  pFor example typically you write a function in javap  precodepublic native void docwork codepre  pon the c sidep  precodevoid JavacomtestjavadocworkJNIEnv env, jobject inst    ...use the instance do your work   codepre  pWhat if some functions get called on the c side, that I would like to get an instance from java to do something with.p  pc functionp  precodepublic int getnumber codepre  pI am a little stuck here, I dont want to instantiate a new java object at this point, mainly because a hrefhttpstackoverflow.comquestions22326302callandroidactivityfromjnidirectlyfromcprocesswithoutjavasidei saw thisa and it seems like overkill. p  pThere must be a way to overcome this obstacle, either by being able to call into java from c without using static or creating a new activity, theres one already there or freeing the globalref but that doesnt seem to be working out so well for me at this moment.p
Positive 804 pHow can I both stronginclude in the compilationstrong and strongview in the project file treestrong some code.hcode and code.cppcode files stronglocated outside of the project directorystrong p  pWith Visual Studio and a C project you would simply use Add existing item, select your files and voil, it just works in ten seconds. Arent Androidbased development supposed to make developpers lives easier  p  pIve been searching for hours how to do this now. None of the answers I found is addressing this.p  pI cant beleive that, among all the people who have been using Android Studio with the NDK, none of them have used C code outside of the codejnicode folder...p  pDo you know how to do  Thank you.p
Positive 804 pI use JNI to call c function in order to create interface. I am getting below error message on android studiop  pIncompatible typesbr Required java.io.FileDescriptorbr Found java.lang.Objectp  ppacket.javap  precodeFileDescriptor myDev null myDev  JNI.preparefddevnettun, myDev gtthis line hava above error in2  new FileInputStreammyDev codepre  pJNI.javap  precode    public class JNI             static                       System.loadLibraryJNITest                        public static native Object preparefdString filename, FileDescriptor fdobj     codepre  ppacketJNI.hp  precodeJNIEXPORT jobject JNICALL JavacomexamplepacketcaptureJNIpreparefd JNIEnv , jclass, jstring  codepre  pJNITest.cp  precode    JNIEXPORT jobject JNICALL     JavacomexamplepacketcaptureJNIprepare1fdJNIEnv env, jclass ignore, jstring filename           jfieldID fieldfd     jmethodID constfdesc     jclass classfdesc, classioex     jobject ret     int fd     char fname      classioex  envgtFindClassenv, javaioIOException     if classioex  NULL return NULL     classfdesc  envgtFindClassenv, javaioFileDescriptor     if classfdesc  NULL return NULL      fname  envgtGetStringUTFCharsenv, filename, NULL      fd  openfname, ORDWR  ONONBLOCK      envgtReleaseStringUTFCharsenv, filename, fname      if fd lt 0           open returned an error. Throw an IOException with the error string         char buf[1024]         sprintfbuf, open s, strerrorerrno         envgtThrowNewenv, classioex, buf         return NULL            construct a new FileDescriptor     constfdesc  envgtGetMethodIDenv, classfdesc, ltinitgt, V     if constfdesc  NULL return NULL     ret  envgtNewObjectenv, classfdesc, constfdesc       poke the fd field with the file descriptor     fieldfd  envgtGetFieldIDenv, classfdesc, fd, I     if fieldfd  NULL return NULL     envgtSetIntFieldenv, ret, fieldfd, fd       and return it     return ret      codepre  pCan anyone give me some idea How to fix this error. Thank you.p
Positive 804 pI am using a third party C native library which is calling callbacks to my JNI.p  pSo in my JNIs C portion, I have a callback function codecallbackcode which i registered to the library while initialization. This is getting called by the library as a callback, no issues with that.p  pBut once it enters the function codecallbackcode and when i try to call the java function in my upper layer, I get a crash.p  pHeres the function codecallbackcode snippets p  precodethreadStatus  javaVMgtGetEnvjavaVM, void ampenvCallBack, JNIVERSION16     androidlogprintANDROIDLOGVERBOSE,threadStatus , d,threadStatus threadStatus is 2 as I can see in logs       ifthreadStatus  JNIEDETACHED             res  javaVMgtAttachCurrentThreadjavaVM,voidampenvCallBack,NULL     androidlogprintANDROIDLOGVERBOSE,Getting JNI EnvRace JNI, d,122333       ifres  JNIOK              return            else if res  JNIEVERSION      androidlogprintANDROIDLOGVERBOSE,JNI Version Not SupportedRace JNI, d,122333          codepre  pthen at the end of this function I am calling,p  precodeandroidlogprintANDROIDLOGVERBOSE,CallMethodRace JNI, d,callMethod      androidlogprintANDROIDLOGVERBOSE,Parameter 1Race JNI, d,eventDataValue      androidlogprintANDROIDLOGVERBOSE,Parameter 2Race JNI, d,objcallbackData     envCallBackgtCallVoidMethodenvCallBack, callbackObject, callMethod codepre  pwhere I am getting the crash. Can anyone suggest whats the mistake I am doing Am i attaching the thread correctlyp  pHere are the logs p  precodeVthreadStatus  2021 2 VGetting JNI EnvRace JNI 2021 122333 VMethod CalledRace JNI 2021 200000 VBefore Method Called RaceCallBackRace JNI 2021 200000 VCallMethodRace JNI 2021 1115468904 VParameter 1Race JNI 2021 0 VParameter 2Race JNI 2021 1080861840 Wdalvikvm 2021 JNI WARNING JNI method called with exception raised Wdalvikvm 2021              in LdalviksystemNativeStart.run V CallVoidMethod Wdalvikvm 2021 Pending exception is Idalvikvm 2021 LjavalangCloneNotSupportedException Class doesnt implement Cloneable Idalvikvm 2021  at java.lang.Object.cloneObject.java155 Idalvikvm 2021  at dalvik.system.NativeStart.runNative Method Idalvikvm 2021 Thread10 prio5 tid9 NATIVE Idalvikvm 2021    groupmain sCount0 dsCount0 obj0x406ca3b0 self0x1f6040 Idalvikvm 2021    sysTid2057 nice0 sched00 cgrp[nocpusubsys] handle2214832 Idalvikvm 2021    schedstat 1783000 11852000 9  Idalvikvm 2021   at dalvik.system.NativeStart.runNative Method codepre
Positive 804 pMy problem is that I fail to find some proper documentsguides to follow in order to set up my environment correctly.p  pBasically I am using Android Studio 1.3.2 latest stable as of 22nd september 2015 with Gradle Experimental version 2.5.p  pI followed Google official documentation here  a hrefhttptools.android.comtechdocsnewbuildsystemgradleexperimental relnofollowhttptools.android.comtechdocsnewbuildsystemgradleexperimentala but I find no help when it comes to JNI Libs. I tried many other solutions but they do not work because they seem to be obsolete.p  pI have a strong.sostrong file of a simple strongC librarystrong I created to test the NDK support amp integration that should be better with this Android Studio 1.3 as announced during Google IO 2015.p  pThis is how looks my very simple codeC Libcodep  pContent of TestCPPClass.hp  precodeifndef TESTCPPCLASSH define TESTCPPCLASSH  class TestCPPClass  public     double getDouble   endif TESTCPPCLASSH codepre  pAnd TestClass.cppp  precodeinclude TestCPPClass.h    double TestCPPClassgetDouble      return 1  cannot be dumber    codepre  pUsing strongCygwin terminalstrong and stronggccstrong I compiled this very advanced library using the following line p  blockquote   pgcc.exe shared o TestLib.so TestCPPClass.cppp blockquote  pWhich did correctly produce a codeTestLib.socode.p  pIn my current Android project, I have a strongnativestrong method that is implemented in JNI as followed p  pcodepublic static double getDoubleFromJNIcodep  pUsing strongjavah.exestrong I generated the strong.hstrong file and then implemented the JNI method as follow p  precodeinclude jni.h include mypackageheader.h include TestCPPClass.h  gt MARKED AS RED because not found   JNIEXPORT jdouble JNICALL JavamypackageheadergetDoubleFromJNI         JNIEnv env, jobject caller        Here I wish to call my TestLib.so that should contain my TestCPPClass and call TestCPPClassgetDouble       in order to return the result.  codepre  pSo what about my strongbuild.gradlestrong  This is what I have for NDK inside codemodelcodep  precodeandroid.ndk          moduleName  MyAwesomeJNI         ldLibs  TestLib gt gradle SYNC works, but BUILD fails       codepre  pThis is the error I get p  blockquote   pErrorExecution failed for task   applinkArm64v8aDebugMyAwesomeJNISharedLibrary.p      blockquote     pA build operation failed.           Linker failed while linking libMyAwesomeJNI.so.   See the complete log at     fileCUsersMeDocumentsMyProjectappbuildtmplinkArm64v8aDebugMyAwesomeJNISharedLibraryoutput.txtp   blockquote blockquote  pI manually created the strongjniLibsstrong folder alongside strongjnistrong using codeNew gt directorycode. I also added a strongarmeabistrong folder and put strongTestLib.sostrong inside. I tried without codearmeabicode but with no luck.p  pWhat am I missing here  I am totally lost Thanks for the helpp
Positive 804 pIm trying to run an android app with two relativesp  ol lipCSipSimple Library project.pli lipcode.socode libraries loaded using JNI.pli ol  pWhen running the app using only the code.socode libraries, it works perfectly, but when running it after adding the CSipSimple project, it cant find the code.socode library and give me the following exceptionp  p0922 171802.650 WSystem.err13662 java.lang.UnsatisfiedLinkError Couldnt load dvr from loader dalvik.system.PathClassLoader[DexPathList[[zip file dataappcom.automation.isolace2.apk],nativeLibraryDirectories[dataapplibcom.automation.isolace2, vendorlib, systemlib]]] findLibrary returned null 0922 171802.650 WSystem.err13662    at java.lang.Runtime.loadLibraryRuntime.java358 0922 171802.650 WSystem.err13662    at java.lang.System.loadLibrarySystem.java526 0922 171802.650 WSystem.err13662    at com.company.NetSDK.INetSDK.LoadLibrarysINetSDK.java26 0922 171802.650 WSystem.err13662    at com.company.NetSDK.INetSDK.INetSDK.java6 0922 171802.650 WSystem.err13662    at com.automation.isolace.VideoViewActivity3.runVideoViewActivity.java137p  pThe method strongLoadLibrariesstrongp  precode       public static void LoadLibrarys                  try            17        String strOSType  System.getPropertyos.name  18        if strOSType.containsWindow              20          System.loadLibrarydhconfigsdk  21          System.loadLibrarydhnetsdk  22          System.loadLibrarynetsdk                        else              26          System.loadLibrarydvr  27          System.loadLibraryconfigsdk  28          System.loadLibrarynetsdk  29          System.loadLibrarysdk                       catch UnsatisfiedLinkError ulink   32        ulink.printStackTrace                   codepre  pand the Hierarchy of my appp  pa hrefhttpi.stack.imgur.comDXPg1.png relnofollowimg srchttpi.stack.imgur.comDXPg1.png altenter image description hereap
Positive 804 pId like to start by saying please dont ask me to use the javah tool, Ive had more luck writing the few jni function prototypes than getting that tool to work properly.p  pI know that I am loading my jni libraries properly because they work when I leave the class structure the same.p  pI have some package name package com.bb.mep  precodepublic class test     test2 iTest  null    public parent test        iTest  new test     return iTest       putting my native methods here work just fine   public native void init   etc   codepre  pThe c jni function prototype for that above function looks like thisp  precodeJNIEXPORT void JNICALL JavacombbmetestinitJNIEnv e, jobject i  codepre  pif I break that above function signature by renaming it codeinitacode and call the function I get an error like thisp  pstrongNo implementation found for native Lcombbmetest.initVstrongp  pif on the other hand I move the native function to the inner class like thisp  precodeclass test2 extends parent  public native void init  codepre  pand then try to call the same function, jni will complain at me a different way about unimplemented function but this time it looks like thisp  pstrongNo implementation found for native Lcombbmetesttest2.initVstrongp  pI originally thought if I edited the jni function signature to something like thisp  precodeJNIEXPORT void JNICALL Javacombbmetesttest2initJNIEnv e, jobject i  codepre  pthat the function would work but it doesnt seem like thats the case.p  pWhat does the strongstrong dollar sign mean in this jni function signaturep  pstrongNo implementation found for native Lcombbmetesttest2.initVstrongp  pHow can I move the location of this native function and update the jni function signatures without using the javah toolp
Positive 804 pI have my below java codep  precodepublic class JNIWrapper   static         System.loadLibraryJNIDemo   public native String geterrorstringint errorcode public native int  startParams params public native int cancelString cookies public native int getfilenameString cookies,String fileName  public native int getstatusString cookies,int percentagecomplete codepre  p Below is my generated .H file p  precode  DO NOT EDIT THIS FILE  it is machine generated  include ltjni.hgt  Header for class demoJNIWrapper   ifndef IncludeddemoJNIWrapper define IncludeddemoJNIWrapper ifdef cplusplus extern C  endif  JNIEXPORT jstring JNICALL JavademoJNIWrapperget1error1string   JNIEnv , jobject, jint   JNIEXPORT jint JNICALL JavademoJNIWrapper1start   JNIEnv , jobject, jobject   JNIEXPORT jint JNICALL JavademoJNIWrappercancel   JNIEnv , jobject, jstring   JNIEXPORT jint JNICALL JavademoJNIWrappergetfile1name   JNIEnv , jobject, jstring, jstring   JNIEXPORT jint JNICALL JavademoJNIWrapperget1status   JNIEnv , jobject, jstring, jint  ifdef cplusplus  endif endif codepre  pIncase of lets say getstatus ,i want to have the percentagecomplete as the out parameter and it returns say 0,with this I will have in return both percentagecompleteAs its in out parameter  a return value .p  pAny help would be highly appreciated and would be really helpfulp  pNOTEI cannot use struct for this ieI cany encapsulate both percentagecomplete and return output in a struct and return that structp
Positive 804 pI am working on android for the past few months. I would like to know whether we can access the memory location of a file in android, just like we do in C using pointers. I am talking about the os memory location of a file.I heard about JNI but dont know whether it can used and how. PLease help me out. p  pThank you in advancep
Positive 804 pIve problem with native code in Android.p  pI used this code to fill array with content from vectorp  precodefloat  MapLoaderConvertToArray      float arr  new float[faces.size 13]     int index  0, j  0     whileindex lt faces.size              arr[ j ]  faces[ index ].vertex[ 0 ].x         arr[ j 1 ]  faces[ index ].vertex[ 1 ].y         arr[ j 2 ]  faces[ index ].vertex[ 2 ].z         j  3         index          return arr  codepre  pand I used this code to create pointer and get values from the functionp  precodefloat x  Map.ConvertToArray codepre  pIts working in windows , but in android Ive problem..p  pBest regardsp
Positive 804 pIm trying to work build my very first JNI application, following this tutorial a hrefhttpswww3.ntu.edu.sghomeehchuaprogrammingjavaJavaNativeInterface.html relnofollowhttpswww3.ntu.edu.sghomeehchuaprogrammingjavaJavaNativeInterface.htmlap  pProblem Summary While running my application, I get an java.lang.UnsatisfiedLinkError error.p  pFirst I wrote the Class strongHelloJNI.javastrongp  precodepublic class HelloJNI     static        System.loadLibraryhello  Load native library at runtime                                     hello.dll Windows or libhello.so Unixes          Declare a native method sayHello that receives nothing and returns void    private native void sayHello      Test Driver    public static void mainString[] args        new HelloJNI.sayHello   invoke the native method      codepre  pThis class I compiled with strongjavac HelloJNI.javastrong Next I ran strongjavah HelloJNIstrong This produced the following file strongHelloJNI.hstrongp  precode DO NOT EDIT THIS FILE  it is machine generated  include ltjni.hgt  Header for class HelloJNI   ifndef IncludedHelloJNI define IncludedHelloJNI ifdef cplusplus extern C  endif    Class     HelloJNI   Method    sayHello   Signature V   JNIEXPORT void JNICALL JavaHelloJNIsayHello   JNIEnv , jobject  ifdef cplusplus  endif endif codepre  pNext I implemented strongHelloJNI.cstrongp  precodeinclude ltjni.hgt include ltstdio.hgt include HelloJNI.h   Implementation of native method sayHello of HelloJNI class JNIEXPORT void JNICALL JavaHelloJNIsayHelloJNIEnv env, jobject thisObj     printfHello Worldn    return  codepre  pFinally I compiled the c classp  ul ligcc Iusrlibjvmjava8oracleinclude Iusrlibjvmjava8oracleincludelinux c Wall Werror fpic HelloJNI.cli ligcc shared o hello.so HelloJNI.oli ul  pThis produces the files hello.so and HelloJNI.o. Next I try to run the codep  ul lipjava Djava.library.path. HelloJNI This produces the errorp  pException in thread main java.lang.UnsatisfiedLinkError no hello in java.library.path     at java.lang.ClassLoader.loadLibraryClassLoader.java1864     at java.lang.Runtime.loadLibrary0Runtime.java870     at java.lang.System.loadLibrarySystem.java1122     at HelloJNI.HelloJNI.java3pli ul  pThis seems to be the most common JNI error on the internet... My method names seem to be correct. I also ranp  ul linm hello.so  grep sayli ul  pThis gives me strong00000000000006b0 T JavaHelloJNIsayHellostrong which seems to be correct, i.e. the compiler didnt add additional characters. I simply ran out of ideas of things I could try. Any suggestionsp  pMy OS Linux Mint 13, GCC version 4.7.3, java version 1.8.060p  pUPDATE When I replace codeSystem.loadLibraryhellocode by codeSystem.loadusr0homejkinableworkspacejavaIDEAjnitesthello.socode my HelloWorld example works However, I dont want to use an absolute path so Im still looking for a way to use codeSystem.loadLibraryhellocode instead Any suggestions Ive also tried running on a different linux system, but I get the same issue.p
Positive 804 pI have a jni code ,it runs well Under Android 5.0 ,but crash in Android 5.0. java code p  precodeOverride public void onCreateBundle savedInstanceState      super.onCreatesavedInstanceState     setContentViewR.layout.main     editTxt  EditTextfindViewByIdR.id.threadNum     msgTxt  TextViewfindViewByIdR.id.msgTxt     mybtn  ButtonfindViewByIdR.id.button     mybtn.setOnClickListenernew View.OnClickListener              Override         public void onClickView v                      msgTxt.setVisibilityView.VISIBLE             msgTxt.setTextrun             threadCount0             String threadnum editTxt.getText.toString             ifthreadnum  null  .equalsthreadnum                 Toast.makeTextJniThreadTestActivity.this, run 1, Toast.LENGTHLONG                 return                          try                 threadNo Integer.parseIntthreadnum             catchException ex                 Toast.makeTextJniThreadTestActivity.this, run , Toast.LENGTHLONG                 System.out.printlnex.toString                 return                          mybtn.setEnabledfalse             start  System.currentTimeMillis             mainThreadthreadNo             whiletrue                 ifthreadCount threadNo                     myHanlder.sendEmptyMessage0                     break                                                       setJNIEnv  private synchronized void fromJNIint i   Log.iyusp,   Javagti  System.out.printlnyusp Javagti  threadCount   public void showMsg  private native void mainThreadint num private native void setJNIEnv codepre  pC code is p  precodedefine NUMTHREADS 5 JavaVM gjvm  NULL jobject gobj  NULL void threadfunvoid arg        JNIEnv env      jclass cls      jmethodID mid       ifgjvmgtAttachCurrentThreadgjvm, ampenv, NULL  JNIOK               LOGEs AttachCurrentThread failed, FUNCTION         return NULL            cls  envgtGetObjectClassenv,gobj      ifcls  NULL              LOGEFindClass Error.....        goto error            mid  envgtGetMethodIDenv, cls, fromJNI, IV      if mid  NULL               LOGEGetMethodID Error.....         goto error              Here I call the java method crash in android 5.0      envgtCallVoidMethodenv, cls, mid ,intarg      error         ifgjvmgtDetachCurrentThreadgjvm  JNIOK                LOGEs DetachCurrentThread failed, FUNCTION            pthreadexit0  JNIEXPORT void JavacomtestJniThreadTestActivitymainThread JNIEnv env, jobject obj, jint threadNum   LOGEyuspmain thread in.....  int i  pthreadt pt  pt  pthreadt mallocthreadNum  sizeofpthreadt  for i  0 i lt threadNum i     pthreadcreateamppt[i], NULL, ampthreadfun, void i    for i  0 i lt threadNum i     pthreadjoin pt[i], NULL   LOGEyuspmain thread exit.....  JNIEXPORT void JavacomtestJniThreadTestActivitysetJNIEnv JNIEnv env, jobject obj   envgtGetJavaVMenv,ampgjvm  gobj  envgtNewGlobalRefenv,obj  JNIEXPORT jint JNICALL JNIOnLoadJavaVM vm, void reserved   JNIEnv env  NULL  jint result  1     if vmgtGetEnvvm, voidampenv, JNIVERSION14  JNIOK        LOGEGetEnv failed          return result    return JNIVERSION14  codepre  pI use NewGlobalRef to save global object and use it to find the class then find  the Method ID ,and use CallVoidMethod to call the java Method. then the crash erro message isp  precodeEyusp    16411 yuspmain thread in..... Fart     16411 artruntimecheckjni.cc65] JNI DETECTED ERROR IN APPLICATION cant call void com.test.JniThreadTestActivity.fromJNIint on instance of java.lang.Classltcom.test.JniThr Fart     16411 artruntimecheckjni.cc65]     in call to CallVoidMethod Fart     16411 artruntimecheckjni.cc65] Thread356 prio5 tid22 Runnable Fart     16411 artruntimecheckjni.cc65]    groupmain sCount0 dsCount0 obj0x12d1e080 self0xd6f06400 Fart     16411 artruntimecheckjni.cc65]    sysTid16440 nice0 cgrpapps sched00 handle0xe3bc7000 Fart     16411 artruntimecheckjni.cc65]    stateR schedstat 0 0 1  utm0 stm0 core2 HZ100 Fart     16411 artruntimecheckjni.cc65]    stack0xd70040000xd7006000 stackSize1012KB Fart     16411 artruntimecheckjni.cc65]    held mutexes mutator lockshared held Fart     16411 artruntimecheckjni.cc65]   native 00 pc 00004640  systemliblibbacktracelibc.so UnwindCurrentUnwindunsigned int, ucontext23 Fart     16411 artruntimecheckjni.cc65]   native 01 pc 00002e8d  systemliblibbacktracelibc.so BacktraceUnwindunsigned int, ucontext8 Fart     16411 artruntimecheckjni.cc65]   native 02 pc 0023ed8d  systemliblibart.so artDumpNativeStackstd1basicostreamltchar, std1chartraitsltchargt gtamp, int, cha Fart     16411 artruntimecheckjni.cc65]   native 03 pc 002242df  systemliblibart.so artThreadDumpstd1basicostreamltchar, std1chartraitsltchargt gtamp const146 Fart     16411 artruntimecheckjni.cc65]   native 04 pc 000af993  systemliblibart.so artJniAbortchar const, char const582 Fart     16411 artruntimecheckjni.cc65]   native 05 pc 000b00cd  systemliblibart.so artJniAbortFchar const, char const, ...60 Fart     16411 artruntimecheckjni.cc65]   native 06 pc 000b031d  systemliblibart.so artScopedCheckCheckVirtualMethodjobject, jmethodID268 Fart     16411 artruntimecheckjni.cc65]   native 07 pc 000ba639  systemliblibart.so artCheckJNICallVoidMethodJNIEnv, jobject, jmethodID, ...76 Fart     16411 artruntimecheckjni.cc65]   native 08 pc 00000e29  dataappcom.test1libarmlibJNIThreads.so threadfun132 Fart     16411 artruntimecheckjni.cc65]   native 09 pc 00013a53  systemliblibc.so pthreadstartvoid30 Fart     16411 artruntimecheckjni.cc65]   native 10 pc 00011a47  systemliblibc.so startthread6 Fart     16411 artruntimecheckjni.cc65]   no managed stack frames Fart     16411 artruntimecheckjni.cc65] Fart     16411 artruntimeruntime.cc284] Runtime aborting... codepre  pPlease help me to fix it , TKS p
Positive 804 pI can use codeSystem.loadLibrarylibcode In android java to load my shared library and use it. The problem with this current approach is that I can actually have two instances of my android application running.p  pHaving two instances of my application with one shared library doesnt. I need two instances of my shared library. The good new is that from java I can find out if I am running either instance A or instance B. Sometimes Ill be running in instance A but still have to load instance B doing this totally messes up the first instance.p  pWhat ive done so far is find out which instance I am running in and pass that to JNI then inside my .c file I load the .so with dlopen, now I have a handle to my shared library.p  pThe java sidep  precode        ifpreview                      for String lib  getLibraries                     nativeInitPreviewlib                                   else                      for String lib  getLibraries                  nativeInitLivelib                           codepre  pthe c code sidep  precodestatic void mainHandleLive  NULL static void SDLHandleLive  NULL  JNIEXPORT int JNICALL JavaorglibsdlappSDLActivitynativeInitLiveJNIEnv env, jobject instance, jstring lib      const char libString  envgtGetStringUTFCharsenv, lib, NULL     androidlogprintANDROIDLOGINFO, SDL, JavaorglibsdlappSDLActivitynativeInitLive s, libString     envgtReleaseStringUTFCharsenv, lib, libString      mainHandleLive  dlopendataappliborg.libsdl.app1libmain.so, RTLDNOW  RTLDLOCAL     if mainHandleLive  0              androidlogprintANDROIDLOGINFO, SDL, dataappliborg.libsdl.app1libmain.so failed to open          SDLHandleLive  dlopendataappliborg.libsdl.app1libSDL2.so, RTLDNOW  RTLDLOCAL     if SDLHandleLive  0              androidlogprintANDROIDLOGINFO, SDL, dataappliborg.libsdl.app1libSDL2.so failed to open        codepre  pI have two questions, the initial post that lead me to this idea used a function prototype like thisp  precodedlmopenLMIDNEWLM, pathtolib, RTLDNOW  RTLDLOCAL codepre  pon android compiling with codeLMIDNEWLMcode throws an codeLMIDNEWLMcode undeclared first use in this function.p  pSo I tried to use RTLDLOCAL based on a hrefhttpstackoverflow.comquestions1716472usinglibtooltoloadaduplicatefunctionnamefromasharedlibrarythis questionap  pI dont currently get any errors when compiling this project.p  pMy question now is, how do I actually use these libs once they have been loaded from c codep
Positive 804 pIm trying to get the audio volume on Android using JNI from C. My constraint is that I dont have any access to the Java part. p  pI found a way to make my JNI query from this site a hrefhttpsgithub.comouyaouyasdkexamplesblobmasterAndroidAndroidVirtualControllerNativeActivityjniAudioManager.cpp relnofollowAudioManager.cppap  pbut I supposed I did something wrong with my last call in this codep  precodejclass AudioManager  envgtFindClassandroidmediaAudioManager  jmethodID getStreamVolume  envgtGetMethodIDAudioManager, getStreamVolume, I  jint stream  3 STREAMMUSIC int volume  envgtCallIntMethodAudioManager, getStreamVolume, stream Crash here codepre  pIn this code, Im trying to get the audio volume from STREAMMUSIC identified by id3 in the Android documentation a hrefhttpdeveloper.android.comreferenceandroidmediaAudioManager.htmlgetStreamVolumeint relnofollowhttpdeveloper.android.comreferenceandroidmediaAudioManager.htmlgetStreamVolumeintap  pThank you for your help.p  h2EDIT This is my working codeh2  precodejclass context  envgtFindClassandroidcontentContext  jfieldID audioServiceField  envgtGetStaticFieldIDcontext, AUDIOSERVICE, LjavalangString  jstring jstr  jstringenvgtGetStaticObjectFieldcontext, audioServiceField  jmethodID getSystemServiceID  envgtGetMethodIDcontext, getSystemService, LjavalangStringLjavalangObject  jobject tm  envgtCallObjectMethodcurrentAndroidActivity, getSystemServiceID, jstr  jclass AudioManager  envgtFindClassandroidmediaAudioManager  jmethodID getStreamVolume  envgtGetMethodIDAudioManager, getStreamVolume, II  jint stream  3 MUSICSTREAM  3 int volume  envgtCallIntMethodtm, getStreamVolume, stream DEBUGLOGDEBUGTAG, volume    tostringvolume codepre
Positive 804 pI try creating a peer for a Panel using WToolkit windows only createPanel, but it ends up with a NPT in the native function. Long story short I wish to create an AWT component and add it to a Win32 Application in JNI roughly what a browser plugin achieves with an applet panel So maybe someone knows how to do it, or could point to a source code for a browser plugin  I failed so far finding one...p
Positive 804 pI using the following code p  precodeGet constructor cid  envgtGetMethodIDc, ltinitgt, V  Create object in JNI object  envgtNewObjectvalueclass, cid codepre  pThe problem is that my codeJNIcode function returns an integer result about the process, hence I cannot return this object directly.p  pPlease provide me a method to pass this object to my codeJAVAcode code.p
Positive 804 pIs there any way to limit Android NDK Library to the Specific JAVA Application  I would like to prevent programmers from using my lib in another applications.p  pstrongEDITstrongp  pIm building a shared library that will be used in another application by useranother programmer.p  pstrongEDIT 2strong this library also include a java library that interact with the native library via JNI.p
Positive 804 pI know there are similar questions about simple variables in C, but I guess this one is a bit different...p  pI have an int value named occurrences where I want to assign to it a value from a function like thatp  precodeoccurrences  GPOINTERTOINTghashtablelookupSipincome2, headersDigest[i] codepre  pMy problem is that when i try to assign to this variable a value by using the hashtablelookup function ,as I already showed above, then this value in java is equal to 0.p  pHowever, if I assign a value in a variable occurrence e.g p  precodeoccurrences  5 codepre  pand then i pass this variable as a parameter to a java function with JNI this value is indeed equal to 5 in java, so there is no problem with that. p  pWhat should the problem that causes all that and is there any possible solutionp
Positive 804 pI would like to use eclipse to debug the C code of a JNI aplication I am writing. I have followed some tutorial and done the followingp  ul liLaunch the Java program in debug modeli liReach a breakpoint in Java code before calling loadLibraryli liRun the CC attach to application debug configuration in Eclipse by passing javaw.exe as a program to attach toli ul  pAt this point I get an error window gdborig.exe has stopped working and the following output in the consolep  precodeGNU gdb GDB 7.9.1 Copyright C 2015 Free Software Foundation, Inc. License GPLv3 GNU GPL version 3 or later         lthttpgnu.orglicensesgpl.htmlgt This is free software you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law.  Type show copying and show warranty for details. This GDB was configured as x8664w64mingw32. Type show configuration for configuration details. For bug reporting instructions, please see lthttpwww.gnu.orgsoftwaregdbbugsgt. Find the GDB manual and other documentation resources online at lthttpwww.gnu.orgsoftwaregdbdocumentationgt. For help, type help. Type apropos word to search for commands related to word. codepre  pI am a bit stuck as I cannot see an error message.p
Positive 804 pSo here I am trying to write into a file from a C program that is called from Java using JNI.p  pThe C contains the minimum, taken from a hrefhttpwww.cplusplus.comdoctutorialfiles relnofollowherea.p  precodeinclude JNIHeader.h include ltiostreamgt include ltfstreamgt using namespace std  JNIEXPORT jlong JNICALL JavamyclasswriteSomeStuff     JNIEnv env, jclass clazz      ofstream myfile     myfile.openexample.txt     myfile ltlt Writing this to a file.n     myfile.close     return 1  codepre  pWhen I run the code, I get the following errorp  precode  EXCEPTIONACCESSVIOLATION 0xc0000005 at pc0x0000000180126ff7,     pid3648, tid13192   JRE version JavaTM SE Runtime Environment 8.060b27 build 1.8.060b27  Java VM Java HotSpotTM 64Bit Server VM 25.60b23 mixed mode windowsamd64 compressed oops  Problematic frame  C  [cygwin1.dll0xe6ff7] codepre  pWhen other non IO methods are called, JNI calls works perfectly.p  pCompilation is done using G 4.9.3 with CYGWIN64 on a Windows 7 64 bits machine. Antivirus is turned off.p  pRight now, I am totally stucked quite new to JNI and any help is welcome p
Positive 804 pI am facing memory leak issue with the below module in my C application when calling java methods using JNI.p  precodewhile true       jarray strArrayDR  jarrayjEnvgtCallObjectMethodJobjHQ,mIDParse,jStrMsgDRQ         jsize length  jEnvgtGetArrayLengthstrArrayDR         jEnvgtReleaseStringUTFCharsjStrMsgDRQ,NULL         jEnvDRQgtDeleteLocalRefjStrMsgDRQ          jsize index         forindex0 index lt length index                       jstring element  jstringjEnvgtGetObjectArrayElementjobjectArraystrArrayDR,index              char  const sznativeString  jEnvgtGetStringUTFCharselement,NULL             string szMsgsznativeString             jEnvgtReleaseStringUTFCharselement,sznativeString             jEnvgtDeleteLocalRefelement             vecDR.pushbackszMsg                  jEnvgtReleaseStringUTFCharsjStrMsgDRQ,NULL         jEnvgtDeleteLocalRefjStrMsgDRQ         jEnvgtDeleteLocalRefstrArrayDR   codepre  pCorresponding java method is shown belowp  precodepublic String[] parseJsonString strJson      ArrayList list  new ArrayList     try          if strJson  null              JSONArray objList  new JSONArraystrJson             for int i  0 i lt objList.length i                  JSONObject objMsg  JSONObject objList.geti                 if objMsg  null                      String strDR  parseDRJsonStringobjMsg                     if strDR  null                          list.addstrDR                     else                     System.out.printlnJson Parsing Failed  objMsg.toString                                       else                      System.out.printlnJson Obj is null                                                return list.size gt 0  String[] list.toArraynew String[1]  null      catch Exception e          e.printStackTrace          return null  codepre  pPlease help. Also the elements in codevecDRcode is being erased and cleared in a seperate while loop. p
Positive 804 pI built this sample, and generated the shared file and ran it on my phone. I just see a pic. What does this sample supposed to do I can not find anything on it in the docs folder of ndk or online. p
Positive 804 pI have one C application which communicates over Message Queues with other C applications.p  pI am trying to create one Java Application that readswrites communicates queue being used by C application.p  pI have looked on JNI but i dont want to call C routines from Java application. I would only be interested in accessing data being readwrite by C application Is there any possible way to do sop
Positive 804 pIm writing an application where I have lot to do with codeJNIcode call and everytime I have to perform codegettercode call to access variable values. Instead is it possible to access strongObject referencestrong of codeJNIcode object on Java Layer so can get updated variable value just by variable name like codeobj.namecode instead codeobj.getNamecode.p  pI have check with a hrefhttpstackoverflow.comq16323672624806thisa and a hrefhttpstackoverflow.coma239967462624806thisa, but not getting way how to covert address to Object at java layer.p  pstrongEDITstrong I wanted to access Obj this way at Java layer from JNI.p  precodeprivate native CustomObj getCPPCustomObjectPointer codepre  pAny suggestion here.p
Positive 804 precodeThread  Crashed com.octro.rummy 0  libart.so                                          0xb503e482 std1basicostreamltchar, std1chartraitsltchargt gtamp std1operatorltlt ltchar, std1chartraitsltchargt, std1allocatorltchargt gtstd1basicostreamltchar, std1chartraitsltchargt gtamp, std1basicstringltchar, std1chartraitsltchargt, std1allocatorltchargt gt constamp 1  libart.so                                          0xb51b83e9 artThreadDumpStatestd1basicostreamltchar, std1chartraitsltchargt gtamp, artThread const, int 2  libart.so                                          0xb51b8d41 artThreadDumpstd1basicostreamltchar, std1chartraitsltchargt gtamp const 3  libart.so                                          0xb51c1eb1 artThreadListDumpLockedstd1basicostreamltchar, std1chartraitsltchargt gtamp 4  libart.so                                          0xb51a91c7  5  libart.so                                          0xb51a9409 artRuntimeAbort 6  libart.so                                          0xb5039d25 artLogMessageLogMessage 7  libart.so                                          0xb5043985  8  libart.so                                          0xb5043ecf artJniAbortFchar const, char const, ... 9  libart.so                                          0xb50462d1  10 libart.so                                          0xb504eb81  11 libcocos2dcpp.so                                   0xa42269a4 JNIEnvNewStringUTFchar const 12 libcocos2dcpp.so                                   0xa49ed7dc showEditTextDialogJNIchar const, char const, int, int, int, int, void char const, void, bool, void 13 libcocos2dcpp.so                                   0xa4aaefb4 cocos2duiEditBoxImplAndroidopenKeyboard 14 libcocos2dcpp.so                                   0xa4aaab74 cocos2duiEditBoxtouchDownActioncocos2dRef, cocos2duiWidgetTouchEventType 15 libcocos2dcpp.so                                   0xa4aad648 ZNSt3110function6funcINS6bindIMN7cocos2d2ui7EditBoxEFvPNS33RefENS46Widget14TouchEventTypeEEJPS5RNS12placeholders4phILi1EEERNSEILi2EEEEEENS9allocatorISJEEFvS7S9EEclEOS7OS9 16 libcocos2dcpp.so                                   0xa42c5b64 std1functionltvoid cocos2dRef, cocos2duiWidgetTouchEventTypegtoperatorcocos2dRef, cocos2duiWidgetTouchEventType const 17 libcocos2dcpp.so                                   0xa4a7179c cocos2duiWidgetreleaseUpEvent 18 libcocos2dcpp.so                                   0xa4a716e4 cocos2duiWidgetonTouchEndedcocos2dTouch, cocos2dEvent 19 libcocos2dcpp.so                                   0xa4a7759c ZNSt3110function6funcINS6bindIMN7cocos2d2ui6WidgetEFvPNS35TouchEPNS35EventEEJPS5RNS12placeholders4phILi1EEERNSEILi2EEEEEENS9allocatorISJEEFvS7S9EEclEOS7OS9 20 libcocos2dcpp.so                                   0xa4c04688 std1functionltvoid cocos2dTouch, cocos2dEventgtoperatorcocos2dTouch, cocos2dEvent const 21 libcocos2dcpp.so                                   0xa4c03aec  22 libcocos2dcpp.so                                   0xa4c034bc  23 libcocos2dcpp.so                                   0xa4bf5f3c std1functionltbool cocos2dEventListenergtoperatorcocos2dEventListener const 24 libcocos2dcpp.so                                   0xa4bf5c70 cocos2dEventDispatcherdispatchEventToListenerscocos2dEventDispatcherEventListenerVector, std1functionltbool cocos2dEventListenergt constamp 25 libcocos2dcpp.so                                   0xa4bf6bc0 cocos2dEventDispatcherdispatchTouchEventcocos2dEventTouch 26 libcocos2dcpp.so                                   0xa4bf5fdc cocos2dEventDispatcherdispatchEventcocos2dEvent 27 libcocos2dcpp.so                                   0xa4b8479c cocos2dGLViewhandleTouchesOfEndOrCancelcocos2dEventTouchEventCode, int, int, float, float 28 libcocos2dcpp.so                                   0xa4b84a00 cocos2dGLViewhandleTouchesEndint, int, float, float 29 libcocos2dcpp.so                                   0xa49f055c Javaorgcocos2dxlibCocos2dxRenderernativeTouchesEnd 30 mntaseccom.octro.rummy1base.apkclasses.dex    0xa5efc9b3 codepre
Positive 804 pI have an application that uses JNI and the NDK to run native C in background of the UI. The native layer is initialized in codeonCreatecode, and finalized in codeonDestroycode.p  precodepublic class XXXXActivity extends Activity      TermScreenView mTermScreenView  null      Override     protected void onCreate Bundle savedInstanceState               super.onCreate savedInstanceState           try                      this.setRequestedOrientation ActivityInfo.SCREENORIENTATIONLANDSCAPE               setContentView R.layout.activityXXXX              mTermScreenView  TermScreenView findViewById R.id.termScreenView               if  initializeNative                               Toast.makeText getBaseContext, Failed to initialize, Toast.LENGTHLONG .show                 throw new Exception Failed to initialize native layer                                catch Exception exc                       exc.printStackTrace                    Override     public void onDestroy              finalizeNative          super.onDestroy           public native boolean initializeNative      public native boolean finalizeNative       Etc  codepre  pFor some reason, after codeinitializeNativecode ends successfully by returning codetruecode and without throwing any exception in the native code and codeonCreatecode ends successfully too, codeonDestroyedcode gets called several milliseconds after. Nothing is supposed to be called once onCreate ends in my application, except codeonDestroycode when the user quits it.p  pI dont know why codeonDestroycode is called since codeonCreatecode succeeds. What could be the reason p  pThank you p  pEDIT  Here is the code from initializeNative p  precodejboolean XXXXActivityinitializeNative JNIEnv  pEnv, jobject pActivityObject       TRACEI gpJniLog, XXXXActivityinitializeNative  Begin.       if NULL  gpAppAdapt               TRACEI gpJniLog, XXXXActivityinitializeNative  End, already called.          return false           jclass pActivityClass  pEnvgtFindClass XXXXActivity      assert NULL  pActivityClass      TRACEI gpJniLog, XXXXActivityinitializeNative  pActivityClass  p., pActivityClass       gpActivityClass  jclass pEnvgtNewGlobalRef pActivityClass      assert NULL  gpActivityClass       gpActivityObject  jobject pEnvgtNewGlobalRef pActivityObject      assert NULL  gpActivityObject       TRACEI gpJniLog, XXXXActivityinitializeNative  Creating XXXXActivityAdapter.      gpAppAdapt  new XXXXActivityAdapter      TRACEI gpJniLog, XXXXActivityinitializeNative  Initializing XXXXActivityAdapter.      gpAppAdaptgtInitializeInstance      TRACEI gpJniLog, XXXXActivityinitializeNative  End, success.      return true   codepre  pI dont think it would be relevant to provide more since since it would get very big. I can tell you that the function doesnt throw a native exception and doesnt return false.p
Positive 804 pI am writing a simple Hello World Java program to call code from a native library. However, when I run the program, I receive the following errorbrp  precode Exception in thread main java.lang.UnsatisfiedLinkError no TestJNI in java.library.path     at java.lang.ClassLoader.loadLibraryClassLoader.java1764     at java.lang.Runtime.loadLibrary0Runtime.java823     at java.lang.System.loadLibrarySystem.java1044     at TestJNI.ltclinitgtTestJNI.java4 codepre  pBelow is the codebr Javap  precodefilename TestJNI.java  public class TestJNI      static         System.loadLibraryTestJNI              private native void helloWorld      public static void mainString[] args         new TestJNI.helloWorld      codepre  pCbrp  precodefilnameTestJNI.c  include ltjni.hgt include ltstdio.hgt include TestJNI.h  JNIEXPORT void JNICALL JavaTestJNIhelloWorldJNIEnv env, jobject thisObj     printfHello Worldn     return  codepre  pThe C file is compiled with the following compiler, flags and argumentsbr codeclang o TestJNI.jnilib ISystemLibraryFrameworksJavaVM.frameworkHeaders lc shared TestJNI.ccode brThen the Java application is run as belowbr codejava Djava.library.path. TestJNIcodep  pI am compiling and running the files on Mac OS X Yosemite. Does anyone have any idea what I am doing wrongp
Positive 804 pWhen I use codeSystem.loadlibrarycode to load my so file, rarely, it fails and the Logcat says p  precodeCannot load library reloclibrary[1286] 121 cannot locate cxaatexit codepre  pMost of the time, it can work well, but rarely crash as above.p
Positive 804 pI have a C service, which exposes 2 interfacesp  pa. Submit For submitting a DistCp job to YARNRMp  pb. Query For querying the status of the application. p  pThis service internally calls a Java client through JNI, which has 2 static functionsp  ol lipSubmitpli lipQuerypli ol  pSubmit doesp  precodeDistCp distCp  new DistCpconfiguration, distCpOptions Job job  distCp.execute Parses the application ID from the tracking URL and returns it. codepre  pQuery does p  precodeTakes application ID returned in Submit YarnClient yarnClient  YarnClient.createYarnClient yarnClient.initnew YarnConfiguration yarnClient.start yarnClient.getApplicationReportapplicationID  yarnClient.stop codepre  pThe problem I am facing is,p  ol liIf the first call to the service is Submit, then all the subsequent calls both Submit and Query SUCCEEDli liBut, if the first call to the service is Query, then all the Submit calls FAIL. li ol  pQuery calls succeed under all the conditions.p  pThe Submit calls fail with errors 1st call, 2nd call and 3rd call below, with different exceptionsp  ol lijava.util.ServiceConfigurationError org.apache.hadoop.mapreduce.protocol.ClientProtocolProvider Provider org.apache.hadoop.mapred.LocalClientProtocolProvider not foundli lijava.util.ServiceConfigurationError org.apache.hadoop.mapreduce.protocol.ClientProtocolProvider Provider org.apache.hadoop.mapred.YarnClientProtocolProvider not foundli lijava.io.IOException Cannot initialize Cluster. Please check your configuration for mapreduce.framework.name and the correspond server addresses.li ol  pI debugged the issue and figured out that, when Query API is called first, then classes LocalClientProtocolProvider and YarnClientProtocolProvider are not loaded. The class loader should load these classes, when Submit is called. But, that is not happening.p  pI also observed that, when the Query API is called first, the Hadoop configuration gets changed and contains lot many default settings related to mapreduce. configuration.p  pI tried explicit loading using Class.forName, as soon as the Submit method is called. But, that did not help either.p  pWhen Submit is called, why does not the class loader load the required classes Is this the problem with Hadoop configuration or Java class loader Or is it the problem because I am mixing MapReduce and Yarn APIsp  pmapreduce.framework.name configuration is set to yarn.p  pMy environment is Hadoop 2.6.0.p  pMy classpath contains, all the Hadoop jars present in following pathsp  pa. hadoopcommonp  pb. hadoopcommonlibp  pc. hadoophdfsp  pd. hadoophdfslibp  pe. hadoopmapreducep  pf. hadoopmapreducelibp  pg. hadoopyarnp  ph. hadoopyarnlibp  pstrongEDIT 1strongp  pI figured out that, I am mixing Yarn and MapReduce APIs and that is causing some problems. When Query is called first, it loads all YARN related classes. For e.g.p  porg.apache.hadoop.yarn.client.api.YarnClient from fileDdatahadoop2 .6.0SNAPSHOTsharehadoopyarnhadoopyarnclient2.6.0SNAPSHOT.jarp  pBut, the MapReduce related classes are not loaded. For e.g. p  porg.apache.hadoop.mapred.YarnClientProtocolProvider from fileDdatah adoop2.6.0SNAPSHOTsharehadoopmapreducehadoopmapreduceclientjobclient2. 6.0SNAPSHOT.jar p  pSo, when the Submit is called, the class loader assumes that, it has loaded all the required classes. But, classes YarnClientProtocolProvider and LocalClientProtocolProvider are not loaded yet. Hence, the Submit call fails.p  pTo force the class loader to load all the MapReduce related classes, I added following statements in the constructor for YarnClientWrapper which is a singleton class.p  precodeCluster cluster  new Clusterconfiguration cluster.getFileSystem cluster.close codepre  pThis resolved the issue.  But, cleaner implementation would be to use MapReduce client in Query instead of YarnClient. This will ensure that, we will not get into class loading issues.p
Positive 804 pAs the title says.p  pSuppose the max heap size is 50MB , yet the device has 2GB of RAM, will Renderscript be able to use the 2GB or will it be constrained to the 50MB p  pIf it will be constrained to the 50MB , is it possible to use the 2GB instead somehowp  pIf it wont be constrained to the 50MB , how do I use it this way p  pAnd, does the Allocation usage actually allocate more memory, or is it more of binding of the data of the bitmap to be used on Renderscript  p  pIm asking this because sometimes youd want to use a lot of memory to handle a task, even though the input and the output might be small in memory usage.p
Positive 804 pI intend to use an array of bytes as a C string. p  pI am interested in both the zerolength and nonzero length conditions.p
Positive 804 pIs there a better way to run NDK Lib  JNI unit tests on device using Android Studio amp Gradlep  pCurrently p  pBuild all NDK source and then use adb to push the built files to a tmp directory on devicep  pe.gp  precodeadb push libsarmeabi datalocaltmp done codepre  pRun all of the tests on devicep  precodeadb shell LDLIBRARYPATHdatalocaltmp datalocaltmprunallunitTests codepre  pExtract resultsp  precodeadb pull datalocaltmptestresults.xml  codepre
Positive 804 pI am new to jni and objective c. I want to convert CFArray to int[] in java and return the data.p  pI have tried the following 2 methods but I didnt get the result.p  precodeCFArrayRef windowids CGWindowListCreatekCGWindowListOptionOnScreenOnly ,kCGNullWindowID  jintArray res  jenvgtNewIntArrayjenv, CFArrayGetCountwindowids for int i0iltCFArrayGetCountwindowidsi     res[i]CFArrayGetValueAtIndexwindowids,i  return res codepre  pandp  precodeCFArrayRef windowids CGWindowListCreatekCGWindowListOptionOnScreenOnly ,kCGNullWindowID  jintArray res  jenvgtNewIntArrayjenv, CFArrayGetCountwindowids jenvgtSetIntArrayRegionjenv, res, 0, CFArrayGetCountwindowids, windowids return res codepre  pHow to properly convert the CFArrayRef to java int arrayp
Positive 804 pI am writing a library for clojure which involves native code. How can I bundle the shared library aka native dependencies when I deploy the clojure libraries to public repositories like clojarsp  h2Further Infoh2  pMy project structure looks roughly likep  precodesrc     native      C code , C Object files and compiled shared libs     java        Java stuff     clojure     Clojure stuff codepre  pI am currently using leineingen. I have tried doingp  precodejvmopts [str Djava.library.pathsrcnative           Systemgetenv LDLIBRARYPATH] codepre  pIt works if I am in the project. However, if I include this project as a dependency, I will get a codeUnsatisfiedLinkcode error.p
Positive 804 pFor some reason, when I call codeGetEnvcode, it returns NULL. I know that this is a normal behaviour when calling it from a thread that in not attached to the VM object but, in my case, Im calling it from codeJNIOnLoadcode, which is called when I call codeSystem.loadLibrarycode on the JAVA, should it shoult not be NULL.p  pJNI.h p  precodeclass JNI  public      static jint OnLoad JavaVM  pJavaVM, void  reserved       static JNIEnv  GetEnv       Etc...  codepre  pJNI.cpp p  precodejint JNIOnLoad JavaVM  pJavaVM, void  reserved       static bool bFirstCall  true      if  bFirstCall               LOGCATE TnxJNIOnLoad  Cannot call this function more than once.          return 1           bFirstCall  false      LOGCATI TnxJNIOnLoad  Begin, pJavaVM  p., pJavaVM       spJavaVM  pJavaVM      try              JNIEnv  pEnv  GetEnv  THROWS HERE           More stuff...          catch const exception amp oExc               LOGCATE TnxJNIOnLoad  Failed, exception  s., oExc.what          return false          catch ...               LOGCATE TnxJNIOnLoad  Failed, unknown exception.          return false           LOGCATI TnxJNIOnLoad  End, success.      return JNIVERSION14   JNIEnv  JNIGetEnv      JNIEnv  const pEnv  NULL      if NULL  spJavaVM          throw runtimeerror TnxJNIGetEnv  spJavaVM is NULL.       spJavaVMgtGetEnv void  amp pEnv, JNIVERSION14       if NULL  pEnv          throw runtimeerror TnxJNIGetEnv  Failed to get JNI environment.       return pEnv   jint JNICALL JNIOnLoad JavaVM  pJavaVM, void  reserved       return TnxJNIOnLoad pJavaVM, reserved   codepre  p.java p  precodepublic class XXXXActivity extends Activity      static              System.loadLibrary XXXXNative            private native static boolean initializeNative XXXXActivity XXXXActivity, TermScreenView termScreenView       private native static boolean finalizeNative      private native boolean initializeInstance      private native boolean finalizeInstance      private TermScreenView mTermScreenView  null      Override     protected void onCreate Bundle savedInstanceState               Log.v , XXXXActivityonCreate  Begin.           super.onCreate savedInstanceState           try                      this.setRequestedOrientation ActivityInfo.SCREENORIENTATIONLANDSCAPE               setContentView R.layout.activityXXXX              mTermScreenView  TermScreenView findViewById R.id.termScreenView                   catch Exception exc                       exc.printStackTrace                   if null  savedInstanceState                       Log.v , XXXXActivityonCreate  First call to onCreate, initializing native layer.               if  initializeNative this, mTermScreenView  ampamp initializeInstance                  Toast.makeText getBaseContext, Failed to initialize, Toast.LENGTHLONG .show                   Log.v , XXXXActivityonCreate  End.             Etc...  codepre  pLog p  precode1001 130714.460 Ddalvikvm29694 Trying to load lib datadataXXXX.XXXXliblibXXXXNative.so 0x41970d10 1001 130714.460 Ddalvikvm29694 Added shared lib datadataXXXX.XXXXliblibXXXXNative.so 0x41970d10 1001 130714.463 IXXXX.XXXX29694 TnxJNIOnLoad  Begin, pJavaVM  0x40f34948. 1001 130714.463 EXXXX.XXXX29694 TnxJNIOnLoad  Failed, exception  TnxJNIGetEnv  Failed to get JNI environment.. 1001 130714.463 Wdalvikvm29694 JNIOnLoad returned bad version 0 in datadataXXXX.XXXXliblibXXXXNative.so 0x41970d10 1001 130715.123 Ddalvikvm29694 threadid1 still suspended after undo sc1 dc1 codepre  pAny idea why it could be NULL  Thanks.p
Positive 804 pI am find the index a CGWindowID from the CFArrayRef. This is my code.p  precodeCFArrayRef window2ids CGWindowListCreatekCGWindowListOptionOnScreenOnly ,kCGNullWindowID jint windowid  440  I have selected this id from the CFArrayRef and trying to find the index CFRange range  0, CFArrayGetCountwindow2ids const void p p  ampwindowid CFIndex index  CFArrayGetFirstIndexOfValuewindow2ids, range, p return index codepre  pBut the above code is always returning code1code. Which means the window id is not present in the CFArrayRef. How is that possible if I am selecting the window id from that array How to solve my issuep
Positive 804 pI have an Android Project in Eclipse 4.5. I have a jni folder with .c and .h files. I also have .so file which needs to be added to lib folder. But I dont know how to add these to my Android Project and make my Project running. Any kind of assistance would help me.p
Positive 804 pI have a project that I am working on that uses a NativeActivity, along with the androidnativeappglue files to connect to the Java side. I need to access a few non NDK classes through Java and have figured out how to make the calls from C to Java, however I am having issues with the reverse. When calling from Java to C I get No implementation found for  etc..., I have checked most of the pitfalls for this kind of call and believe everything is correct. Here is the Activity class.p  precodepackage com.JNITest  import android.app.NativeActivity import android.util.Log  public class JniNativeActivity extends NativeActivity      private static String TAG  JniNativeActivity      public static native void nativeJniCall      public JniNativeActivity              super         Log.vTAG, Creating JniNativeActivity           public void testCall              Log.vTAG, Calling native         nativeJniCall       codepre  pSince this is a NativeActivity using the glue code there is no JNIOnLoad called, the entry point is androidmain which the glue code has setup to run in its own thread. p  precodevoid androidmainstruct androidapp state      testcallstategtactivity     etc...   ...  void testcallANativeActivity activity      JNIEnv jni      activitygtvmgtAttachCurrentThreadampjni, NULL      jclass activityClassjnigtGetObjectClassactivitygtclazz     jmethodID testCallIdjnigtGetMethodIDactivityClass, testCall, V      jnigtCallVoidMethodactivitygtclazz, testCallId   extern C      JNIEXPORT void JNICALL JavacomJNITestJniNativeActivitynativeJniCallJNIEnv , jclass              LOGInativeJniCall       codepre  pfrom logcatp  precode... waiting for debugger to settle... waiting for debugger to settle... debugger has settled 1388 Creating JniNativeActivity Creating 0xb420b100 Config mcc0 mnc0 langen cntUS orien2 touch3 dens576 keys2 nav1 keysHid1 navHid0 sdk22 size2 long1 modetype1 modenight1 Start 0xb420b100 removeObsoleteFile deleting file161task.xml Calling native No implementation found for void com.JNITest.JniNativeActivity.nativeJniCall tried JavacomJNITestJniNativeActivitynativeJniCall and JavacomJNITestJniNativeActivitynativeJniCall activityState10 Resume 0xb420b100 activityState11 Adding window Window2b21e24c u0 com.JNITestcom.JNITest.JniNativeActivity at 2 of 8 before Window3238fdec u0 Starting com.JNITest InputQueueCreated 0xb420b100  0xb420b880 APPCMDINPUTCHANGED Attaching input queue to looper NativeWindowCreated 0xb420b100  0xb417ae08 APPCMDINITWINDOW Waiting for host to establish connection WindowFocusChanged 0xb420b100  1 Accepting new connection from local client Accepted new client connection PID  3945, fd  39 Requesting connection from host Sending initiation request to host Accepting new connection from host service Accepted new host connection fd  40 Connecting local socket 39 to host socket 40 HostConnectionget New Host Connection established 0xb4272e50, tid 3976 Displayed com.JNITest.JniNativeActivity 5s618ms codepre  pThe fact that anything runs implies that the library is loaded, it is also in the logp  precode... threadcreated,id9,groupidi1[New Thread 3958] threadcreated,id10,groupidi1[New Thread 3959] threadcreated,id11,groupidi1[New Thread 3960] Loaded DprojectsJNITestJNITestJNITest.Android.NativeActivityx86DebuglibJNITest.so threadcreated,id12,groupidi1[New Thread 3976] [Switching to Thread 3976] threadcreated,id13,groupidi1[New Thread 3975] Loaded gralloc.donatello.so ... codepre  pI have verified its name with javahp  precodeextern C  endif    Class     comJNITestJniNativeActivity   Method    nativeJniCall   Signature V   JNIEXPORT void JNICALL JavacomJNITestJniNativeActivitynativeJniCall   JNIEnv , jclass  ifdef cplusplus  endif codepre  pI have also checked the library externs and the function is therep  precode...          U glRotatef          U glShadeModel          U glTranslatef          U glVertexPointer          U glViewport 00007004 D indices 00004b70 T JavacomJNITestJniNativeActivitynativeJniCall          U malloc          U memcpy          U memset          U pipe ... codepre  pI had this issue in another project and created a test app where the code above is from so it is not some random unique config problem. I am at a bit of a loss on this one, I am assuming it has some issue with the NativeActivity and glue code likely the threading but not sure how to work around it. Any help would be appreciated.p
Positive 804 pI have successfully modified my build.gradle to work with gradleexperimental however when trying to add a signingConfigs block it fails.  I followed the instructions from a hrefhttptools.android.comtechdocsnewbuildsystemgradleexperimental relnofollowhttptools.android.comtechdocsnewbuildsystemgradleexperimentala as best I can but i always get the following errorp  blockquote   pA problem occurred configuring project app.p      blockquote     pThe following model rules are unbound         model.android.signingConfigs  namedrelease           Mutable              android.signingConfigs.release com.android.build.gradle.managed.SigningConfigp   blockquote blockquote  pI search for the error but couldnt find anything relevant.  What does The following model rules are unbound meanp  pHeres what my signingConfig block looks like, its outside the android block and modified to use  as is the case when using gradleexperimental.p  precodeandroid.signingConfigs      release          storeFile  filemyreleasekey.keystore         storePassword  password         keyAlias  MyReleaseKey         keyPassword  password       codepre
Positive 804 pI want to use some jni libraries. So I put binaries like thisp  precodeproject app jnilibs armeabi libqwerty.so codepre  pand in my build.gradle app modulep  precodesourceSets.main      jniLibs.srcDirs  [jniLibs]  codepre  pit works as expected, however when I add renderscript to my projectp  precoderenderscriptTargetApi 22 renderscriptSupportModeEnabled true codepre  papplication doesnt see my jniLibs directory anymore. And the content of codegetApplicationInfo.nativeLibraryDircode is code[libRSSupport.so, librsjni.so]codep  pstrongUPDATEstrong ok, I was able to resolve this issue with just renaming directory codearmeabicode to codearmeabiv7acode. However what if I want to support some other cpuarchitecturesp
Positive 804 pI am writing a Java application which uses FFmpeg. Therefore I use JNI to execute some native code. Compiling my shared object works without problems, but when I execute my code I get the following errorp  precodeusrlocaljamaica6.31targetlinuxx8664binjamaicavmbin symbol lookup error hometobiworkspacesenderliblibsender.so undefined symbol avframealloc codepre  pavframealloc is a method of FFmpegs libavutil library. I linked my shared object against a few FFmpeg libraries such as libavcodec, libavutil, etc., but Im not able to execute methods from libavutil.  When I run the nm command I get the following resultp  precodetobitobiworkspacesenderlib nm libsender.so               U avcodecalloccontext3LIBAVCODEC54              U avcodeccopycontextLIBAVCODEC54              U avcodecfinddecoderLIBAVCODEC54              U avcodecfindencoderLIBAVCODEC54              U avcodecopen2LIBAVCODEC54              U avdumpformatLIBAVFORMAT54              U avformatfindstreaminfoLIBAVFORMAT54              U avformatopeninputLIBAVFORMAT54              U avframealloc              U avimageallocLIBAVUTIL52              U avlogLIBAVUTIL52              U avregisterallLIBAVFORMAT54 codepre  pSo, obviously, there is something wrong with avframealloc. Why do I get a symbol lookup error every time I want to call avframeallocp  pThanksp
Positive 804 ppHi allp pI have a Native Java application in linux and i want detect memory weak. I try used Valgrind but seem that dont work fine. Then I tried to also install codedbx Oracle Studiocode but it seems that is not available for codeUbuntu 14.04code. Is there another solution that can be used to detect these leaks pp
Positive 804 pEvery time i try to build an android app, that uses ndk to run native code, i get the following errorp  precodeErrorGradle Execution failed for task sampleNDKndkBuild. gt Process command CNDKandroidndkr10endkbuild.cmd finished with nonzero exit value 2 codepre  pI use Intellij with a grandle projekt. I think the error appears in this function in the build.gradle filep  precodetask ndkBuildtype Exec      def ndkDir  plugins.getPlugincom.android.application.sdkHandler.getNdkFolder      iforg.gradle.internal.os.OperatingSystem.current.windows         commandLine ndkDirndkbuild.cmd, NDKPROJECTPATHsrcmain         does not work too         commandLine ndkDirndkbuild.cmd, NDKPROJECTPATHsrcmain     else         commandLine ndkDirndkbuild, NDKPROJECTPATHsrcmain       codepre  pIn fact that im using windows, i think the error appears in the if case.p  pDoes anyone know what went wrong or what i can try to avoid the failurep
Positive 804 pIm attempting to build NDK compatible code that works and has been tested, but Im getting the following error during the build processp  precode[armeabiv7a] Compile thumb   cpufeatures lt cpufeatures.c UsersseanLibraryAndroidsdkndkbundlesourcesandroidcpufeaturescpufeatures.c In function getelfhwcapfromprocselfauxv UsersseanLibraryAndroidsdkndkbundlesourcesandroidcpufeaturescpufeatures.c5345 warning implicit declaration of function typeof [Wimplicitfunctiondeclaration]      int fd  TEMPFAILURERETRYopenfilepath, ORDONLY       In file included from UsersseanLibraryAndroidsdkndkbundleplatformsandroid14archarmusrincludefcntl.h340,                  from UsersseanLibraryAndroidsdkndkbundlesourcesandroidcpufeaturescpufeatures.c75 UsersseanLibraryAndroidsdkndkbundleplatformsandroid14archarmusrincludeunistd.h20718 error expected  before rc      typeof exp rc                                          UsersseanLibraryAndroidsdkndkbundlesourcesandroidcpufeaturescpufeatures.c53414 note in expansion of macro TEMPFAILURERETRY      int fd  TEMPFAILURERETRYopenfilepath, ORDONLY                UsersseanLibraryAndroidsdkndkbundleplatformsandroid14archarmusrincludeunistd.h2099 error rc undeclared first use in this function          rc  exp                                  UsersseanLibraryAndroidsdkndkbundlesourcesandroidcpufeaturescpufeatures.c53414 note in expansion of macro TEMPFAILURERETRY      int fd  TEMPFAILURERETRYopenfilepath, ORDONLY                UsersseanLibraryAndroidsdkndkbundleplatformsandroid14archarmusrincludeunistd.h2099 note each undeclared identifier is reported only once for each function it appears in          rc  exp                                  UsersseanLibraryAndroidsdkndkbundlesourcesandroidcpufeaturescpufeatures.c53414 note in expansion of macro TEMPFAILURERETRY      int fd  TEMPFAILURERETRYopenfilepath, ORDONLY                UsersseanLibraryAndroidsdkndkbundleplatformsandroid14archarmusrincludeunistd.h20718 error expected  before rc      typeof exp rc                                          UsersseanLibraryAndroidsdkndkbundlesourcesandroidcpufeaturescpufeatures.c54419 note in expansion of macro TEMPFAILURERETRY          int ret  TEMPFAILURERETRYreadfd, charampentry, sizeof entry                     make  [objlocalarmeabiv7aobjscpufeaturescpufeatures.o] Error 1 codepre  pIve tried setting APABI to different architectures, but with more or less the same result. My local dev environment is OSX and Im running this directly using codendkclean amp ndkbuildcodep  pAnyone else figure this out p
Positive 804 pIm trying to return a string from native. For that Im using the following code.p  pNativep  precodeinclude ltstring.hgt include ltjni.hgt  jstring JavacomtestDemogetStringJNIEnv env, jobject javaThis      return envgtNewStringUTFenv, hello  codepre  pJavap  precodeprivate native String getString in com.test.Demo codepre  pAfter this Im generating .so files using codendkbuildcode and including them in codejniLibscode. p  pHowever, the string returned is null. Any ideas on what is wrong p
Positive 804 pIm trying to use a python interpreter in my Android app to run SymPy. I already compiled Python for arm using this guide. a hrefhttpmdqinc.comblog201109crosscompilingpythonforandroid relnofollowhttpmdqinc.comblog201109crosscompilingpythonforandroidap  pThis got me a libpython2.7.so file which I put into jniLibsarmeabi. In my app I load it as followsp  precodepublic class PythonTest      static          System.loadLibrarypython2.7           public static native void PyInitialize     public static native void PyFinalize     public static native int PyRunSimpleStringString s  codepre  pI am trying to use the methods from the headers located in the include directory which can also be found here a hrefhttpsdocs.python.org2capi relnofollowhttpsdocs.python.org2capiap  pWhen I run the app on my device I get the following errorp  precodeNo implementation found for void com.example.dorian.testapplication.PythonTest.PyInitialize tried JavacomexampledoriantestapplicationPythonTestPy1Initialize and JavacomexampledoriantestapplicationPythonTestPy1Initialize codepre  pSo to me this seems like the library loaded but it seems to look for the JNIEXPORT functions. But shouldnt I be able to use this library without writing specific C files And if not, how would I accomplish this. Might there be a tool to generate wrapper files or something similarp
